System.register("chunks:///_virtual/AAModelLayer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./BaseLayer.ts"],(function(o){var t,n,e,r;return{setters:[function(o){t=o.inheritsLoose},function(o){n=o.cclegacy,e=o._decorator},function(o){r=o.BaseLayer}],execute:function(){var c;n._RF.push({},"9a6458D4U5M1pdY0YQYdSP8","AAModelLayer",void 0);var i=e.ccclass;e.property,o("ModelLayer",i("ModelLayer")(c=function(o){function n(){return o.apply(this,arguments)||this}t(n,o);var e=n.prototype;return e.onLoad=function(){o.prototype.onLoad.call(this)},e.onEnable=function(){o.prototype.onEnable.call(this)},e.onDisable=function(){o.prototype.onDisable.call(this)},e.onDestroy=function(){o.prototype.onDestroy.call(this)},e.initUI=function(){},e.processEvent=function(o,t){},e.onButtonClick=function(o,t){},n}(r))||c);n._RF.pop()}}}));

System.register("chunks:///_virtual/AnimationCtrl.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(n){var t,i,e,o,a,s,l,p;return{setters:[function(n){t=n.inheritsLoose,i=n.asyncToGenerator,e=n.regeneratorRuntime},function(n){o=n.cclegacy,a=n._decorator,s=n.sp,l=n.Animation,p=n.Component}],execute:function(){var r;o._RF.push({},"517fcBVlr9DKIQaityUmdFx","AnimationCtrl",void 0);var m=a.ccclass;a.property,n("AnimationCtrl",m("AnimationCtrl")(r=function(n){function o(){for(var t,i=arguments.length,e=new Array(i),o=0;o<i;o++)e[o]=arguments[o];return(t=n.call.apply(n,[this].concat(e))||this).spineSkeleton=void 0,t.animationComponent=void 0,t.lastAni=void 0,t.lastLoop=void 0,t.animationEndCallback=void 0,t}t(o,n);var a=o.prototype;return a.onLoad=function(){this.spineSkeleton||(this.spineSkeleton=this.getComponent(s.Skeleton)),this.spineSkeleton||(this.spineSkeleton=this.getComponentInChildren(s.Skeleton)),this.spineSkeleton||(this.animationComponent=this.getComponent(l)),this.animationComponent||(this.animationComponent=this.getComponentInChildren(l)),this.animationComponent&&this.animationComponent.on(l.EventType.FINISHED,this.animationFinished,this)},a.setSpineSkeletonNode=function(n){this.spineSkeleton=n.getComponent(s.Skeleton)},a.setAnimationNode=function(n){this.animationComponent=n.getComponent(l)},a.pauseAnimation=function(){this.spineSkeleton&&(this.spineSkeleton.paused=!0)},a.resumeAnimation=function(){this.spineSkeleton&&(this.spineSkeleton.paused=!1)},a.animationFinished=function(n,t){n==l.EventType.FINISHED&&this.animationEndCallback&&this.animationEndCallback(t.name)},a.playAnimation=function(n,t,i){if(void 0===t&&(t=!0),n)return this.spineSkeleton?(this.spineSkeleton.loop=t,this.spineSkeleton.setAnimation(0,n,t),void(i?this.spineSkeleton.setCompleteListener((function(){i(n)})):this.spineSkeleton.setCompleteListener(null))):this.animationComponent?(this.animationEndCallback=i,void this.animationComponent.play(n)):void 0},a.playAnimationOnce=function(){var n=i(e().mark((function n(t,i){var o=this;return e().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",new Promise((function(n,e){if(!t)return n(),void(i&&i());o.spineSkeleton&&(null==o.lastAni&&(o.lastAni=o.spineSkeleton.animation),null==o.lastLoop&&(o.lastLoop=o.spineSkeleton.loop)),o.playAnimation(t,!1,(function(){o.spineSkeleton&&(o.playAnimation(o.lastAni,o.lastLoop),o.lastAni=void 0,o.lastLoop=void 0),n(),i&&i()}))})));case 1:case"end":return n.stop()}}),n)})));return function(t,i){return n.apply(this,arguments)}}(),o}(p))||r);o._RF.pop()}}}));

System.register("chunks:///_virtual/AnimationTrack.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./utilTools.ts","./mapModel.ts"],(function(t){var i,a,o,n,e,s,r,c,h,l,d;return{setters:[function(t){i=t.inheritsLoose},function(t){a=t.cclegacy,o=t._decorator,n=t.Tween,e=t.Vec2,s=t.tween,r=t.v3,c=t.Component},function(t){h=t.cocosUtil},function(t){l=t.utilTools},function(t){d=t.mapModel}],execute:function(){var u;a._RF.push({},"1aaeck613xITIbUbbtA/wml","AnimationTrack",void 0);var v=o.ccclass;o.property,t("AnimationTrack",v("AnimationTrack")(u=function(t){function a(){for(var i,a=arguments.length,o=new Array(a),n=0;n<a;n++)o[n]=arguments[n];return(i=t.call.apply(t,[this].concat(o))||this).duration=.6,i.time=0,i.g=-2e3,i.v=800,i.vx=0,i.vy=0,i.endY=0,i.aniFlag=0,i.targetPos=void 0,i.endCallback=void 0,i}i(a,t);var o=a.prototype;return o.startShowThrow=function(t){this.endCallback=t,this.aniFlag=1,n.stopAllByTarget(this.node);var i=l.getFloatValue(l.angleToRadian(75),l.angleToRadian(85));Math.random()>.5&&(i=Math.PI-i),this.v=800+200*Math.random(),this.vx=this.v*Math.cos(i),this.vy=this.v*Math.sin(i),this.endY=this.node.position.y-20-50*Math.random()},o.startBeiSaiEr=function(){this.aniFlag=2,this.targetPos=h.convertToWorldSpace(d.mapLayer.coinIconNode)},o.moveTargetUpdate=function(t){var i=h.convertToNodeSpace(this.node,this.targetPos),a=d.player.node.position;i.x+=a.x,i.y+=a.y;var o=this.node.getPosition();if(e.distance(o,i)<=20)this.endCallback&&this.endCallback();else{var n=i.subtract(o).normalize(),s=1500*t;n.multiplyScalar(s),o.add(n),this.node.position=o}},o.showThrowUpdate=function(t){var i=this,a=this.node.getPosition();if(a.x+=this.vx*t,a.y+=this.vy*t,this.vy+=this.g*t,this.node.setPosition(a),a.y<=this.endY){this.aniFlag=0;var o=15;this.vx<0&&(o=-o),s(this.node).by(.1,{position:r(o,40)},{easing:"quadOut"}).by(.1,{position:r(o,-40)},{easing:"quadIn"}).delay(.5+.3*Math.random()).call((function(){i.startBeiSaiEr()})).start()}},o.update=function(t){switch(this.aniFlag){case 1:this.showThrowUpdate(t);break;case 2:this.moveTargetUpdate(t)}},a}(c))||u);a._RF.pop()}}}));

System.register("chunks:///_virtual/AscendLayer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./audioManager.ts","./ServerCtr.ts","./UserData.ts","./constants.ts","./layerManager.ts","./BaseUILayer.ts"],(function(e){var t,n,i,r,a,o,s,l,c,u,d,h,p,f,g,y,C,m,v;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,i=e.initializerDefineProperty,r=e.assertThisInitialized,a=e.asyncToGenerator,o=e.regeneratorRuntime},function(e){s=e.cclegacy,l=e._decorator,c=e.Node,u=e.sp,d=e.Prefab,h=e.Label,p=e.instantiate},function(e){f=e.audioManager},function(e){g=e.default},function(e){y=e.UserData},function(e){C=e.constants},function(e){m=e.layerManager},function(e){v=e.BaseUILayer}],execute:function(){var b,B,k,P,I,N,w,L,S,D,A,E,M,T,x,U,z,R,_,G,H,V,O,q,F,$,j,W,J,K,Q,X,Y,Z,ee,te,ne;s._RF.push({},"18a28eNwI5P+qmnE6qFWIoG","AscendLayer",void 0);var ie=l.ccclass,re=l.property;e("AscendLayer",(b=ie("AscendLayer"),B=re({type:c,tooltip:"GrayMask"}),k=re({type:c,tooltip:"propagationStopped"}),P=re({type:u.Skeleton,tooltip:"hero"}),I=re({type:c,tooltip:"btnBack"}),N=re({type:c,tooltip:"Mask"}),w=re({type:c,tooltip:"道具列表View"}),L=re({type:c,tooltip:"道具列表Content"}),S=re({type:c,tooltip:"confirmBox"}),D=re({type:c,tooltip:"confirmMask"}),A=re({type:d,tooltip:"选中角色卡片"}),E=re({type:c,tooltip:"升级信息"}),M=re({type:c,tooltip:"所需碎片数量"}),T=re({type:c,tooltip:"碎片数量提示"}),x=re({type:c,tooltip:"升级按钮"}),U=re({type:h,tooltip:"succRate"}),z=re({type:h,tooltip:"需要合成的等级"}),R=re([c]),b((H=t((G=function(e){function t(){for(var t,n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return t=e.call.apply(e,[this].concat(a))||this,i(t,"GrayMask",H,r(t)),i(t,"propagationStopped",V,r(t)),i(t,"herosk",O,r(t)),i(t,"btnBack",q,r(t)),i(t,"Mask",F,r(t)),i(t,"scrollView",$,r(t)),i(t,"scrollViewContent",j,r(t)),i(t,"confirmBox",W,r(t)),i(t,"confirmMask",J,r(t)),i(t,"ascendSel",K,r(t)),i(t,"ascendInfo",Q,r(t)),i(t,"ascendNeed",X,r(t)),i(t,"ascendNeedTip",Y,r(t)),i(t,"ascendBtn",Z,r(t)),i(t,"succRate",ee,r(t)),i(t,"upDataLevel",te,r(t)),i(t,"buttons",ne,r(t)),t.bgNodes=[],t.rootNode=void 0,t.allEquipmentList=[],t.rarityList=["R","SR","UR"],t.rarity=t.rarityList[0],t.selCharacter=[],t.ascendInfoData=null,t}n(t,e);var s=t.prototype;return s.onLoad=function(){e.prototype.onLoad.call(this),this.rootNode=this.node},s.start=function(){var e=this;this.initList(),this.buttons.forEach((function(t,n){var i=t.getChildByName("bg");i&&e.bgNodes.push(i),t.on(c.EventType.TOUCH_END,(function(t){e.onButtonIconClick(t,n)}),e)})),this.btnBack.on(c.EventType.TOUCH_END,(function(t){e.closeLayer()}),this),this.propagationStopped.on(c.EventType.TOUCH_END,(function(e){e.propagationStopped=!0}),this),this.GrayMask.on(c.EventType.TOUCH_END,(function(t){e.Mask.active=!1}),this)},s.onButtonIconClick=function(e,t){var n=this;f.playEffect("btnClick"),this.bgNodes.forEach((function(e,n){e.active=n===t})),this.rarity=this.rarityList[t];var i=this.allEquipmentList.filter((function(e){return e.details.rarity===n.rarity}));this.setScrollViewUi(i)},s.initList=function(){var e=a(o().mark((function e(){var t,n,i=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.herosk.node.active=!1,this.renderAscendSelList(),e.prev=2,this.rootNode.getChildByName("Loading").active=!0,e.next=6,g.GetInstance().getSkinsByUserId(y.getInstance().getUserServerData().userId,"skin");case 6:return t=e.sent,this.allEquipmentList=t,n=this.allEquipmentList.filter((function(e){return e.details.rarity===i.rarity})),this.setScrollViewUi(n),n[0]&&this.herosk.setSkin(n[0].details.name.toLowerCase()),e.abrupt("return",t);case 14:e.prev=14,e.t0=e.catch(2),console.log("🚀 ~ AscendLayer ~ initList ~ error:",e.t0);case 17:return e.prev=17,this.rootNode.getChildByName("Loading").active=!1,e.finish(17);case 20:case"end":return e.stop()}}),e,this,[[2,14,17,20]])})));return function(){return e.apply(this,arguments)}}(),s.setScrollViewUi=function(e){var t=this;this.scrollViewSetData(this.scrollView,e,(function(n,i,r){var s;t.setSpriteFrame2(n.getChildByPath("hero"),"skins/"+(null==i||null==(s=i.details)?void 0:s.icon),null,C.bundles.resources),n.getChildByPath("level").getComponent(h).string=i.details.level,n.off(c.EventType.TOUCH_END),n.on(c.EventType.TOUCH_END,a(o().mark((function n(r){var a,s;return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(t.upDataLevel.node.active=!0,t.upDataLevel.string="+"+(i.details.level+1),!(t.selCharacter.length>=5)){n.next=4;break}return n.abrupt("return");case 4:if(!t.selCharacter.some((function(e){return e.id===i.id}))){n.next=6;break}return n.abrupt("return");case 6:return t.selCharacter.some((function(e){return e.details.id!==i.details.id}))&&(t.selCharacter=[]),n.next=9,t.renderAscendInfo(i.details.id);case 9:if(t.selCharacter.push(i),t.selCharacter.length<t.ascendInfoData.upgradeNeedNum)for(a=e.filter((function(e){return e.id!==i.id&&e.details.id===i.details.id})),s=0;s<t.ascendInfoData.upgradeNeedNum-1;s++)a.length>0&&a[s]&&t.selCharacter.push(a[s]);t.selCharacter[0]&&t.herosk.setSkin(t.trimHeroSkin(t.selCharacter[0].details.icon.toLowerCase())),t.renderAscendSelList(),t.herosk.node.active=!0;case 14:case"end":return n.stop()}}),n)}))),t),n.getChildByPath("Mask").active=!1})),this.renderAscendSelList()},s.trimHeroSkin=function(e){return e.replace(/^skin_hero(\d+)$/,"skin$1")},s.renderAscendSelList=function(){var e=this;this.ascendInfo.active=this.selCharacter.length>0;var t=this.propagationStopped.getChildByPath("btnList");t.removeAllChildren();for(var n=function(n){var i=p(e.ascendSel);i.active=!0,e.selCharacter[n]?(e.setSpriteFrame2(i.getChildByPath("character/hero"),"skins/"+e.selCharacter[n].details.icon,null,C.bundles.resources),i.getChildByPath("character").active=!0,i.getChildByPath("nocharacter").active=!1,i.on(c.EventType.TOUCH_END,(function(t){e.selCharacter.splice(n,1),e.setAscendNeedTip(),e.renderAscendSelList()}),e)):(i.getChildByPath("character").active=!1,i.getChildByPath("nocharacter").active=!0),t.addChild(i)},i=0;i<5;i++)n(i);this.scrollViewContent.children.forEach((function(t){t.getChildByPath("Mask").active=e.selCharacter.find((function(e){return e.id===t.item.id}))})),this.setAscendNeedTip()},s.renderAscendInfo=function(){var e=a(o().mark((function e(t){var n,i,r,a,s,l,c;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,g.GetInstance().levelUpCostSkin("skin",t);case 3:(n=e.sent)?(this.succRate.string="Success Probability\nCurrent Success Rate: "+n.succRate+"%",this.ascendInfoData=n,i=this.ascendInfo.getChildByPath("ascend"),r=this.ascendInfo.getChildByPath("hp"),a=this.ascendInfo.getChildByPath("atk"),s=this.ascendInfo.getChildByPath("defense"),l=n.currentItem,c=n.nextItem,i.getChildByPath("from").getComponent(h).string=l.level,i.getChildByPath("to").getComponent(h).string=c.level,r.getChildByPath("from").getComponent(h).string=l.hpAdd,r.getChildByPath("to").getComponent(h).string=c.hpAdd,a.getChildByPath("from").getComponent(h).string=l.atkAdd,a.getChildByPath("to").getComponent(h).string=c.atkAdd,s.getChildByPath("from").getComponent(h).string=l.defenseAdd,s.getChildByPath("to").getComponent(h).string=c.defenseAdd):m.createNotice("Get data failed"),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),m.createNotice("Get data failed");case 10:case"end":return e.stop()}}),e,this,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),s.setAscendNeedTip=function(){var e,t,n,i;this.ascendNeed.getComponent(h).string=this.selCharacter.length+"/"+((null==(e=this.ascendInfoData)?void 0:e.upgradeNeedNum)||0),this.ascendNeedTip.active=this.selCharacter.length<(null==(t=this.ascendInfoData)?void 0:t.upgradeNeedNum),this.ascendBtn.getChildByPath("bg/canAscend").active=this.selCharacter.length>=(null==(n=this.ascendInfoData)?void 0:n.upgradeNeedNum),this.ascendBtn.getChildByPath("costNum").getComponent(h).string=null==(i=this.ascendInfoData)?void 0:i.mpCoinCost},s.onClickBtnSkin=function(){var e;this.selCharacter.length>=(null==(e=this.ascendInfoData)?void 0:e.upgradeNeedNum)&&(this.confirmBox.active=!0)},s.onDestroy=function(){e.prototype.onDestroy.call(this)},s.onBtnCloseConfirm=function(){this.confirmBox.active=!1},s.onBtnConfirm=function(){var e=a(o().mark((function e(){var t,n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.selCharacter.map((function(e){return e.id})),e.prev=1,e.next=4,g.GetInstance().levelUpSkin(y.getInstance().getUserServerData().userId,t);case 4:(n=e.sent)?(this.confirmBox.active=!1,this.confirmMask.active=!0,this.selCharacter.length=0,this.renderConfirmMask(n),this.initList()):m.createNotice("Ascend failed"),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),console.log("🚀 ~ AscendLayer ~ onBtnConfirm ~ error:",e.t0);case 11:case"end":return e.stop()}}),e,this,[[1,8]])})));return function(){return e.apply(this,arguments)}}(),s.renderConfirmMask=function(e){var t=this.confirmMask.getChildByPath("HPBox"),n=t.getChildByPath("hp"),i=t.getChildByPath("atk"),r=t.getChildByPath("defense"),a=t.getChildByPath("soul");n.getChildByPath("from").getComponent(h).string=""+this.ascendInfoData.currentItem.hpAdd,n.getChildByPath("to").getComponent(h).string="+ "+e.hpAdd,i.getChildByPath("from").getComponent(h).string=""+this.ascendInfoData.currentItem.atkAdd,i.getChildByPath("to").getComponent(h).string="+ "+e.atkAdd,r.getChildByPath("from").getComponent(h).string=""+this.ascendInfoData.currentItem.defenseAdd,r.getChildByPath("to").getComponent(h).string="+ "+e.defenseAdd,a.getChildByPath("from").getComponent(h).string=this.ascendInfoData.currentItem.soulDropRateAdd+"%",a.getChildByPath("to").getComponent(h).string="+ "+e.soulDropRateAdd+"%",this.setSpriteFrame2(this.confirmMask.getChildByPath("PropItem_Ascend/hero"),"skins/"+e.icon,null,C.bundles.resources)},t}(v)).prototype,"GrayMask",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),V=t(G.prototype,"propagationStopped",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),O=t(G.prototype,"herosk",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),q=t(G.prototype,"btnBack",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),F=t(G.prototype,"Mask",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),$=t(G.prototype,"scrollView",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),j=t(G.prototype,"scrollViewContent",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),W=t(G.prototype,"confirmBox",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),J=t(G.prototype,"confirmMask",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),K=t(G.prototype,"ascendSel",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Q=t(G.prototype,"ascendInfo",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),X=t(G.prototype,"ascendNeed",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Y=t(G.prototype,"ascendNeedTip",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Z=t(G.prototype,"ascendBtn",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ee=t(G.prototype,"succRate",[U],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),te=t(G.prototype,"upDataLevel",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ne=t(G.prototype,"buttons",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),_=G))||_));s._RF.pop()}}}));

System.register("chunks:///_virtual/audioManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./myLog.ts","./constants.ts","./resManager.ts"],(function(e){var u,i,t,n,o,s,c,r;return{setters:[function(e){u=e.createClass,i=e.asyncToGenerator,t=e.regeneratorRuntime},function(e){n=e.cclegacy,o=e.AudioClip},function(e){s=e.myLog},function(e){c=e.constants},function(e){r=e.resManager}],execute:function(){n._RF.push({},"2976bjwcONEkaYppxD7Xhz0","audioManager",void 0);var a=function(){function e(){this.musicAudioSource=void 0,this.effectAudioSource=void 0,this.audioClips={},this.musicVolume=0,this.effectVolume=1,this.musicName=""}var n=e.prototype;return n.setMusicAudioSource=function(e){this.musicAudioSource=e},n.setEffectAudioSource=function(e){this.effectAudioSource=e},n.initData=function(e){e||(e={}),null!=e.musicVolume&&(this.musicVolume=e.musicVolume),null!=e.effectVolume&&(this.effectVolume=e.effectVolume)},n.getSaveData=function(e){var u={};return u.musicVolume=this.musicVolume,u.effectVolume=this.effectVolume,u},n.loadAllAudio=function(e,u){var i=this;r.loadAssetByBundleDir(c.bundles.audio,"",o,(function(u,i){u>.96&&(u=.96),e&&e(u)}),(function(e){for(var t in e){var n=e[t],o=n.name;o&&(i.audioClips[o]=n)}u&&u()}))},n.loadAudios=function(e,u,i){var t=this;r.loadAssetByPathArr(c.bundles.audio,e,o,(function(e){e>.96&&(e=.96),u&&u(e)}),(function(e){for(var u in e){var n=e[u],o=n.name;o&&(t.audioClips[o]=n)}i&&i()}))},n.loadAudio=function(e,u){var i=this;r.loadAsset(c.bundles.audio,e,o,null,(function(e,t){e?u&&u():(i.audioClips[t.name]=t,u&&u(t))}))},n.getMusiceVolume=function(){return this.musicVolume},n.setMusicVolume=function(e){e=Math.round(1e3*e)/1e3,this.musicVolume=e,this.musicAudioSource.volume=e,e<=0?this.musicAudioSource.pause():this.playMusic(this.musicName)},n.playMusic=function(){var e=i(t().mark((function e(u){var i;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(u){e.next=2;break}return e.abrupt("return");case 2:if(this.musicName=u,!(this.musicVolume<=0)){e.next=5;break}return e.abrupt("return");case 5:return e.next=7,this.getAudioClip(u);case 7:if(i=e.sent){e.next=10;break}return e.abrupt("return");case 10:if(!this.musicAudioSource.playing){e.next=14;break}if(this.musicAudioSource.clip!=i){e.next=13;break}return e.abrupt("return");case 13:this.musicAudioSource.stop();case 14:this.musicAudioSource.clip=i,this.musicAudioSource.loop=!0,this.musicAudioSource.play();case 17:case"end":return e.stop()}}),e,this)})));return function(u){return e.apply(this,arguments)}}(),n.gameOnShow=function(e){void 0===e&&(e=!1),!this.musicAudioSource||this.musicVolume<=0||(s.i("===========gameOnShow:",this.musicAudioSource.playing,this.musicAudioSource.state),this.musicAudioSource.playing&&!e||(s.i("=======call playing"),this.musicAudioSource.play()))},n.getEffectVolume=function(){return this.effectVolume},n.setEffectVolume=function(e){e=Math.round(1e3*e)/1e3,this.effectVolume=e,this.effectAudioSource.volume=e},n.playEffect=function(){var e=i(t().mark((function e(u){var i;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(u&&!(this.effectVolume<=0)){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.getAudioClip(u);case 4:if(i=e.sent){e.next=7;break}return e.abrupt("return");case 7:this.effectAudioSource.playOneShot(i);case 8:case"end":return e.stop()}}),e,this)})));return function(u){return e.apply(this,arguments)}}(),n.getAudioClip=function(e){var u=this;return new Promise((function(i){var t=u.audioClips[e];t?i(t):u.loadAudio(e,(function(e){i(e)}))}))},u(e,null,[{key:"instance",get:function(){return this._instance||(this._instance=new e),this._instance}}]),e}();a._instance=void 0;e("audioManager",a.instance);n._RF.pop()}}}));

System.register("chunks:///_virtual/AwardInfoLayer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./BaseLayer.ts"],(function(t){var n,o,e,r,i;return{setters:[function(t){n=t.inheritsLoose},function(t){o=t.cclegacy,e=t._decorator,r=t.find},function(t){i=t.BaseLayer}],execute:function(){var a;o._RF.push({},"24d91kKegVDn5us4NfnRGDS","AwardInfoLayer",void 0);var s=e.ccclass;e.property,t("AwardInfoLayer",s("AwardInfoLayer")(a=function(t){function o(){return t.apply(this,arguments)||this}n(o,t);var e=o.prototype;return e.onLoad=function(){t.prototype.onLoad.call(this)},e.onEnable=function(){t.prototype.onEnable.call(this)},e.onDisable=function(){t.prototype.onDisable.call(this)},e.onDestroy=function(){t.prototype.onDestroy.call(this)},e.initUI=function(){this.setItemLayer(this.getNodeByPath("ui/itemLayer"),this.layerData.awardArr,this.refreshAwardItem.bind(this))},e.refreshAwardItem=function(t,n){this.setPropItem(n[0],r("icon",t),n[1],r("bg",t),r("num",t))},e.processEvent=function(t,n){},e.onButtonClick=function(t,n){},e.onClickBtnSure=function(){this.closeLayer()},e.onClickBg=function(){this.closeLayer()},o}(i))||a);o._RF.pop()}}}));

System.register("chunks:///_virtual/BackHomeLayer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./msgac.ts","./serverMsg.ts","./BaseLayer.ts"],(function(o){var t,n,e,c,i,s,a;return{setters:[function(o){t=o.inheritsLoose},function(o){n=o.cclegacy,e=o._decorator},function(o){c=o.cocosUtil},function(o){i=o.msgac},function(o){s=o.serverMsg},function(o){a=o.BaseLayer}],execute:function(){var r;n._RF.push({},"c7122ITL3dBxJTT4wZtwJfh","BackHomeLayer",void 0);var l=e.ccclass;e.property,o("BackHomeLayer",l("BackHomeLayer")(r=function(o){function n(){for(var t,n=arguments.length,e=new Array(n),c=0;c<n;c++)e[c]=arguments[c];return(t=o.call.apply(o,[this].concat(e))||this).uiNode=void 0,t}t(n,o);var e=n.prototype;return e.onLoad=function(){o.prototype.onLoad.call(this),this.uiNode=this.getNodeByPath("ui")},e.onEnable=function(){o.prototype.onEnable.call(this)},e.onDisable=function(){o.prototype.onDisable.call(this)},e.onDestroy=function(){o.prototype.onDestroy.call(this)},e.initUI=function(){c.tweenScaleIn2(this.uiNode)},e.onButtonClick=function(o,t){},e.onClickBtnGoOn=function(){this.closeLayer()},e.onClickBtnExit=function(){this.closeLayer(),s.send(i.mapLeave)},n}(a))||r);n._RF.pop()}}}));

System.register("chunks:///_virtual/BackLifeLayer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./localText.ts","./designManager.ts","./mapModel.ts","./UserData.ts","./BaseLayer.ts"],(function(t){var e,o,n,i,a,c,s,r,l,d,u,f;return{setters:[function(t){e=t.inheritsLoose},function(t){o=t.cclegacy,n=t._decorator,i=t.tween,a=t.v3,c=t.Color},function(t){s=t.cocosUtil},function(t){r=t.localText},function(t){l=t.designManager},function(t){d=t.mapModel},function(t){u=t.UserData},function(t){f=t.BaseLayer}],execute:function(){var m;o._RF.push({},"c3674+8/wVPk67jTPRnM3jt","BackLifeLayer",void 0);var p=n.ccclass;n.property,t("BackLifeLayer",p("BackLifeLayer")(m=function(t){function o(){for(var e,o=arguments.length,n=new Array(o),i=0;i<o;i++)n[i]=arguments[i];return(e=t.call.apply(t,[this].concat(n))||this).timeNode=void 0,e.time=9,e.diamondNumNode=void 0,e}e(o,t);var n=o.prototype;return n.onLoad=function(){t.prototype.onLoad.call(this),this.timeNode=this.getNodeByPath("ui/time/time"),this.diamondNumNode=this.getNodeByPath("ui/btns/btnDiamond/info/num")},n.onEnable=function(){t.prototype.onEnable.call(this),u.getInstance().mapData=null},n.onDisable=function(){t.prototype.onDisable.call(this)},n.onDestroy=function(){t.prototype.onDestroy.call(this)},n.initUI=function(){var t=this;if(l.config.backLifeCount>0&&d.mapSystem.backlifeCount>=l.config.backLifeCount)return d.mapSystem.doSettlement(!1),void this.closeLayer();i(this.timeNode).delay(.2).to(.6,{scale:a(1.3,1.3,1)}).call((function(){t.time--,t.time<0&&(t.time=0,t.onClickBtnClose()),t.setString(t.timeNode,t.time)})).to(.6,{scale:a(1,1,1)}).union().repeat(10).start(),this.setString(this.diamondNumNode,"x"+l.config.backLifeDiamond),u.getInstance().getUserServerData().diamondCoin<l.config.backLifeDiamond?s.setRenderableColor(this.diamondNumNode,c.RED):s.setRenderableColor(this.diamondNumNode,c.WHITE)},n.processEvent=function(t,e){},n.onButtonClick=function(t,e){},n.roleBackLife=function(){d.mapSystem.backlifeCount++,d.player.backLife(),this.closeLayer()},n.onClickBtnClose=function(){d.mapSystem.doSettlement(!1),this.closeLayer()},n.onClickBtnDiamond=function(){u.getInstance().getUserServerData().diamondCoin<l.config.backLifeDiamond?this.createNotice(r.lackDiamond):this.roleBackLife()},o}(f))||m);o._RF.pop()}}}));

System.register("chunks:///_virtual/BackMaplLayer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./UserData.ts","./BaseLayer.ts"],(function(t){var n,o,a,e,c;return{setters:[function(t){n=t.inheritsLoose},function(t){o=t.cclegacy,a=t._decorator},function(t){e=t.UserData},function(t){c=t.BaseLayer}],execute:function(){var r;o._RF.push({},"d7f58XJjSFF0Yg9arSRiiWI","BackMaplLayer",void 0);var i=a.ccclass;a.property,t("BackMapLayer",i("BackMapLayer")(r=function(t){function o(){return t.apply(this,arguments)||this}n(o,t);var a=o.prototype;return a.onLoad=function(){t.prototype.onLoad.call(this)},a.onEnable=function(){t.prototype.onEnable.call(this)},a.onDisable=function(){t.prototype.onDisable.call(this)},a.onDestroy=function(){t.prototype.onDestroy.call(this)},a.initUI=function(){},a.processEvent=function(t,n){},a.onButtonClick=function(t,n){},a.onClickBtnClose=function(){e.getInstance().mapData=null,this.closeLayer()},a.onClickBtnSure=function(){var t=e.getInstance().mapData.mapModel.mapId;this.layerCb(t),this.closeLayer()},o}(c))||r);o._RF.pop()}}}));

System.register("chunks:///_virtual/Bag.ts",["./rollupPluginModLoBabelHelpers.js","cc","./BaseUILayer.ts","./ServerCtr.ts","./UserData.ts","./constants.ts"],(function(t){var e,n,r,i,o,a,s,c,l,u,p,f,g,h;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,r=t.initializerDefineProperty,i=t.assertThisInitialized,o=t.asyncToGenerator,a=t.regeneratorRuntime},function(t){s=t.cclegacy,c=t._decorator,l=t.Node,u=t.Label},function(t){p=t.BaseUILayer},function(t){f=t.default},function(t){g=t.UserData},function(t){h=t.constants}],execute:function(){var d,v,y,m,w,B,D,b,C;s._RF.push({},"f3982/lXWpKVIBrwHoZ6O3D","Bag",void 0);var L=c.ccclass,I=c.property;t("Bag",(d=L("Bag"),v=I([l]),y=I([l]),m=I({type:l}),d((D=e((B=function(t){function e(){for(var e,n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return e=t.call.apply(t,[this].concat(o))||this,r(e,"dialogConfirm",D,i(e)),r(e,"containers",b,i(e)),r(e,"conversionScrollView",C,i(e)),e.rootNode=void 0,e.navTabs=["conversion","equip","character"],e.conversionData=[],e.selItem=null,e}n(e,t);var s=e.prototype;return s.onLoad=function(){this.rootNode=this.node},s.start=function(){var t=o(a().mark((function t(){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.rootNode.getChildByName("Loading").active=!0,this.initList();case 2:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),s.initList=function(){var t=o(a().mark((function t(){var e,n=this;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,f.GetInstance().getUserBagList(g.getInstance().getUserServerData().userId);case 3:(e=t.sent)&&e.length&&this.scrollViewSetData(this.conversionScrollView,e,(function(t,e,r){console.log(99999999,e),console.log(99999999,t);var i=t.getChildByPath("num"),o=t.getChildByPath("text"),a=t.getChildByPath("poweReward/iconPower");n.setSpriteFrame2(a,"Bag/"+e.detials.icon,null,h.bundles.ui),i.getComponent(u).string=e.detials.value,o.getComponent(u).string=e.detials.itemName,t.on(l.EventType.TOUCH_END,(function(t){n.dialogConfirm.active=!0,n.selItem=e}))})),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.log("🚀 ~ Bag ~ initList ~ error:",t.t0);case 10:return t.prev=10,this.rootNode.getChildByName("Loading").active=!1,t.finish(10);case 13:case"end":return t.stop()}}),t,this,[[0,7,10,13]])})));return function(){return t.apply(this,arguments)}}(),s.onDestroy=function(){t.prototype.onDestroy.call(this)},s.closeDialog=function(){this.dialogConfirm.active=!1},s.confirmDialog=function(){var t=o(a().mark((function t(){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:console.log("confirmDialog",this.selItem),this.dialogConfirm.active=!1;case 2:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),s.closeLayer=function(){t.prototype.closeLayer.call(this)},e}(p)).prototype,"dialogConfirm",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),b=e(B.prototype,"containers",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),C=e(B.prototype,"conversionScrollView",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),w=B))||w));s._RF.pop()}}}));

System.register("chunks:///_virtual/BaseLayer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./myLog.ts","./cocosUtil.ts","./constants.ts","./localText.ts","./msgac.ts","./audioManager.ts","./designManager.ts","./eventManager.ts","./layerManager.ts","./resManager.ts","./UserData.ts","./ItemLayer.ts","./ScrollViewUtil.ts"],(function(e){var t,n,o,i,a,r,s,l,c,d,u,h,f,p,g,v,m,L,y,C,I,S,B,b,T,A,N,R,w,V;return{setters:[function(e){t=e.inheritsLoose},function(e){n=e.cclegacy,o=e.view,i=e.ResolutionPolicy,a=e.find,r=e.Widget,s=e.v3,l=e.Button,c=e.Node,d=e.ScrollView,u=e.sp,h=e.ProgressBar,f=e.Label,p=e.RichText,g=e.Sprite,v=e.Component},function(e){m=e.myLog},function(e){L=e.cocosUtil},function(e){y=e.constants},function(e){C=e.localText},function(e){I=e.msgac},function(e){S=e.audioManager},function(e){B=e.designManager},function(e){b=e.eventManager},function(e){T=e.layerManager},function(e){A=e.resManager,N=e.ResLoader},function(e){R=e.UserData},function(e){w=e.ItemLayer},function(e){V=e.ScrollViewUtil}],execute:function(){n._RF.push({},"2672bmyPkFNdbrkVilq/shn","BaseLayer",void 0);e("BaseLayer",function(e){function n(){for(var t,n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return(t=e.call.apply(e,[this].concat(o))||this).layerName="DefaultLayer",t.layerData={},t.layerCb=null,t.layerId=-1,t.pathNodeObj=new Map,t.resLoader=new N,t.autoReleaseAsset=!0,t.preLoadAssetConfigArr=void 0,t.eventArr=void 0,t.openUpdateSecond=!1,t.updateSecondInterval=void 0,t.openAllBtnInteractive=!0,t.openBtnLongPress=!1,t.btnLongTrigTime=.5,t.btnLognTrigTimeCount=0,t.btnLongTrigCount=0,t.btnLongNode=null,t}t(n,e);var v=n.prototype;return v.onLoad=function(){this.addPathNode(this.node,"")},v.DesignResolutionHeight=function(){o.setDesignResolutionSize(720,1660,i.FIXED_HEIGHT),m.i("-----ResolutionPolicy.FIXED_HEIGHT")},v.chooseDesignResolution=function(){var e=o.getVisibleSize();e.width/e.height>.5625?(o.setDesignResolutionSize(720,1280,i.FIXED_HEIGHT),m.i("choose  ResolutionPolicy.FIXED_HEIGHT")):(m.i("choose  ResolutionPolicy.FIXED_WIDTH"),o.setDesignResolutionSize(720,1280,i.FIXED_WIDTH))},v.onEnable=function(){var e=this;this.addButtonListener(this.node),this.initUI(),this.refreshRedPoint(),this.openUpdateSecond&&(this.updateSecondInterval&&clearInterval(this.updateSecondInterval),this.updateSecondInterval=setInterval((function(){e.updateSecond()}),1e3),this.updateSecond()),b.on(I.refreshRedPoint,this.refreshRedPoint,this)},v.updateSecond=function(){},v.refreshRedPoint=function(){},v.initUI=function(){},v.onDisable=function(){this.removeEventArr(this.eventArr),b.off(I.refreshRedPoint,this.refreshRedPoint,this),this.updateSecondInterval&&(clearInterval(this.updateSecondInterval),this.updateSecondInterval=void 0)},v.onDestroy=function(){switch(this.layerName){case y.layers.HomeLayer:return}this.autoReleaseAsset&&this.resLoader.releaseAllAsset()},v.addPathNode=function(e,t){e!=this.node&&this.pathNodeObj.set(t,e),t&&(t+="/");for(var n=e.children,o=0,i=n.length;o<i;o++){var a=n[o];this.addPathNode(a,t+a.name)}},v.getNodeByPath=function(e){var t=this.pathNodeObj.get(e);return t||((t=a(e,this.node))?(this.pathNodeObj.set(e,t),t):null)},v.screenAdapterBG=function(e){if(L.isValid(e)){var t=e.getComponent(r);t&&(t.enabled=!1);var n=L.getScreenBgAdapterScale(),o=e.getScale().x,i=e.getScale().y;e.setScale(s(o*n,i*n,1))}},v.screenAdapterUI=function(e){if(L.isValid(e)){var t=L.getScreenAdapterScale(),n=e.getScale().x,o=e.getScale().y;e.setScale(s(n*t,o*t,1))}},v.addButtonListener=function(e){(e.getComponent(l)&&(e.on("click",this.preOnButtonClick,this),this.openBtnLongPress&&(e.on(c.EventType.TOUCH_START,this.preOnButtonTouchStart,this),e.on(c.EventType.TOUCH_MOVE,this.preOnButtonTouchMove,this),e.on(c.EventType.TOUCH_END,this.preOnButtonTouchEnd,this),e.on(c.EventType.TOUCH_CANCEL,this.preOnButtonTouchCancel,this))),e.getComponent(d))&&(-1!=e.name.indexOf("NoUtil")||e.getComponent(V)||e.addComponent(V));for(var t=e.children,n=0,o=t.length;n<o;n++){var i=t[n];this.addButtonListener(i)}},v.preOnButtonClick=function(e){if(this.openAllBtnInteractive)if(this.openBtnLongPress&&this.btnLongTrigCount>0)this.btnLongTrigCount=0;else{var t=e.node,n=t.name;if(m.i(this.layerName+" onButtonClick "+n),this.onButtonClick&&this.onButtonClick(t,t.name),n.length>=2){var o=n.substring(0,1),i=n.substring(1,n.length),a="onClick"+o.toLocaleUpperCase()+i;this[a]&&this[a](t)}t.hasPlayAudio}},v.preOnButtonLongClick=function(e){if(this.openAllBtnInteractive){var t=e.name;if(m.i(this.layerName+" onButtonLongClick "+t),this.onButtonLongClick)return this.onButtonLongClick(e,t);if(t.length>=2){var n=t.substring(0,1),o=t.substring(1,t.length),i="onLongClick"+n.toLocaleUpperCase()+o;if(this[i])return this[i](e)}return!1}},v.preOnButtonTouchStart=function(e){var t=e.target;e.touch;this.btnLongNode=t,this.btnLognTrigTimeCount=0,this.btnLongTrigCount=0},v.preOnButtonTouchMove=function(e){},v.preOnButtonTouchEnd=function(e){this.btnLongNode=null},v.preOnButtonTouchCancel=function(e){this.btnLongNode=null},v.openPropInfoLayer2=function(e,t){void 0===t&&(t=void 0),null==t&&(t=R.getInstance().getPropNumById(e));var n={id:e,num:t};this.openLayer(y.layers.PropInfoLayer2,n)},v.isShowingLayer=function(e){return T.isShowingLayer(e)},v.showHintLayer=function(e,t){var n=a("Canvas/hintLayer");n.active=!0,n.cb=t,this.setString(a("ui/hint",n),e)},v.hideHintLayer=function(){var e=a("Canvas/hintLayer");e.active=!1,e.cb&&e.cb()},v.openMsgBoxLayer=function(e){var t={hint:e};this.openLayer(y.layers.MsgBoxLayer,t)},v.openAwardGetLayer=function(e){!e||e.length<=0||this.openLayer(y.layers.RewardLayer,{propArr:e,notMoveAni:!0})},v.openAwardInfoLayer=function(e){!e||e.length<=0||this.openLayer(y.layers.AwardInfoLayer,{awardArr:e})},v.setRoleSkin=function(e,t){var n=R.getInstance().getHeroSkin();e.getComponent(u.Skeleton).setSkin(n)},v.playAudioEffect=function(e,t,n){n||(n=0),L.isValid(t)&&(t.hasPlayAudio=!0),this.scheduleOnce((function(){S.playEffect(e),L.isValid(t)&&(t.hasPlayAudio=void 0)}),n)},v.onClickBtnClose=function(e){this.closeLayer()},v.openLayer=function(e,t,n,o){"function"==typeof t&&(n=t,t=null),T.openSingleLayer(e,t,n,(function(e,t){e.autoReleaseAsset&&e.resLoader&&(e.resLoader.addAsset(t),e.preLoadAssetConfigArr&&e.preLoadAssetConfigArr.forEach((function(t){t.asset&&e.resLoader.addAsset(t.asset)}))),o&&o()}))},v.closeLayer=function(e){e||(e=this.layerId),e&&-1!=e?T.closeLayer(e):this.node.destroy()},v.addEventArr=function(e){for(var t in this.eventArr=e,e){var n=e[t];n&&b.on(n,this.preProcessEvent,this)}},v.removeEventArr=function(e){for(var t in e){var n=e[t];n&&b.off(n,this.preProcessEvent,this)}},v.preProcessEvent=function(e){var t=e.ac,n=e.data,o=I.ac2KeyObj[t]+"Ret";this[o]&&this[o].call(this,n),this.processEvent(t,n)},v.processEvent=function(e,t){},v.showLackItem=function(e){var t=B.getRowById(y.tableName.prop,e);t&&this.createNotice(C.lackItemHint.format(t.name))},v.showGetItem=function(e,t){},v.createNotice=function(e){T.createNotice(e)},v.scrollViewSetData=function(e,t,n,o,i){var a=this;void 0===o&&(o=!0),void 0===i&&(i=!1);var r=e.getComponent(V);r&&r.setData(t,(function(e,t,o){n&&n(e,t,o),a.addButtonListener(e)}),o,i)},v.scrollViewAddData=function(e,t,n){void 0===n&&(n=!1);var o=e.getComponent(V);o&&o.pushData(t,n)},v.scrollViewRefreshList=function(e){var t=e.getComponent(V);t&&t.refreshList()},v.scrollViewRefreshItemUI=function(e,t,n){var o=e.getComponent(V);o&&o.refreshIndex(t.index,n)},v.scrollViewRefreshItemUIByIndex=function(e,t,n){var o=e.getComponent(V);o&&o.refreshIndex(t,n)},v.scrollViewRemoveItemUI=function(e,t,n){void 0===n&&(n=!1);var o=e.getComponent(V);o&&o.removeByIndex(t.index,n)},v.scrollViewRemoveItemUIByIndex=function(e,t,n){void 0===n&&(n=!1);var o=e.getComponent(V);o&&o.removeByIndex(t,n)},v.scrollViewScrollToEnd=function(e,t){var n=e.getComponent(V);n&&n.scrollToEnd(t)},v.scrollViewScrollToItemUI=function(e,t,n){this.scrollViewScrollToIndex(e,t.index,n)},v.scrollViewScrollToIndex=function(e,t,n){var o=e.getComponent(V);o&&null!=t&&o.scrollToIndex(t)},v.setProgressBar=function(e,t){e instanceof c&&(e=e.getComponent(h)),e&&(e.progress=t)},v.setNumString=function(e,t){t=L.formatNum(t),this.setString(e,t)},v.setItemLayer=function(e,t,n){L.addComponentOnce(e,w).initUI(this,t,n)},v.setNumItemLayer=function(e,t,n){for(var o=[],i=0;i<t;i++)o.push(i+1);var a=e.getComponent(w);a||(a=e.addComponent(w)),a.initUI(this,o,(function(e,t,o){n&&n(e,t,o)}))},v.setPropItem=function(e,t,n,o,i){void 0===n&&(n=0);var a=B.getRowById(y.tableName.prop,e);a||m.e("setPropItem error id:"+e);var r="prop/"+a.icon;11==a.type&&(r="weapon/"+B.getRowById(y.tableName.weapon,a.weaponid).icon);this.setSpriteFrame2(t,r),o&&this.setSpriteFrame2(o,"prop/propbg"+a.quality),n>0&&i&&this.setString(i,"x"+n)},v.shakeScreen=function(){L.tweenShakeNode(T.getPopLayerParentNode())},v.removeRenderBatch=function(e){var t=e.parent.getComponent(w);t&&t.renderChildBatch&&t.renderChildBatch.removeRootItemNode(e)},v.addRenderBatch=function(e){var t=e.parent.getComponent(w);t&&t.renderChildBatch&&t.renderChildBatch.addRootItemNode(e)},v.setString=function(e,t){if(e){t+="";var n=e.getComponent(f);if(n)n.string=t;else{var o=e.getComponent(p);o&&(o.string=t)}}else m.e("setString error:node is null",t)},v.setSpriteFrame=function(e,t,n,o){var i=this;if(void 0===o&&(o=y.bundles.icon),t&&L.isValid(e)){var a=e.getComponent(g);if(L.isValid(a)){a.enabled=!1,e.loadName=t;var r=o,s=t.split("_")[0]+"/"+t,l=t.split("|");l.length>=2&&(r=l[0],s=l[1]),A.loadSpriteFrame(r,s,(function(o,r){o||L.isValid(e)&&L.isValid(a)&&e.loadName==t&&(i.autoReleaseAsset&&i.resLoader.addAsset(r),a.enabled=!0,a.spriteFrame=r,n&&n())}))}}},v.setSpriteFrame2=function(e,t,n,o){var i=this;if(void 0===o&&(o=y.bundles.icon),t&&L.isValid(e)){var a=e.getComponent(g);if(L.isValid(a)){a.enabled=!1,e.loadName=t;var r=o,s=t;A.loadSpriteFrame(r,s,(function(o,r){o||L.isValid(e)&&L.isValid(a)&&e.loadName==t&&(i.autoReleaseAsset&&i.resLoader.addAsset(r),a.enabled=!0,a.spriteFrame=r,n&&n())}))}}},v.setSpineData=function(e,t,n){var o=this;if(L.isValid(e)){var i=e.getComponent(u.Skeleton);if(L.isValid(i)){i.enabled=!1,e.loadName=t;var a=y.bundles.spine,r=t+"/"+t;A.loadSpineData(a,r,(function(a,r){a||L.isValid(e)&&L.isValid(i)&&e.loadName==t&&(o.autoReleaseAsset&&o.resLoader.addAsset(r),i.enabled=!0,i.skeletonData=r,n&&n(i))}))}}},v.setSpineData2=function(e,t,n,o){var i=this;if(L.isValid(e)){var a=e.getComponent(u.Skeleton);if(L.isValid(a)){a.enabled=!1,e.loadName=n;var r=n;A.loadSpineData(t,r,(function(t,r){t||L.isValid(e)&&L.isValid(a)&&e.loadName==n&&(i.autoReleaseAsset&&i.resLoader.addAsset(r),a.enabled=!0,a.skeletonData=r,o&&o(a))}))}}},v.update=function(e){if(this.openBtnLongPress&&this.btnLongNode&&(this.btnLognTrigTimeCount+=e,this.btnLognTrigTimeCount>=this.btnLongTrigTime)){var t=this.preOnButtonLongClick(this.btnLongNode);this.btnLongTrigCount++,t||(this.btnLongNode=null,this.btnLognTrigTimeCount=0)}},n}(v));n._RF.pop()}}}));

System.register("chunks:///_virtual/BaseUILayer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./myLog.ts","./cocosUtil.ts","./constants.ts","./audioManager.ts","./layerManager.ts","./resManager.ts","./ScrollViewUtil.ts"],(function(e){var t,n,o,i,a,r,s,c,l,d,u,h,p,f,g,y,m,v,w,C,S,L,M;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,o=e.initializerDefineProperty,i=e.assertThisInitialized},function(e){a=e.cclegacy,r=e._decorator,s=e.view,c=e.Sprite,l=e.Prefab,d=e.UITransform,u=e.v3,h=e.Button,p=e.Component,f=e.Node,g=e.tween},function(e){y=e.myLog},function(e){m=e.cocosUtil},function(e){v=e.constants},function(e){w=e.audioManager},function(e){C=e.layerManager},function(e){S=e.ResLoader,L=e.resManager},function(e){M=e.ScrollViewUtil}],execute:function(){var b,D,I;a._RF.push({},"309d0hb9ntM15cYJx7d98Qw","BaseUILayer",void 0);var P=r.ccclass,z=r.property;e("BaseUILayer",P("BaseUILayer")((I=t((D=function(e){function t(){for(var t,n=arguments.length,a=new Array(n),r=0;r<n;r++)a[r]=arguments[r];return(t=e.call.apply(e,[this].concat(a))||this).layerCb=null,t.resLoader=new S,t.layerId=-1,t.layerData={},o(t,"isShowBanner",I,i(t)),t}n(t,e);var a=t.prototype;return a.onLoad=function(){},a.onEnable=function(){},a.getScreenScale=function(){var e=s.getVisibleSize(),t=s.getDesignResolutionSize();return e.width/e.height<=.5625?e.width/t.width:e.height/t.height},a.toast=function(e){C.createNotice(e)},a.onDisable=function(){},a.onDestroy=function(){},a.setSpriteFrame2=function(e,t,n,o){var i=this;if(void 0===o&&(o=v.bundles.icon),t&&m.isValid(e)){var a=e.getComponent(c);if(m.isValid(a)){a.enabled=!1,e.loadName=t;var r=o,s=t;L.loadSpriteFrame(r,s,(function(o,r){o||m.isValid(e)&&m.isValid(a)&&e.loadName==t&&(i.resLoader.addAsset(r),a.enabled=!0,a.spriteFrame=r,n&&n(a.node))}))}}},a.openLayer=function(e,t,n,o){"function"==typeof t&&(n=t,t=null),C.openSingleLayer(e,t,n,(function(e,t){e.resLoader&&t&&e.resLoader.addAsset(t),o&&o()}))},a.addTopUILayer=function(e){var t=this;L.loadAsset(v.bundles.layer,e,l,null,(function(n,o){if(n)y.e("LayerManager.openLayer error:"+n.message,e,n);else{var i=m.instantiate(o);(i.getComponent(e)||i.addComponent(e)).updateData(),i.parent=t.node}}))},a.onClickClose=function(){this.closeLayer()},a.closeLayer=function(e){e||(e=this.layerId),e&&-1!=e?C.closeLayer(e):this.node.destroy()},a.stringToArr=function(e){var t=e.indexOf("["),n=e.indexOf("]");return e.substring(t+1,n).split(",")},a.fitScrollView=function(e,t,n){var o=s.getVisibleSize(),i=s.getDesignResolutionSize(),a=1;a=o.width/o.height<=.5625?o.width/i.width:o.height/i.height,e.getComponent(d).height=Math.min(n,t+(o.height/a/2-640))},a.fitNodeWidget=function(e,t){var n=s.getVisibleSize(),o=s.getDesignResolutionSize(),i=1;i=n.width/n.height<=.5625?n.width/o.width:n.height/o.height,e.position=u(e.position.x,0-n.height/i/2+t,e.position.z),console.log("fitNodeWidget "+e.name,e.position.y)},a.scrollViewSetData=function(e,t,n,o,i){var a=e.getComponent(M);a&&a.setData(t,(function(e,t,i){n&&n(e,t,i,o)}))},a.setImageCustomSize=function(e,t){var n=e.getComponent(d).width,o=e.getComponent(d).height,i=Math.min(t/n,t/o),a=n*i,r=o*i;e.getComponent(d).width=a,e.getComponent(d).height=r},a.addButtonHander=function(e,t,n,o,i){e instanceof h||(e=e.getComponent(h)?e.getComponent(h):e.addComponent(h)),e.transition=h.Transition.SCALE;var a=new p.EventHandler;a.target=t,a.component=n,a.handler=o,a.customEventData=i,e.clickEvents=[a]},a.showGetReward=function(e){var t=this;w.playEffect("coin"),e.forEach((function(e,n){var o="";"COIN"===e.wearTypeName?(o="prop/prop_coin4",t.playCoinFlyAnim(8,o,u(0,60,0),u(200,600,0),40)):(o="prop/"+e.icon+e.equipUniqueId,t.playCoinFlyAnim(n,o,u(0,0,0),u(-150,-600,0),20,100,.02*n))}))},a.playCoinFlyAnim=function(e,t,n,o,i,a,r){var s=this;void 0===i&&(i=50),void 0===a&&(a=0),void 0===r&&(r=0),this.getCirclePoints(i,n,e).map((function(e){var i=new f("Sprite");if(i.addComponent(c),a>0){var r=s;s.setSpriteFrame2(i,t,(function(e){r.setImageCustomSize(e,a)}))}else s.setSpriteFrame2(i,t);return i.layer=s.node.layer,s.node.addChild(i),i.setPosition(e.x,e.y,0),i.scale=u(0,0,0),g(i).to(.2,{scale:u(1.2,1.2,1.2)}).to(.2,{scale:u(1,1,1)}).union().repeatForever().start(),{node:i,startPos:n,midPos:e,endPos:o,dis:s.calcDistance(e,o)}})).forEach((function(e,t){g(e.node).to(.15,{position:u(e.midPos.x,e.midPos.y,0)}).delay(.05*t+.5+r).to(.35,{position:u(e.endPos.x,e.endPos.y,0)}).call((function(){e.node.destroy()})).union().start()}))},a.getCirclePoints=function(e,t,n,o){void 0===o&&(o=50);for(var i=[],a=0;a<n;a++){var r=Math.PI/180*Math.round(360/n),s=t.x+e*Math.sin(r*a),c=t.y+e*Math.cos(r*a);i.unshift(u(s+Math.random()*o,c+Math.random()*o,0))}return i},a.calcDistance=function(e,t){var n=e.x-t.x,o=e.y-t.y;return Math.pow(n*n+o*o,.5)},t}(p)).prototype,"isShowBanner",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),b=D))||b);a._RF.pop()}}}));

System.register("chunks:///_virtual/blockArrow.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./mapModel.ts"],(function(t){var o,n,e,i,r,s,c,a,l,h;return{setters:[function(t){o=t.inheritsLoose},function(t){n=t.cclegacy,e=t._decorator,i=t.UITransform,r=t.Tween,s=t.tween,c=t.v3,a=t.Component},function(t){l=t.cocosUtil},function(t){h=t.mapModel}],execute:function(){var u;n._RF.push({},"26082K0Kx9A84bAyKtyHwII","blockArrow",void 0);var p=e.ccclass;e.property,t("blockArrow",p("blockArrow")(u=function(t){function n(){for(var o,n=arguments.length,e=new Array(n),i=0;i<n;i++)e[i]=arguments[i];return(o=t.call.apply(t,[this].concat(e))||this).hint=void 0,o.monster=void 0,o.outVec1=c(0,0,0),o}o(n,t);var e=n.prototype;return e.init=function(t){var o=this;this.hint=t,this.monster=this.hint.extraObj.monster;var n=this.hint.extraObj.duration,e=this.hint.extraObj.dis,c=this.hint.bodyNode.getComponent(i);c.width=120,r.stopAllByTarget(c),s(c).to(n,{width:e}).call((function(){o.hint.recycleSelf()})).start()},e.update=function(t){h.player.node.getPosition(this.outVec1).subtract(this.monster.node.position),this.node.angle=l.vec2XAngle(this.outVec1),this.node.position=this.monster.node.position},n}(a))||u);n._RF.pop()}}}));

System.register("chunks:///_virtual/BoxColliderUtil.ts",["./rollupPluginModLoBabelHelpers.js","cc","./physicsGroup.ts"],(function(t){var i,e,o,n,r,c,s,a,l,h,u,d,f;return{setters:[function(t){i=t.applyDecoratedDescriptor,e=t.inheritsLoose,o=t.initializerDefineProperty,n=t.assertThisInitialized,r=t.createClass},function(t){c=t.cclegacy,s=t._decorator,a=t.Enum,l=t.Vec2,h=t.Rect,u=t.Component,d=t.Size},function(t){f=t.physicsGroup}],execute:function(){var p,b,y,C,g,w,x,v,z,O;c._RF.push({},"83984O8uZdGNKPCi1VRIjBN","BoxColliderUtil",void 0);var j=s.ccclass,B=s.property,m=s.executeInEditMode;t("BoxColliderUtil",(p=j("BoxColliderUtil"),b=m(!0),y=B({type:a(f)}),p(C=b((w=i((g=function(t){function i(){for(var i,e=arguments.length,r=new Array(e),c=0;c<e;c++)r[c]=arguments[c];return i=t.call.apply(t,[this].concat(r))||this,o(i,"_offset",w,n(i)),o(i,"_size",x,n(i)),o(i,"tag",v,n(i)),o(i,"group",z,n(i)),o(i,"isSync",O,n(i)),i.worldPoints=[new l,new l,new l,new l],i.worldAabb=new h,i.contactColliderObj={},i.contactBeginCb=void 0,i.contactEndCb=void 0,i}e(i,t);var c=i.prototype;return c.onDisable=function(){for(var t in this.contactColliderObj){var i=this.contactColliderObj[t];i&&this.contactEnd(i)}},c.getContactKey=function(t){return this.uuid+"_"+t.uuid},c.updateCollider=function(){var t=this.worldAabb;t.x=this.offset.x-.5*this.size.width,t.y=this.offset.y-.5*this.size.height,t.width=this.size.width,t.height=this.size.height;var i=this.worldPoints[0],e=this.worldPoints[1],o=this.worldPoints[2],n=this.worldPoints[3];t.transformMat4ToPoints(this.node.worldMatrix,i,e,o,n);var r=Math.min(i.x,e.x,o.x,n.x),c=Math.max(i.x,e.x,o.x,n.x),s=Math.min(i.y,e.y,o.y,n.y),a=Math.max(i.y,e.y,o.y,n.y);t.x=r,t.y=s,t.width=c-r,t.height=a-s},c.setContactBegin=function(t){this.contactBeginCb=t},c.setContactEnd=function(t){this.contactEndCb=t},c.contactBegin=function(t){var i=this.getContactKey(t),e=t.getContactKey(this);this.contactColliderObj[i]||(this.contactColliderObj[i]=t,this.contactBeginCb&&this.contactBeginCb(this,t)),t.contactColliderObj[e]||(t.contactColliderObj[e]=this,t.contactBeginCb&&t.contactBeginCb(t,this))},c.contactEnd=function(t){var i=this.getContactKey(t),e=t.getContactKey(this),o=this.contactColliderObj[i];o&&o==t&&(this.contactColliderObj[i]=void 0,this.contactEndCb&&this.contactEndCb(this,t));var n=t.contactColliderObj[e];n&&n==this&&(t.contactColliderObj[e]=void 0,t.contactEndCb&&t.contactEndCb(t,this))},c.update=function(){},r(i,[{key:"offset",get:function(){return this._offset},set:function(t){this._offset=t}},{key:"size",get:function(){return this._size},set:function(t){this._size=t}}]),i}(u)).prototype,"_offset",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new l}}),i(g.prototype,"offset",[B],Object.getOwnPropertyDescriptor(g.prototype,"offset"),g.prototype),x=i(g.prototype,"_size",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new d(1,1)}}),i(g.prototype,"size",[B],Object.getOwnPropertyDescriptor(g.prototype,"size"),g.prototype),v=i(g.prototype,"tag",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),z=i(g.prototype,"group",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return f.DEFAULT}}),O=i(g.prototype,"isSync",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),C=g))||C)||C));c._RF.pop()}}}));

System.register("chunks:///_virtual/BoxMonsterLayer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./utilTools.ts","./constants.ts","./localText.ts","./designManager.ts","./mapModel.ts","./BaseLayer.ts"],(function(e){var t,n,o,r,i,a,s,c,l,p,u,f,d;return{setters:[function(e){t=e.inheritsLoose},function(e){n=e.cclegacy,o=e._decorator,r=e.Button,i=e.Color,a=e.find},function(e){s=e.cocosUtil},function(e){c=e.utilTools},function(e){l=e.constants},function(e){p=e.localText},function(e){u=e.designManager},function(e){f=e.mapModel},function(e){d=e.BaseLayer}],execute:function(){var h;n._RF.push({},"3a9bbcOj/dPkYkW2JkTGGD8","BoxMonsterLayer",void 0);var m=o.ccclass;o.property,e("BoxMonsterLayer",m("BoxMonsterLayer")(h=function(e){function n(){for(var t,n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(t=e.call.apply(e,[this].concat(o))||this).getIndexs={},t.canRefresh=!0,t.refreshCount=0,t}t(n,e);var o=n.prototype;return o.onLoad=function(){e.prototype.onLoad.call(this)},o.onEnable=function(){e.prototype.onEnable.call(this)},o.onDisable=function(){e.prototype.onDisable.call(this)},o.onDestroy=function(){e.prototype.onDestroy.call(this)},o.initUI=function(){var e=this,t=this.getNodeByPath("ui/bg/itemLayer").children,n=this.getItemArr();t.forEach((function(t,o){var r=n[o];t.item=r,t.index=o,e.refreshSelectItem(t,r,o)})),this.refreshBtnsLayer()},o.refreshBtnsLayer=function(){var e=this.getNodeByPath("ui/bg/btnRefresh");e.getComponent(r).enabled=!0,this.canRefresh&&this.refreshCount<u.config.carTime?s.setRenderableColor(e,i.WHITE,!0):(s.setRenderableColor(e,l.colors.yin.parseColor(),!0),e.getComponent(r).enabled=!1);var t=this.getNodeByPath("ui/bg/btnRefresh/limit");this.setString(t,"(%d/%d)".format(this.refreshCount,u.config.carTime))},o.refreshSelectLayer=function(){var e=this;this.getNodeByPath("ui/bg/itemLayer").children.forEach((function(t,n){e.refreshSelectItem(t,t.item,t.index)}))},o.refreshSelectItem=function(e,t,n){var o=a("skillItem",e),r=a("propItem",e);if(o&&(o.active=!1),r.active=!1,a("hasGet",e).active=!!this.getIndexs[n],t.name==l.tableName.prop){r.active=!0;var i=u.getRowById(l.tableName.prop,t.id),s=i.info;t.id!=l.propIds.coin&&t.id!=l.propIds.diamond||(s=p.propGet.format(t.num,i.name)),this.setString(a("info",r),s)}else{o.active=!0;var c=t.info,f=u.getFirstIdByType(t.type);c&&(f=c.id+1);var d=u.getRowById(t.name,f);this.setSpriteFrame(a("icon",o),d.icon);var h=a("starLayer",o);this.setNumItemLayer(h,d.lv,(function(e){var t=a("icon",e),n=a("icon2",e);d.lv>=l.design.maxLv?(t.active=!1,n.active=!0):(t.active=!0,n.active=!1)}))}},o.getItemArr=function(){var e=f.mapSystem.getSelectItemArr();return e.forEach((function(e){e.name==l.tableName.prop&&(e.id=l.propIds.coin,e.num=c.getFloatValue(u.config.carGoldNum[0],u.config.carGoldNum[1],!0))})),e.push({name:l.tableName.prop,id:l.propIds.coin,num:u.config.carGold}),e.push({name:l.tableName.prop,id:l.propIds.diamond,num:u.config.carDiamond}),e.push({name:l.tableName.prop,id:l.propIds.addHpPercent}),e},o.closeLayer=function(){e.prototype.closeLayer.call(this),this.layerCb&&this.layerCb()},o.onClickBtnGet=function(e){var t=e.parent.parent.item,n=e.parent.parent.index;f.propSystem.getProp(t.id,t.num),this.getIndexs[n]=1,this.refreshSelectLayer()},n}(d))||h);n._RF.pop()}}}));

System.register("chunks:///_virtual/BtnLayer.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var e,n,i,o,h,r,s,a,p,l,d,m;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,i=t.initializerDefineProperty,o=t.assertThisInitialized},function(t){h=t.cclegacy,r=t._decorator,s=t.Label,a=t.Sprite,p=t.UITransform,l=t.v3,d=t.tween,m=t.Component}],execute:function(){var g,u,c,C,w;h._RF.push({},"7a63e1JJGZOm5XaOX2JTDIM","BtnLayer",void 0);var f=r.ccclass,y=r.property;t("BtnLayer",(g=f("BtnLayer"),u=y({type:s,tooltip:"发光"}),g((w=e((C=function(t){function e(){for(var e,n=arguments.length,h=new Array(n),r=0;r<n;r++)h[r]=arguments[r];return(e=t.call.apply(t,[this].concat(h))||this).bolInit=!1,e.intCheckTime=1,e.runTime=void 0,e.runTimeLast=void 0,e.tween=void 0,i(e,"light",w,o(e)),e}n(e,t);var h=e.prototype;return h.onLoad=function(){this.bolInit=!1,this.runTime=0,this.runTimeLast=0,this.intCheckTime=1,this.tween=null,this.node.getChildByName("light").active=!1},h.setStart=function(){if(this.node.parent&&null==this.tween){this.runTime=0,this.runTimeLast=0,null==this.node.getComponent(a).spriteFrame&&(this.node.getComponent(a).spriteFrame=this.node.parent.getComponent(a).spriteFrame),this.node.getComponent(p).width=this.node.parent.getComponent(p).width,this.node.getComponent(p).height=this.node.parent.getComponent(p).height;var t=this.node.getChildByName("light"),e=this.node.parent.getComponent(p).width/t.getComponent(p).width,n=this.node.parent.getComponent(p).height/t.getComponent(p).height,i=Math.max(e,n);t.scale=l(i,i,1),this.node.getChildByName("light").active=!0,this.tween=d(t).show().set({position:l(.5*-(this.node.parent.getComponent(p).width+t.getComponent(p).width),0)}).to(.8,{position:l(.5*(this.node.parent.getComponent(p).width+t.getComponent(p).width),0,0)}).hide().delay(.2+.5*Math.random()).union().repeatForever(),this.tween.start()}},h.setStop=function(){this.tween&&(this.tween.stop(),this.tween=null,this.node.getChildByName("light").active=!1,this.node.getChildByName("light").position=l(.5*-(this.node.parent.getComponent(p).width+this.node.getChildByName("light").getComponent(p).width),0,0))},h.update=function(t){this.runTime+=t,this.runTime>this.intCheckTime&&(this.runTime=0,"ffffff"==this.node.parent.getComponent(a).color.toHEX("#rrggbb").toLowerCase()?this.setStart():this.setStop())},e}(m)).prototype,"light",[u],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),c=C))||c));h._RF.pop()}}}));

System.register("chunks:///_virtual/Bullet.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./utilTools.ts","./constants.ts","./audioManager.ts","./designManager.ts","./mapModel.ts","./physicsGroup.ts","./Monster.ts"],(function(t){var e,i,l,o,n,s,a,c,r,u,h,d,b,g,p,v,y,f,m;return{setters:[function(t){e=t.inheritsLoose},function(t){i=t.cclegacy,l=t._decorator,o=t.BoxCollider2D,n=t.Contact2DType,s=t.find,a=t.Tween,c=t.Vec3,r=t.Vec2,u=t.v3,h=t.Component},function(t){d=t.cocosUtil},function(t){b=t.utilTools},function(t){g=t.constants},function(t){p=t.audioManager},function(t){v=t.designManager},function(t){y=t.mapModel},function(t){f=t.physicsGroup},function(t){m=t.Monster}],execute:function(){var T;i._RF.push({},"e223cwh0a9GWbHSl49R/0HT","Bullet",void 0);var C=l.ccclass;l.property,t("Bullet",C("Bullet")(T=function(t){function i(){for(var e,i=arguments.length,l=new Array(i),o=0;o<i;o++)l[o]=arguments[o];return(e=t.call.apply(t,[this].concat(l))||this).id=void 0,e.row=void 0,e.direction=void 0,e.isDestroyInNoShow=void 0,e.extraObj=void 0,e.speed=void 0,e.atk=void 0,e.bodyNode=void 0,e.collider=void 0,e.bulletUtil=void 0,e.timeCount=void 0,e.contactItemArr=void 0,e.isFollow=!1,e.rotateSpeed=Math.PI/3,e.vec3Obj={targetPos:u(0,0,0),direction:u(0,0,0),outVec3:u(0,0,0)},e}e(i,t);var l=i.prototype;return l.onLoad=function(){this.collider=this.node.getComponent(o),this.collider&&(this.collider.on(n.BEGIN_CONTACT,this.contactBegin,this),this.collider.on(n.END_CONTACT,this.contactEnd,this)),this.bodyNode=s("body",this.node)},l.onDestroy=function(){},l.init=function(t,e,i,l,o){this.bodyNode||this.onLoad(),this.collider&&(this.collider.group=e,this.collider.enabled=!0),this.id=t,this.extraObj=o,i||(i=d.convertToWorldSpace(y.player.node));var n=d.convertToNodeSpace(this.node,i);this.node.setPosition(n),l||(l=this.getFacePlayerDirection()),0==l.x&&0==l.y&&(l.x=1),this.direction=l.clone().normalize();var s=v.getRowById(g.tableName.bullet,t);this.row=s,this.speed=s.speed,this.atk=s.atk;var c=b.radianToAngle(Math.atan2(this.direction.y,this.direction.x));this.node.angle=c,this.timeCount=0,this.isFollow=!1,this.contactItemArr=[],this.isDestroyInNoShow=!1,a.stopAllByTarget(this.node),this.unscheduleAllCallbacks();try{var r=this.node.name;switch(this.node.name){case"bullet1011":case"bullet1012":r="bullet1011";break;case"bullet1021":case"bullet1022":r="bullet1021";break;case"bullet1041":case"bullet1043":r="bullet1041";break;case"bullet1042":case"bullet1044":r="bullet1042";break;case"bullet1051":case"bullet1053":r="bullet1051";break;case"bullet1052":case"bullet1054":r="bullet1052";break;case"bullet1061":case"bullet1062":r="bullet1061";break;case"bullet1081":case"bullet1082":r="bullet1081";break;case"bullet1091":case"bullet1092":r="bullet1091";break;case"bullet1101":case"bullet1104":r="bullet1101";break;case"bullet1102":case"bullet1105":r="bullet1102";break;case"bullet1103":case"bullet1106":r="bullet1103"}var u=d.addComponentOnce(this,r);u.unscheduleAllCallbacks(),this.bulletUtil=u,u.init(this)}catch(t){}},l.getFacePlayerDirection=function(){var t=this.node.getPosition();return y.player.node.getPosition().subtract(t)},l.setDirection=function(t){this.direction=t.normalize()},l.contactBegin=function(t,e){var l=null;if(e.group==f.MONSTER&&0==e.tag?l=e.getComponent(m):e.group==f.PLAYER&&(l=y.player),l){this.contactEnmeyCanHide()?this.recycleSelf():-1==this.contactItemArr.indexOf(l)&&(this.contactItemArr.push(l),l.contactBulletTime=0),this.bulletUtil&&this.bulletUtil.contactBegin&&this.bulletUtil.contactBegin(e.node);var o=this.atk;this.extraObj&&this.extraObj.atkPercentAdd>0&&(o*=1+this.extraObj.atkPercentAdd,o=Math.ceil(o)),l.hitWithDam(o,this.getShineColor()),p.playEffect(this.row.audio)}if(e.group==f.MONSTER_BULLET){var n=e.getComponent(i);n.contactEnmeyCanHide()&&n.recycleSelf()}},l.contactEnd=function(t,e){var i=null;if(e.group==f.MONSTER?i=e.getComponent(m):e.group==f.PLAYER&&(i=y.player),i){var l=this.contactItemArr.indexOf(i);-1!=l&&this.contactItemArr.splice(l,1)}},l.getShineColor=function(){if(this.bulletUtil&&this.bulletUtil.shineColor)return this.bulletUtil.shineColor},l.contactEnmeyCanHide=function(){return!this.bulletUtil||!this.bulletUtil.contactNotHide},l.outScreenCanRecyle=function(){return!this.bulletUtil||!this.bulletUtil.outScreenNotRecycle},l.recycleSelf=function(){y.bulletSystem.recycleBulletNode(this.node),this.bulletUtil&&this.bulletUtil.recycleSelfEnd&&this.bulletUtil.recycleSelfEnd(),a.stopAllByTarget(this.node),a.stopAllByTarget(this.bodyNode),this.unscheduleAllCallbacks(),this.bulletUtil&&this.bulletUtil.unscheduleAllCallbacks()},l.getFollowTargetPos=function(){return this.bulletUtil&&this.bulletUtil.targetPos?d.vec3CopyVal(this.vec3Obj.targetPos,this.bulletUtil.targetPos):d.vec3CopyVal(this.vec3Obj.targetPos,y.player.node.position)},l.update=function(t){var e=this,i=!0;if(this.bulletUtil&&this.bulletUtil.moveStop&&(i=!1),this.speed<=0&&(i=!1),i){var l=this.speed*t,o=this.node.position;if(this.isFollow){var n=this.getFollowTargetPos().subtract(o).normalize(),s=Math.atan2(n.y,n.x);s<0&&(s+=2*Math.PI);var a=Math.atan2(this.direction.y,this.direction.x);a<0&&(a+=2*Math.PI);var u=this.rotateSpeed*t,h=Math.abs(s-a);u>h&&(u=h),s>a?s-a>Math.PI&&(u=-u):a-s<Math.PI&&(u=-u),this.direction=c.rotateZ(this.vec3Obj.outVec3,this.direction,c.ZERO,u);var g=b.radianToAngle(Math.atan2(this.direction.y,this.direction.x));this.node.angle=g}else{var v=b.radianToAngle(Math.atan2(this.direction.y,this.direction.x));this.node.angle=v}var f=null;if(this.bulletUtil&&this.bulletUtil.targetPos&&this.bulletUtil.arriveTargetPos)f=this.getFollowTargetPos().subtract(o);if(o.add(d.vec3CopyVal(this.vec3Obj.direction,this.direction).multiplyScalar(l)),this.node.position=o,f){var m=this.getFollowTargetPos().subtract(o);if(b.radianToAngle(r.angle(f,m))>90)return void this.bulletUtil.arriveTargetPos()}}this.contactItemArr.length>0&&b.forArr(this.contactItemArr,(function(i){i.contactBulletTime+=t;var l=.5;e.bulletUtil&&e.bulletUtil.contactBulletTime>0&&(l=e.bulletUtil.contactBulletTime),i.contactBulletTime>=l&&(i.contactBulletTime=0,i.hitWithDam(e.atk,e.getShineColor()),p.playEffect(e.row.audio))})),this.timeCount+=t,this.timeCount>=2&&this.outScreenCanRecyle()&&!y.isInScreenVisible(this.node)&&this.recycleSelf()},i}(h))||T);i._RF.pop()}}}));

System.register("chunks:///_virtual/Bullet1011.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./utilTools.ts","./mapModel.ts"],(function(t){var e,i,o,n,s,l,c,r;return{setters:[function(t){e=t.inheritsLoose},function(t){i=t.cclegacy,o=t._decorator,n=t.tween,s=t.Component},function(t){l=t.cocosUtil},function(t){c=t.utilTools},function(t){r=t.mapModel}],execute:function(){var u;i._RF.push({},"01617jEdq9KILpUXdznmc6J","Bullet1011",void 0);var a=o.ccclass;o.property,t("bullet1011",a("bullet1011")(u=function(t){function i(){for(var e,i=arguments.length,o=new Array(i),n=0;n<i;n++)o[n]=arguments[n];return(e=t.call.apply(t,[this].concat(o))||this).bullet=void 0,e.contactNotHide=!0,e.g=-800,e.v=800,e.vx=0,e.vy=0,e}e(i,t);var o=i.prototype;return o.init=function(t){this.bullet=t,n(this.node).by(1,{angle:360}).repeatForever().start();var e=Math.PI/15,i=c.getFloatValue(Math.PI/2-e,Math.PI/2+e);this.vx=this.v*Math.cos(i),this.vy=this.v*Math.sin(i)},o.update=function(t){var e=this.node.getPosition();e.x+=this.vx*t,e.y+=this.vy*t,this.vy+=this.g*t,this.node.setPosition(e),r.isInScreenVisible(this.node)||this.bullet.recycleSelf()},o.recycleSelfEnd=function(){l.isValid(this.bullet.extraObj)&&this.bullet.extraObj.subNum()},i}(s))||u);i._RF.pop()}}}));

System.register("chunks:///_virtual/bullet10170.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./mapModel.ts","./Hint.ts"],(function(t){var n,e,o,l,i,c,u;return{setters:[function(t){n=t.inheritsLoose},function(t){e=t.cclegacy,o=t._decorator,l=t.Component},function(t){i=t.cocosUtil},function(t){c=t.mapModel},function(t){u=t.HintNames}],execute:function(){var r;e._RF.push({},"cf053ZSiuRAtINPklnj/BxA","bullet10170",void 0);var s=o.ccclass;o.property,t("bullet10170",s("bullet10170")(r=function(t){function e(){for(var n,e=arguments.length,o=new Array(e),l=0;l<e;l++)o[l]=arguments[l];return(n=t.call.apply(t,[this].concat(o))||this).bullet=void 0,n}n(e,t);var o=e.prototype;return o.init=function(t){var n=this;this.bullet=t,this.bullet.rotateSpeed=Math.PI/4+Math.random()*Math.PI/2,this.scheduleOnce((function(){n.bullet.isFollow=!0}),.4+.2*Math.random()),this.scheduleOnce((function(){n.bullet.isFollow=!1}),2.5+.5*Math.random())},o.contactBegin=function(t){c.hintSystem.addHint(u.hit2,i.convertToWorldSpace(this.bullet.node))},e}(l))||r);e._RF.pop()}}}));

System.register("chunks:///_virtual/bullet10180.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./AnimationCtrl.ts"],(function(t){var n,i,o,e,l,c;return{setters:[function(t){n=t.inheritsLoose},function(t){i=t.cclegacy,o=t._decorator,e=t.Component},function(t){l=t.cocosUtil},function(t){c=t.AnimationCtrl}],execute:function(){var r;i._RF.push({},"e7659gNqdVEN4DaILxPJn21","bullet10180",void 0);var a=o.ccclass;o.property,t("bullet10180",a("bullet10180")(r=function(t){function i(){for(var n,i=arguments.length,o=new Array(i),e=0;e<i;e++)o[e]=arguments[e];return(n=t.call.apply(t,[this].concat(o))||this).bullet=void 0,n.contactNotHide=!0,n.animationCtrl=void 0,n}return n(i,t),i.prototype.init=function(t){var n=this;this.bullet=t,this.animationCtrl=l.addComponentOnce(this,c),this.animationCtrl.playAnimationOnce("ani",(function(){n.bullet.recycleSelf()}))},i}(e))||r);i._RF.pop()}}}));

System.register("chunks:///_virtual/bullet10190.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./mapModel.ts","./physicsGroup.ts"],(function(t){var e,o,c,l,n,r,u;return{setters:[function(t){e=t.inheritsLoose},function(t){o=t.cclegacy,c=t._decorator,l=t.Component},function(t){n=t.cocosUtil},function(t){r=t.mapModel},function(t){u=t.physicsGroup}],execute:function(){var i;o._RF.push({},"6dcb0y+mMtKdLIy4QrhMsv0","bullet10190",void 0);var s=c.ccclass;c.property,t("bullet10190",s("bullet10190")(i=function(t){function o(){for(var e,o=arguments.length,c=new Array(o),l=0;l<o;l++)c[l]=arguments[l];return(e=t.call.apply(t,[this].concat(c))||this).bullet=void 0,e.contactNotHide=!0,e}return e(o,t),o.prototype.init=function(t){var e=this;this.bullet=t;var o=this.bullet.extraObj;this.scheduleOnce((function(){e.bullet.recycleSelf(),r.bulletSystem.addBullet(o,u.MONSTER_BULLET,n.convertToWorldSpace(e.node))}),.8)},o}(l))||i);o._RF.pop()}}}));

System.register("chunks:///_virtual/bullet10200.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./AnimationCtrl.ts"],(function(t){var n,e,o,i,l,c,a,r;return{setters:[function(t){n=t.inheritsLoose},function(t){e=t.cclegacy,o=t._decorator,i=t.UIOpacity,l=t.v3,c=t.Component},function(t){a=t.cocosUtil},function(t){r=t.AnimationCtrl}],execute:function(){var s;e._RF.push({},"aa3e2m2O79H3ax5qkQRjVv4","bullet10200",void 0);var u=o.ccclass;o.property,t("bullet10200",u("bullet10200")(s=function(t){function e(){for(var n,e=arguments.length,o=new Array(e),i=0;i<e;i++)o[i]=arguments[i];return(n=t.call.apply(t,[this].concat(o))||this).bullet=void 0,n.contactNotHide=!0,n.contactBulletTime=1,n.animationCtrl=void 0,n.shineColor="#2AA32A".parseColor(),n}return n(e,t),e.prototype.init=function(t){var n=this;this.bullet=t,this.animationCtrl=a.addComponentOnce(this,r),this.node.angle=0,this.animationCtrl.playAnimation("ani",!0),this.getComponent(i).opacity=255,this.node.scale=l(1,1,1);var e=this.bullet.extraObj;e>0&&(this.node.scale=l(e,e,1)),this.scheduleOnce((function(){a.tweenFadeOut(n.node,1,(function(){n.bullet.recycleSelf()}))}),2)},e}(c))||s);e._RF.pop()}}}));

System.register("chunks:///_virtual/Bullet1021.ts",["./rollupPluginModLoBabelHelpers.js","cc","./mapModel.ts","./cocosUtil.ts"],(function(t){var e,i,o,n,l,c,s,r,a;return{setters:[function(t){e=t.inheritsLoose},function(t){i=t.cclegacy,o=t._decorator,n=t.v3,l=t.tween,c=t.Vec3,s=t.Component},function(t){r=t.mapModel},function(t){a=t.cocosUtil}],execute:function(){var u;i._RF.push({},"86474WEu6dJGYa5KdH3dG0s","Bullet1021",void 0);var d=o.ccclass;o.property,t("bullet1021",d("bullet1021")(u=function(t){function i(){for(var e,i=arguments.length,o=new Array(i),l=0;l<i;l++)o[l]=arguments[l];return(e=t.call.apply(t,[this].concat(o))||this).bullet=void 0,e.contactNotHide=!0,e.outVec3=n(0,0,0),e.direction=void 0,e.speed=1.5*-Math.PI,e}e(i,t);var o=i.prototype;return o.init=function(t){this.bullet=t;var e=this.bullet.extraObj.direction;this.direction=e;var i=this.getScale();this.node.setScale(n(i,i,1)),l(this.node).by(.6,{angle:-360}).repeatForever().start(),this.show(),this.bullet.extraObj.endCb(this.bullet)},o.getScale=function(){return 1+r.skillSystem.getSkill2RangeAddScale()},o.hide=function(t){var e=this;void 0===t&&(t=!1),t?this.bullet.recycleSelf():a.tweenScaleOut(this.node,.5,(function(){e.bullet.recycleSelf()}))},o.show=function(){var t=this.getScale();this.node.setScale(n(0,0,0)),this.node.active=!0,l(this.node).to(.5,{scale:n(t,t,1)}).start()},o.update=function(t){var e=this.speed*t;c.rotateZ(this.direction,this.direction,c.ZERO,e);var i=r.player.node.position.clone();i.add(this.direction),this.node.position=i},i}(s))||u);i._RF.pop()}}}));

System.register("chunks:///_virtual/Bullet1031.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./mapModel.ts","./Hint.ts"],(function(t){var e,i,n,o,l,s,r,c,u;return{setters:[function(t){e=t.inheritsLoose},function(t){i=t.cclegacy,n=t._decorator,o=t.tween,l=t.UITransform,s=t.Component},function(t){r=t.cocosUtil},function(t){c=t.mapModel},function(t){u=t.HintNames}],execute:function(){var a;i._RF.push({},"65e7ficzCZFhI6xxZK1d3nb","Bullet1031",void 0);var d=n.ccclass;n.property,t("bullet1031",d("bullet1031")(a=function(t){function i(){for(var e,i=arguments.length,n=new Array(i),o=0;o<i;o++)n[o]=arguments[o];return(e=t.call.apply(t,[this].concat(n))||this).bullet=void 0,e.contactNotHide=!0,e.moveSpeed=void 0,e.yinTimeCount=void 0,e}e(i,t);var n=i.prototype;return n.init=function(t){this.bullet=t,this.moveSpeed=1200,this.yinTimeCount=0,o(this.node).by(.2,{angle:-360}).repeatForever().start()},n.update=function(t){var e=this.node.getPosition();this.moveSpeed-=30;var i=this.moveSpeed*t,n=this.bullet.direction.clone().multiplyScalar(i);if(e.add(n),this.node.setPosition(e),this.yinTimeCount+=t,this.yinTimeCount>.2){this.yinTimeCount=0;var o=this.bullet.bodyNode.getComponent(l),s={width:o.width,height:o.height};c.hintSystem.addHint(u.feiBiao,r.convertToWorldSpace(this.node),this.node.angle,s)}},n.recycleSelfEnd=function(){r.isValid(this.bullet.extraObj)&&this.bullet.extraObj.subNum()},i}(s))||a);i._RF.pop()}}}));

System.register("chunks:///_virtual/Bullet1041.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./mapModel.ts","./physicsGroup.ts"],(function(t){var e,l,o,n,r,i,u,c;return{setters:[function(t){e=t.inheritsLoose},function(t){l=t.cclegacy,o=t._decorator,n=t.tween,r=t.Component},function(t){i=t.cocosUtil},function(t){u=t.mapModel},function(t){c=t.physicsGroup}],execute:function(){var s;l._RF.push({},"5a38fyki0NACYwygEQJj3a1","Bullet1041",void 0);var a=o.ccclass;o.property,t("bullet1041",a("bullet1041")(s=function(t){function l(){for(var e,l=arguments.length,o=new Array(l),n=0;n<l;n++)o[n]=arguments[n];return(e=t.call.apply(t,[this].concat(o))||this).bullet=void 0,e}return e(l,t),l.prototype.init=function(t){var e=this;this.bullet=t,this.node.angle=0,n(this.node).by(.6,{angle:-360}).repeatForever().start();var l=this.bullet.extraObj.targetPos;n(this.node).to(.6,{position:l},{easing:"quadOut"}).call((function(){e.bullet.recycleSelf(),u.bulletSystem.addBullet(e.bullet.id+1,c.PLAYER_BULLET,i.convertToWorldSpace(e.node),null,e.bullet.extraObj.time)})).start()},l}(r))||s);l._RF.pop()}}}));

System.register("chunks:///_virtual/Bullet1042.ts",["./rollupPluginModLoBabelHelpers.js","cc","./mapModel.ts"],(function(t){var e,l,n,o,c,r,i;return{setters:[function(t){e=t.inheritsLoose},function(t){l=t.cclegacy,n=t._decorator,o=t.v3,c=t.tween,r=t.Component},function(t){i=t.mapModel}],execute:function(){var a;l._RF.push({},"025b70d3+tO+537adU1A+ju","Bullet1042",void 0);var s=n.ccclass;n.property,t("bullet1042",s("bullet1042")(a=function(t){function l(){for(var e,l=arguments.length,n=new Array(l),o=0;o<l;o++)n[o]=arguments[o];return(e=t.call.apply(t,[this].concat(n))||this).bullet=void 0,e.contactNotHide=!0,e.contactBulletTime=.5,e.shineColor="#FF1313".parseColor(),e}e(l,t);var n=l.prototype;return n.init=function(t){var e=this;this.bullet=t,this.node.angle=0,this.node.setScale(o(.3,.3,1));var l=this.getScale();c(this.node).to(.06,{scale:o(l,l,1)}).start(),this.scheduleOnce((function(){c(e.node).to(.15,{scale:o(0,0,1)}).call((function(){e.bullet.recycleSelf()})).start()}),this.bullet.extraObj)},n.getScale=function(){return 1+i.skillSystem.getSkill2RangeAddScale()},l}(r))||a);l._RF.pop()}}}));

System.register("chunks:///_virtual/Bullet1051.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./mapModel.ts","./physicsGroup.ts"],(function(t){var e,l,c,o,n,s,i;return{setters:[function(t){e=t.inheritsLoose},function(t){l=t.cclegacy,c=t._decorator,o=t.Component},function(t){n=t.cocosUtil},function(t){s=t.mapModel},function(t){i=t.physicsGroup}],execute:function(){var u;l._RF.push({},"02c03wPkYNFKKQ64OmVr52/","Bullet1051",void 0);var r=c.ccclass;c.property,t("bullet1051",r("bullet1051")(u=function(t){function l(){for(var e,l=arguments.length,c=new Array(l),o=0;o<l;o++)c[o]=arguments[o];return(e=t.call.apply(t,[this].concat(c))||this).bullet=void 0,e.contactNotHide=!0,e.hasScheduled=void 0,e}e(l,t);var c=l.prototype;return c.init=function(t){this.bullet=t,this.hasScheduled=!1,this.bullet.speed=this.bullet.speed*(1+s.skillSystem.getSkill2BulletSpeedAddPercent())},c.contactBegin=function(){var t=this;this.hasScheduled||(this.hasScheduled=!0,this.scheduleOnce((function(){t.bullet.recycleSelf(),s.bulletSystem.addBullet(t.bullet.id+1,i.PLAYER_BULLET,n.convertToWorldSpace(t.node))}),.15))},l}(o))||u);l._RF.pop()}}}));

System.register("chunks:///_virtual/Bullet1052.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./mapModel.ts","./AnimationCtrl.ts"],(function(t){var n,i,e,l,o,c,r;return{setters:[function(t){n=t.inheritsLoose},function(t){i=t.cclegacy,e=t._decorator,l=t.Component},function(t){o=t.cocosUtil},function(t){c=t.mapModel},function(t){r=t.AnimationCtrl}],execute:function(){var a;i._RF.push({},"14e52wxr7ZGTpJHd3wViPI2","Bullet1052",void 0);var s=e.ccclass;e.property,t("bullet1052",s("bullet1052")(a=function(t){function i(){for(var n,i=arguments.length,e=new Array(i),l=0;l<i;l++)e[l]=arguments[l];return(n=t.call.apply(t,[this].concat(e))||this).bullet=void 0,n.contactNotHide=!0,n.contactBulletTime=6,n.animationCtrl=void 0,n}return n(i,t),i.prototype.init=function(t){var n=this;this.bullet=t,this.node.angle=0,this.animationCtrl=o.addComponentOnce(this,r);var i=this.bullet.atk*(1+c.skillSystem.getSkill2AtkAddPercent());this.bullet.atk=Math.floor(i),this.animationCtrl.playAnimationOnce("ani",(function(){n.bullet.recycleSelf()}))},i}(l))||a);i._RF.pop()}}}));

System.register("chunks:///_virtual/Bullet1061.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./utilTools.ts","./mapModel.ts"],(function(e){var t,i,l,n,o,r,s,c,a;return{setters:[function(e){t=e.inheritsLoose},function(e){i=e.cclegacy,l=e._decorator,n=e.tween,o=e.Vec3,r=e.Component},function(e){s=e.cocosUtil},function(e){c=e.utilTools},function(e){a=e.mapModel}],execute:function(){var u;i._RF.push({},"b6cefy75lZGXpoB4YkWctUm","Bullet1061",void 0);var f=l.ccclass;l.property,e("bullet1061",f("bullet1061")(u=function(e){function i(){for(var t,i=arguments.length,l=new Array(i),n=0;n<i;n++)l[n]=arguments[n];return(t=e.call.apply(e,[this].concat(l))||this).bullet=void 0,t.contactNotHide=!0,t.outScreenNotRecycle=!0,t.isOutScreenReflex=void 0,t}t(i,e);var l=i.prototype;return l.init=function(e){var t=this;this.bullet=e,this.isOutScreenReflex=!1,s.tweenScaleIn(this.node,.5),n(this.node).by(.6,{angle:360}).repeatForever().start(),this.scheduleOnce((function(){s.tweenScaleOut(t.node,.5,(function(){t.bullet.recycleSelf()}))}),this.bullet.extraObj.time)},l.contactBegin=function(){if(!this.isOutScreenReflex){var e=this.bullet.direction.negative(),t=c.angleToRadian(60);t=c.getFloatValue(-t,t),o.rotateZ(e,e,o.ZERO,t),this.bullet.setDirection(e)}},l.mirrorReflex=function(e,t){void 0===t&&(t=!1),this.isOutScreenReflex&&!t||(this.isOutScreenReflex=!0,e?this.bullet.direction.x*=-1:this.bullet.direction.y*=-1)},l.outScreenX=function(e,t){return Math.abs(t.x-e.x)>=a.visibleHalfSize.width},l.outScreenY=function(e,t){return Math.abs(t.y-e.y)>=a.visibleHalfSize.height},l.outWallX=function(e){return!!a.mapSystem.wallLayer.active&&(e.x>=a.mapSystem.wallRightVal||e.x<=a.mapSystem.wallLeftVal)},l.outWallY=function(e){return!!a.mapSystem.wallLayer.active&&(e.y>=a.mapSystem.wallTopVal||e.y<=a.mapSystem.wallBottomVal)},l.update=function(e){var t=a.player.node.position,i=this.node.position;this.outScreenX(i,t)?this.mirrorReflex(!0):this.outWallX(i)?this.mirrorReflex(!0,!0):this.outScreenY(i,t)?this.mirrorReflex(!1):this.outWallY(i)?this.mirrorReflex(!1,!0):this.isOutScreenReflex=!1},l.recycleSelfEnd=function(){s.isValid(this.bullet.extraObj.invokeClass)&&this.bullet.extraObj.invokeClass.subNum()},i}(r))||u);i._RF.pop()}}}));

System.register("chunks:///_virtual/Bullet1071.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./utilTools.ts","./constants.ts","./mapModel.ts"],(function(t){var e,o,n,l,i,a,s,r,c,u,d,h,p;return{setters:[function(t){e=t.inheritsLoose},function(t){o=t.cclegacy,n=t._decorator,l=t.Tween,i=t.UIOpacity,a=t.tween,s=t.find,r=t.v3,c=t.Component},function(t){u=t.cocosUtil},function(t){d=t.utilTools},function(t){h=t.constants},function(t){p=t.mapModel}],execute:function(){var f;o._RF.push({},"927fdRjIC5PqoToDG6jaxe2","Bullet1071",void 0);var v=n.ccclass;n.property,t("bullet1071",v("bullet1071")(f=function(t){function o(){for(var e,o=arguments.length,n=new Array(o),l=0;l<o;l++)n[l]=arguments[l];return(e=t.call.apply(t,[this].concat(n))||this).bullet=void 0,e.contactNotHide=!0,e.contactBulletTime=1,e.lv=void 0,e.shineColor=void 0,e}e(o,t);var n=o.prototype;return n.init=function(t){var e=this;this.bullet=t,this.node.angle=0;var o=this.bullet.extraObj.lv;this.lv=o;var n="#22D600".parseColor();o==h.design.maxLv&&(n="#FF00F5".parseColor()),this.shineColor=n,this.initScale(),l.stopAllByTarget(this.bullet.bodyNode);var c=this.bullet.bodyNode.getComponent(i);c.opacity=0,a(c).to(2,{opacity:255}).start(),u.setRenderableColor(this.bullet.bodyNode,n);var p=s("frameLayer",this.node);d.forArr(p.children,(function(t,o){t.active=!1,u.setRenderableColor(t,n),l.stopAllByTarget(t),e.scheduleOnce((function(){a(t).call((function(){t.active=!0,t.scale=r(0,0,1),t.getComponent(i).opacity=255,t.angle=360*Math.random()})).to(3.2,{scale:r(.8,.8,1)}).to(.8,{scale:r(1,1,1)},{onUpdate:function(e,o){t.getComponent(i).opacity=255*(1-o)}}).union().repeatForever().start()}),.8*o*1.25)})),this.bullet.extraObj.endCb(this)},n.initScale=function(){var t=.8+.4*this.lv;t+=p.skillSystem.getSkill2RangeAddScale(),this.node.scale=r(t,t,1)},n.update=function(){var t=p.player.node.getPosition();this.node.setPosition(t)},n.recycleSelfEnd=function(){this.unscheduleAllCallbacks(),d.forArr(s("frameLayer",this.node).children,(function(t){l.stopAllByTarget(t)}))},o}(c))||f);o._RF.pop()}}}));

System.register("chunks:///_virtual/Bullet1081.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./AnimationCtrl.ts"],(function(t){var n,i,o,e,l,c;return{setters:[function(t){n=t.inheritsLoose},function(t){i=t.cclegacy,o=t._decorator,e=t.Component},function(t){l=t.cocosUtil},function(t){c=t.AnimationCtrl}],execute:function(){var r;i._RF.push({},"22c20Yw0epFZpdqi8kryqCu","Bullet1081",void 0);var a=o.ccclass;o.property,t("bullet1081",a("bullet1081")(r=function(t){function i(){for(var n,i=arguments.length,o=new Array(i),e=0;e<i;e++)o[e]=arguments[e];return(n=t.call.apply(t,[this].concat(o))||this).bullet=void 0,n.contactNotHide=!0,n.animationCtrl=void 0,n}return n(i,t),i.prototype.init=function(t){var n=this;this.bullet=t,this.node.angle=0,this.animationCtrl=l.addComponentOnce(this,c),this.animationCtrl.playAnimationOnce("ani",(function(){n.bullet.recycleSelf()}))},i}(e))||r);i._RF.pop()}}}));

System.register("chunks:///_virtual/Bullet1091.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./mapModel.ts"],(function(e){var t,l,i,r,o,s;return{setters:[function(e){t=e.inheritsLoose},function(e){l=e.cclegacy,i=e._decorator,r=e.Component},function(e){o=e.cocosUtil},function(e){s=e.mapModel}],execute:function(){var n;l._RF.push({},"fc0ebvS2jlKk7UPVC1qONrd","Bullet1091",void 0);var u=i.ccclass;i.property,e("bullet1091",u("bullet1091")(n=function(e){function l(){for(var t,l=arguments.length,i=new Array(l),r=0;r<l;r++)i[r]=arguments[r];return(t=e.call.apply(e,[this].concat(i))||this).bullet=void 0,t.contactNotHide=!0,t.outScreenNotRecycle=!0,t.isOutScreenReflex=void 0,t}t(l,e);var i=l.prototype;return i.init=function(e){var t=this;this.bullet=e,this.isOutScreenReflex=!1,this.bullet.speed=this.bullet.speed*(1+s.skillSystem.getSkill2BulletSpeedAddPercent());var l=this.bullet.atk*(1+s.skillSystem.getSkill2AtkAddPercent());this.bullet.atk=Math.floor(l),this.scheduleOnce((function(){t.bullet.recycleSelf()}),this.bullet.extraObj.time)},i.mirrorReflex=function(e,t){void 0===t&&(t=!1),this.isOutScreenReflex&&!t||(this.isOutScreenReflex=!0,e?this.bullet.direction.x*=-1:this.bullet.direction.y*=-1)},i.outScreenX=function(e,t){return Math.abs(t.x-e.x)>=s.visibleHalfSize.width},i.outScreenY=function(e,t){return Math.abs(t.y-e.y)>=s.visibleHalfSize.height},i.outWallX=function(e){return!!s.mapSystem.wallLayer.active&&(e.x>=s.mapSystem.wallRightVal||e.x<=s.mapSystem.wallLeftVal)},i.outWallY=function(e){return!!s.mapSystem.wallLayer.active&&(e.y>=s.mapSystem.wallTopVal||e.y<=s.mapSystem.wallBottomVal)},i.update=function(e){var t=s.player.node.getPosition(),l=this.node.getPosition();this.outScreenX(l,t)?this.mirrorReflex(!0):this.outWallX(l)?this.mirrorReflex(!0,!0):this.outScreenY(l,t)?this.mirrorReflex(!1):this.outWallY(l)?this.mirrorReflex(!1,!0):this.isOutScreenReflex=!1},i.recycleSelfEnd=function(){o.isValid(this.bullet.extraObj.invokeClass)&&this.bullet.extraObj.invokeClass.subNum()},l}(r))||n);l._RF.pop()}}}));

System.register("chunks:///_virtual/Bullet1101.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./utilTools.ts","./mapModel.ts","./physicsGroup.ts"],(function(t){var e,i,n,o,s,a,l,r,h,d,c,u,p,v;return{setters:[function(t){e=t.inheritsLoose},function(t){i=t.cclegacy,n=t._decorator,o=t.tween,s=t.v3,a=t.Tween,l=t.macro,r=t.Vec3,h=t.Vec2,d=t.Component},function(t){c=t.cocosUtil},function(t){u=t.utilTools},function(t){p=t.mapModel},function(t){v=t.physicsGroup}],execute:function(){var y;i._RF.push({},"75d79Ach4RMub5Zg6PHH5wP","Bullet1101",void 0);var P=n.ccclass;n.property,t("bullet1101",P("bullet1101")(y=function(t){function i(){for(var e,i=arguments.length,n=new Array(i),o=0;o<i;o++)n[o]=arguments[o];return(e=t.call.apply(t,[this].concat(n))||this).bullet=void 0,e.hasTweenPlay=!1,e.outScreenNotRecycle=!0,e.lv=void 0,e.targetDis=260,e.radianSpeed=void 0,e.radian=void 0,e.shotTimeCount=void 0,e}e(i,t);var n=i.prototype;return n.init=function(t){this.bullet=t,this.node.angle=0,this.radianSpeed=0,this.setUpDownTween(!0);var e=p.player.node.getPosition();e.x+=80,e.y+=80,this.node.setPosition(e),this.lv=this.bullet.extraObj.lv,this.bullet.extraObj.endCb(this)},n.setUpDownTween=function(t){t?this.hasTweenPlay||(this.hasTweenPlay=!0,o(this.node).by(1,{position:s(0,20,0)}).by(1,{position:s(0,-20,0)}).union().repeatForever().start()):this.hasTweenPlay&&(this.hasTweenPlay=!1,a.stopAllByTarget(this.node))},n.startShot=function(t){var e=this;this.radianSpeed=2*Math.PI/t,this.radian=Math.random()*Math.PI*2,this.schedule(this.shot,.1-.01*this.lv,l.REPEAT_FOREVER),this.scheduleOnce((function(){e.radianSpeed=0,e.unschedule(e.shot)}),t)},n.shot=function(){var t=s(this.targetDis+50*(Math.random()-.5),0,0);r.rotateZ(t,t,r.ZERO,this.radian+(Math.random()-.5)*u.angleToRadian(20));var e=p.player.node.getPosition().add(t),i=e.clone().subtract(this.node.getPosition()),n=(Math.random()-.5)*u.angleToRadian(180);r.rotateZ(i,i,r.ZERO,n),p.bulletSystem.addBullet(this.bullet.id+1,v.PLAYER_BULLET,c.convertToWorldSpace(this.node),i,e)},n.update=function(t){var e=this.node.getPosition(),i=p.player.node.getPosition();e.x>i.x?this.node.scale=s(-1,1,1):this.node.scale=s(1,1,1),i.x+=80,i.y+=80;var n=0,o=h.distance(e,i);if(o>5){n=2*o;var a=1.5*p.player.getMoveSpeed();n>a&&(n=a)}if(this.hasTweenPlay&&o<=30&&(n=0),n>0){this.setUpDownTween(!1);var l=i.subtract(e).normalize();l.multiplyScalar(t*n),e.add(l),this.node.setPosition(e)}else this.setUpDownTween(!0);this.radianSpeed>0&&(this.radian-=this.radianSpeed*t)},i}(d))||y);i._RF.pop()}}}));

System.register("chunks:///_virtual/Bullet1102.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./mapModel.ts","./physicsGroup.ts","./Hint.ts"],(function(t){var e,i,o,n,l,s,c,r,u,a;return{setters:[function(t){e=t.inheritsLoose},function(t){i=t.cclegacy,o=t._decorator,n=t.Vec2,l=t.macro,s=t.Component},function(t){c=t.cocosUtil},function(t){r=t.mapModel},function(t){u=t.physicsGroup},function(t){a=t.HintNames}],execute:function(){var h;i._RF.push({},"abffdk5IzhFA42U89k/78pc","Bullet1102",void 0);var d=o.ccclass;o.property,t("bullet1102",d("bullet1102")(h=function(t){function i(){for(var e,i=arguments.length,o=new Array(i),n=0;n<i;n++)o[n]=arguments[n];return(e=t.call.apply(t,[this].concat(o))||this).bullet=void 0,e.outScreenNotRecycle=!0,e.targetPos=void 0,e.hint=void 0,e}e(i,t);var o=i.prototype;return o.init=function(t){var e=this;this.bullet=t,this.targetPos=this.bullet.extraObj,this.hint=null,this.scheduleOnce((function(){e.bullet.isFollow=!0,e.bullet.rotateSpeed=6*Math.PI}),.02+.02*Math.random()),r.hintSystem.addHint(a.targetPos2,c.convertToWorldSpaceWithPos(this.node,this.targetPos),0,(function(t){c.isValid(e)&&e.node.activeInHierarchy?e.hint=t:t.recycleSelf()})),this.schedule((function(t){var i=e.bullet.speed;(i-=20)<200&&(i=200),e.bullet.speed=i,n.distance(e.targetPos,e.node.getPosition())<=100&&e.arriveTargetPos()}),.1,l.REPEAT_FOREVER)},o.arriveTargetPos=function(){this.bullet.recycleSelf(),c.isValid(this.hint)&&this.hint.hint.recycleSelf(),r.bulletSystem.addBullet(this.bullet.id+1,u.PLAYER_BULLET,c.convertToWorldSpace(this.node))},i}(s))||h);i._RF.pop()}}}));

System.register("chunks:///_virtual/Bullet1103.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./AnimationCtrl.ts"],(function(t){var n,i,o,e,l,c;return{setters:[function(t){n=t.inheritsLoose},function(t){i=t.cclegacy,o=t._decorator,e=t.Component},function(t){l=t.cocosUtil},function(t){c=t.AnimationCtrl}],execute:function(){var r;i._RF.push({},"9f56bUVxilGH5JfDJDIaJwR","Bullet1103",void 0);var a=o.ccclass;o.property,t("bullet1103",a("bullet1103")(r=function(t){function i(){for(var n,i=arguments.length,o=new Array(i),e=0;e<i;e++)o[e]=arguments[e];return(n=t.call.apply(t,[this].concat(o))||this).bullet=void 0,n.contactNotHide=!0,n.contactBulletTime=6,n.animationCtrl=void 0,n}return n(i,t),i.prototype.init=function(t){var n=this;this.bullet=t,this.node.angle=0,this.animationCtrl=l.addComponentOnce(this,c),this.animationCtrl.playAnimationOnce("ani",(function(){n.bullet.recycleSelf()}))},i}(e))||r);i._RF.pop()}}}));

System.register("chunks:///_virtual/Bullet12.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var e,r,n,l,o;return{setters:[function(t){e=t.inheritsLoose},function(t){r=t.cclegacy,n=t._decorator,l=t.tween,o=t.Component}],execute:function(){var u;r._RF.push({},"a2151oUN3xParIX0Hp7FqxX","Bullet12",void 0);var c=n.ccclass;n.property,t("bullet12",c("bullet12")(u=function(t){function r(){for(var e,r=arguments.length,n=new Array(r),l=0;l<r;l++)n[l]=arguments[l];return(e=t.call.apply(t,[this].concat(n))||this).bullet=void 0,e}return e(r,t),r.prototype.init=function(t){this.bullet=t,l(this.bullet.node).by(4,{angle:-360}).repeatForever().start()},r}(o))||u);r._RF.pop()}}}));

System.register("chunks:///_virtual/Bullet13.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./mapModel.ts","./physicsGroup.ts","./Hint.ts"],(function(t){var e,l,o,n,i,s,u,c,r,a;return{setters:[function(t){e=t.inheritsLoose},function(t){l=t.cclegacy,o=t._decorator,n=t.Vec2,i=t.tween,s=t.Component},function(t){u=t.cocosUtil},function(t){c=t.mapModel},function(t){r=t.physicsGroup},function(t){a=t.HintNames}],execute:function(){var d;l._RF.push({},"aede7nqKw5NJo4zrdexd5GL","Bullet13",void 0);var p=o.ccclass;o.property,t("bullet13",p("bullet13")(d=function(t){function l(){for(var e,l=arguments.length,o=new Array(l),n=0;n<l;n++)o[n]=arguments[n];return(e=t.call.apply(t,[this].concat(o))||this).bullet=void 0,e.moveStop=void 0,e.bulletId=1010,e}return e(l,t),l.prototype.init=function(t){var e=this;this.bullet=t,this.moveStop=!0,this.bullet.node.angle=0;var l=this.bullet.extraObj,o=n.distance(this.bullet.node.getPosition(),l)/this.bullet.speed;i(this.bullet.node).by(o,{angle:360}).start(),i(this.bullet.node).to(o,{position:l}).call((function(){e.bullet.recycleSelf(),c.bulletSystem.addBullet(e.bulletId,r.MONSTER_BULLET,u.convertToWorldSpace(e.bullet.node))})).start(),c.hintSystem.addHint(a.targetPos,u.convertToWorldSpaceWithPos(this.bullet.node,l),0,o)},l}(s))||d);l._RF.pop()}}}));

System.register("chunks:///_virtual/Bullet14.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./AnimationCtrl.ts"],(function(t){var e,l,i,o,n,r,s,c,u;return{setters:[function(t){e=t.inheritsLoose},function(t){l=t.cclegacy,i=t._decorator,o=t.UIOpacity,n=t.Tween,r=t.tween,s=t.Component},function(t){c=t.cocosUtil},function(t){u=t.AnimationCtrl}],execute:function(){var a;l._RF.push({},"97454HzNdZJp7Cr1EZrtpWC","Bullet14",void 0);var h=i.ccclass;i.property,t("bullet14",h("bullet14")(a=function(t){function l(){for(var e,l=arguments.length,i=new Array(l),o=0;o<l;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))||this).bullet=void 0,e.moveStop=void 0,e.contactNotHide=!0,e.aniCtrl=void 0,e}e(l,t);var i=l.prototype;return i.init=function(t){var e=this;this.bullet=t,this.moveStop=!0,this.bullet.node.angle=0;var l=this.bullet.getComponent(o);l&&(l.opacity=255),this.aniCtrl||(this.aniCtrl=this.bullet.addComponent(u)),this.aniCtrl.playAnimation("bashou",!0,(function(){e.startColliderAni()})),this.startColliderAni(),this.scheduleOnce((function(){c.tweenFadeOut(e.bullet.node,1,(function(){e.bullet.recycleSelf()}))}),2.6)},i.startColliderAni=function(){n.stopAllByTarget(this.bullet.collider.size),n.stopAllByTarget(this.bullet.collider.offset),this.bullet.collider.size.width=80,this.bullet.collider.size.height=80,this.bullet.collider.offset.y=0,r(this.bullet.collider.size).delay(.55).to(.05,{width:500,height:180}).delay(.3).to(.05,{width:80,height:80}).start(),r(this.bullet.collider.offset).delay(.55).to(.05,{y:-30}).delay(.3).to(.05,{y:0}).start()},l}(s))||a);l._RF.pop()}}}));

System.register("chunks:///_virtual/bullet16.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var e,n,r,c;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy,r=t._decorator,c=t.Component}],execute:function(){var o;n._RF.push({},"dc488f7X8pJQJKa5fAURiPt","bullet16",void 0);var l=r.ccclass;r.property,t("bullet16",l("bullet16")(o=function(t){function n(){for(var e,n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))||this).bullet=void 0,e.contactNotHide=!0,e}return e(n,t),n}(c))||o);n._RF.pop()}}}));

System.register("chunks:///_virtual/Bullet17.ts",["./rollupPluginModLoBabelHelpers.js","cc","./mapModel.ts","./AnimationCtrl.ts"],(function(t){var e,l,n,o,i,c;return{setters:[function(t){e=t.inheritsLoose},function(t){l=t.cclegacy,n=t._decorator,o=t.Component},function(t){i=t.mapModel},function(t){c=t.AnimationCtrl}],execute:function(){var u;l._RF.push({},"cfb425XKhxK+pvFspil2GnJ","Bullet17",void 0);var r=n.ccclass;n.property,t("bullet17",r("bullet17")(u=function(t){function l(){for(var e,l=arguments.length,n=new Array(l),o=0;o<l;o++)n[o]=arguments[o];return(e=t.call.apply(t,[this].concat(n))||this).bullet=void 0,e.moveStop=!0,e.contactNotHide=!0,e}return e(l,t),l.prototype.init=function(t){var e=this;this.bullet=t,this.bullet.collider.enabled=!1,this.scheduleOnce((function(){e.bullet.collider.enabled=!0}),.2),this.bullet.node.angle=this.bullet.extraObj,this.addComponent(c).playAnimation("2",!1,(function(){i.bulletSystem.recycleBulletNode(e.node)}))},l}(o))||u);l._RF.pop()}}}));

System.register("chunks:///_virtual/Bullet18.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./AnimationCtrl.ts"],(function(t){var n,o,i,e,l,c;return{setters:[function(t){n=t.inheritsLoose},function(t){o=t.cclegacy,i=t._decorator,e=t.Component},function(t){l=t.cocosUtil},function(t){c=t.AnimationCtrl}],execute:function(){var r;o._RF.push({},"b18c8bZJTRLvbjF/wPbnPu+","Bullet18",void 0);var u=i.ccclass;i.property,t("bullet18",u("bullet18")(r=function(t){function o(){for(var n,o=arguments.length,i=new Array(o),e=0;e<o;e++)i[e]=arguments[e];return(n=t.call.apply(t,[this].concat(i))||this).bullet=void 0,n.moveStop=void 0,n.contactNotHide=!0,n.aniCtrl=void 0,n}return n(o,t),o.prototype.init=function(t){var n=this;this.bullet=t,this.moveStop=!0,this.bullet.node.angle=0,this.aniCtrl=l.addComponentOnce(this,c),this.aniCtrl.playAnimation("3",!1,(function(){n.bullet.recycleSelf()}))},o}(e))||r);o._RF.pop()}}}));

System.register("chunks:///_virtual/Bullet19.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./AnimationCtrl.ts"],(function(t){var e,l,n,i,o,c,r;return{setters:[function(t){e=t.inheritsLoose},function(t){l=t.cclegacy,n=t._decorator,i=t.v3,o=t.Component},function(t){c=t.cocosUtil},function(t){r=t.AnimationCtrl}],execute:function(){var s;l._RF.push({},"3ef6cc1Z8JHaoCfBKN/yXYy","Bullet19",void 0);var a=n.ccclass;n.property,t("bullet19",a("bullet19")(s=function(t){function l(){for(var e,l=arguments.length,n=new Array(l),i=0;i<l;i++)n[i]=arguments[i];return(e=t.call.apply(t,[this].concat(n))||this).bullet=void 0,e.moveStop=void 0,e.contactNotHide=!0,e.aniCtrl=void 0,e}return e(l,t),l.prototype.init=function(t){var e=this;this.bullet=t,this.moveStop=!0,this.bullet.node.angle=0,this.bullet.collider.enabled=!1;var l=1;this.bullet.extraObj&&this.bullet.extraObj.scale>0&&(l=this.bullet.extraObj.scale),this.node.setScale(i(l,l,1)),this.scheduleOnce((function(){e.bullet.collider.enabled=!0}),.1),this.aniCtrl=c.addComponentOnce(this,r),this.aniCtrl.playAnimation("4",!1,(function(){e.bullet.recycleSelf()}))},l}(o))||s);l._RF.pop()}}}));

System.register("chunks:///_virtual/Bullet20.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var e,o,i,l,n,r;return{setters:[function(t){e=t.inheritsLoose},function(t){o=t.cclegacy,i=t._decorator,l=t.find,n=t.UITransform,r=t.Component}],execute:function(){var c;o._RF.push({},"c4b50kNRxxIBJ12K6I74FHo","Bullet20",void 0);var s=i.ccclass;i.property,t("bullet20",s("bullet20")(c=function(t){function o(){for(var e,o=arguments.length,i=new Array(o),l=0;l<o;l++)i[l]=arguments[l];return(e=t.call.apply(t,[this].concat(i))||this).bullet=void 0,e.moveStop=!0,e.contactNotHide=!0,e.contactBulletTime=1,e.bodyNodeTf=void 0,e.aniCtrl=void 0,e}e(o,t);var i=o.prototype;return i.init=function(t){this.bullet=t,this.bodyNodeTf=l("body",this.node).getComponent(n),this.bullet.extraObj.invokeClass(t)},i.setBodyWidth=function(t){this.bodyNodeTf.width=t,this.bullet.collider.size.width=t-15,this.bullet.collider.offset.x=.5*(t-15)-13},o}(r))||c);o._RF.pop()}}}));

System.register("chunks:///_virtual/Bullet21.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var e,o,i,l,n,r;return{setters:[function(t){e=t.inheritsLoose},function(t){o=t.cclegacy,i=t._decorator,l=t.find,n=t.UITransform,r=t.Component}],execute:function(){var c;o._RF.push({},"52be2gmUGBPe6z6QYqIIW/I","Bullet21",void 0);var s=i.ccclass;i.property,t("bullet21",s("bullet21")(c=function(t){function o(){for(var e,o=arguments.length,i=new Array(o),l=0;l<o;l++)i[l]=arguments[l];return(e=t.call.apply(t,[this].concat(i))||this).bullet=void 0,e.moveStop=!0,e.contactNotHide=!0,e.contactBulletTime=1,e.bodyNodeTf=void 0,e.aniCtrl=void 0,e}e(o,t);var i=o.prototype;return i.init=function(t){this.bullet=t,this.bodyNodeTf=l("body",this.node).getComponent(n),this.bullet.extraObj.invokeClass(t)},i.setBodyWidth=function(t){this.bodyNodeTf.width=t,this.bullet.collider.size.width=t-15,this.bullet.collider.offset.x=.5*(t-15)-24},o}(r))||c);o._RF.pop()}}}));

System.register("chunks:///_virtual/Bullet22.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var n,e,o,i,l,r;return{setters:[function(t){n=t.inheritsLoose},function(t){e=t.cclegacy,o=t._decorator,i=t.find,l=t.Animation,r=t.Component}],execute:function(){var c;e._RF.push({},"2dfabYDvF5NxLn0MN4pRg1w","Bullet22",void 0);var u=o.ccclass;o.property,t("bullet22",u("bullet22")(c=function(t){function e(){for(var n,e=arguments.length,o=new Array(e),i=0;i<e;i++)o[i]=arguments[i];return(n=t.call.apply(t,[this].concat(o))||this).bullet=void 0,n.contactNotHide=!0,n}return n(e,t),e.prototype.init=function(t){this.bullet=t,i("body",this.node).getComponent(l).play("ani")},e}(r))||c);e._RF.pop()}}}));

System.register("chunks:///_virtual/Bullet4.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./mapModel.ts","./Hint.ts"],(function(t){var e,n,o,l,c,i,u;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy,o=t._decorator,l=t.Component},function(t){c=t.cocosUtil},function(t){i=t.mapModel},function(t){u=t.HintNames}],execute:function(){var s;n._RF.push({},"ae144wlNA9LuIlwcq3kyMDY","Bullet4",void 0);var r=o.ccclass;o.property,t("bullet4",r("bullet4")(s=function(t){function n(){for(var e,n=arguments.length,o=new Array(n),l=0;l<n;l++)o[l]=arguments[l];return(e=t.call.apply(t,[this].concat(o))||this).bullet=void 0,e}e(n,t);var o=n.prototype;return o.init=function(t){var e=this;this.bullet=t,this.bullet.rotateSpeed=Math.PI,this.scheduleOnce((function(){e.bullet.isFollow=!0}),.3),this.scheduleOnce((function(){e.bullet.isFollow=!1}),3)},o.contactBegin=function(t){i.hintSystem.addHint(u.hit2,c.convertToWorldSpace(this.bullet.node))},n}(l))||s);n._RF.pop()}}}));

System.register("chunks:///_virtual/Bullet5.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./mapModel.ts","./physicsGroup.ts"],(function(t){var e,l,i,o,n,c,u,r,s,a,d,h;return{setters:[function(t){e=t.inheritsLoose},function(t){l=t.cclegacy,i=t._decorator,o=t.v3,n=t.UIOpacity,c=t.tween,u=t.macro,r=t.Vec3,s=t.Component},function(t){a=t.cocosUtil},function(t){d=t.mapModel},function(t){h=t.physicsGroup}],execute:function(){var p;l._RF.push({},"cd56afYd4RCRrD+B541mM04","Bullet5",void 0);var b=i.ccclass;i.property,t("bullet5",b("bullet5")(p=function(t){function l(){for(var e,l=arguments.length,i=new Array(l),o=0;o<l;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))||this).bullet=void 0,e.contactNotHide=!0,e.moveStop=!1,e.direction1=void 0,e.direction2=void 0,e.bulletId=1005,e.turnSpeed=Math.PI/3,e}e(l,t);var i=l.prototype;return i.init=function(t){var e=this;this.bullet=t,this.bullet.node.setScale(o(1,1,1));var l=this.bullet.getComponent(n);l&&(l.opacity=255),this.moveStop=!0;var i=200;this.bullet.direction.x<0&&(i=-i),c(this.bullet.node).by(.3,{position:o(i,0,0)},{easing:"quadOut"}).call((function(){e.moveStop=!1,e.bullet.direction=d.player.node.getPosition().subtract(e.bullet.node.getPosition()).normalize(),a.tweenBlink(e.bullet.node,.5),e.direction1=o(0,1,0),e.direction2=o(0,-1,0),e.schedule(e.createSmallBullet,.2,u.REPEAT_FOREVER)})).start(),this.scheduleOnce((function(){e.unschedule(e.createSmallBullet),a.tweenScaleOut(e.bullet.node,.2,(function(){e.bullet.recycleSelf()}))}),6)},i.createSmallBullet=function(t){var e=t*this.turnSpeed,l=a.convertToWorldSpace(this.bullet.node);r.rotateZ(this.direction1,this.direction1,r.ZERO,e),d.bulletSystem.addBullet(this.bulletId,h.MONSTER_BULLET,l,this.direction1),r.rotateZ(this.direction2,this.direction2,r.ZERO,e),d.bulletSystem.addBullet(this.bulletId,h.MONSTER_BULLET,l,this.direction2)},l}(s))||p);l._RF.pop()}}}));

System.register("chunks:///_virtual/Bullet6.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var e,n,r,l,o;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy,r=t._decorator,l=t.tween,o=t.Component}],execute:function(){var u;n._RF.push({},"fa5eb6DaCBL0aeL+J9waOT1","Bullet6",void 0);var c=r.ccclass;r.property,t("bullet6",c("bullet6")(u=function(t){function n(){for(var e,n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(e=t.call.apply(t,[this].concat(r))||this).bullet=void 0,e}return e(n,t),n.prototype.init=function(t){this.bullet=t,l(this.bullet.node).by(.5,{angle:-360}).repeatForever().start()},n}(o))||u);n._RF.pop()}}}));

System.register("chunks:///_virtual/Bullet8.ts",["./rollupPluginModLoBabelHelpers.js","cc","./utilTools.ts","./mapModel.ts"],(function(t){var e,o,i,n,l,s,a,u,d,r;return{setters:[function(t){e=t.inheritsLoose},function(t){o=t.cclegacy,i=t._decorator,n=t.find,l=t.Vec2,s=t.UITransform,a=t.BoxCollider2D,u=t.Component},function(t){d=t.utilTools},function(t){r=t.mapModel}],execute:function(){var c;o._RF.push({},"d1442W07IpCMqaQMACJmBoZ","Bullet8",void 0);var h=i.ccclass;i.property,t("bullet8",h("bullet8")(c=function(t){function o(){for(var e,o=arguments.length,i=new Array(o),n=0;n<o;n++)i[n]=arguments[n];return(e=t.call.apply(t,[this].concat(i))||this).bullet=void 0,e.contactNotHide=!0,e.moveStop=!1,e.bodyNode=void 0,e.heightWidthRatio=207/440,e.maxFollowDis=600,e}e(o,t);var i=o.prototype;return i.init=function(t){var e=this;this.bullet=t,this.moveStop=!0,this.bodyNode=n("body",this.bullet.node),this.updateAngleAndDis(),this.scheduleOnce((function(){e.bullet.recycleSelf()}),2.3)},i.updateAngleAndDis=function(){var t=this.bullet.getFacePlayerDirection(),e=d.radianToAngle(Math.atan2(t.y,t.x));this.bullet.node.angle=e;var o=l.distance(this.bullet.node.getPosition(),r.player.node.getPosition())+40;o>this.maxFollowDis&&(o=this.maxFollowDis),this.bodyNode.getComponent(s).width=o,this.bodyNode.getComponent(s).height=this.heightWidthRatio*o,this.bullet.getComponent(a).offset.x=o-50},i.update=function(t){this.updateAngleAndDis()},o}(u))||c);o._RF.pop()}}}));

System.register("chunks:///_virtual/Bullet9.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./utilTools.ts","./mapModel.ts","./physicsGroup.ts","./Hint.ts"],(function(t){var e,o,l,n,i,c,s,u,r,a,d,p;return{setters:[function(t){e=t.inheritsLoose},function(t){o=t.cclegacy,l=t._decorator,n=t.v3,i=t.tween,c=t.Vec2,s=t.Component},function(t){u=t.cocosUtil},function(t){r=t.utilTools},function(t){a=t.mapModel},function(t){d=t.physicsGroup},function(t){p=t.HintNames}],execute:function(){var f;o._RF.push({},"9af4fCsYKhK9q9CNw1YrS3I","Bullet9",void 0);var b=l.ccclass;l.property,t("bullet9",b("bullet9")(f=function(t){function o(){for(var e,o=arguments.length,l=new Array(o),n=0;n<o;n++)l[n]=arguments[n];return(e=t.call.apply(t,[this].concat(l))||this).bullet=void 0,e.moveStop=!1,e.contactNotHide=!0,e.bulletId=1008,e.timeCount=0,e}return e(o,t),o.prototype.init=function(t){var e=this;this.bullet=t,this.timeCount=0,this.moveStop=!0;this.bullet.node.setScale(n(.1,.1,1)),i(this.bullet.node).to(.7,{scale:n(1.5,1.5,1)}).start(),this.scheduleOnce((function(){e.bullet.direction=e.bullet.getFacePlayerDirection().normalize();var t=a.player.node.getPosition(),o=c.distance(t,e.bullet.node.getPosition())/e.bullet.speed;i(e.bullet.node).to(o,{position:t}).call((function(){e.bullet.recycleSelf();var t=e.bullet.node.getPosition(),o=u.getCircleDirectionArr(10);t=u.convertToWorldSpaceWithPos(e.bullet.node,t),r.forArr(o,(function(o){a.bulletSystem.addBullet(e.bulletId,d.MONSTER_BULLET,t,o)})),a.hintSystem.addHint(p.boom1,t)})).start()}),.7)},o}(s))||f);o._RF.pop()}}}));

System.register("chunks:///_virtual/BulletSystem.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./utilTools.ts","./constants.ts","./designManager.ts","./resManager.ts","./mapModel.ts","./physicsGroup.ts","./BaseLayer.ts","./NodePoolUtil.ts","./Bullet.ts"],(function(e){var t,n,r,o,l,i,a,u,s,c,d,f,b,y,p,h,B,g,L;return{setters:[function(e){t=e.inheritsLoose,n=e.asyncToGenerator,r=e.regeneratorRuntime},function(e){o=e.cclegacy,l=e._decorator,i=e.find,a=e.Node,u=e.UITransform,s=e.Prefab},function(e){c=e.cocosUtil},function(e){d=e.utilTools},function(e){f=e.constants},function(e){b=e.designManager},function(e){y=e.resManager},function(e){p=e.mapModel},function(e){h=e.physicsGroup},function(e){B=e.BaseLayer},function(e){g=e.NodePoolUtil},function(e){L=e.Bullet}],execute:function(){var m;o._RF.push({},"9db09W/rHhFgJ7o4TJVZW7b","BulletSystem",void 0);var v=l.ccclass;l.property,e("BulletSystem",v("BulletSystem")(m=function(e){function o(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(t=e.call.apply(e,[this].concat(r))||this).idBulletLayerObj={},t.bulletLayer=void 0,t.bulletLayer2=void 0,t.waitAddArr=[],t}t(o,e);var l=o.prototype;return l.onLoad=function(){e.prototype.onLoad.call(this),this.bulletLayer=this.node,this.bulletLayer2=i("bulletLayer2",this.node.parent)},l.onEnable=function(){e.prototype.onEnable.call(this)},l.onDestroy=function(){e.prototype.onDestroy.call(this)},l.getBulletLayerNameById=function(e){return"bulletLayer"+e},l.getBulletLayerById=function(e){var t=b.getRowById(f.tableName.bullet,e),n=this.idBulletLayerObj[e];if(!n){switch((n=new a(this.getBulletLayerNameById(e))).addComponent(u),n.setPosition(0,0),t.prefab){case"bullet1042":case"bullet1044":case"bullet1071":case"bullet10200":n.parent=this.bulletLayer2;break;default:n.parent=this.bulletLayer}this.idBulletLayerObj[e]=n,n.addComponent(g).init(p.bulletPrefabObj[t.prefab])}return n},l.loadBulletPrefab=function(e){return new Promise((function(t,n){y.loadAsset(f.bundles.bullet,e,s,null,(function(e,r){e?n():t(r)}))}))},l.addBullet=function(){var e=n(r().mark((function e(t,n,o,l,i){var a,u,s,d,y=this;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=this.getBulletLayerById(t).getComponent(g),u=b.getRowById(f.tableName.bullet,t),s=function(){if(c.isValid(a)){if(a.itemNode||a.init(p.bulletPrefabObj[u.prefab]),!a.node.activeInHierarchy){var e={};return e.id=t,e.group=n,e.startWorldPos=o,e.direction=l,e.extraObj=i,void y.waitAddArr.push(e)}var r=a.getNode();c.addComponentOnce(r,L).init(t,n,o,l,i)}},p.bulletPrefabObj[u.prefab]){e.next=8;break}return e.next=6,this.loadBulletPrefab(u.prefab);case 6:d=e.sent,p.bulletPrefabObj[u.prefab]=d;case 8:s();case 9:case"end":return e.stop()}}),e,this)})));return function(t,n,r,o,l){return e.apply(this,arguments)}}(),l.forVisibleMonsterBullet=function(e){d.forArr(this.node.children,(function(t){d.forArr(t.children,(function(t){if(t.active&&p.isInScreenVisible(t)){var n=t.getComponent(L);n.collider&&n.collider.group==h.MONSTER_BULLET&&e(n)}}))}))},l.recycleAllBulletNodeById=function(e){var t=this.getBulletLayerNameById(e),n=i(t,this.bulletLayer);n&&d.forArr(n.children,(function(e){e.getComponent(L).recycleSelf()})),(n=i(t,this.bulletLayer2))&&d.forArr(n.children,(function(e){e.getComponent(L).recycleSelf()}))},l.recycleBulletNode=function(e){var t=e.getComponent(L);this.getBulletLayerById(t.id).getComponent(g).recycleNode(e)},l.updateLogic=function(e){var t=this.waitAddArr.shift();t&&this.addBullet(t.id,t.group,t.startWorldPos,t.direction,t.extraObj)},o}(B))||m);o._RF.pop()}}}));

System.register("chunks:///_virtual/BuyLifeLayer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./msgac.ts","./designManager.ts","./eventManager.ts","./playerModel.ts","./UserData.ts","./BaseLayer.ts"],(function(n){var t,e,o,a,i,r,s,c,l;return{setters:[function(n){t=n.inheritsLoose},function(n){e=n.cclegacy,o=n._decorator},function(n){a=n.msgac},function(n){i=n.designManager},function(n){r=n.eventManager},function(n){s=n.playerModel},function(n){c=n.UserData},function(n){l=n.BaseLayer}],execute:function(){var u;e._RF.push({},"92b8crcdL5PUopsmiVmqHrj","BuyLifeLayer",void 0);var y=o.ccclass;o.property,n("BuyLifeLayer",y("BuyLifeLayer")(u=function(n){function e(){for(var t,e=arguments.length,o=new Array(e),a=0;a<e;a++)o[a]=arguments[a];return(t=n.call.apply(n,[this].concat(o))||this).diamondNumNode=void 0,t}t(e,n);var o=e.prototype;return o.onLoad=function(){n.prototype.onLoad.call(this),this.diamondNumNode=this.getNodeByPath("ui/btns/btnDiamond/info/num")},o.onEnable=function(){n.prototype.onEnable.call(this),c.getInstance().mapData=null},o.onDisable=function(){n.prototype.onDisable.call(this)},o.onDestroy=function(){n.prototype.onDestroy.call(this)},o.initUI=function(){this.setString(this.diamondNumNode,"x"+i.config.backLifeDiamond)},o.onClickBtnDiamond=function(){s.skillLifeNum++,this.closeLayer(),r.send(a.mapRefreshSkill)},o.closeLayer=function(){n.prototype.closeLayer.call(this),this.layerCb&&this.layerCb()},e}(l))||u);e._RF.pop()}}}));

System.register("chunks:///_virtual/cocosUtil.ts",["./rollupPluginModLoBabelHelpers.js","cc","./utilTools.ts"],(function(t){var e,n,o,r,i,a,c,s,u,l,h,p,f,d,g,v,S,w,m,y,A,P;return{setters:[function(t){e=t.asyncToGenerator,n=t.regeneratorRuntime,o=t.createForOfIteratorHelperLoose},function(t){r=t.cclegacy,i=t.Color,a=t.Node,c=t.UIOpacity,s=t.v3,u=t.Vec3,l=t.view,h=t.UITransform,p=t.tween,f=t.Tween,d=t.Quat,g=t.instantiate,v=t.isValid,S=t.sys,w=t.input,m=t.Input,y=t.UIRenderer,A=t.Button},function(t){P=t.utilTools}],execute:function(){r._RF.push({},"c6b74pmm/VEqaWZqrRtczgX","cocosUtil",void 0),String.prototype.parseColor=function(){return new i(this)},Object.defineProperty(a.prototype,"opacity",{configurable:!0,enumerable:!0,get:function(){return T.addComponentOnce(this,c).opacity},set:function(t){T.addComponentOnce(this,c).opacity=t}});var T=t("cocosUtil",{getAroundPos:function(t,e,n,o){void 0===o&&(o=!1);var r=P.getFloatValue(e,n,!0),i=Math.random()*Math.PI*2,a=s(r,0,0);return u.rotateZ(a,a,u.ZERO,i),a=t.getPosition().add(a),o&&(a=T.convertToWorldSpaceWithPos(t,a)),a},getRectPos:function(t,e,n,o,r,i){void 0===i&&(i=!1),o||(o=e+10),r||(r=n+10);var a=[],c={};c.x=.5*-o,c.y=.5*n,c.width=o,c.height=.5*(r-n),c.weight=c.width*c.height,a.push(c);var u={};u.x=c.x,u.y=.5*-r,u.width=c.width,u.height=c.height,u.weight=c.weight,a.push(u);var l={};l.x=.5*-o,l.y=.5*-n,l.width=.5*(o-e),l.height=n,l.weight=l.width*l.height,a.push(l);var h={};h.x=.5*e,h.y=l.y,h.width=l.width,h.height=l.height,h.weight=l.weight,a.push(h);var p=P.getRowByWeight(a),f=p.x+Math.random()*p.width,d=p.y+Math.random()*p.height,g=s(f,d);return g=t.getPosition().add(g),i&&(g=T.convertToWorldSpaceWithPos(t,g)),g},vec2XAngle:function(t){var e=Math.atan2(t.y,t.x);return e<0&&(e+=2*Math.PI),P.radianToAngle(e)},vec3CopyVal:function(t,e){return t.x=e.x,t.y=e.y,t.z=e.z,t},schedule:function(t,e,n,o,r,i){void 0===r&&(r=0),void 0===i&&(i=!1),t.schedule(e,n,o,r),i&&e()},addComponentOnce:function(t,e){var n=t.getComponent(e);return n||(n=t.addComponent(e)),n},getSectorDirectionArr:function(t,e,n,o){if(void 0===o&&(o=1),t=t.clone().normalize().multiplyScalar(o),n<=1)return[t];for(var r=Math.floor(n/2),i=P.angleToRadian(e),a=[],c=[],s=r;s>=1;s--){var l=new u(0,0,0),h=i*s;u.rotateZ(l,t,u.ZERO,h),a.push(l);var p=new u(0,0,0);h=-i*(r+1-s),u.rotateZ(p,t,u.ZERO,h),c.push(p)}return a.push(t),a.concat(c)},getCircleDirectionArr:function(t,e){void 0===e&&(e=1);for(var n=2*Math.PI/t,o=s(e,0,0),r=[],i=Math.random()*Math.PI*2,a=0;a<t;a++){var c=i+n*a,l=s(0,0,0);l=u.rotateZ(l,o.clone(),u.ZERO,c),r.push(l)}return r},isInScreenVisible:function(t){if(!t||!t.parent)return!1;var e=l.getVisibleOrigin(),n=T.convertToWorldSpace(t),o=l.getVisibleSize().height,r=l.getVisibleSize().width,i=t.getComponent(h);return n.x+(1-i.anchorX)*i.width>e.x&&n.x-i.anchorX*i.width<r+e.x&&n.y+(1-i.anchorY)*i.height>e.y&&n.y-i.anchorY*i.height<o+e.y},tweenScaleOut:function(t,e,n){p(t).to(e,{scale:s(0,0,0)}).call((function(){n()})).start()},tweenHitScale:function(t,e,n){void 0===e&&(e=.1),f.stopAllByTarget(t);var o=t.getScale();p(t).to(e,{scale:s(.95*o.x,1.1*o.y,1)}).to(2*e,{scale:s(o.x,.9*o.y,1)}).to(2*e,{scale:s(.95*o.x,1.1*o.y,1)}).to(e,{scale:s(o.x,o.y,1)}).call((function(){n&&n()})).start()},tweenScaleShake:function(t,e){var n=new d;d.fromEuler(n,0,0,10);var o=new d;d.fromEuler(o,0,0,-10);var r=new d;d.fromEuler(r,0,0,0),p(t).to(.3,{scale:s(1.3,1.3,1)}).to(.2,{rotation:n}).to(.4,{rotation:o}).to(.2,{rotation:r}).to(.2,{scale:s(1,1,1)}).call((function(){e&&e()})).start()},instantiate:function(t){return g(t)},tweenBubbling:function(t){f.stopAllByTarget(t),t.setScale(s(.4,.4,1)),p(t).to(.5,{scale:s(1,1,1)}).to(.5,{scale:s(.4,.4,1)}).union().repeatForever().start()},waitTimeAsync:function(t,e){return new Promise((function(n){"number"==typeof t?setTimeout((function(){n()}),1e3*t):t.scheduleOnce((function(){n()}),e)}))},getScreenMidWorldPos:function(){var t=l.getVisibleSize();return s(.5*t.width,.5*t.height,0)},nodeChangeParent:function(t,e){if(this.isValid(t)&&this.isValid(e)){var n=T.convertToWorldSpace(t);t.parent=e,n=T.convertToNodeSpace(t,n),t.setPosition(n)}},tweenUIShow:function(t){f.stopAllByTarget(t);var e=t.getScale();t.setScale(s(.5,.5,1)),p(t).to(.1,{scale:e}).start()},tweenBounceAction:function(t){f.stopAllByTarget(t);var e=t.getScale().x,n=t.getScale().y;p(t).to(.15,{scale:s(.4*e,1.2*n,1)},{easing:"bounceInOut"}).to(.15,{scale:s(1.4*e,.8*n,1)},{easing:"bounceInOut"}).to(.2,{scale:s(e,n,1)},{easing:"smooth"}).delay(.7).union().repeatForever().start()},tweenShakeNode:function(t){var e=.1;p(t).to(e,{position:s(5,-5)}).to(e,{position:s(-5,5)}).to(e,{position:s(5,5)}).to(e,{position:s(-5,-5)}).to(e,{position:s(0,0)}).start()},tweenFallDown:function(t,e){t.setScale(.5,.5,1);var n=t.getPosition();T.setNodePositionY(t,n.y+100),p(t).to(.3,{position:n}).to(.2,{scale:s(1,1,1)}).call((function(){e&&e()})).start()},tweenTopFadeOut:function(t,e){var n=t.getComponent(c);n||(n=t.addComponent(c)),n.opacity=255,t.setScale(1,1,1),p(t).to(.05,{scale:s(1.2,1.2,1)}).to(.1,{scale:s(1,1,1)}).by(.5,{position:s(0,40)}).by(1,{position:s(0,0)},{onUpdate:function(t,e){n.opacity=255*(1-e)}}).union().call((function(){e&&e()})).start()},tweenScaleEffect:function(t,e,n){e||(e=.2),t.setScale(1,1,1),p(t).to(e,{scale:s(1.5,1.5,1)}).to(e,{scale:s(1,1,1)}).call((function(){n&&n()})).start()},tweenFlyToPos:function(t,o,r){return e(n().mark((function e(){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return f.stopAllByTarget(t),e.abrupt("return",new Promise((function(e,n){var i=T.getQuatByAngleZ(360),a=p(t).to(.5,{position:o}),c=p(t).by(.5,{rotation:i},{easing:"quadOut",onUpdate:function(e,n){t.setRotation(T.getQuatByAngleZ(360*n))}});p(t).parallel(a,c).call((function(){t.setRotation(T.getQuatByAngleZ(0)),e(),r&&r()})).start()})));case 2:case"end":return e.stop()}}),e)})))()},tweenTopRightPao:function(t,e){var n=40;n+=20*Math.random(),t.setScale(s(1,1,1)),p(t).by(.3,{position:s(n,100)},{easing:"quadOut",onUpdate:function(e,n){var o=.5*n;t.setScale(s(1+o,1+o,1))}}).by(.3,{position:s(40,-80)},{easing:"quadIn",onUpdate:function(e,n){var o=.5*n;t.setScale(s(1.5-o,1.5-o,1))}}).union().call((function(){e&&e()})).start()},tweenScaleIn:function(t,e,n){e||(e=.2),t.setScale(0,0,1),p(t).to(e,{scale:s(1,1,1)}).call((function(){n&&n()})).start()},tweenScaleIn2:function(t,e,n){e||(e=.2),t.setScale(0,0,1),p(t).to(e,{scale:s(1.3,1.3,1)}).to(e/2,{scale:s(1,1,1)}).union().call((function(){n&&n()})).start()},tweenBlink:function(t,e,n){e||(e=.5);var o=this.addComponentOnce(t,c);o.opacity=255,p(o).to(e,{opacity:80}).to(e,{opacity:255}).call((function(){n&&n()})).union().repeatForever().start()},tweenRotate:function(t,e){e||(e=2);var n=T.getQuatByAngleZ(360);p(t).by(e,{rotation:n},{easing:"linear",onUpdate:function(t,e){var n=360*e;t.setRotation(T.getQuatByAngleZ(n))}}).repeatForever().start()},tweenUpDown:function(t,e,n){e||(e=6),n||(n=1.5);var o=t.getPosition();o.y+=e;var r=t.getPosition();p(t).to(n,{position:o}).to(n,{position:r}).union().repeatForever().start()},tweenFadeIn:function(t,o,r){var i=this;return e(n().mark((function e(){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){o||(o=1);var a=i.addComponentOnce(t,c);a.opacity=0,p(a).to(o,{opacity:255}).call((function(){e(),r&&r()})).start()})));case 1:case"end":return e.stop()}}),e)})))()},tweenFadeOut:function(t,o,r){var i=this;return e(n().mark((function e(){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){o||(o=1.5);var a=i.addComponentOnce(t,c);a.opacity=255,p(a).to(o,{opacity:0}).call((function(){e(),r&&r()})).start()})));case 1:case"end":return e.stop()}}),e)})))()},tweenBreath:function(t,e,n){e||(e=.4),n||(n=1.2),p(t).to(e,{scale:s(n,n,1)}).to(e,{scale:s(1,1,1)}).union().repeatForever().start()},tweenShake:function(t,e,n,o,r){f.stopAllByTarget(t),e||(e=.2),n||(n=6),null==o&&(o=5*e);var i=new d;d.fromEuler(i,0,0,n);var a=new d;d.fromEuler(a,0,0,-n);var c=new d;d.fromEuler(c,0,0,0);var s=p(t).to(e,{rotation:i}).to(2*e,{rotation:a}).to(e,{rotation:c});null==r?s.delay(o).union().repeatForever().start():s.start()},isValid:function(t){return!(!t||!v(t))},isAndroid:function(){return S.platform===S.Platform.ANDROID},isDesktopBrowser:function(){return S.platform===S.Platform.DESKTOP_BROWSER},isIos:function(){return S.platform===S.Platform.IOS},isWechatGame:function(){return S.platform===S.Platform.WECHAT_GAME},addKeyDownListener:function(t,e){w.on(m.EventType.KEY_DOWN,t,e)},init:function(){this.designSize=l.getDesignResolutionSize(),this.frameSize=l.getFrameSize(),this.safeAreaRect=S.getSafeAreaRect(),this.safeAreaMarginTop=this.designSize.height-this.safeAreaRect.height,this.safeAreaMarginTop<0&&(this.safeAreaMarginTop=0),this.intiScreenAdapterWidthScale(),this.initScreenBgAdapterWidthScale()},intiScreenAdapterWidthScale:function(){var t=this.frameSize.height,e=this.frameSize.width,n=t/this.designSize.height,o=this.designSize.width*n,r=1;o>e&&(r=e/o),this.screenAdapterScale=r},getScreenAdapterScale:function(){return this.screenAdapterScale||(this.screenAdapterScale=1),this.screenAdapterScale},initScreenBgAdapterWidthScale:function(){var t=this.frameSize.height,e=this.frameSize.width,n=t/this.designSize.height,o=this.designSize.width*n,r=1;o<e&&(r=e/o),this.screenBgAdapterScale=r},getScreenBgAdapterScale:function(){return this.screenBgAdapterScale||(this.screenBgAdapterScale=1),this.screenBgAdapterScale},convertToWorldSpace:function(t,e){var n=t.parent.getComponent(h),o=t.getPosition();if(e){var r=t.getComponent(h);o.x=o.x+(.5-r.anchorX)*r.width,o.y=o.y+(.5-r.anchorY)*r.height}return n.convertToWorldSpaceAR(o)},convertToWorldSpaceWithPos:function(t,e){return e=t.parent.getComponent(h).convertToWorldSpaceAR(e)},convertToNodeSpace:function(t,e){return t.parent.getComponent(h).convertToNodeSpaceAR(e)},setRenderableColor:function(t,e,n){var r=t.getComponent(y);if(r&&r.color){var i=null;i="string"==typeof e?e.parseColor():e,r.color=i}if(n)for(var a,c=o(t.children);!(a=c()).done;){var s=a.value;this.setRenderableColor(s,e,n)}},getRenderableColor:function(t){var e=t.getComponent(y);return e&&e.color?e.color.clone():null},getColorByHEX:function(t){return new i(t)},setButtonEnabled:function(t,e){var n=t.getComponent(A);n&&(n.enabled=e)},getQuatByAngleZ:function(t){var e=new d;return d.fromEuler(e,0,0,t),e},formatNum:function(t){return t<1e4?t:t<1e6?((t=Math.floor(t/1e3*100))/100).toFixed(2)+"K":((t=Math.floor(t/1e6*100))/100).toFixed(2)+"M"},formatNumString:function(t){return t<1e3?t:t<1e4?((t=Math.floor(t/1e3*10))/10).toFixed(1)+"K":t<1e7?((t=Math.floor(t/1e4*10))/10).toFixed(1)+"w":((t=Math.floor(t/1e6*100))/100).toFixed(2)+"M"},setNodePositionX:function(t,e){var n=t.getPosition();n.x=e,t.setPosition(n)},setNodePositionY:function(t,e){var n=t.getPosition();n.y=e,t.setPosition(n)},drawCurvePath:function(t,e,n,o,r,i){var a;void 0===i&&(i=0);var c=[(e[0]+n[0])/2-(e[1]-n[1])*o,(e[1]+n[1])/2-(n[0]-e[0])*o],u=[];u.push(p(t).delay(i));for(var l=e[0],h=e[1],f=0;f<=r/100;f+=.01){var d=this.quadraticBezier(e[0],c[0],n[0],f),g=this.quadraticBezier(e[1],c[1],n[1],f),v=(Math.abs(d-l)+Math.abs(g-h))/1500;u.push(p(t).to(v,{position:s(d,g,0)})),l=d,h=g}var S=(Math.abs(n[0]-l)+Math.abs(n[1]-h))/1500;u.push(p(t).to(S,{position:s(n[0],n[1],0)})),(a=p(t)).sequence.apply(a,u).start()},quadraticBezier:function(t,e,n,o){var r=1-o;return r*r*t+2*(1-o)*o*e+o*o*n},setRemoteImage:function(t,e){var n=t.getComponent(cc.Sprite);n?cc.assetManager.loadRemote(e,{ext:".png"},(function(t,e){if(t)console.error("Failed to load image:",t);else if(e){var o=new cc.Texture2D;o.image=e;var r=new cc.SpriteFrame;r.texture=o,n.spriteFrame=r}else console.error("ImageAsset is undefined or null.")})):console.error("Failed to get Sprite component.")}});r._RF.pop()}}}));

System.register("chunks:///_virtual/comeShine.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./mapModel.ts"],(function(t){var e,n,o,c,i,r;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy,o=t._decorator,c=t.Component},function(t){i=t.cocosUtil},function(t){r=t.mapModel}],execute:function(){var s;n._RF.push({},"39615xkBlpHPLeCPBzWKu+h","comeShine",void 0);var u=o.ccclass;o.property,t("comeShine",u("comeShine")(s=function(t){function n(){for(var e,n=arguments.length,o=new Array(n),c=0;c<n;c++)o[c]=arguments[c];return(e=t.call.apply(t,[this].concat(o))||this).hint=void 0,e}return e(n,t),n.prototype.init=function(t){var e=this;this.hint=t;var n=this.hint.extraObj.monsterId;this.scheduleOnce((function(){r.monsterSystem.createMonster(n,i.convertToWorldSpace(e.node))}),.4)},n}(c))||s);n._RF.pop()}}}));

System.register("chunks:///_virtual/conf.ts",["cc"],(function(e){var t;return{setters:[function(e){t=e.cclegacy}],execute:function(){t._RF.push({},"f97e0MoLgtPP5tALE0CHh/1","conf",void 0);e("GNetConf",{mrtgd_WsUrl:"wss://api.play.xmtyq.com:39001/sh",mrtgd_HttpUrl:"https://api.play.xmtyq.com:39001",mrtgd_jjws_WsUrl:"wss://api.play.xmtyq.com:39002/sh",mrtgd_jjws_HttpUrl:"https://api.play.xmtyq.com:39002"}),e("GNetCmd",{StickPack:1e5,Heartbeat:101e3,UserLogin:101001,UserRegister:101002,AntiAddiction:101003,SensitiveWordsCheck:101004,SaveUserRecord:102003,GetRegionData:102004,GetRegionList:102005,SaveUserRecordAll:102007,UploadAvatar:102008,GetUserDataByKey:102009,ReqWxSession:103001,ReqSendAuthCode:103002,ReqPhoneLogin:103003,SetFriendCode:104001,GetFriendVal:104002,GetRankInfo:201001,GetInviteCode:201002,GetInviteCodeReward:201003,GetInviteLevelReward:201004,PushInviteProcess:201005,IsRankOpen:201006,GetSomeonePlayerInfo:201007,GetMidAutumnRank:301001,SetMidAutumnRank:301002,GetWorldBossRank:301003,SetWorldBossRank:301004,PushWorldBossSettle:301005,SetWorldBossPlayerStatus:301006,GetWorldBossPlayerStatus:301007,GetEmpireSpotData:302001,ActionEmpireSpot:302002}),e("GClientEvent",{}),e("GNetConst",{SaveHead:"game",ServerIsNew:"serverIsNew",ServerIsOld:"serverIsOld",ResSuccess:"success",ResFail:"fail",DataTypeInt:"int",DataTypeString:"string",DataTypeBoolean:"boolean",DataTypeObject:"object",ServerEventHead:"ServerDown_",Http_isAlive:"/isAlive"}),e("GLoginState",function(e){return e.noYet="noYet",e.loginFail="loginFail",e.loginWithoutAccount="loginWithoutAccount",e.loginWithAccount="loginWithAccount",e}({}));t._RF.pop()}}}));

System.register("chunks:///_virtual/constants.ts",["cc"],(function(e){var a;return{setters:[function(e){a=e.cclegacy}],execute:function(){a._RF.push({},"bd851Zf7BtBf7ZqFmN8xVxt","constants",void 0);e("constants",{gameName:"mrtgd",animations:{animation:"animation",standBy:"standby",attack:"attack",hit:"hit",die:"die",appear:"appear",walk:"walk"},audioNames:{home:"home",map:"map",win:"win"},propIds:{coin:101,dayAct:107,energy:108,exp:201,magnet:301,addHpPercent:401,bomb:501,box1:601,box2:701,diamond:801,boxMonsterCoin:1001,equip:1002},propTypes:{coin:1,exp:2,skin:17},mapTypes:{main:1,tower:2},materials:{shineColor:"shader/shineColor",shineColorSpine:"shader/shineColorSpine"},monsterTypes:{common:1,elite:2,boss:3},monsterIds:{boxMonster:24},skillTypes:{hammer:1,disk:2},times:{minute:6e4,houre:36e5,day:864e5},tableName:{map:"map",level:"level",monster:"monster",weapon:"weapon",bullet:"bullet",skill:"skill",skill2:"skill2",expLv:"expLv",expType:"expType",prop:"prop",box1:"box1",config:"config",heroLevel:"heroLevel",suit:"suit",draw:"draw",weaponOpt:"weaponOpt",towerFloor:"towerFloor",dayTask:"dayTask",daySign:"daySign",energyAward:"energyAward",CNTM:"CNTM",vip:"vip",monsterTimeAdd:"monsterTimeAdd"},bundles:{audio:"audio",bullet:"bullet",common:"common",design:"design",hint:"hint",icon:"icon",layer:"layer",monster:"monster",prefab:"prefab",spine:"spine",ui:"ui",weapon:"weapon",wwqVec:"wwqVec",resources:"resources"},layers:{LoadingLayer:"LoadingLayer",NoticeLayer:"NoticeLayer",TributeLayer:"TributeLayer",AscendLayer:"AscendLayer",WalletLayer:"WalletLayer",WalletLinkLayer:"WalletLinkLayer",NewShopLayer:"NewShopLayer",SkinsLayer:"SkinsLayer",SelectSummonLayer:"SelectSummonLayer",SkinsDetailsLayer:"SkinsDetailsLayer",InviteLayer:"InviteLayer",Daily:"Daily",Quests:"Quests",HomeLayer:"HomeLayer",MapLayer:"MapLayer",MapFightLayer:"MapFightLayer",SkillSelectLayer:"SkillSelectLayer",PauseLayer:"PauseLayer",SettlementLayer:"SettlementLayer",BackHomeLayer:"BackHomeLayer",BackLifeLayer:"BackLifeLayer",BackMapLayer:"BackMapLayer",HandLayer:"HandLayer",TransLayer:"TransLayer",BoxMonsterLayer:"BoxMonsterLayer",DayTaskLayer:"DayTaskLayer",EnergyLayer:"EnergyLayer",Earn:"Earn",Summon:"Summon",Shop:"Shop",Events:"Events",DaySignLayer:"DaySignLayer",LetterLayer:"LetterLayer",LetterConfirmLayer:"LetterConfirmLayer",LetterDetailsLayer:"LetterDetailsLayer",SkinChangeLayer:"SkinChangeLayer",PropInfoLayer2:"PropInfoLayer2",AwardInfoLayer:"AwardInfoLayer",VipLayer:"VipLayer",ShareLayer:"ShareLayer",MsgBoxLayer:"MsgBoxLayer",BuyLifeLayer:"BuyLifeLayer",PropInfoLayer:"PropInfoLayer",NewPropInfoLayer:"NewPropInfoLayer",MoreGameLayer:"MoreGameLayer",LoginLayer:"LoginLayer",RewardItemLayer:"RewardItemLayer",ShopLayer:"ShopLayer",RewardLayer:"RewardLayer",SettingLayer:"SettingLayer",PatrolLayer:"PatrolLayer",PatrolFastLayer:"PatrolFastLayer",PyramidDrawLayer:"PyramidDrawLayer",HeroLayer:"HeroLayer",Loading:"Loading",MainLayer:"MainLayer",TopUILayer:"TopUILayer",LoadingManager:"LoadingManager",ExChangeLayer:"ExChangeLayer",Bag:"Bag"},saveTimeGap:3e5,colors:{yin:"#666666",white:"#ffffff",green:"#38ff38",blue:"#1096fd",purple:"#f153ff"},design:{maxLv:5,weaponNum:4,skillNum:6,backLifeMax:1}});a._RF.pop()}}}));

System.register("chunks:///_virtual/CountTimeUtil.ts",["./rollupPluginModLoBabelHelpers.js","cc","./utilTools.ts"],(function(t){var e,i,n,o,s,u,r;return{setters:[function(t){e=t.inheritsLoose},function(t){i=t.cclegacy,n=t._decorator,o=t.Label,s=t.macro,u=t.Component},function(t){r=t.utilTools}],execute:function(){var l;i._RF.push({},"aa2e7PxHLFHprbziHo7Pp5S","CountTimeUtil",void 0);var c=n.ccclass;n.property,t("CountTimeUtil",c("CountTimeUtil")(l=function(t){function i(){for(var e,i=arguments.length,n=new Array(i),o=0;o<i;o++)n[o]=arguments[o];return(e=t.call.apply(t,[this].concat(n))||this)._time=0,e._callFun=null,e}e(i,t);var n=i.prototype;return n.onLoad=function(){this.node.getComponent(o).string=r.getTimeStr(1e3*this._time,!0)},n.setTime=function(t,e){void 0===e&&(e=null),this._time=t,this._callFun=e,this._time>0?(this.node.getComponent(o).string=r.getTimeStr(1e3*this._time,!0),this.schedule(this.updateTime,1,s.REPEAT_FOREVER)):this.node.getComponent(o).string=""},n.start=function(){},n.updateTime=function(){this._time>0&&(this._time--,this.node.getComponent(o).string=r.getTimeStr(1e3*this._time,!0)),this._time<=0&&(this.unschedule(this.updateTime),this.node.getComponent(o).string="",this._callFun&&this._callFun())},i}(u))||l);i._RF.pop()}}}));

System.register("chunks:///_virtual/CronCtr.ts",["./rollupPluginModLoBabelHelpers.js","cc","./conf.ts","./ServerCtr.ts","./wmsocket.ts"],(function(t){var n,e,r,o,c,a,i,s;return{setters:[function(t){n=t.inheritsLoose},function(t){e=t.cclegacy,r=t._decorator,o=t.Component},function(t){c=t.GLoginState,a=t.GNetCmd},function(t){i=t.default},function(t){s=t.WmSocket}],execute:function(){var l,u;e._RF.push({},"7166aCA9O1JwpNeRr4Y/Af5","CronCtr",void 0);var f=r.ccclass;r.property,t("default",f("CronCtr")(((u=function(t){function e(){for(var n,e=arguments.length,r=new Array(e),o=0;o<e;o++)r[o]=arguments[o];return(n=t.call.apply(t,[this].concat(r))||this).msgArr=[],n.msgArrIdx=0,n.isPutEnable=!1,n.testTimeDelta=0,n}n(e,t),e.getInstance=function(){return this._instance||(this._instance=new e),this._instance};var r=e.prototype;return r.init=function(){},r.uploadAllRecord=function(t){if(i.GetInstance().loginState==c.loginWithAccount){var n={cmd:a.SaveUserRecordAll,lang:"zh",type:"single",token:i.GetInstance().token,version:i.GetInstance().dataVersion,allData:JSON.stringify(t)};console.warn("发送数据到云端---",n),s.getInstance().send({data:n})}},e}(o))._instance=void 0,l=u))||l);e._RF.pop()}}}));

System.register("chunks:///_virtual/Daily.ts",["./rollupPluginModLoBabelHelpers.js","cc","./BaseUILayer.ts","./ServerCtr.ts","./utilTools.ts","./layerManager.ts","./audioManager.ts","./UserData.ts"],(function(e){var t,a,i,n,r,o,c,l,d,s,g,m,u,h,C,y,p;return{setters:[function(e){t=e.applyDecoratedDescriptor,a=e.inheritsLoose,i=e.initializerDefineProperty,n=e.assertThisInitialized,r=e.asyncToGenerator,o=e.regeneratorRuntime},function(e){c=e.cclegacy,l=e._decorator,d=e.Node,s=e.Prefab,g=e.Label},function(e){m=e.BaseUILayer},function(e){u=e.default},function(e){h=e.utilTools},function(e){C=e.layerManager},function(e){y=e.audioManager},function(e){p=e.UserData}],execute:function(){var v,w,N,f,B,R,k,b,L;c._RF.push({},"cdb9czUc/hCx56+fK/hX1EE","Daily",void 0);var I=l.ccclass,D=l.property;e("Daily",(v=I("Daily"),w=D({type:d}),N=D({type:d}),f=D({type:s}),v((k=t((R=function(e){function t(){for(var t,a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return t=e.call.apply(e,[this].concat(r))||this,i(t,"scrollView",k,n(t)),i(t,"itemLayer",b,n(t)),i(t,"dailyItemPrefab",L,n(t)),t.rootNode=void 0,t}a(t,e);var c=t.prototype;return c.onLoad=function(){this.rootNode=this.node},c.start=function(){this.loadTaskItems()},c.update=function(e){},c.onDestroy=function(){e.prototype.onDestroy.call(this)},c.loadTaskItems=function(){var e=r(o().mark((function e(){var t,a,i,n,r,c,l,d,s,m,y,p,v,w=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.rootNode.getChildByName("Loading").active=!0,e.prev=1,e.next=4,u.GetInstance().getUserCheckInList(h.getUserId());case 4:t=e.sent,a=null==t?void 0:t.slice(0,-1),i=null==t?void 0:t.slice(-1)[0],this.rootNode.getChildByName("Loading").active=!1,n=0,a?(this.scrollViewSetData(this.scrollView,a,(function(e,t,a){var i=e.getChildByName("awardLayer"),r=e.getChildByName("Label"),o=e.getChildByName("hasGot"),c=e.getChildByName("today"),l=e.getChildByName("bgLayer"),d=l.getChildByName("bg"),s=l.getChildByName("bg-today"),m=l.getChildByName("bg-7");d.active=!1,s.active=!1,m.active=!1,c.active=!1;var u={bg:d,day2d:s,bg7:m},h="bg";!n&&t.isCompleted&&(n++,c.active=!0,h="day2d"),o.active=!!t.isCompleted,u[h=a>0&&(a+1)%7==0?"bg7":h].active=!0,r?r.getComponent(g).string=t.name:console.log("Label node not found");var C=i.getChildByName("powerRechargeReward"),y=i.getChildByName("soulCoinReward"),p=i.getChildByName("mpCoinReward"),v=i.getChildByName("diamondCoinReward"),N=i.getChildByName("summoningTicketReward");(C.active=!1,y.active=!1,p.active=!1,v.active=!1,N.active=!1,t.powerRechargeReward>0)&&(C.active=!0,C.getChildByName("val").getComponent(g).string="x"+t.powerRechargeReward.toString());t.soulCoinReward>0&&(y.active=!0,y.getChildByName("val").getComponent(g).string="x"+t.soulCoinReward.toString());t.mpCoinReward>0&&(p.active=!0,p.getChildByName("val").getComponent(g).string="x"+t.mpCoinReward.toString());t.diamondCoinReward>0&&(v.active=!0,v.getChildByName("val").getComponent(g).string="x"+t.diamondCoinReward.toString());t.summoningTicketReward>0&&(N.active=!0,N.getChildByName("val").getComponent(g).string="x"+t.summoningTicketReward.toString());w.addClickListener(i,t)})),r=this.rootNode.getChildByName("day30"),c=r.getChildByName("awardLayer"),l=c.getChildByName("powerRechargeReward"),d=c.getChildByName("soulCoinReward"),s=c.getChildByName("mpCoinReward"),m=c.getChildByName("diamondCoinReward"),y=c.getChildByName("summoningTicketReward"),l.active=!1,d.active=!1,s.active=!1,m.active=!1,y.active=!1,p={powerRechargeReward:l,soulCoinReward:d,mpCoinReward:s,diamondCoinReward:m,summoningTicketReward:y},v=[],["summoningTicketReward","powerRechargeReward","soulCoinReward","mpCoinReward","diamondCoinReward"].forEach((function(e){var t,a=i[e];a>0&&v.push(((t={})[e]=a,t))})),v.forEach((function(e,t){var a=p[Object.keys(e)[0]];a.active=!0;var i=Object.values(e)[0];a.getChildByName("num").getChildByName("val").getComponent(g).string="x"+i.toString(),t===v.length-1&&(a.getChildByName("plus").active=!1)})),this.addClickListener(r,i)):C.createNotice("Fetch Daily CheckIn Error"),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(1),console.log("🚀 ~ Daily ~ loadTaskItems ~ error:",e.t0),C.createNotice("Fetch Daily CheckIn Error");case 16:case"end":return e.stop()}}),e,this,[[1,12]])})));return function(){return e.apply(this,arguments)}}(),c.loadTaskItems1=function(){var e=r(o().mark((function e(){var t,a=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.rootNode.getChildByName("Loading").active=!0,e.prev=1,e.next=4,u.GetInstance().getUserCheckInList(h.getUserId());case 4:t=e.sent,this.rootNode.getChildByName("Loading").active=!1,console.log(11111111111,t),t?this.scrollViewSetData(this.scrollView,t,(function(e,t,i){var n=e.getChildByName("awardLayer"),r=e.getChildByName("Label"),o=e.getChildByName("btnGet");o.active=!t.isCompleted,r?r.getComponent(g).string=t.name:console.log("Label node not found");var c=n.getChildByName("powerRechargeReward"),l=n.getChildByName("soulCoinReward"),d=n.getChildByName("mpCoinReward"),s=n.getChildByName("diamondCoinReward"),m=n.getChildByName("summoningTicketReward");(c.active=!1,l.active=!1,d.active=!1,s.active=!1,m.active=!1,t.powerRechargeReward>0)&&(c.active=!0,c.getChildByName("num").getChildByName("val").getComponent(g).string=t.powerRechargeReward.toString());t.soulCoinReward>0&&(l.active=!0,l.getChildByName("num").getChildByName("val").getComponent(g).string=t.soulCoinReward.toString());t.mpCoinReward>0&&(d.active=!0,d.getChildByName("num").getChildByName("val").getComponent(g).string=t.mpCoinReward.toString());t.diamondCoinReward>0&&(s.active=!0,s.getChildByName("num").getChildByName("val").getComponent(g).string=t.diamondCoinReward.toString());t.summoningTicketReward>0&&(m.active=!0,m.getChildByName("num").getChildByName("val").getComponent(g).string=t.summoningTicketReward.toString());a.addClickListener(o,t)})):C.createNotice("Fetch Daily CheckIn Error"),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(1),console.log("🚀 ~ Daily ~ loadTaskItems1 ~ error:",e.t0),C.createNotice("Fetch Daily CheckIn Error");case 14:case"end":return e.stop()}}),e,this,[[1,10]])})));return function(){return e.apply(this,arguments)}}(),c.addClickListener=function(e,t){var a=this;e.off(d.EventType.TOUCH_END),e.on(d.EventType.TOUCH_END,r(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Item clicked:",t.id),y.playEffect("btnClick"),a.rootNode.getChildByName("Loading").active=!0,e.prev=3,e.next=6,u.GetInstance().completeCheckIn(h.getUserId().toString(),t.id);case 6:return e.next=8,p.getInstance().updateUserData();case 8:a.loadTaskItems(),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(3),console.error("Error during check-in:",e.t0);case 14:return e.prev=14,a.rootNode.getChildByName("Loading").active=!1,e.finish(14);case 17:case"end":return e.stop()}}),e,null,[[3,11,14,17]])}))))},c.confirmDailyCheckIn=function(){var e=r(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),c.onClickBtnClose=function(){this.closeLayer()},c.onClickBtnVerify=function(){},t}(m)).prototype,"scrollView",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),b=t(R.prototype,"itemLayer",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),L=t(R.prototype,"dailyItemPrefab",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),B=R))||B));c._RF.pop()}}}));

System.register("chunks:///_virtual/DaySignLayer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./sdkManager.ts","./tyqSDK.ts","./cocosUtil.ts","./constants.ts","./localText.ts","./msgac.ts","./designManager.ts","./eventManager.ts","./playerModel.ts","./UserData.ts","./BaseLayer.ts"],(function(t){var a,n,e,i,r,o,s,d,c,y,h,g,f,l,u,p;return{setters:[function(t){a=t.inheritsLoose},function(t){n=t.cclegacy,e=t._decorator,i=t.find,r=t.Tween},function(t){o=t.sdkManager},function(t){s=t.tyqSDK},function(t){d=t.cocosUtil},function(t){c=t.constants},function(t){y=t.localText},function(t){h=t.msgac},function(t){g=t.designManager},function(t){f=t.eventManager},function(t){l=t.playerModel},function(t){u=t.UserData},function(t){p=t.BaseLayer}],execute:function(){var v;n._RF.push({},"7faeagfy2tN9JzWiIAnph2z","DaySignLayer",void 0);var w=e.ccclass;e.property,t("DaySignLayer",w("DaySignLayer")(v=function(t){function n(){for(var a,n=arguments.length,e=new Array(n),i=0;i<n;i++)e[i]=arguments[i];return(a=t.call.apply(t,[this].concat(e))||this).itemUIArr=[],a.awardDay=0,a}a(n,t);var e=n.prototype;return e.onLoad=function(){var a=this;t.prototype.onLoad.call(this);for(var n=this.getNodeByPath("ui/itemLayer"),e=i("propItem",n),r=0;r<2;r++)d.instantiate(e).parent=n;var o=d.instantiate(n);o.parent=n.parent;var s=o.getPosition();s.y-=150,o.position=s,d.instantiate(e).parent=n,n.children.forEach((function(t){a.itemUIArr.push(t)})),o.children.forEach((function(t){a.itemUIArr.push(t)}))},e.onEnable=function(){t.prototype.onEnable.call(this)},e.onDisable=function(){t.prototype.onDisable.call(this)},e.onDestroy=function(){t.prototype.onDestroy.call(this)},e.initUI=function(){var t=new Date,a=Math.floor((t.getTime()-l.daySignObj.startTime)/c.times.day);this.awardDay=a;for(var n=0;n<this.itemUIArr.length;n++){var e=this.itemUIArr[n],o=g.getRowById(c.tableName.daySign,n+1);this.setPropItem(o.award[0],i("icon",e),o.award[1],i("bg",e),i("num/val",e)),this.setString(i("day",e),y.dayIndex.format(n+1));var s=i("get",e),h=i("patch",e),f=i("target",e);s.active=!1,h.active=!1,f.active=!1;var u=!1;-1!=l.daySignObj.awardDayArr.indexOf(n)&&(u=!0),u?s.active=!0:n<a?h.active=!0:n==a&&(f.active=!0,r.stopAllByTarget(f),d.tweenBlink(f,.3))}this.setString(this.getNodeByPath("ui/bottom/info/has/info/text"),l.daySignObj.awardDayArr.length+y.ci),this.setString(this.getNodeByPath("ui/bottom/info/no/info/text"),7-l.daySignObj.awardDayArr.length+y.ci),this.setProgressBar(this.getNodeByPath("ui/bottom/bar"),l.daySignObj.awardDayArr.length/7),this.refreshFinalAwardLayer(),this.refreshBoxLayer()},e.refreshFinalAwardLayer=function(){var t=this.getNodeByPath("ui/bottom/extraAward/get"),a=this.getNodeByPath("ui/bottom/extraAward/lock");t.active=!1,a.active=!1,l.daySignObj.finalAward?t.active=!0:l.daySignObj.awardDayArr.length<7&&(a.active=!0)},e.refreshBoxLayer=function(){l.daySignObj.notBox?this.getNodeByPath("ui/hintLayer/btnBox/gou").active=!1:this.getNodeByPath("ui/hintLayer/btnBox/gou").active=!0},e.processEvent=function(t,a){},e.onButtonClick=function(t,a){},e.signWithDay=function(t,a){void 0===a&&(a=!1);var n=g.getRowById(c.tableName.daySign,t+1);if(n){var e=[n.award];a&&e.push(n.award),e=u.getInstance().addPropArrByDesign(e),this.openAwardGetLayer(e),l.daySignObj.awardDayArr.push(t),this.initUI(),f.send(h.refreshRedPoint)}},e.onClickBtnGetAward=function(){var t=this;g.getRowById(c.tableName.daySign,this.awardDay+1)?-1==l.daySignObj.awardDayArr.indexOf(this.awardDay)?(l.addDayTaskNum(2),s.eventSendCustomEvent("签到玩家"),l.daySignObj.notBox?this.signWithDay(this.awardDay):o.openAd("签到双倍奖励",(function(a){1==a&&t.signWithDay(t.awardDay,!0)}))):this.createNotice(y.daySignHasGet):this.createNotice(y.daySignOutdate)},e.onClickBtnPatch=function(){for(var t=this,a=-1,n=0;n<7;n++)if(-1==l.daySignObj.awardDayArr.indexOf(n)){a=n;break}-1==a||a>=this.awardDay?this.createNotice(y.daySignNoLeave):o.openAd("快速补签",(function(n){1==n&&t.signWithDay(a)}))},e.onClickBtnBox=function(){l.daySignObj.notBox?l.daySignObj.notBox=0:l.daySignObj.notBox=1,this.refreshBoxLayer()},e.onClickExtraAward=function(){if(l.daySignObj.awardDayArr.length<7)this.createNotice(y.daySignFinalAwardHint);else if(l.daySignObj.finalAward)this.createNotice(y.hasGet);else{l.daySignObj.finalAward=1;var t=u.getInstance().addPropByDesign(g.config.daySignFinalAward);this.openAwardGetLayer([t]),this.refreshFinalAwardLayer()}},n}(p))||v);n._RF.pop()}}}));

System.register("chunks:///_virtual/DayTaskLayer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./tyqSDK.ts","./cocosUtil.ts","./utilTools.ts","./constants.ts","./msgac.ts","./designManager.ts","./eventManager.ts","./playerModel.ts","./UserData.ts","./BaseLayer.ts"],(function(t){var e,a,n,r,i,s,o,c,d,l,g,h,u,f;return{setters:[function(t){e=t.inheritsLoose},function(t){a=t.cclegacy,n=t._decorator,r=t.find},function(t){i=t.tyqSDK},function(t){s=t.cocosUtil},function(t){o=t.utilTools},function(t){c=t.constants},function(t){d=t.msgac},function(t){l=t.designManager},function(t){g=t.eventManager},function(t){h=t.playerModel},function(t){u=t.UserData},function(t){f=t.BaseLayer}],execute:function(){var y;a._RF.push({},"e30ce7SVfRMu7LF0Te6TcB1","DayTaskLayer",void 0);var v=n.ccclass;n.property,t("DayTaskLayer",v("DayTaskLayer")(y=function(t){function a(){for(var e,a=arguments.length,n=new Array(a),r=0;r<a;r++)n[r]=arguments[r];return(e=t.call.apply(t,[this].concat(n))||this).flagArr=[25,50,75,100],e.taskListNode=void 0,e}e(a,t);var n=a.prototype;return n.onLoad=function(){t.prototype.onLoad.call(this),this.taskListNode=this.getNodeByPath("ui/listbg/list")},n.onEnable=function(){t.prototype.onEnable.call(this),this.addEventArr([d.overDay])},n.onDisable=function(){t.prototype.onDisable.call(this)},n.onDestroy=function(){t.prototype.onDestroy.call(this)},n.initUI=function(){this.refreshTopLayer();for(var t=l.getTable(c.tableName.dayTask),e=[],a=0;a<t.length;a++){var n=t[a],r={};r.id=n.id,e.push(r)}o.sortArr(e,(function(t,e){var a=l.getRowById(c.tableName.dayTask,t.id),n=l.getRowById(c.tableName.dayTask,e.id),r=h.getTaskInfoById(t.id),i=h.getTaskInfoById(e.id),s=r.num/a.needNum,o=i.num/n.needNum;return r.getAward&&(s=-1),i.getAward&&(o=-1),s<o})),this.scrollViewSetData(this.taskListNode,e,this.refreshTaskItem.bind(this),!0,!0)},n.refreshTopLayer=function(){var t=u.getInstance().dayAct;this.setString(this.getNodeByPath("ui/top/act/num"),t),this.setProgressBar(this.getNodeByPath("ui/top/progress"),t/100);for(var e=this.getNodeByPath("ui/top/progress/boxs").children,a=0;a<e.length;a++){var n=e[a];n.index=a;var i=this.flagArr[a];this.setString(r("num",n),i);var o=r("shine",n),c=r("icon",n),d=r("open",n);if(o.active=!1,c.active=!1,d.active=!1,t>=i){var l=this.getAwardFlag(a);-1==h.dayTaskObj.awardFlagArr.indexOf(l)?(c.active=!0,o.active=!0,s.tweenBreath(o,.5,1.2)):d.active=!0}else o.active=!1,c.active=!0,d.active=!1}},n.refreshTaskItem=function(t,e){var a=this,n=l.getRowById(c.tableName.dayTask,e.id);this.setString(r("info",t),n.info),r("awardLayer",t).children.forEach((function(t,e){var i=n.award[e][0],s=n.award[e][1];a.setPropItem(i,r("icon",t),s,null,r("num/val",t)),t.award=n.award[e]}));var i=h.getTaskInfoById(n.id),s=i.num;1==n.id&&s>1&&(s=1),this.setString(r("progress/hint",t),s+"/"+n.needNum),this.setProgressBar(r("progress",t),i.num/n.needNum),this.setString(r("btnGo/text",t),n.btnText);var o=r("btnGet",t),d=r("btnGo",t),g=r("done",t);o.item=e,d.item=e,o.active=!1,d.active=!1,g.active=!1,i.num>=n.needNum?i.getAward?g.active=!0:o.active=!0:d.active=!0,3==n.type&&l.config.taskDoge>u.getInstance().$freeDraw?d.getChildByName("hand").active=!0:d.getChildByName("hand").active=!1},n.overDayRet=function(){this.initUI()},n.getAwardFlag=function(t){return"dayTaskAward"+(t+1)},n.processEvent=function(t,e){},n.onButtonClick=function(t,e){},n.onClickBoxItem=function(t){for(var e=[],a=0;a<this.flagArr.length;a++){var n=this.getAwardFlag(a),r=l.config[n],s=this.flagArr[a];if(!(u.getInstance().dayAct<s)&&-1==h.dayTaskObj.awardFlagArr.indexOf(n)){var o=u.getInstance().addPropNum(r[0],r[1]);h.dayTaskObj.awardFlagArr.push(n),e.push(o),i.eventSendCustomEvent("每日任务-完成"+this.flagArr[a])}}if(e.length>0)this.openAwardGetLayer(e),this.refreshTopLayer();else{var c=this.getAwardFlag(t.index),d=l.config[c];this.openAwardInfoLayer([d])}},n.onClickBtnGo=function(t){switch(l.getRowById(c.tableName.dayTask,t.item.id).type){case 2:c.layers.DaySignLayer}this.closeLayer()},n.onClickBtnGet=function(t){var e=h.getTaskInfoById(t.item.id),a=l.getRowById(c.tableName.dayTask,t.item.id);if(!(e.getAward||e.num<a.needNum)){var n=u.getInstance().addPropArrByDesign(a.award);this.openAwardGetLayer(n),e.getAward=1,this.refreshTopLayer(),this.scrollViewRefreshList(this.taskListNode),g.send(d.refreshRedPoint),i.eventSendCustomEvent("每日任务-参与领取奖励")}},n.onClickAwardItem=function(t){var e=t.award;this.openPropInfoLayer2(e[0],e[1])},a}(f))||y);a._RF.pop()}}}));

System.register("chunks:///_virtual/debug-view-runtime-control.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var e,o,i,n,s,l,r,a,g,h,p,c,C,d,m,u,L;return{setters:[function(t){e=t.applyDecoratedDescriptor,o=t.inheritsLoose,i=t.initializerDefineProperty,n=t.assertThisInitialized},function(t){s=t.cclegacy,l=t._decorator,r=t.Node,a=t.Color,g=t.Canvas,h=t.UITransform,p=t.instantiate,c=t.Label,C=t.RichText,d=t.Toggle,m=t.Button,u=t.director,L=t.Component}],execute:function(){var f,M,b,v,T,S,x,E,I;s._RF.push({},"b2bd1+njXxJxaFY3ymm06WU","debug-view-runtime-control",void 0);var A=l.ccclass,y=l.property;t("DebugViewRuntimeControl",(f=A("internal.DebugViewRuntimeControl"),M=y(r),b=y(r),v=y(r),f((x=e((S=function(t){function e(){for(var e,o=arguments.length,s=new Array(o),l=0;l<o;l++)s[l]=arguments[l];return e=t.call.apply(t,[this].concat(s))||this,i(e,"compositeModeToggle",x,n(e)),i(e,"singleModeToggle",E,n(e)),i(e,"EnableAllCompositeModeButton",I,n(e)),e._single=0,e.strSingle=["No Single Debug","Vertex Color","Vertex Normal","Vertex Tangent","World Position","Vertex Mirror","Face Side","UV0","UV1","UV Lightmap","Project Depth","Linear Depth","Fragment Normal","Fragment Tangent","Fragment Binormal","Base Color","Diffuse Color","Specular Color","Transparency","Metallic","Roughness","Specular Intensity","IOR","Direct Diffuse","Direct Specular","Direct All","Env Diffuse","Env Specular","Env All","Emissive","Light Map","Shadow","AO","Fresnel","Direct Transmit Diffuse","Direct Transmit Specular","Env Transmit Diffuse","Env Transmit Specular","Transmit All","Direct Internal Specular","Env Internal Specular","Internal All","Fog"],e.strComposite=["Direct Diffuse","Direct Specular","Env Diffuse","Env Specular","Emissive","Light Map","Shadow","AO","Normal Map","Fog","Tone Mapping","Gamma Correction","Fresnel","Transmit Diffuse","Transmit Specular","Internal Specular","TT"],e.strMisc=["CSM Layer Coloration","Lighting With Albedo"],e.compositeModeToggleList=[],e.singleModeToggleList=[],e.miscModeToggleList=[],e.textComponentList=[],e.labelComponentList=[],e.textContentList=[],e.hideButtonLabel=void 0,e._currentColorIndex=0,e.strColor=["<color=#ffffff>","<color=#000000>","<color=#ff0000>","<color=#00ff00>","<color=#0000ff>"],e.color=[a.WHITE,a.BLACK,a.RED,a.GREEN,a.BLUE],e}o(e,t);var s=e.prototype;return s.start=function(){if(this.node.parent.getComponent(g)){var t=this.node.parent.getComponent(h),e=.5*t.width,o=.5*t.height,i=.1*e-e,n=o-.1*o,s=this.node.getChildByName("MiscMode"),l=p(s);l.parent=this.node,l.name="Buttons";var r=p(s);r.parent=this.node,r.name="Titles";for(var u=0;u<2;u++){var L=p(this.EnableAllCompositeModeButton.getChildByName("Label"));L.setPosition(i+(u>0?450:150),n,0),L.setScale(.75,.75,.75),L.parent=r;var f=L.getComponent(c);f.string=u?"----------Composite Mode----------":"----------Single Mode----------",f.color=a.WHITE,f.overflow=0,this.labelComponentList[this.labelComponentList.length]=f}n-=20;for(var M=0,b=0;b<this.strSingle.length;b++,M++){b===this.strSingle.length>>1&&(i+=200,M=0);var v=b?p(this.singleModeToggle):this.singleModeToggle;v.setPosition(i,n-20*M,0),v.setScale(.5,.5,.5),v.parent=this.singleModeToggle.parent;var T=v.getComponentInChildren(C);T.string=this.strSingle[b],this.textComponentList[this.textComponentList.length]=T,this.textContentList[this.textContentList.length]=T.string,v.on(d.EventType.TOGGLE,this.toggleSingleMode,this),this.singleModeToggleList[b]=v}i+=200,this.EnableAllCompositeModeButton.setPosition(i+15,n,0),this.EnableAllCompositeModeButton.setScale(.5,.5,.5),this.EnableAllCompositeModeButton.on(m.EventType.CLICK,this.enableAllCompositeMode,this),this.EnableAllCompositeModeButton.parent=l;var S=this.EnableAllCompositeModeButton.getComponentInChildren(c);this.labelComponentList[this.labelComponentList.length]=S;var x=p(this.EnableAllCompositeModeButton);x.setPosition(i+90,n,0),x.setScale(.5,.5,.5),x.on(m.EventType.CLICK,this.changeTextColor,this),x.parent=l,(S=x.getComponentInChildren(c)).string="TextColor",this.labelComponentList[this.labelComponentList.length]=S;var E=p(this.EnableAllCompositeModeButton);E.setPosition(i+200,n,0),E.setScale(.5,.5,.5),E.on(m.EventType.CLICK,this.hideUI,this),E.parent=this.node.parent,(S=E.getComponentInChildren(c)).string="Hide UI",this.labelComponentList[this.labelComponentList.length]=S,this.hideButtonLabel=S,n-=40;for(var I=0;I<this.strMisc.length;I++){var A=p(this.compositeModeToggle);A.setPosition(i,n-20*I,0),A.setScale(.5,.5,.5),A.parent=s;var y=A.getComponentInChildren(C);y.string=this.strMisc[I],this.textComponentList[this.textComponentList.length]=y,this.textContentList[this.textContentList.length]=y.string,A.getComponent(d).isChecked=!!I,A.on(d.EventType.TOGGLE,I?this.toggleLightingWithAlbedo:this.toggleCSMColoration,this),this.miscModeToggleList[I]=A}n-=150;for(var D=0;D<this.strComposite.length;D++){var B=D?p(this.compositeModeToggle):this.compositeModeToggle;B.setPosition(i,n-20*D,0),B.setScale(.5,.5,.5),B.parent=this.compositeModeToggle.parent;var w=B.getComponentInChildren(C);w.string=this.strComposite[D],this.textComponentList[this.textComponentList.length]=w,this.textContentList[this.textContentList.length]=w.string,B.on(d.EventType.TOGGLE,this.toggleCompositeMode,this),this.compositeModeToggleList[D]=B}}else console.error("debug-view-runtime-control should be child of Canvas")},s.isTextMatched=function(t,e){var o=new String(t),i=o.search(">");return-1===i?t===e:(o=(o=o.substr(i+1)).substr(0,o.search("<")))===e},s.toggleSingleMode=function(t){for(var e=u.root.debugView,o=t.getComponentInChildren(C),i=0;i<this.strSingle.length;i++)this.isTextMatched(o.string,this.strSingle[i])&&(e.singleMode=i)},s.toggleCompositeMode=function(t){for(var e=u.root.debugView,o=t.getComponentInChildren(C),i=0;i<this.strComposite.length;i++)this.isTextMatched(o.string,this.strComposite[i])&&e.enableCompositeMode(i,t.isChecked)},s.toggleLightingWithAlbedo=function(t){u.root.debugView.lightingWithAlbedo=t.isChecked},s.toggleCSMColoration=function(t){u.root.debugView.csmLayerColoration=t.isChecked},s.enableAllCompositeMode=function(t){var e=u.root.debugView;e.enableAllCompositeMode(!0);for(var o=0;o<this.compositeModeToggleList.length;o++){this.compositeModeToggleList[o].getComponent(d).isChecked=!0}var i=this.miscModeToggleList[0].getComponent(d);i.isChecked=!1,e.csmLayerColoration=!1,(i=this.miscModeToggleList[1].getComponent(d)).isChecked=!0,e.lightingWithAlbedo=!0},s.hideUI=function(t){var e=this.node.getChildByName("Titles"),o=!e.active;this.singleModeToggleList[0].parent.active=o,this.miscModeToggleList[0].parent.active=o,this.compositeModeToggleList[0].parent.active=o,this.EnableAllCompositeModeButton.parent.active=o,e.active=o,this.hideButtonLabel.string=o?"Hide UI":"Show UI"},s.changeTextColor=function(t){this._currentColorIndex++,this._currentColorIndex>=this.strColor.length&&(this._currentColorIndex=0);for(var e=0;e<this.textComponentList.length;e++)this.textComponentList[e].string=this.strColor[this._currentColorIndex]+this.textContentList[e]+"</color>";for(var o=0;o<this.labelComponentList.length;o++)this.labelComponentList[o].color=this.color[this._currentColorIndex]},s.onLoad=function(){},s.update=function(t){},e}(L)).prototype,"compositeModeToggle",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),E=e(S.prototype,"singleModeToggle",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),I=e(S.prototype,"EnableAllCompositeModeButton",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),T=S))||T));s._RF.pop()}}}));

System.register("chunks:///_virtual/designManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./constants.ts","./resManager.ts"],(function(t){var n,e,r,i,s;return{setters:[function(t){n=t.createClass},function(t){e=t.cclegacy,r=t.JsonAsset},function(t){i=t.constants},function(t){s=t.resManager}],execute:function(){e._RF.push({},"2f587trJmZF/Y4kXjIZp9XA","designManager",void 0);var a=function(){function t(){this.tb2Arr={},this.tb2Obj={},this.tbType2Arr={},this.config={}}var e=t.prototype;return e.loadAllDesignTable=function(t,n){var e=this;s.loadAsset(i.bundles.design,"design",r,(function(n){t&&t(n)}),(function(t,r){if(!t){for(var i in e.tb2Arr=r.json,e.tb2Arr){var a=e.tb2Arr[i];e.initTable(i,a)}s.releaseAsset(r),n&&n()}}))},e.initTable=function(t,n){for(var e in this.tb2Obj[t]={},n){var r=n[e];if(this.tb2Obj[t][r.id]=r,r.hasOwnProperty("type")&&""!=r.type&&null!=r.type)this.tbType2Arr[t]||(this.tbType2Arr[t]={}),this.tbType2Arr[t][r.type]||(this.tbType2Arr[t][r.type]=[]),this.tbType2Arr[t][r.type].push(r);"config"==t&&(this.config[r.name]=r.val||r.val2)}},e.getTable=function(t){return this.tb2Arr[t]},e.getRowById=function(t,n){return this.tb2Obj[t][n]},e.getRowsByType=function(t,n){return this.tbType2Arr[t]&&this.tbType2Arr[t][n]?this.tbType2Arr[t][n]:[]},e.getLastRow=function(t){var n=this.getTable(t);return n[n.length-1]},e.getFirstIdByType=function(t){return 10*t+1},n(t,null,[{key:"instance",get:function(){return this._instance||(this._instance=new t),this._instance}}]),t}();a._instance=void 0;t("designManager",a.instance);e._RF.pop()}}}));

System.register("chunks:///_virtual/devModel.ts",["cc","./cocosUtil.ts","./utilTools.ts","./constants.ts","./audioManager.ts","./designManager.ts","./layerManager.ts","./mapModel.ts","./playerModel.ts"],(function(){var n,o,e,t,a,i,s,c,l;return{setters:[function(o){n=o.cclegacy},function(n){o=n.cocosUtil},function(n){e=n.utilTools},function(n){t=n.constants},function(n){a=n.audioManager},function(n){i=n.designManager},function(n){s=n.layerManager},function(n){c=n.mapModel},function(n){l=n.playerModel}],execute:function(){n._RF.push({},"a9bfcKNUT1MqpA94+oMlUD8","devModel",void 0),o.isDesktopBrowser()&&(window.designManager=i,window.audioManager=a,window.utilTools=e,window.constants=t,window.layerManager=s,window.mapModel=c,window.playerModel=l),n._RF.pop()}}}));

System.register("chunks:///_virtual/DialogEffect.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var e,o,n,c,r,s;return{setters:[function(t){e=t.inheritsLoose},function(t){o=t.cclegacy,n=t._decorator,c=t.tween,r=t.v3,s=t.Component}],execute:function(){var i;o._RF.push({},"41530QtsZtBv5/oXgY+vRZP","DialogEffect",void 0);var a=n.ccclass;n.property,t("DialogEffect",a("DialogEffect")(i=function(t){function o(){return t.apply(this,arguments)||this}return e(o,t),o.prototype.onEnable=function(){c(this.node).set({scale:r(0,0,0)}).to(.17,{scale:r(1.1,1.1,1.2)}).to(.06,{scale:r(1,1,1)}).start()},o}(s))||i);o._RF.pop()}}}));

System.register("chunks:///_virtual/Earn.ts",["./rollupPluginModLoBabelHelpers.js","cc","./constants.ts","./BaseUILayer.ts","./http.ts","./utilTools.ts","./ServerCtr.ts","./audioManager.ts"],(function(t){var e,n,i,r,o,a,l,s,c,u,p,d,f,g,h,b,y,m;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,i=t.initializerDefineProperty,r=t.assertThisInitialized,o=t.asyncToGenerator,a=t.regeneratorRuntime},function(t){l=t.cclegacy,s=t._decorator,c=t.Node,u=t.Sprite,p=t.find,d=t.Label},function(t){f=t.constants},function(t){g=t.BaseUILayer},function(t){h=t.default},function(t){b=t.utilTools},function(t){y=t.default},function(t){m=t.audioManager}],execute:function(){var k,w,v,C,L,S,B,N,T,V,E,x,z,M,U,I,D,_,R,F,G,P,A,O,H;l._RF.push({},"f8e10KNbO1LT7ao1auzb7g3","Earn",void 0);var j=s.ccclass,q=s.property;t("Earn",(k=j("Earn"),w=q({type:c,tooltip:"任务列表View"}),v=q({type:c,tooltip:"任务列表容器View"}),C=q({type:c,tooltip:"排行榜列表View"}),L=q({type:c,tooltip:"排行榜列表容器View"}),S=q({type:c,tooltip:"切换任务按钮"}),B=q({type:c,tooltip:"切换排行榜按钮"}),N=q({type:c,tooltip:"任务界面"}),T=q({type:c,tooltip:"排行榜界面"}),V=q({type:c,tooltip:"名字"}),E=q([c]),x=q([c]),k((U=e((M=function(t){function e(){for(var e,n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return e=t.call.apply(t,[this].concat(o))||this,i(e,"taskScrollView",U,r(e)),i(e,"taskScrollContentView",I,r(e)),i(e,"userScrollView",D,r(e)),i(e,"userScrollContentView",_,r(e)),i(e,"btnMidnightTasks",R,r(e)),i(e,"btnLeaderBoard",F,r(e)),i(e,"uiMidnightTasks",G,r(e)),i(e,"uiLeaderBoard",P,r(e)),i(e,"Name",A,r(e)),i(e,"buttons",O,r(e)),i(e,"bodys",H,r(e)),e.bgNodes=[],e.Utils=null,e.util=null,e.userData=null,e.rootNode=void 0,e}n(e,t);var l=e.prototype;return l.onLoad=function(){var e=this;t.prototype.onLoad.call(this),this.rootNode=this.node,this.onChgTab(null,1),this.buttons.forEach((function(t,n){var i=t.getChildByName("checked");i&&e.bgNodes.push(i),t.on(c.EventType.TOUCH_END,(function(t){e.onButtonClick(t,n)}),e)}))},l.onButtonClick=function(t,e){m.playEffect("btnClick"),this.bgNodes.forEach((function(t,n){t.active=n===e}))},l.start=function(){var t=o(a().mark((function t(){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.initList();case 2:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),l.initList=function(){var t=o(a().mark((function t(){var e,n=this;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.rootNode.getChildByName("Loading").active=!0,t.next=3,y.GetInstance().getEarnTaskMainList(b.getUserId().toString(),1);case 3:e=t.sent,this.rootNode.getChildByName("Loading").active=!1,e&&e.length>0&&this.scrollViewSetData(this.taskScrollView,e,o(a().mark((function t(e,i,r){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.getChildByName("center").getChildByName("desc").getComponent(d).string=i.title,i.isCompleted?(p("btnClaimed",e).active=!0,p("btn",e).active=!1):(p("btnClaimed",e).active=!1,p("btn",e).active=!0,console.log(i.status,"---- item.status"),n.setTaskBtnSprite(p("btn",e),i.status),p("btn",e).on("click",o(a().mark((function t(){var e,r,o,l,s,c,u,p,d;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(m.playEffect("btnClick"),e=i.id,r=i.socialId,o=i.link,l=i.verifyInfo,s=i.actionType,!window.TelegramWebviewProxy){t.next=23;break}if(console.log("🚀 ~ Earn ~ this. execute ~ item:",i),!l){t.next=23;break}if(c=l.split("?")[0],u=l.split("params")[1]&&l.split("params")[1].slice(1)||"[]",p=l.includes("GET")?"GET":"","OUT_JUMP"!==s){t.next=10;break}n.Utils.openLink(y.BASE_URL+"/"+c,{tryInstantView:!0}),t.next=23;break;case 10:return t.prev=10,t.next=13,b.checkRequestState(c,p,u,String(e),r,o);case 13:d=t.sent,console.log("🚀 ~ Earn ~ find ~ checkRes:",d),d.flag||(console.log("🚀 ~ Earn ~ find ~ checkRes.flag:",d.flag),d.link.includes("https://t.me")?n.Utils.openTelegramLink(d.link):n.Utils.openLink(d.link,{tryInstantView:!0})),t.next=20;break;case 18:t.prev=18,t.t0=t.catch(10);case 20:return t.prev=20,n.initList(),t.finish(20);case 23:case"end":return t.stop()}}),t,null,[[10,18,20,23]])})))));case 2:case"end":return t.stop()}}),t)}))));case 6:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),l.setTaskBtnSprite=function(t,e){var n=0==e?"verify":"gobtn";this.setSpriteFrame2(t,"earn/"+n,null,f.bundles.ui)},l.update=function(t){},l.onChgTab=function(t,e){var n=this;if(1==e)this.uiMidnightTasks.active=!0,this.uiLeaderBoard.active=!1,this.btnMidnightTasks.getComponent(u).enabled=!0,this.btnLeaderBoard.getComponent(u).enabled=!1,this.fitScrollView(this.taskScrollContentView,600,1e3);else{this.uiMidnightTasks.active=!1,this.uiLeaderBoard.active=!0,this.btnMidnightTasks.getComponent(u).enabled=!1,this.btnLeaderBoard.getComponent(u).enabled=!0,this.fitScrollView(this.userScrollContentView,600,1e3);var i=[];this.rootNode.getChildByName("Loading").active=!0,h.getInstance().httpGet(y.BASE_URL+"/user/rankings_v2",{pageNo:1,pageSize:20},(function(t){if(t.data){var e=(i=t.data.users).slice(0,3),r=i.slice(3,i.length);e.forEach((function(t,e){p("top3/no"+(e+1)+"/ap/name",n.uiLeaderBoard).getComponent(d).string=t.tgFirstName,p("top3/no"+(e+1)+"/ap/Label",n.uiLeaderBoard).getComponent(d).string=t.totalScore})),n.scrollViewSetData(n.userScrollView,r,(function(t,e,n){t.getChildByName("rank").getComponent(d).string=(n+4).toString(),t.getChildByName("username").getComponent(d).string=e.tgFirstName,p("ap/Label",t).getComponent(d).string=e.totalScore})),n.rootNode.getChildByName("Loading").active=!1}}))}},l.onDestroy=function(){t.prototype.onDestroy.call(this)},e}(g)).prototype,"taskScrollView",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),I=e(M.prototype,"taskScrollContentView",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),D=e(M.prototype,"userScrollView",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),_=e(M.prototype,"userScrollContentView",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),R=e(M.prototype,"btnMidnightTasks",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),F=e(M.prototype,"btnLeaderBoard",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),G=e(M.prototype,"uiMidnightTasks",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),P=e(M.prototype,"uiLeaderBoard",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),A=e(M.prototype,"Name",[V],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),O=e(M.prototype,"buttons",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),H=e(M.prototype,"bodys",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),z=M))||z));l._RF.pop()}}}));

System.register("chunks:///_virtual/eventManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./myLog.ts","./msgac.ts"],(function(n){var t,e,a,i;return{setters:[function(n){t=n.createClass},function(n){e=n.cclegacy},function(n){a=n.myLog},function(n){i=n.msgac}],execute:function(){e._RF.push({},"c2a1a1LsQRIE5uIjpvtQUe8","eventManager",void 0);var s=function(){function n(){this.acList={}}var e=n.prototype;return e.on=function(n,t,e){var a=this.acList[n];for(var i in a||(a=[],this.acList[n]=a),a){if(a[i].sender==e)return}var s={};s.cb=t,s.sender=e,a.push(s)},e.off=function(n,t,e){var a=this.acList[n];if(a){var i=[];for(var s in a){var r=a[s];r.cb==t&&r.sender==e||i.push(r)}this.acList[n]=i}},e.offWithSender=function(n){for(var t in this.acList){var e=this.acList[t],a=[];for(var i in e){var s=e[i];s.sender!=n&&a.push(s)}this.acList[t]=a}},e.send=function(n,t){var e=this.acList[n];if(e){var s=!0;if(t&&t.notMyLog&&(s=!1),n==i.joystick&&(s=!1),s){var r=i.ac2KeyObj[n];a.i(r,t)}try{for(var c in e){var o=e[c],u=o.cb,v=o.sender,f={ac:n,data:t};u.call(v,f)}}catch(e){a.e("eventManager send error:"+e.message,n,t,e)}}},t(n,null,[{key:"instance",get:function(){return this._instance||(this._instance=new n),this._instance}}]),n}();s._instance=void 0;n("eventManager",s.instance);e._RF.pop()}}}));

System.register("chunks:///_virtual/Events.ts",["./rollupPluginModLoBabelHelpers.js","cc","./BaseUILayer.ts","./constants.ts","./cocosUtil.ts","./UserData.ts"],(function(e){var t,i,n,r,o,a,l,s,p,c,m,h,u,d,g,y;return{setters:[function(e){t=e.applyDecoratedDescriptor,i=e.inheritsLoose,n=e.initializerDefineProperty,r=e.assertThisInitialized,o=e.extends},function(e){a=e.cclegacy,l=e._decorator,s=e.sp,p=e.Node,c=e.instantiate,m=e.Label,h=e.Toggle},function(e){u=e.BaseUILayer},function(e){d=e.constants},function(e){g=e.cocosUtil},function(e){y=e.UserData}],execute:function(){var b,f,C,v,B,S,P,I,x,L,k,N,w,z,E,_,D,F,j,T,U,H,R,A,O,q,K;a._RF.push({},"0e327HxrD9K94SSNh5i31eF","Events",void 0);var M=l.ccclass,W=l.property;e("Events",(b=M("Events"),f=W({type:s.Skeleton,tooltip:"角色spine"}),C=W({type:p,tooltip:"sliderBig容器"}),v=W({type:p,tooltip:"sliderBigItem"}),B=W({type:p,tooltip:"slider容器"}),S=W({type:p,tooltip:"sliderItem"}),P=W({type:p,tooltip:"上一个"}),I=W({type:p,tooltip:"下一个"}),x=W({type:p,tooltip:"分页器"}),L=W({type:p,tooltip:"summon1"}),k=W({type:p,tooltip:"summon1Item"}),N=W({type:p,tooltip:"summon10"}),w=W({type:p,tooltip:"summon10Item"}),b((_=t((E=function(e){function t(){for(var t,i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return t=e.call.apply(e,[this].concat(o))||this,n(t,"heroSk",_,r(t)),n(t,"sliderBigContainer",D,r(t)),n(t,"sliderBigItem",F,r(t)),n(t,"sliderContainer",j,r(t)),n(t,"sliderItem",T,r(t)),n(t,"prevBtn",U,r(t)),n(t,"nextBtn",H,r(t)),n(t,"pages",R,r(t)),n(t,"summon1",A,r(t)),n(t,"summon1Item",O,r(t)),n(t,"summon10",q,r(t)),n(t,"summon10Item",K,r(t)),t.sliderImgList=[{small:"https://i.mij.rip/2024/11/16/2aa6c3b38e54357b8809472056f20893.png",big:"https://i.mij.rip/2024/11/16/77568a2aa90268db8e0a63648282b27d.png",type:"Equipment"},{small:"https://i.mij.rip/2024/11/16/9da5102ce8b77a0357d8f0bcabb66701.png",big:"https://i.mij.rip/2024/11/16/9da770b008f9516c5a0b008e678f76b8.png",type:"Character"},{small:"https://i.mij.rip/2024/11/16/9274ac776c54b3c8def8d774274a80a0.png",big:"https://i.mij.rip/2024/11/16/003b909ab87fdc3018ab0d6e27877172.png",type:"Weapon"},{small:"https://i.mij.rip/2024/11/16/ba53b7351f7530c20118eb449cb6c5e8.png",big:"https://i.mij.rip/2024/11/16/344251df8f47990a0d05bff7fb497006.png",type:"Character"}],t.selSummon1Node=null,t.selSummon10Node=null,t.summon1List=[{icon:"Clearer_ticket",num:1},{icon:"crystals_mp 1",num:300},{icon:"prop_diamond2",num:500}],t.summon10List=[{icon:"Clearer_ticket",num:10},{icon:"crystals_mp 1",num:3e3},{icon:"prop_diamond2",num:4500}],t.index=0,t.slidersIndex=[],t}i(t,e);var a=t.prototype;return a.onLoad=function(){this.heroSk.setSkin(y.getInstance().getHeroSkin())},a.start=function(){this.initSlider(),this.updateSlider()},a.initSlider=function(){for(var e=this,t=this.pages.getChildByName("dot"),i=0;i<this.sliderImgList.length-1;i++){var n=c(t);n.active=!0,n.getChildByName("sel").active=i===this.index,this.pages.addChild(n);var r=c(this.sliderBigItem);r.active=!1,this.sliderBigContainer.addChild(r)}this.sliderBigContainer.children.forEach((function(t,i){t.getChildByPath("bottom/summon1").on(p.EventType.TOUCH_END,(function(){e.openLayer(d.layers.Summon,o({},e.layerData,{type:e.sliderImgList[i].type}))}),!1),t.getChildByPath("bottom/summon10").on(p.EventType.TOUCH_END,(function(){e.openLayer(d.layers.Summon,o({},e.layerData,{type:e.sliderImgList[i].type}))}),!1),g.setRemoteImage(t,e.sliderImgList[i].big),e.updateSummonProps(t.getChildByPath("bottom/summon1/select/open/item_wrap"),e.summon1List),e.updateSummonProps(t.getChildByPath("bottom/summon10/select/open/item_wrap"),e.summon10List)}))},a.getSliderChildren=function(){var e,t=this;if(this.slidersIndex.length=0,this.index-1<0)(e=this.slidersIndex).push.apply(e,[this.sliderImgList.length-1,0,1]);else if(this.index+1>this.sliderImgList.length-1){var i;(i=this.slidersIndex).push.apply(i,[this.index-1,this.index,0])}else{var n;(n=this.slidersIndex).push.apply(n,[this.index-1,this.index,this.index+1])}this.sliderContainer.removeAllChildren(),this.slidersIndex.forEach((function(e){var i=c(t.sliderItem);g.setRemoteImage(i,t.sliderImgList[e].small),t.sliderContainer.addChild(i)}))},a.updateSlider=function(){var e=this;this.sliderBigContainer.children.forEach((function(t,i){t.active=i===e.index,t.getChildByPath("bottom/summon1/select/open").active=!1,t.getChildByPath("bottom/summon1/select/close").active=!0,t.getChildByPath("bottom/summon10/select/open").active=!1,t.getChildByPath("bottom/summon10/select/close").active=!0,e.selSummon1Node=null,e.selSummon10Node=null})),this.getSliderChildren(),this.pages.children.forEach((function(t,i){t.getChildByName("sel").active=i===e.index}))},a.updateSummonProps=function(e,t){var i=this;e.removeAllChildren();for(var n=function(n){var r=c(i.summon1Item);r.active=!0,i.setSpriteFrame2(r.getChildByPath("icon"),"prop/"+t[n].icon),r.getChildByPath("num").getComponent(m).string=t[n].num.toString();var o=r.getChildByPath("checkbox").getComponent(h);o?o.node.on("click",(function(e){e.target.parent.parent.children.forEach((function(e){e.getChildByPath("checkbox/Checkmark").active=!1})),r.getChildByPath("checkbox/Checkmark").active=!0,i.onToggleChange(t[n],e.target.parent.parent.parent.parent.parent.name)}),i):console.error("No Toggle component found on node at index "+n),e.addChild(r),r.getChildByPath("checkbox/Checkmark").active=0===n;var a=e.parent.parent.parent;i.setSpriteFrame2(a.getChildByPath("Sprite"),"prop/"+t[0].icon),a.getChildByPath("Sprite/Label").getComponent(m).string=t[0].num,i.setSpriteFrame2(a.getChildByPath("select/close/Sprite"),"prop/"+t[0].icon),a.getChildByPath("select/close/Label").string=t[0].num,i.setSpriteFrame2(a.getChildByPath("select/open/tip/Sprite"),"prop/"+t[0].icon),a.getChildByPath("select/open/tip/Label").string=t[0].num},r=0;r<t.length;r++)n(r)},a.onToggleChange=function(e,t){var i="summon1"===t?this.selSummon1Node:this.selSummon10Node;this.setSpriteFrame2(i.getChildByPath("Sprite"),"prop/"+e.icon),i.getChildByPath("Sprite/Label").getComponent(m).string=e.num,this.setSpriteFrame2(i.getChildByPath("select/close/Sprite"),"prop/"+e.icon),i.getChildByPath("select/close/Label").string=e.num,this.setSpriteFrame2(i.getChildByPath("select/open/tip/Sprite"),"prop/"+e.icon),i.getChildByPath("select/open/tip/Label").string=e.num},a.onPrevClick=function(){this.index=this.index-1<0?this.sliderImgList.length-1:this.index-1,this.updateSlider()},a.onNextClick=function(){this.index=this.index+1>this.sliderImgList.length-1?0:this.index+1,this.updateSlider()},a.onHandleSelect=function(e,t){"1"==t?"tip"===e.target.name?(e.target.parent.parent.getChildByPath("close").active=!0,e.target.parent.active=!1):"close"===e.target.name&&(e.target.parent.getChildByPath("close").active=!1,e.target.parent.getChildByPath("open").active=!0,this.selSummon1Node=e.target.parent.parent):"tip"===e.target.name?(e.target.parent.parent.getChildByPath("close").active=!0,e.target.parent.active=!1):"close"===e.target.name&&(e.target.parent.getChildByPath("close").active=!1,e.target.parent.getChildByPath("open").active=!0,this.selSummon10Node=e.target.parent.parent)},a.closeLayer=function(){e.prototype.closeLayer.call(this)},a.onDestroy=function(){e.prototype.onDestroy.call(this)},t}(u)).prototype,"heroSk",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),D=t(E.prototype,"sliderBigContainer",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),F=t(E.prototype,"sliderBigItem",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),j=t(E.prototype,"sliderContainer",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),T=t(E.prototype,"sliderItem",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),U=t(E.prototype,"prevBtn",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),H=t(E.prototype,"nextBtn",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),R=t(E.prototype,"pages",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),A=t(E.prototype,"summon1",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),O=t(E.prototype,"summon1Item",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),q=t(E.prototype,"summon10",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),K=t(E.prototype,"summon10Item",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),z=E))||z));a._RF.pop()}}}));

System.register("chunks:///_virtual/ExChangeLayer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./BaseUILayer.ts","./audioManager.ts","./constants.ts","./ServerCtr.ts","./UserData.ts"],(function(e){var t,i,n,a,r,o,l,c,s,u,h,p,g,d,v;return{setters:[function(e){t=e.applyDecoratedDescriptor,i=e.inheritsLoose,n=e.initializerDefineProperty,a=e.assertThisInitialized,r=e.asyncToGenerator,o=e.regeneratorRuntime},function(e){l=e.cclegacy,c=e._decorator,s=e.Node,u=e.Label},function(e){h=e.BaseUILayer},function(e){p=e.audioManager},function(e){g=e.constants},function(e){d=e.default},function(e){v=e.UserData}],execute:function(){var y,f,m,C,B,w,b,P,T,D,x,E,S,L,V,R,I,N,q,k,z,U,M,_,H;l._RF.push({},"ac82c4nlmxPYZKBgfqaJZqh","ExChangeLayer",void 0);var A=c.ccclass,F=c.property;e("ExChangeLayer",(y=A("ExChangeLayer"),f=F([s]),m=F([s]),C=F([s]),B=F([s]),w=F([s]),b=F([s]),P=F({type:s}),T=F({type:s}),D=F({type:s}),x=F({type:u}),E=F({type:u}),y((V=t((L=function(e){function t(){for(var t,i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return t=e.call.apply(e,[this].concat(r))||this,n(t,"title",V,a(t)),n(t,"subTitle",R,a(t)),n(t,"dialogConfirm",I,a(t)),n(t,"titles",N,a(t)),n(t,"navBtns",q,a(t)),n(t,"containers",k,a(t)),n(t,"conversionScrollView",z,a(t)),n(t,"equipScrollView",U,a(t)),n(t,"characterScrollView",M,a(t)),n(t,"costText",_,a(t)),n(t,"valueText",H,a(t)),t.bgNodes=[],t.rootNode=void 0,t.navTabs=["conversion","equip","character"],t.conversionData=[],t.equipData=[],t.characterData=[],t.selItem=null,t}i(t,e);var l=t.prototype;return l.onLoad=function(){this.rootNode=this.node},l.start=function(){var e=r(o().mark((function e(){var t=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.rootNode.getChildByName("Loading").active=!0,this.initList(),this.containers.forEach((function(e,t){e.active=0===t})),this.navBtns.forEach((function(e,i){var n=e.getChildByName("checked");n&&t.bgNodes.push(n),e.on(s.EventType.TOUCH_END,(function(e){t.onButtonClick(e,i)}),t)}));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),l.initList=function(){var e=r(o().mark((function e(){var t=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getAllData();case 2:this.scrollViewSetData(this.conversionScrollView,this.conversionData,(function(e,i,n){var a=i.valueType,r=e.getChildByPath("awardLayer"),o=e.getChildByPath("ExBaseItem/ExBottomItem");r.getChildByPath("mpCoinReward").active="mp"===a,r.getChildByPath("summoningTicketReward").active="summon"===a,r.getChildByPath("powerRechargeReward").active="power"===a,r.getChildByPath("soulCoinReward").active="soul"===a,r.getChildByPath("diamondCoinReward").active="diamond"===a;var l=i[i.valueType+"Value"];r.getChildByPath("mpCoinReward/val").getComponent(u).string=l,r.getChildByPath("summoningTicketReward/val").getComponent(u).string=l,r.getChildByPath("powerRechargeReward/val").getComponent(u).string=l,r.getChildByPath("soulCoinReward/val").getComponent(u).string=l,r.getChildByPath("diamondCoinReward/val").getComponent(u).string=l;var c=i.costType;o.getChildByPath("iconMp").active="mp"===c,o.getChildByPath("iconSummon").active="summon"===c,o.getChildByPath("iconPower").active="power"===c,o.getChildByPath("iconSoul").active="soul"===c,o.getChildByPath("iconDiamond").active="diamond"===c,o.getChildByPath("num").getComponent(u).string=i.costValue,e.on(s.EventType.TOUCH_END,(function(e){t.costText.string=i.costValue+" "+i.costType;var n=[{value:i.diamondValue,label:"GAM"},{value:i.mpValue,label:"MP"},{value:i.powerValue,label:"Power"},{value:i.soulValue,label:"Soul"}];t.valueText.string=n.filter((function(e){return e.value>0})).map((function(e){return e.value+" "+e.label})).join(" + "),t.dialogConfirm.active=!0,t.selItem=i}))})),this.scrollViewSetData(this.equipScrollView,this.equipData,(function(e,i,n){var a=e.getChildByPath("awardLayer"),r=e.getChildByPath("ExBaseItem/ExBottomItem");a.getChildByPath("R-equip").active=0===i.details.level,a.getChildByPath("SR-equip").active=1===i.details.level,a.getChildByPath("UR-equip").active=2===i.details.level;var o=i.details.icon.includes("zb")?"prop/"+i.details.icon:"prop/weapon/"+i.details.icon;["R-equip/icon","SR-equip/icon","UR-equip/icon"].forEach((function(e){t.setSpriteFrame2(a.getChildByPath(e),o,null,g.bundles.icon)}));var l=i.costType;r.getChildByPath("iconMp").active="mp"===l,r.getChildByPath("iconSummon").active="summon"===l,r.getChildByPath("iconPower").active="power"===l,r.getChildByPath("iconSoul").active="soul"===l,r.getChildByPath("iconDiamond").active="diamond"===l,r.getChildByPath("num").getComponent(u).string=i.costValue,e.on(s.EventType.TOUCH_END,(function(e){t.costText.string=i.costValue+" "+i.costType,t.valueText.string=i.details.name,t.dialogConfirm.active=!0,t.selItem=i})),t.rootNode.getChildByName("Loading").active=!1})),this.scrollViewSetData(this.characterScrollView,this.characterData,(function(e,i,n){for(var a=e.getChildByPath("awardLayer"),r=e.getChildByPath("ExBaseItem/ExBottomItem"),o=1;o<=7;o++)a.getChildByPath("chart"+o).active=i.details.level===o,t.setSpriteFrame2(a.getChildByPath("chart"+o+"/role"),"skins/"+i.details.icon,null,g.bundles.resources);var l=i.costType;r.getChildByPath("iconMp").active="mp"===l,r.getChildByPath("iconSummon").active="summon"===l,r.getChildByPath("iconPower").active="power"===l,r.getChildByPath("iconSoul").active="soul"===l,r.getChildByPath("iconDiamond").active="diamond"===l,r.getChildByPath("num").getComponent(u).string=i.costValue,e.on(s.EventType.TOUCH_END,(function(e){t.costText.string=i.costValue+" "+i.costType,t.valueText.string=i.details.name,t.dialogConfirm.active=!0,t.selItem=i}))}));case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),l.getAllData=function(){var e=r(o().mark((function e(){var t=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.rootNode.getChildByName("Loading").active=!0,e.abrupt("return",Promise.all([this.getDataByType(this.navTabs[0]),this.getDataByType(this.navTabs[1]),this.getDataByType(this.navTabs[2])]).then((function(e){console.log("res",e),t.conversionData=e[0],t.equipData=e[1],t.characterData=e[2]})));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),l.getDataByType=function(){var e=r(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,d.GetInstance().getExchangeList(t);case 3:return e.abrupt("return",e.sent);case 6:e.prev=6,e.t0=e.catch(0),console.log("🚀 ~ ExChangeLayer ~ getDataByType ~ error:",e.t0);case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t){return e.apply(this,arguments)}}(),l.onButtonClick=function(e,t){p.playEffect("btnClick");var i=e.target;this.titles.forEach((function(e,i){e.active=t===i})),this.bgNodes.forEach((function(e,i){e.active=t===i})),this.showContainer(i.name)},l.showContainer=function(e){this.containers.forEach((function(t){t.active=t.name===e+"Container"}))},l.closeDialog=function(){this.dialogConfirm.active=!1},l.confirmDialog=function(){var e=r(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,d.GetInstance().exchangeItem(v.getInstance().getUserServerData().userId,this.selItem.id);case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.log("🚀 ~ ExChangeLayer ~ confirmDialog ~ error:",e.t0);case 8:return e.prev=8,this.dialogConfirm.active=!1,e.finish(8);case 11:case"end":return e.stop()}}),e,this,[[0,5,8,11]])})));return function(){return e.apply(this,arguments)}}(),l.closeLayer=function(){e.prototype.closeLayer.call(this)},l.onDestroy=function(){e.prototype.onDestroy.call(this)},t}(h)).prototype,"title",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),R=t(L.prototype,"subTitle",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),I=t(L.prototype,"dialogConfirm",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),N=t(L.prototype,"titles",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),q=t(L.prototype,"navBtns",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),k=t(L.prototype,"containers",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),z=t(L.prototype,"conversionScrollView",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),U=t(L.prototype,"equipScrollView",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),M=t(L.prototype,"characterScrollView",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),_=t(L.prototype,"costText",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),H=t(L.prototype,"valueText",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),S=L))||S));l._RF.pop()}}}));

System.register("chunks:///_virtual/feiBiao.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var i,e,n,o,r,a,c;return{setters:[function(t){i=t.inheritsLoose},function(t){e=t.cclegacy,n=t._decorator,o=t.UITransform,r=t.UIOpacity,a=t.tween,c=t.Component}],execute:function(){var h;e._RF.push({},"93580dXRklK6LDsaqgFZDJp","feiBiao",void 0);var s=n.ccclass;n.property,t("feiBiao",s("feiBiao")(h=function(t){function e(){for(var i,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(i=t.call.apply(t,[this].concat(n))||this).hint=void 0,i}return i(e,t),e.prototype.init=function(t){var i=this;this.hint=t;var e=this.hint.bodyNode.getComponent(o);e.width=this.hint.extraObj.width,e.height=this.hint.extraObj.height;var n=this.getComponent(r);n.opacity=255,a(n).to(.3,{opacity:0}).call((function(){i.hint.recycleSelf()})).start()},e}(c))||h);e._RF.pop()}}}));

System.register("chunks:///_virtual/FileUtils.ts",["cc"],(function(e){var t,i;return{setters:[function(e){t=e.cclegacy,i=e.sys}],execute:function(){t._RF.push({},"85132CQcl5K4IQopku+kAoz","FileUtils",void 0);var n=function(e){return e[e.DATA_URL=0]="DATA_URL",e[e.TEXT=1]="TEXT",e[e.BINARY=2]="BINARY",e[e.ARRAYBUFFER=3]="ARRAYBUFFER",e}(n||{});e("FileUtils",function(){function e(){}return e.openLocalFile=function(e,t){var i=document.getElementById("file_input");i||((i=document.createElement("input")).id="file_input",i.setAttribute("id","file_input"),i.setAttribute("type","file"),i.setAttribute("class","fileToUpload"),i.style.opacity="0",i.style.position="absolute",i.setAttribute("left","-999px"),document.body.appendChild(i)),e=e||".*",i.setAttribute("accept",e),i.onchange=function(e){var n=i.files;if(n&&n.length>0){var a=n[0];t&&t(a)}},i.click()},e.readLocalFile=function(e,t,i){var a=new FileReader;switch(a.onload=function(e){i&&(a.readyState==FileReader.DONE?i(a.result):i(null))},t){case n.DATA_URL:a.readAsDataURL(e);break;case n.TEXT:a.readAsText(e);break;case n.BINARY:a.readAsBinaryString(e);break;case n.ARRAYBUFFER:a.readAsArrayBuffer(e)}},e.saveForBrowser=function(e,t){if(i.isBrowser){console.log("浏览器");var n=new Blob([e],{type:"text/plain;charset=utf-8"}),a=document.createElement("a");a.download=t,a.innerHTML="Download File",null!=window.webkitURL?a.href=window.webkitURL.createObjectURL(n):(a.href=window.URL.createObjectURL(n),a.style.display="none",document.body.appendChild(a)),a.click()}},e.saveDataForNative=function(e,t,n){if(void 0===n&&(n="wb"),i.isNative){var a=window.myjsb;if(a)return a.MyFileUtils.getInstance().writeDataToFile(e,n,t)}return!1},e}());t._RF.pop()}}}));

System.register("chunks:///_virtual/GameCtrl.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./msgac.ts","./eventManager.ts"],(function(t){var o,i,e,n,s,c,h,r,a,d;return{setters:[function(t){o=t.inheritsLoose},function(t){i=t.cclegacy,e=t._decorator,n=t.find,s=t.Node,c=t.Vec3,h=t.Component},function(t){r=t.cocosUtil},function(t){a=t.msgac},function(t){d=t.eventManager}],execute:function(){var u;i._RF.push({},"1e325KYY1ZPsLTs0SuYv9z+","GameCtrl",void 0);var l=e.ccclass;e.property,t("GameCtrl",l("GameCtrl")(u=function(t){function i(){for(var o,i=arguments.length,e=new Array(i),n=0;n<i;n++)e[n]=arguments[n];return(o=t.call.apply(t,[this].concat(e))||this).joystickNode=void 0,o.blockNode=void 0,o.radius=70,o.orignPosition=void 0,o}o(i,t);var e=i.prototype;return e.onLoad=function(){this.joystickNode=n("joystick",this.node),this.blockNode=n("block",this.joystickNode),this.orignPosition=this.joystickNode.getPosition().clone()},e.start=function(){this.node.on(s.EventType.TOUCH_START,this.touchStart,this),this.node.on(s.EventType.TOUCH_MOVE,this.touchMove,this),this.node.on(s.EventType.TOUCH_END,this.touchEnd,this),this.node.on(s.EventType.TOUCH_CANCEL,this.touchCancel,this)},e.touchStart=function(t){var o=t.getUILocation(),i=new c(o.x,o.y,0);i=r.convertToNodeSpace(this.joystickNode,i),this.joystickNode.setPosition(i),this.blockNode.setPosition(0,0),this.sendTouchEvent("start",t)},e.touchMove=function(t){var o=t.getUILocation(),i=new c(o.x,o.y,0);(i=r.convertToNodeSpace(this.blockNode,i)).length()>this.radius&&i.normalize().multiplyScalar(this.radius),this.blockNode.setPosition(i),this.sendTouchEvent("move",t,i)},e.touchEnd=function(t){this.joystickNode.setPosition(this.orignPosition),this.blockNode.setPosition(0,0),this.sendTouchEvent("end",t)},e.touchCancel=function(t){this.joystickNode.setPosition(this.orignPosition),this.blockNode.setPosition(0,0),this.sendTouchEvent("end",t)},e.sendTouchEvent=function(t,o,i){i&&(i=i.normalize().clone());var e={type:t,event:o,pos:i};d.send(a.joystick,e)},i}(h))||u);i._RF.pop()}}}));

System.register("chunks:///_virtual/GameLaunch.ts",["./rollupPluginModLoBabelHelpers.js","cc","./myLog.ts","./conf.ts","./CronCtr.ts","./ServerCtr.ts","./cocosUtil.ts","./BaseLayer.ts","./constants.ts","./msgac.ts","./audioManager.ts","./eventManager.ts","./layerManager.ts","./localStorageManager.ts","./playerModel.ts","./UserData.ts"],(function(e){var n,t,o,a,s,r,i,c,l,d,u,g,p,f,h,v,m,y,L,w,N,S,D,b,k,I;return{setters:[function(e){n=e.inheritsLoose,t=e.asyncToGenerator,o=e.regeneratorRuntime},function(e){a=e.cclegacy,s=e._decorator,r=e.find,i=e.AudioSource,c=e.director,l=e.assetManager,d=e.Node},function(e){u=e.myLog},function(e){g=e.GNetCmd,p=e.GNetConst,f=e.GLoginState},function(e){h=e.default},function(e){v=e.default},function(e){m=e.cocosUtil},function(e){y=e.BaseLayer},function(e){L=e.constants},function(e){w=e.msgac},function(e){N=e.audioManager},function(e){S=e.eventManager},function(e){D=e.layerManager},function(e){b=e.localStorageManager},function(e){k=e.playerModel},function(e){I=e.UserData}],execute:function(){var C;a._RF.push({},"0ca88Ac39FHk6N+9LN2sjMi","GameLaunch",void 0);var E=s.ccclass;s.property,e("GameLaunch",E("GameLaunch")(C=function(e){function a(){return e.apply(this,arguments)||this}n(a,e);var s=a.prototype;return s.onLoad=function(){e.prototype.onLoad.call(this),k.isInDevelopmentEnvironment()&&(u.isOpen=!0),m.init(),w.init(),e.prototype.onLoad.call(this),this.getNodeByPath("btnTest").active=k.isInDevelopmentEnvironment();var n=r("layer1",this.node),a=r("layerHint",this.node);D.init(n,a),N.setMusicAudioSource(this.getNodeByPath("audio/music").getComponent(i)),N.setEffectAudioSource(this.getNodeByPath("audio/effect").getComponent(i));var s=L.layers.LoadingLayer;this.getNodeByPath(s).addComponent(s);var d=L.layers.NoticeLayer;r(d,a).addComponent(d),c.on(g.GetFriendVal.toString(),this.onMessageEvent,this),c.on(g.ReqWxSession.toString(),this.onMessageEvent,this),c.on(g.GetRegionData.toString(),this.onMessageEvent,this);l.loadRemote("https://unpkg.com/@telegram-apps/sdk@1.0.0/dist/index.iife.js",(function(e,n){if(e)console.error("Failed to load script:",e);else if(window.TelegramWebviewProxy){console.log("成功加载TG的SDK");var t=window.telegramApps.sdk,o=t.postEvent,a=t.retrieveLaunchParams;o("web_app_expand"),o("web_app_setup_closing_behavior",{need_confirmation:!0});var s=a().initData;window.userData=s.user,console.log("用户数据 ===",window.userData)}}));var p=window.Telegram&&window.Telegram.WebApp?(console.log("当前环境是 Telegram"),"Telegram"):/Line/i.test(navigator.userAgent)?(console.log("当前环境是 LINE"),"LINE"):(console.log("当前环境未知或不是 Telegram/LINE"),"Unknown");console.log(p),l.loadBundle("lineSDK",t(o().mark((function e(n){var t,a,s,r,i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n){e.next=3;break}return console.error("Failed to load SDK:",n),e.abrupt("return");case 3:return console.log("LINE Dapp Portal SDK loaded"),t=window.LineDappPortalSDK,e.prev=5,e.next=8,t.init({clientId:"714228e2-80f4-428e-81d7-7f670364513f",chainId:"1001"});case 8:if(a=e.sent,console.log("--------- lineSdk:",a),s=a.getWalletProvider()){e.next=14;break}return console.error("Failed to get WalletProvider."),e.abrupt("return");case 14:return I.getInstance().setUserWeb3Data(s),console.log("WalletProvider retrieved.",s),e.next=18,s.request({method:"kaia_requestAccounts"});case 18:(r=e.sent)&&r.length>0?(console.log(r,"accounts"),i=r[0],I.getInstance().setUserAddress(i),console.log("Connected wallet address:",i)):console.error("No wallet address retrieved."),e.next=25;break;case 22:e.prev=22,e.t0=e.catch(5),console.error("Error initializing SDK:",e.t0);case 25:case"end":return e.stop()}}),e,null,[[5,22]])}))))},s.onEnable=function(){e.prototype.onEnable.call(this),this.addEventArr([w.openLayer,w.showNotice])},s.onDisable=function(){e.prototype.onDisable.call(this)},s.start=function(){r("Canvas").on(d.EventType.TOUCH_START,(function(e){S.send(w.globalTouchStart,e)}))},s.onMessageEvent=function(e){if(console.log("处理服务端发送的消息:",e),e.status!=p.ResSuccess)return console.error("服务端响应失败~!"),v.GetInstance().isLogin=!1,h.getInstance().isPutEnable=!1,void(v.GetInstance().loginState=f.loginWithAccount);var n=v.GetInstance();switch(e.cmd){case g.GetFriendVal:k.shareObj.friendNum=e.friendCnt;var t=JSON.parse(e.friendData);k.shareObj.friendAdNum=t.videoCalCnt,k.shareObj.friendPassNum=t.friendPassCnt;break;case g.ReqWxSession:n.token=e.token,n.regionDataList=e.regionDataList,e.nickName&&""!=e.nickName&&(n.nickName=e.nickName),e.wxRes&&e.wxRes.openid&&(b.openId=e.wxRes.openid),e.uid&&(b.uid=e.uid);break;case g.GetRegionData:n.token=e.token,n.isLogin=!0,v.GetInstance().serverDataVersion=e.dataVersion,e.dataVersionFlag==p.ServerIsNew&&(v.GetInstance().serverData=JSON.parse(e.jsonData)),n.loginState=f.loginWithAccount,h.getInstance().isPutEnable=!1,console.log("获得服务端数据!",v.GetInstance().serverData),n.uid=e.uid,n.regionId=e.regionId}},s.openLayerRet=function(e){console.log(e,"这是什么？？？？？"),this.openLayer(L.layers[e.name],e)},s.showNoticeRet=function(e){this.createNotice(e)},s.onClickBtnTest=function(e){u.i(l.assets)},s.onClickBtnHintClose=function(){this.hideHintLayer()},a}(y))||C);a._RF.pop()}}}));

System.register("chunks:///_virtual/GameMemoryStorage.ts",["cc"],(function(e){var t,r;return{setters:[function(e){t=e.cclegacy,r=e._decorator}],execute:function(){var n,o;t._RF.push({},"55b2ffzgpVPZ4Ld/QLrvdot","GameMemoryStorage",void 0);var c=r.ccclass;r.property,e("default",c(((o=function(){function e(){}return e.getItem=function(e){return localStorage.getItem(e)},e.setItem=function(e,t){localStorage.setItem(e,this.encrypt(t))},e.removeItem=function(e){localStorage.removeItem(e)},e.len=function(){return Object.keys(this.memory).length},e.keys=function(){var e=[];for(var t in this.memory)e.push(t);return e},e.encrypt=function(e){return e},e.decrypt=function(e){return e},e}()).memory={},o.publicKey="JmksO12Ldl60Lsk",o.isEncrypt=!1,n=o))||n);t._RF.pop()}}}));

System.register("chunks:///_virtual/gameStorage.ts",["./rollupPluginModLoBabelHelpers.js","cc","./conf.ts","./GameMemoryStorage.ts"],(function(e){var t,r,n,a,i,o,s,l;return{setters:[function(e){t=e.inheritsLoose,r=e.asyncToGenerator,n=e.regeneratorRuntime},function(e){a=e.cclegacy,i=e._decorator,o=e.Component},function(e){s=e.GNetConst},function(e){l=e.default}],execute:function(){var g,c;a._RF.push({},"d28a9LZiYhKeJA2ODlbTLd0","gameStorage",void 0);var u=i.ccclass;i.property,e("GameStorage",u("GameStorage")(((c=function(e){function a(){return e.apply(this,arguments)||this}return t(a,e),a.Key=function(e){return this.GameKey+"_"+e},a.GetRawKey=function(e){return e.replace(a.GameKey+"_","")},a.getStorage=function(){return l},a.getInt=function(e,t){void 0===t&&(t=0);var r=this.getStorage().getItem(this.Key(e));return null!==r&&""!==r?Number(r):t},a.setInt=function(e,t){e=this.Key(e),this.getStorage().setItem(e,t+"")},a.setIntMemory=function(e,t){e=this.Key(e),this.getStorage().setItem(e,t+"")},a.getBoolean=function(e,t){void 0===t&&(t=!1);var r=this.getStorage().getItem(this.Key(e));return null!==r&&""!==r?1==Number(r):t},a.setBoolean=function(e,t){e=this.Key(e);var r=t?1:0;this.getStorage().setItem(e,r+"")},a.setBooleanMemory=function(e,t){e=this.Key(e);var r=t?1:0;this.getStorage().setItem(e,r+"")},a.getString=function(e,t){void 0===t&&(t="");var r=this.getStorage().getItem(this.Key(e));return null!==r&&""!==r?r:t},a.getStringDisk=function(e,t){void 0===t&&(t="");var r=localStorage.getItem(this.Key(e));return null!==r&&""!==r?r:t},a.getIntDisk=function(e,t){void 0===t&&(t="");var r=localStorage.getItem(this.Key(e));return null!==r&&""!==r?Number(r):t},a.setStringDisk=function(e,t){localStorage.setItem(this.Key(e),t)},a.setStringMemory=function(e,t){e=this.Key(e),this.getStorage().setItem(e,t),localStorage.setItem(e,t)},a.setString=function(e,t){e=this.Key(e),this.getStorage().setItem(e,t),a.GameKey},a.getObject=function(e,t){void 0===t&&(t=null);var r=this.getStorage().getItem(this.Key(e));if(null!==r&&""!==r)try{return JSON.parse(r)||t}catch(e){return t}return t},a.setObject=function(e,t){e=this.Key(e);var r=JSON.stringify(t);this.getStorage().setItem(e,r)},a.sendObject=function(e,t){e=this.Key(e);JSON.stringify(t)},a.setObjectMemory=function(e,t){e=this.Key(e);var r=JSON.stringify(t);this.getStorage().setItem(e,r)},a.removeItem=function(e){e=this.Key(e),this.getStorage().removeItem(e)},a.clear=function(){for(var e=[],t=0;t<localStorage.length;t++){var r=localStorage.key(t);r.indexOf(this.GameKey)>=0&&-1==r.indexOf("login")&&-1==r.indexOf("zzdl")&&e.push(r)}for(var n=this.getStorage().keys(),a=0;a<n.length;a++){var i=n[a];-1==i.indexOf("login")&&-1==i.indexOf("zzdl")&&e.push(i)}for(var o=0;o<e.length;o++){var s=e[o];this.getStorage().removeItem(s)}},a.clearByKey=function(e){for(var t=[],r=0;r<localStorage.length;r++){var n=localStorage.key(r);-1!=n.indexOf(e)&&t.push(n)}for(var a=0;a<t.length;a++){var i=t[a];this.getStorage().removeItem(i)}},a.getStringArrayByKey=function(e){for(var t=[],r=[],n=this.getStorage().keys(),a=0;a<n.length;a++){var i=n[a];if(-1!=i.indexOf(e)){var o=this.getStorage().getItem(i);t.push(o),r.push(i)}}return{keys:r,values:t}},a.getObjectArrayByKey=function(e){for(var t=[],r=this.getStorage().keys(),n=0;n<r.length;n++){var a=r[n];if(-1!=a.indexOf(e)){var i=this.getStorage().getItem(a),o=null;if(null!==i&&""!==i)try{o=JSON.parse(i)||null}catch(e){o=null}o&&t.push(o)}}return t},a.getAll=function(e){void 0===e&&(e=!1);for(var t={},r=0;r<localStorage.length;r++){var n=localStorage.key(r);if(-1==n.indexOf("login"))if(e){var i=n;t[n.replace("zzdl",a.GameKey)]=localStorage.getItem(i)}else{if(-1!=n.indexOf("zzdl"))continue;t[n]=localStorage.getItem(n)}}if(e){var o={};for(var s in t)if(Object.prototype.hasOwnProperty.call(t,s)){var l=t[s];switch(s){case a.GameKey+"_sect_xtbls":for(var g=JSON.parse(l),c=0;c<g.length;c++){var u=g[c],f={id:u.id,star:u.star,debris:u.debris};o[a.GameKey+"_SectXtbl_"+u.id]=JSON.stringify(f)}break;case a.GameKey+"_pack_equips":for(var h=JSON.parse(l),y=0;y<h.length;y++){var v=h[y],S={id:v.id,index:v.index,level:v.level,star:v.star,partner:v.partner,score:v.score,skill_skr:v.skill_skr,skill_skr_attr:v.skill_skr_attr,skill_star:v.skill_star,skill_star_attr:v.skill_star_attr};o[a.GameKey+"pack_equip_"+v.index]=JSON.stringify(S)}break;default:localStorage.setItem(s,l)}}for(var m in delete t.zzdl_sect_xtbls,delete t.zzdl_pack_equips,o){var d=o[m];t[m]=d}}return t},a.setAll=function(){var e=r(n().mark((function e(t){var r;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(r in t)this.getStorage().setItem(r,t[r]);case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),a}(o)).GameKey=s.SaveHead,g=c))||g);a._RF.pop()}}}));

System.register("chunks:///_virtual/GParam.ts",["cc","./MapWrap.ts"],(function(t){var n,e;return{setters:[function(t){n=t.cclegacy},function(t){e=t.MapWrap}],execute:function(){n._RF.push({},"10abfD21F5JKaWJ0jnuKCjx","GParam",void 0);t("default",function(){function t(t){this.arguments=new e,this._onlyArgument=void 0,this._onlyArgument=t}var n=t.prototype;return n.push=function(t,n){t&&this.arguments.set(t,n)},n.get=function(t){return t?this.arguments.get(t):this._onlyArgument},n.clear=function(){this.arguments.clear()},n.toList=function(){return 0==this.arguments.size?null:this.arguments.values()},n.toString=function(){for(var t=this.arguments.keys(),n="",e=0;e<t.length;e++)n+=t[e]+"="+this.get(t[e])+"/t";return n},t}());n._RF.pop()}}}));

System.register("chunks:///_virtual/HandLayer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./msgac.ts","./BaseLayer.ts"],(function(t){var n,o,e,a,r;return{setters:[function(t){n=t.inheritsLoose},function(t){o=t.cclegacy,e=t._decorator},function(t){a=t.msgac},function(t){r=t.BaseLayer}],execute:function(){var c;o._RF.push({},"2a4c8xwp8pKy4PtBA/7pPD5","HandLayer",void 0);var i=e.ccclass;e.property,t("HandLayer",i("HandLayer")(c=function(t){function o(){return t.apply(this,arguments)||this}n(o,t);var e=o.prototype;return e.onLoad=function(){t.prototype.onLoad.call(this)},e.onEnable=function(){t.prototype.onEnable.call(this),this.addEventArr([a.globalTouchStart])},e.onDisable=function(){t.prototype.onDisable.call(this)},e.onDestroy=function(){t.prototype.onDestroy.call(this)},e.initUI=function(){},e.globalTouchStartRet=function(t){this.closeLayer(),this.layerCb&&this.layerCb()},e.processEvent=function(t,n){},e.onButtonClick=function(t,n){},o}(r))||c);o._RF.pop()}}}));

System.register("chunks:///_virtual/HeroLayer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./constants.ts","./msgac.ts","./audioManager.ts","./designManager.ts","./eventManager.ts","./UserData.ts","./PropItemPrefab.ts","./BaseUILayer.ts","./ServerCtr.ts","./utilTools.ts"],(function(t){var e,i,n,r,o,a,s,l,u,p,c,f,h,d,b,g,y,m,L,v,w,k,S;return{setters:[function(t){e=t.applyDecoratedDescriptor,i=t.inheritsLoose,n=t.initializerDefineProperty,r=t.assertThisInitialized,o=t.asyncToGenerator,a=t.regeneratorRuntime},function(t){s=t.cclegacy,l=t._decorator,u=t.Node,p=t.Prefab,c=t.sp,f=t.Label,h=t.instantiate},function(t){d=t.constants},function(t){b=t.msgac},function(t){g=t.audioManager},function(t){y=t.designManager},function(t){m=t.eventManager},function(t){L=t.UserData},function(t){v=t.PropItemPrefab},function(t){w=t.BaseUILayer},function(t){k=t.default},function(t){S=t.utilTools}],execute:function(){var C,I,N,E,q,_,D,x,B,P,z,R,T,W,U,V,A,H,M,G,F,J,O,Q,j,K,X,Y,Z,$,tt;s._RF.push({},"26adcAfOJ5CCJMDw2soV+18","HeroLayer",void 0);var et=l.ccclass,it=l.property;t("HeroLayer",(C=et("HeroLayer"),I=it([u]),N=it({type:u,tooltip:"道具列表容器"}),E=it({type:p,tooltip:"道具节点"}),q=it({type:u,tooltip:"道具列表View"}),_=it({type:u,tooltip:"道具列表View"}),D=it({type:u,tooltip:"穿戴装备"}),x=it({type:u,tooltip:"穿戴装备"}),B=it({type:u,tooltip:"攻击力"}),P=it({type:u,tooltip:"生命值"}),z=it({type:u,tooltip:"防御力"}),R=it({type:u,tooltip:"排序按钮"}),T=it({type:c.Skeleton,tooltip:"角色spine"}),W=it({type:u,tooltip:"跳转装备合成"}),U=it({type:u,tooltip:"跳转皮肤合成"}),C((H=e((A=function(t){function e(){for(var e,i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return e=t.call.apply(t,[this].concat(o))||this,n(e,"buttons",H,r(e)),e.bgNodes=[],n(e,"propLayer",M,r(e)),n(e,"rewardItem",G,r(e)),n(e,"propView",F,r(e)),n(e,"scrollView",J,r(e)),n(e,"propNodeLeft",O,r(e)),n(e,"propNodeRight",Q,r(e)),n(e,"attackLabel",j,r(e)),n(e,"lifeLabel",K,r(e)),n(e,"defenseLabel",X,r(e)),n(e,"sortbtn",Y,r(e)),n(e,"heroSk",Z,r(e)),n(e,"btnTribute",$,r(e)),n(e,"btnAscend",tt,r(e)),e._propNodeList=[],e._isSort=!1,e.rootNode=void 0,e.allEquipmentList=[],e._allWearRquipList=[],e.equipButtons=[],e}i(e,t);var s=e.prototype;return s.onLoad=function(){t.prototype.onLoad.call(this),this.rootNode=this.node;for(var e=0;e<this.propNodeLeft.children.length;e++)this._propNodeList.push(this.propNodeLeft.children[e]);for(var i=0;i<this.propNodeRight.children.length;i++)this._propNodeList.push(this.propNodeRight.children[i])},s.onEnable=function(){t.prototype.onEnable.call(this),m.on(b.wearDrop,this.updateProp,this),m.on(b.updateDropData,this.updateProp,this)},s.onDisable=function(){t.prototype.onDisable.call(this),m.off(b.wearDrop,this.updateProp,this),m.off(b.updateDropData,this.updateProp,this)},s.onDestroy=function(){t.prototype.onDestroy.call(this)},s.onBtnTributeClick=function(){this.openLayer(d.layers.TributeLayer)},s.onBtnAscendClick=function(){this.openLayer(d.layers.AscendLayer)},s.getAllRquip=function(){var t=o(a().mark((function t(){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,k.GetInstance().getUserWearEquipment(S.getUserId().toString());case 2:this._allWearRquipList=t.sent;case 3:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),s.start=function(){var t=this;this.initList(),this.initWearDrop(),this.heroSk.setSkin(L.getInstance().getHeroSkin()),this.attackLabel.getComponent(f).string=L.getInstance().attack+"",this.lifeLabel.getComponent(f).string=L.getInstance().life+"",this.defenseLabel.getComponent(f).string=L.getInstance().defense+"",this.sortbtn.getChildByName("Label").getComponent(f).string="Sort Quality",this.buttons.forEach((function(e,i){var n=e.getChildByName("bg");n&&t.bgNodes.push(n),e.on(u.EventType.TOUCH_END,(function(e){t.onButtonClick(e,i)}),t)}))},s.onButtonClick=function(t,e){g.playEffect("btnClick");var i=t.target;switch(this.bgNodes.forEach((function(t,i){t.active=i===e})),i.name){case"item0":this.initListSort(this.allEquipmentList);break;case"item1":this.initListSort(this.allEquipmentList.filter((function(t){return 0===t.details.wearIndex})));break;case"item2":this.initListSort(this.allEquipmentList.filter((function(t){return 1===t.details.wearIndex})));break;case"item3":this.initListSort(this.allEquipmentList.filter((function(t){return 3===t.details.wearIndex})));break;case"item4":this.initListSort(this.allEquipmentList.filter((function(t){return 5===t.details.wearIndex})));break;case"item5":this.initListSort(this.allEquipmentList.filter((function(t){return 4===t.details.wearIndex})));break;case"item6":this.initListSort(this.allEquipmentList.filter((function(t){return 2===t.details.wearIndex})))}},s.updateProp=function(){var t=o(a().mark((function t(){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.initList();case 2:return t.next=4,this.initWearDrop();case 4:this.heroSk.setSkin(L.getInstance().getHeroSkin());case 5:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),s.initList=function(){var t=o(a().mark((function t(){var e,i,n;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.allEquipmentList=[],this.rootNode.getChildByName("Loading").active=!0,t.prev=2,t.next=5,k.GetInstance().getEquipmentByUserId(S.getUserId().toString(),"weaponAndEquipment");case 5:return e=t.sent,t.next=8,k.GetInstance().getUserWearEquipment(S.getUserId().toString());case 8:if(i=t.sent,!e||!i){t.next=16;break}return this.allEquipmentList=e,this._allWearRquipList=i||[],this.initListSort(this.allEquipmentList),n=e.sort((function(t,e){return e.id-t.id})),this.scrollViewSetData(this.scrollView,n,this.initItem.bind(this)),t.abrupt("return",e);case 16:t.next=21;break;case 18:t.prev=18,t.t0=t.catch(2),console.log("🚀 ~ initList ~ error:",t.t0);case 21:return t.prev=21,this.rootNode.getChildByName("Loading").active=!1,t.finish(21);case 24:case"end":return t.stop()}}),t,this,[[2,18,21,24]])})));return function(){return t.apply(this,arguments)}}(),s.initListSort=function(){var t=o(a().mark((function t(e){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.scrollViewSetData(this.scrollView,e,this.initItem.bind(this));case 1:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),s.initItem=function(t,e,i){if(this._allWearRquipList){var n=t.getComponent(v);if(n){var r=this._allWearRquipList;for(var o in r){var a;if((null==(a=r[o])?void 0:a.id)===e.id){n.greybg.active=!0;break}n.greybg.active=!1}n.setViewSuper(null==e?void 0:e.details,1,v.Type_HideNum|v.Type_ToWear,e),n.setScale(120)}else console.error("PropItemPrefab 组件未找到")}else console.error("_allWearRquipList 未初始化或为空")},s.initWearDrop=function(){var t=o(a().mark((function t(){var e,i,n,r,o,s,l,u,p,c,d;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,this.rootNode.getChildByName("Loading").active=!0,t.next=4,k.GetInstance().getUserWearEquipment(S.getUserId().toString());case 4:if(e=t.sent,n=0,r=0,o=0,(i=e)&&!(i.length<=0)){t.next=11;break}return t.abrupt("return");case 11:for(s=0;s<i.length;s++)null==(d=this._propNodeList[s].getChildByName("PropItem"))&&(d=h(this.rewardItem),this._propNodeList[s].addChild(d),d.name="PropItem"),d.getComponent(v).greybg.active=!1,d.getComponent(v).setViewSuper(null==(l=i[s])?void 0:l.details,s,v.Type_HideNum|v.Type_UnWear,i[s]),d.getComponent(v).setScale(120),n+=(null==(u=i[s])||null==(u=u.details)?void 0:u.atkAdd)||0,r+=(null==(p=i[s])||null==(p=p.details)?void 0:p.hpAdd)||0,o+=(null==(c=i[s])||null==(c=c.details)?void 0:c.defenseAdd)||0;this.attackLabel.getComponent(f).string=n+"",this.lifeLabel.getComponent(f).string=r+"",this.defenseLabel.getComponent(f).string=o+"",t.next=20;break;case 17:t.prev=17,t.t0=t.catch(0),console.log("🚀 ~ initWearDrop ~ error:",t.t0);case 20:return t.prev=20,this.rootNode.getChildByName("Loading").active=!1,t.finish(20);case 23:case"end":return t.stop()}}),t,this,[[0,17,20,23]])})));return function(){return t.apply(this,arguments)}}(),s.updateRedPoint=function(){this.propLayer.children},s.getPropList=function(){var t=L.getInstance().getPropSort(),e=[];return t.forEach((function(t){var i=1==t.iswear?t.num-1:t.num,n=y.getRowById(d.tableName.prop,t.id);if(8==n.type||11==n.type)for(var r=0;r<i;r++)e.push(t.id)})),e},s.propSort=function(){g.playEffect("btnClick"),this._isSort?(this.sortbtn.getChildByName("Label").getComponent(f).string="Sort Quality",this._isSort=!1):(this.sortbtn.getChildByName("Label").getComponent(f).string="Clear Sort",this._isSort=!0),this.initList()},s.openBless=function(){g.playEffect("btnClick")},s.onClickBtnSkin=function(){var t=this;g.playEffect("btnClick"),this.openLayer(d.layers.SkinChangeLayer,null,(function(e){"close"===e&&t.closeLayers("close"),t.heroSk.setSkin(L.getInstance().getHeroSkin())}))},s.closeLayers=function(e){t.prototype.closeLayer.call(this),this.layerCb&&this.layerCb(e)},e}(w)).prototype,"buttons",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),M=e(A.prototype,"propLayer",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),G=e(A.prototype,"rewardItem",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),F=e(A.prototype,"propView",[q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),J=e(A.prototype,"scrollView",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),O=e(A.prototype,"propNodeLeft",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Q=e(A.prototype,"propNodeRight",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),j=e(A.prototype,"attackLabel",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),K=e(A.prototype,"lifeLabel",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),X=e(A.prototype,"defenseLabel",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Y=e(A.prototype,"sortbtn",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Z=e(A.prototype,"heroSk",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),$=e(A.prototype,"btnTribute",[W],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),tt=e(A.prototype,"btnAscend",[U],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),V=A))||V));s._RF.pop()}}}));

System.register("chunks:///_virtual/Hint.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./mapModel.ts","./AnimationCtrl.ts"],(function(t){var i,o,n,e,s,c,r,h,a;return{setters:[function(t){i=t.inheritsLoose},function(t){o=t.cclegacy,n=t._decorator,e=t.find,s=t.Tween,c=t.Component},function(t){r=t.cocosUtil},function(t){h=t.mapModel},function(t){a=t.AnimationCtrl}],execute:function(){var l;o._RF.push({},"d7328lgUsxDaYvB3Zr0hgZx","Hint",void 0);var d=n.ccclass;n.property,t("HintNames",{targetPos:"targetPos",targetPos2:"targetPos2",targetPos3:"targetPos3",hit1:"hit1",hit2:"hit2",hit3:"hit3",hit4:"hit4",hit5:"hit5",hit6:"hit6",hit7:"hit7",boom1:"boom1",feiBiao:"feiBiao",blockArrow:"blockArrow",comeShine:"comeShine"}),t("Hint",d("Hint")(l=function(t){function o(){for(var i,o=arguments.length,n=new Array(o),e=0;e<o;e++)n[e]=arguments[e];return(i=t.call.apply(t,[this].concat(n))||this).bodyNode=void 0,i.hintUtil=void 0,i.extraObj=void 0,i}i(o,t);var n=o.prototype;return n.init=function(t,i,o,n){var c=this;void 0===o&&(o=0),this.bodyNode=e("body",this.node),this.extraObj=n,this.unscheduleAllCallbacks(),s.stopAllByTarget(this.node);var l=r.convertToNodeSpace(this.node,i);this.node.setPosition(l),this.node.angle=o,r.addComponentOnce(e("body",this.node),a).playAnimation("ani",!1,(function(){h.hintSystem.recycleHintNode(c.node)}));try{this.hintUtil=r.addComponentOnce(this,t),this.hintUtil.unscheduleAllCallbacks(),this.hintUtil.init(this)}catch(t){}},n.recycleSelf=function(){h.hintSystem.recycleHintNode(this.node)},o}(c))||l);o._RF.pop()}}}));

System.register("chunks:///_virtual/HintSystem.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./constants.ts","./resManager.ts","./BaseLayer.ts","./NodePoolUtil.ts","./Hint.ts"],(function(t){var e,n,i,a,o,r,s,c,y,l,u,f,h,d;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy,i=t._decorator,a=t.find,o=t.Node,r=t.UITransform,s=t.Prefab},function(t){c=t.cocosUtil},function(t){y=t.constants},function(t){l=t.resManager},function(t){u=t.BaseLayer},function(t){f=t.NodePoolUtil},function(t){h=t.HintNames,d=t.Hint}],execute:function(){var m;n._RF.push({},"e5def4jLXtEnZXDiJCC8BFw","HintSystem",void 0);var p=i.ccclass;i.property,t("HintSystem",p("HintSystem")(m=function(t){function n(){for(var e,n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(e=t.call.apply(t,[this].concat(i))||this).nameLayerObj={},e.namePrefabObj={},e.hintLayer=void 0,e.hintLayer2=void 0,e}e(n,t);var i=n.prototype;return i.onLoad=function(){t.prototype.onLoad.call(this),this.hintLayer=this.node,this.hintLayer2=a("hintLayer2",this.node.parent)},i.onEnable=function(){t.prototype.onEnable.call(this)},i.onDestroy=function(){t.prototype.onDestroy.call(this)},i.getHintLayerNameById=function(t){return t+"Layer"},i.getHintLayerByName=function(t){var e=this.nameLayerObj[t];if(!e){switch((e=new o(this.getHintLayerNameById(t))).addComponent(r),e.setPosition(0,0),t){case h.targetPos:case h.targetPos2:case h.targetPos3:case h.feiBiao:case h.blockArrow:case h.comeShine:e.parent=this.hintLayer2;break;default:e.parent=this.hintLayer}this.nameLayerObj[t]=e,e.addComponent(f).init(this.namePrefabObj[t])}return e},i.addHint=function(t,e,n,i){var a=this;void 0===n&&(n=0);var o=this.getHintLayerByName(t).getComponent(f),r=function(){if(o.node.activeInHierarchy){var a=o.getNode();c.addComponentOnce(a,d).init(t,e,n,i)}};this.namePrefabObj[t]?r():l.loadAsset(y.bundles.hint,t,s,null,(function(e,n){c.isValid(a)&&(a.namePrefabObj[t]=n,o.init(n),r())}))},i.recycleHintNode=function(t){this.getHintLayerByName(t.name).getComponent(f).recycleNode(t)},n}(u))||m);n._RF.pop()}}}));

System.register("chunks:///_virtual/HomeLayer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./myLog.ts","./constants.ts","./msgac.ts","./audioManager.ts","./eventManager.ts","./resManager.ts","./mapModel.ts","./UserData.ts","./BaseLayer.ts","./ShineColor.ts"],(function(e){var t,a,n,o,r,s,i,l,c,g,u,h,y,d,p,m,f,v,L,N,C,P;return{setters:[function(e){t=e.inheritsLoose,a=e.asyncToGenerator,n=e.regeneratorRuntime},function(e){o=e.cclegacy,r=e._decorator,s=e.Sprite,i=e.EventHandler,l=e.Button,c=e.tween,g=e.v3,u=e.Prefab,h=e.instantiate},function(e){y=e.myLog},function(e){d=e.constants},function(e){p=e.msgac},function(e){m=e.audioManager},function(e){f=e.eventManager},function(e){v=e.resManager},function(e){L=e.mapModel},function(e){N=e.UserData},function(e){C=e.BaseLayer},function(e){P=e.ShineColor}],execute:function(){var B;o._RF.push({},"be74cBlU0tDKKhGwwM56Gmm","HomeLayer",void 0);var b=r.ccclass;r.property,e("HomeLayer",b("HomeLayer")(B=function(e){function o(){for(var t,a=arguments.length,n=new Array(a),o=0;o<a;o++)n[o]=arguments[o];return(t=e.call.apply(e,[this].concat(n))||this).toggles=[],t.togglesLock=[!1,!1,!1,!1,!1],t._PageLayer=[d.layers.SelectSummonLayer,d.layers.Earn,d.layers.MainLayer,d.layers.NewShopLayer,d.layers.InviteLayer,d.layers.ExChangeLayer],t.jumpLayerData=void 0,t.tabMainRedPointNode=void 0,t.tabEnergyRedPointNode=void 0,t.rootNode=void 0,t}t(o,e);var r=o.prototype;return r.onLoad=function(){this.rootNode=this.node,this.chooseDesignResolution()},r.onEnable=function(){var t=this;e.prototype.onEnable.call(this),this.addEventArr([p.homeHideMenu,p.mapEnter,p.jumpLayer]),f.on(p.setTabPage,(function(e){var a=e.data;t.setPage(a)}),this),N.getInstance().mapData&&(N.getInstance().mapData=null),m.playMusic(d.audioNames.home)},r.onDisable=function(){e.prototype.onDisable.call(this)},r.onDestroy=function(){e.prototype.onDestroy.call(this)},r.initUI=function(){for(var e=0;e<5;e++){this.toggles[e]=this.getNodeByPath("Layout/ui_btn"+(e+1)),this.toggles[e].getChildByName("icon").getComponent(s).grayscale=this.togglesLock[e];var t=new i;t.component="HomeLayer",t.target=this.node,t.customEventData=e+"",t.handler="selectPage",this.toggles[e].getComponent(l)||(this.toggles[e].addComponent(l).clickEvents=[t])}this.setPage(2)},r.start=function(){},r.selectPage=function(e,t){console.log("event =",t),this.setPage(parseInt(t)),m.playEffect("btnClick")},r.setPage=function(e){var t=this;this.rootNode.getChildByName("Loading").active=!0;for(var a=0;a<5;a++)a!=e?(this.setSpriteFrame2(this.toggles[a],"homeLayer/ui_xk",null,d.bundles.wwqVec),c(this.toggles[a]).to(.15,{scale:g(1,1,1)}).start(),this.toggles[a].getChildByName("name").active=!1):(this.setSpriteFrame2(this.toggles[a],"homeLayer/ui_hdmb",null,d.bundles.wwqVec),c(this.toggles[a]).to(.15,{scale:g(1.3,1.3,1)}).start(),this.toggles[a].getChildByName("name").active=!0);var n=this.getNodeByPath("ui");""!=this._PageLayer[e]&&v.loadAsset(d.bundles.layer,this._PageLayer[e],u,null,(function(a,o){if(a)y.e("LayerManager.openLayer error:"+a.message,t._PageLayer[e],a);else{n.removeAllChildren();var r=h(o);n.addChild(r),t.rootNode.getChildByName("Loading").active=!1}}))},r.mapEnterRet=function(){var e=a(n().mark((function e(t){var a,o=this;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.rootNode.getChildByName("Loading").active=!0,e.next=3,N.getInstance().updateRoleAtkBeforeFight();case 3:if(a=e.sent){e.next=6;break}return e.abrupt("return");case 6:t.atk=null==a?void 0:a.atk,t.hp=null==a?void 0:a.hp,t.weaponId=22,L.loadMapRes((function(e){e>.99999999&&(o.rootNode.getChildByName("Loading").active=!1,o.openLayer(d.layers.TransLayer))}),(function(){o.openLayer(d.layers.MapLayer,t,null,(function(){o.closeLayer(d.layers.TransLayer),o.closeLayer()}))}));case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),r.homeHideMenuRet=function(e){e.hide?this.getNodeByPath("Layout").active=!1:this.getNodeByPath("Layout").active=!0},r.onClickBtnHit=function(){var e=this.getNodeByPath("monster"),t=e.getComponent(P);t||(t=e.addComponent(P)),t.startShine(d.materials.shineColorSpine)},o}(C))||B);o._RF.pop()}}}));

System.register("chunks:///_virtual/http.ts",["cc"],(function(t){var e;return{setters:[function(t){e=t.cclegacy}],execute:function(){e._RF.push({},"c064dJ3gUJMUrDuaXXLfsGc","http",void 0),t("default",function(){function t(){this.xhr=null}t.getInstance=function(){return this._instance||(this._instance=new t),this._instance};var e=t.prototype;return e.httpPost=function(t,e,n,r){var s=new XMLHttpRequest;s.timeout=8e3,s.onreadystatechange=function(){if(4===s.readyState)if(s.status>=200&&s.status<300)try{var t=s.responseText,e=JSON.parse(t);n(e)}catch(t){r?r(new Error("Failed to parse response JSON")):console.error("Error parsing response:",t)}else r?r(new Error("Request failed with status "+s.status)):console.error("Request failed with status "+s.status)},s.onerror=function(t){console.error("Network error occurred:",t),r&&r(t)},s.open("POST",t,!0),s.setRequestHeader("Content-Type","application/json"),s.send(JSON.stringify(e))},e.httpGet=function(t,e,n,r){var s=new XMLHttpRequest;s.timeout=5e3;var o="?";for(var a in e)"?"!=o&&(o+="&"),o+=a+"="+e[a];s.onreadystatechange=function(){if(4===s.readyState)if(s.status>=200&&s.status<300){var t=s.responseText,e=JSON.parse(t);n(e)}else r?r(new Error("Request failed with status "+s.status)):n(-1)},s.onerror=function(t){console.log(t),r&&r(t)},s.open("GET",t+o,!0),s.send()},t}())._instance=void 0,e._RF.pop()}}}));

System.register("chunks:///_virtual/InviteLayer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./BaseUILayer.ts","./http.ts","./utilTools.ts","./ServerCtr.ts"],(function(t){var e,n,i,o,r,a,s,l,u,c,p,d;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,i=t.initializerDefineProperty,o=t.assertThisInitialized},function(t){r=t.cclegacy,a=t._decorator,s=t.Node,l=t.Label},function(t){u=t.BaseUILayer},function(t){c=t.default},function(t){p=t.utilTools},function(t){d=t.default}],execute:function(){var f,y,v,h,x;r._RF.push({},"2dd79xdooZPypPrOCTsDWQB","InviteLayer",void 0);var L=a.ccclass,g=a.property;t("InviteLayer",(f=L("InviteLayer"),y=g({type:s,tooltip:"邀请码"}),f((x=e((h=function(t){function e(){for(var e,n,r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];return n=t.call.apply(t,[this].concat(a))||this,i(n,"textBox",x,o(n)),n.inviteUrl="",n.userId=null==(e=window.userData)?void 0:e.id,n}n(e,t);var r=e.prototype;return r.start=function(){this.getText()},r.getText=function(){var t=this;c.getInstance().httpGet(d.BASE_URL+"/user/"+this.userId+"/inviteCode",{},(function(e){var n;t.inviteUrl=e.data,t.textBox.getComponent(l).string=null==(n=t.inviteUrl)?void 0:n.split("start=")[1]}))},r.onLoad=function(){},r.onDestroy=function(){t.prototype.onDestroy.call(this)},r.handleCopy=function(){p.copyTextToClipboard(this.inviteUrl)},e}(u)).prototype,"textBox",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),v=h))||v));r._RF.pop()}}}));

System.register("chunks:///_virtual/ItemLayer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./RenderChildBatch.ts"],(function(e){var t,i,r,n,h,a,d,I;return{setters:[function(e){t=e.inheritsLoose,i=e.createForOfIteratorHelperLoose},function(e){r=e.cclegacy,n=e._decorator,h=e.sys,a=e.instantiate,d=e.Component},function(e){I=e.RenderChildBatch}],execute:function(){var s;r._RF.push({},"d4942V0aRFFFp6T4OnZGReu","ItemLayer",void 0);var m=n.ccclass;n.property,e("ItemLayer",m("ItemLayer")(s=function(e){function r(){for(var t,i=arguments.length,r=new Array(i),n=0;n<i;n++)r[n]=arguments[n];return(t=e.call.apply(e,[this].concat(r))||this).itemUI=void 0,t.itemUIFreeArr=void 0,t.itemUIArr=void 0,t.idItemUIObj={},t.layerJS=void 0,t.callback=void 0,t.renderChildBatch=null,t.isFrameLoad=!1,t.dataArr=[],t}t(r,e);var n=r.prototype;return n.onLoad=function(){this.itemUI=this.node.children[0],this.itemUI.active=!1,this.hideAllItems(),this.addRenderChildBatch()},n.addRenderChildBatch=function(){h.isNative||(this.renderChildBatch=this.getComponent(I),this.renderChildBatch||(this.renderChildBatch=this.addComponent(I)))},n.hideAllItems=function(){var e=this.node.children;this.itemUIFreeArr=[],this.itemUIArr=[],this.idItemUIObj={};for(var t,r=i(e);!(t=r()).done;){var n=t.value;n.active=!1,this.itemUIFreeArr.push(n)}},n.initUI=function(e,t,i){if(this.layerJS=e,this.callback=i,this.hideAllItems(),this.itemUIArr=[],this.idItemUIObj={},this.isFrameLoad)this.dataArr=t,this.frameAddItem();else for(var r in t){var n=t[r];this.addItem(n)}},n.setFrameLoad=function(e){this.isFrameLoad=e},n.frameAddItem=function(){var e=this;this.scheduleOnce((function(){if(e.dataArr&&!(e.dataArr.length<=0)){var t=e.dataArr.shift();e.addItem(t),e.frameAddItem()}}))},n.addItem=function(e,t){var i=this.itemUIFreeArr.shift();i||((i=a(this.itemUI)).parent=this.node),i.active=!0,i.item=e;var r=this.itemUIArr.length;return i.index=r,"object"==typeof e&&e&&null!=e.id&&(this.idItemUIObj[e.id]=i),t?t(i,e,r):this.callback&&this.callback(i,e,r),this.layerJS&&this.layerJS.addButtonListener&&this.layerJS.addButtonListener(i),this.itemUIArr.push(i),this.renderChildBatch&&this.renderChildBatch.addRootItemNode(i),i},n.getItemUIById=function(e){return null==e?null:this.idItemUIObj[e]},n.getItemUIByIndex=function(e){var t=null;return this.forShowItemUI((function(i,r){if(i.index==e)return t=i,!0})),t},n.loadAndRefreshItemUIByItem=function(e,t){e&&null!=e.id&&(this.getItemUIById(e.id)?this.refreshItemUIByItem(e):this.addItem(e,t))},n.refreshItemUIByItem=function(e){if(e&&null!=e.id){var t=this.getItemUIById(e.id);t&&(t.item=e,this.refreshItemUIByItemUI(t))}},n.refreshItemUIByItemUI=function(e){var t=e.item;this.callback&&this.callback(e,t,e.index)},n.refreshItemUIById=function(e){var t=this.getItemUIById(e);t&&this.refreshItemUIByItem(t.item)},n.removeItemUIByIndex=function(e){if(!(e<0||e>=this.itemUIArr.length)){for(var t=null,i=0;i<this.itemUIArr.length;i++){var r=this.itemUIArr[i];if(r.active&&r.index==e){t=r;break}}this.removeItemUIByItemUI(t)}},n.removeItemUIById=function(e){if(null!=e){var t=this.idItemUIObj[e];this.removeItemUIByItemUI(t)}},n.removeItemUIByItemUI=function(e){if(e){e.active=!1,-1==this.itemUIFreeArr.indexOf(e)&&(e.index=-1,this.itemUIFreeArr.push(e));var t=e.item,i=this.itemUIArr.indexOf(e);if(-1!=i){this.itemUIArr.splice(i,1);for(var r=i;r<this.itemUIArr.length;r++)this.itemUIArr[r].index=r}"object"==typeof t&&t&&null!=t.id&&delete this.idItemUIObj[t.id],this.renderChildBatch&&this.renderChildBatch.removeRootItemNode(e)}},n.forShowItemUI=function(e){if(e)for(var t,r=i(this.itemUIArr);!(t=r()).done;){var n=t.value;if(e(n,n.item))break}},n.refreshUI=function(){if(this.callback)for(var e,t=i(this.itemUIArr);!(e=t()).done;){var r=e.value;this.callback(r,r.item,r.index)}},r}(d))||s);r._RF.pop()}}}));

System.register("chunks:///_virtual/layerManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./myLog.ts","./cocosUtil.ts","./constants.ts","./resManager.ts"],(function(e){var a,r,n,t,i,o,s,y,l;return{setters:[function(e){a=e.createForOfIteratorHelperLoose,r=e.createClass},function(e){n=e.cclegacy,t=e.Prefab,i=e.find},function(e){o=e.myLog},function(e){s=e.cocosUtil},function(e){y=e.constants},function(e){l=e.resManager}],execute:function(){n._RF.push({},"e4377T2MsZIL5G+/fK/7cUt","layerManager",void 0);var p=function(){function e(){this.layer1=void 0,this.layerHint=void 0,this.openingLayerMap=new Map,this.openedLayerMap=new Map,this.layerNameIdArrMap=new Map,this.layerId=0}var n=e.prototype;return n.loadCommonLayers=function(e,r){var n=[y.layers.HomeLayer,y.layers.Earn,y.layers.Shop,y.layers.InviteLayer,y.layers.SelectSummonLayer,y.layers.MainLayer];l.loadAssetByPathArr(y.bundles.layer,n,t,e,(function(e){for(var n,t=a(e);!(n=t()).done;){n.value.addRef()}r&&r(e)}))},n.getPopLayerParentNode=function(){return this.layer1},n.init=function(e,a){this.layer1=e,this.layerHint=a,this.openingLayerMap=new Map,this.openedLayerMap=new Map,this.layerNameIdArrMap=new Map,this.layerId=0},n.createNotice=function(e){var a=i(y.layers.NoticeLayer,this.layerHint);a&&a.getComponent(y.layers.NoticeLayer).createNotice(e)},n.addLayerNameId=function(e,a){var r=this.layerNameIdArrMap.get(e);r||(r=[],this.layerNameIdArrMap.set(e,r)),r.push(a)},n.removeLayerNameId=function(e,a){var r=this.layerNameIdArrMap.get(e);if(r&&r.length>0){var n=r.indexOf(a);-1!=n&&r.splice(n,1)}},n.openSingleLayer=function(e,a,r,n){a||(a={});var t=this.layerNameIdArrMap.get(e);if(!t||t.length<=0)this.openLayer(e,a,r,n);else{var i=t[0],o=this.openedLayerMap.get(i);if(o)return o.layerData=a,o.layerCb=r,o.onLoad(),o.onEnable(),void(n&&n(o));var s=this.openingLayerMap.get(i);s&&(s.layerName=e,s.obj=a,s.cb=r,s.openSuccessCb=n)}},n.openLayer=function(e,a,r,n){var i=this;a||(a={}),this.layerId++;var p=this.layerId,c={};c.layerName=e,c.obj=a,c.cb=r,c.openSuccessCb=n,this.openingLayerMap.set(p,c),this.addLayerNameId(e,p);var d=y.bundles.layer,u=e;l.loadAsset(d,u,t,null,(function(r,n){if(r)o.e("LayerManager.openLayer error:"+r.message,e,r);else if(c=i.openingLayerMap.get(p)){var t=s.instantiate(n),y=t.getComponent(e)||t.addComponent(e);l.loadAssetConfigArr(y.preLoadAssetConfigArr,!1,null,(function(){y.layerData=c.obj,y.layerCb=c.cb,y.layerName=c.layerName,y.layerId=p,i.openingLayerMap.delete(p),i.openedLayerMap.set(p,y),t.parent=i.layer1,o.i("openLayer "+e,a),c.openSuccessCb&&c.openSuccessCb(y,n)}))}}))},n.closeLayer=function(e){if(console.log("🚀 ~ LayerManager ~ closeLayer ~ layerId:",e),"string"==typeof e){var a=this.layerNameIdArrMap.get(e);if(!a||a.length<=0)return;e=a[a.length-1]}var r=this.openedLayerMap.get(e);r&&(r.node.destroy(),this.openedLayerMap.delete(e),this.removeLayerNameId(r.layerName,e));var n=this.openingLayerMap.get(e);n&&(this.openingLayerMap.delete(e),this.removeLayerNameId(n.layerName,e))},n.isShowingLayer=function(e){var a=this.layerNameIdArrMap.get(e);return!(!a||a.length<=0)},r(e,null,[{key:"instance",get:function(){return this._instance||(this._instance=new e),this._instance}}]),e}();p._instance=void 0;e("layerManager",p.instance);n._RF.pop()}}}));

System.register("chunks:///_virtual/LetterConfirmLayer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./BaseLayer.ts"],(function(t){var e,r,o,n;return{setters:[function(t){e=t.inheritsLoose},function(t){r=t.cclegacy,o=t._decorator},function(t){n=t.BaseLayer}],execute:function(){var i;r._RF.push({},"8e293kV1XVKpKTr3YDnJoqC","LetterConfirmLayer",void 0);var c=o.ccclass;o.property,t("LetterConfirmLayer",c("LetterConfirmLayer")(i=function(t){function r(){return t.apply(this,arguments)||this}e(r,t);var o=r.prototype;return o.start=function(){},o.onClickClose=function(){this.closeLayer()},o.update=function(t){},o.onDestroy=function(){t.prototype.onDestroy.call(this)},r}(n))||i);r._RF.pop()}}}));

System.register("chunks:///_virtual/LetterDetailsLayer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./BaseLayer.ts"],(function(t){var e,r,o,n;return{setters:[function(t){e=t.inheritsLoose},function(t){r=t.cclegacy,o=t._decorator},function(t){n=t.BaseLayer}],execute:function(){var s;r._RF.push({},"4798fs6bytMCKBGw6uf9kPG","LetterDetailsLayer",void 0);var a=o.ccclass;o.property,t("LetterDetailsLayer",a("LetterDetailsLayer")(s=function(t){function r(){return t.apply(this,arguments)||this}e(r,t);var o=r.prototype;return o.start=function(){},o.onClickClose=function(){this.closeLayer()},o.update=function(t){},o.onDestroy=function(){t.prototype.onDestroy.call(this)},r}(n))||s);r._RF.pop()}}}));

System.register("chunks:///_virtual/LetterLayer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./BaseUILayer.ts","./constants.ts","./ServerCtr.ts","./layerManager.ts"],(function(t){var e,n,i,r,o,a,l,s,c,u,p,f,g,d,h;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,i=t.initializerDefineProperty,r=t.assertThisInitialized,o=t.asyncToGenerator,a=t.regeneratorRuntime},function(t){l=t.cclegacy,s=t._decorator,c=t.Node,u=t.instantiate,p=t.Label},function(t){f=t.BaseUILayer},function(t){g=t.constants},function(t){d=t.default},function(t){h=t.layerManager}],execute:function(){var y,m,b,C,B,v,D,x,N,w,L,S,T,E,_,I,k,R,O,z,A,P,V,M,U,F,G,H,W;l._RF.push({},"a8c03DE/+JHxo1+olxbZkMD","LetterLayer",void 0);var j=s.ccclass,J=s.property;t("LetterLayer",(y=j("LetterLayer"),m=J({type:c}),b=J({type:c}),C=J({type:c}),B=J({type:c}),v=J({type:c}),D=J({type:c}),x=J({type:c}),N=J({type:c}),w=J({type:c}),L=J({type:c}),S=J({type:c}),T=J({type:c}),E=J({type:c}),y((k=e((I=function(t){function e(){for(var e,n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return e=t.call.apply(t,[this].concat(o))||this,i(e,"Notice",k,r(e)),i(e,"Rewards",R,r(e)),i(e,"Rewards_Click",O,r(e)),i(e,"Notice_Click",z,r(e)),i(e,"cloneBtn",A,r(e)),i(e,"scrollView",P,r(e)),i(e,"scrollView1",V,r(e)),i(e,"clickBtn",M,r(e)),i(e,"clickOpenBtn",U,r(e)),i(e,"detailsBox",F,r(e)),i(e,"detailsConfirmBox",G,r(e)),i(e,"boxList",H,r(e)),i(e,"boxTemplate",W,r(e)),e.awardArr=[[101,1e4],[801,200]],e.rootNode=void 0,e.navTabs=["NOTICE","REWARDS"],e.NOTICE_Data=[],e.REWARDS_Data=[],e.detailsScrollView_Data=[],e.confirmedId=null,e}n(e,t);var l=e.prototype;return l.start=function(){var t=this;this.initUI(),this.Rewards_Click.on(c.EventType.TOUCH_END,(function(e){t.Rewards.active=!0,t.Notice.active=!1}),this),this.Notice_Click.on(c.EventType.TOUCH_END,(function(e){t.Rewards.active=!1,t.Notice.active=!0}),this),this.cloneBtn.on(c.EventType.TOUCH_END,(function(e){t.closeLayer()}),this)},l.createBoxList=function(t){var e=this;this.boxList.removeAllChildren(),console.log(t),t.forEach((function(t,n){var i,r=u(e.boxTemplate);r.name="box"+t.id,e.boxList.addChild(r);var o=null==(i=r.getChildByName("text"))?void 0:i.getComponent(p);e.getSpriteFrameByName(r,t.icon),o&&(o.string=t.value.toString()),r.setPosition(100*n,0)}))},l.getSpriteFrameByName=function(t,e){this.setSpriteFrame2(t,"Bag/"+e,null,g.bundles.ui)},l.onLoad=function(){this.rootNode=this.node},l.onEnable=function(){t.prototype.onEnable.call(this)},l.onDisable=function(){t.prototype.onDisable.call(this)},l.onDestroy=function(){t.prototype.onDestroy.call(this)},l.getAllData=function(){var t=o(a().mark((function t(){var e=this;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.rootNode.getChildByName("Loading").active=!0,t.abrupt("return",Promise.all([this.getDataByType(this.navTabs[0]),this.getDataByType(this.navTabs[1])]).then((function(t){console.log("res",t),e.NOTICE_Data=t[0],e.REWARDS_Data=t[1]})));case 2:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),l.getDataByType=function(){var t=o(a().mark((function t(e){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,d.GetInstance().getMailBoxByType(e);case 3:return t.abrupt("return",t.sent);case 6:t.prev=6,t.t0=t.catch(0),console.log("🚀 ~ LetterLayer ~ getDataByType ~ error:",t.t0);case 9:case"end":return t.stop()}}),t,null,[[0,6]])})));return function(e){return t.apply(this,arguments)}}(),l.confirmMailFun=function(){var t=o(a().mark((function t(e){var n=this;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,d.GetInstance().confirmMail(this.confirmedId).then(o(a().mark((function t(e){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return h.createNotice("claimed"),n.closeDetailsConfirmBox(),t.next=4,n.getAllData();case 4:n.scrollViewSetData(n.scrollView,n.NOTICE_Data,(function(t,e,i){t.getChildByName("Label").getComponent(p).string=e.subtitle,t.getChildByName("time").getComponent(p).string=n.formatISODate(e.createAt),t.getChildByName("btnGet").on(c.EventType.TOUCH_END,(function(t){n.detailsBox.active=!0;var i=n.detailsBox.getChildByPath("ui/info"),r=n.detailsBox.getChildByPath("ui/info-001");i.getComponent(p).string=e.desc,r.getComponent(p).string=e.subtitle}))})),n.scrollViewSetData(n.scrollView1,n.REWARDS_Data,(function(t,e,i){t.getChildByName("Label").getComponent(p).string=e.subtitle,t.getChildByName("time").getComponent(p).string=n.formatISODate(e.createAt),e.isConfirm?(t.getChildByName("btnGet").active=!1,n.setSpriteFrame2(t,"email/Mailbox02",null,g.bundles.ui)):t.getChildByName("btnGet").on(c.EventType.TOUCH_END,(function(t){n.detailsConfirmBox.active=!0,n.confirmedId=e.id;var i=n.detailsConfirmBox.getChildByPath("ui/info"),r=n.detailsConfirmBox.getChildByPath("ui/info-001");i.getComponent(p).string=e.desc,r.getComponent(p).string=e.subtitle,n.createBoxList(e.details)}))})),n.rootNode.getChildByName("Loading").active=!1;case 7:case"end":return t.stop()}}),t)}))));case 3:return t.abrupt("return",t.sent);case 6:t.prev=6,t.t0=t.catch(0),console.log("🚀 ~ LetterLayer ~ confirmMailFun ~ error:",t.t0),this.rootNode.getChildByName("Loading").active=!1;case 10:case"end":return t.stop()}}),t,this,[[0,6]])})));return function(e){return t.apply(this,arguments)}}(),l.formatISODate=function(t){var e=new Date(t);return e.getFullYear()+"/"+String(e.getMonth()+1).padStart(2,"0")+"/"+String(e.getDate()).padStart(2,"0")+" "+String(e.getHours()).padStart(2,"0")+":"+String(e.getMinutes()).padStart(2,"0")+":"+String(e.getSeconds()).padStart(2,"0")},l.initUI=function(){var t=o(a().mark((function t(){var e,n,i,r,o=this;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.detailsBox.getChildByPath("ui/info"),n=this.detailsBox.getChildByPath("ui/info-001"),i=this.detailsConfirmBox.getChildByPath("ui/info"),r=this.detailsConfirmBox.getChildByPath("ui/info-001"),t.next=6,this.getAllData();case 6:this.scrollViewSetData(this.scrollView,this.NOTICE_Data,(function(t,i,r){t.getChildByName("Label").getComponent(p).string=i.subtitle,t.getChildByName("time").getComponent(p).string=o.formatISODate(i.createAt),t.getChildByName("btnGet").on(c.EventType.TOUCH_END,(function(t){o.detailsBox.active=!0,e.getComponent(p).string=i.desc,n.getComponent(p).string=i.subtitle,console.log(i.subtitle)}))})),this.scrollViewSetData(this.scrollView1,this.REWARDS_Data,(function(t,e,n){t.getChildByName("Label").getComponent(p).string=e.subtitle,t.getChildByName("time").getComponent(p).string=o.formatISODate(e.createAt),e.isConfirm?(t.getChildByName("btnGet").active=!1,o.setSpriteFrame2(t,"email/Mailbox02",null,g.bundles.ui)):t.getChildByName("btnGet").on(c.EventType.TOUCH_END,(function(t){o.detailsConfirmBox.active=!0,o.confirmedId=e.id,i.getComponent(p).string=e.desc,r.getComponent(p).string=e.subtitle,o.createBoxList(e.details),console.log(e.subtitle)}))})),this.Rewards.active=!1,this.rootNode.getChildByName("Loading").active=!1;case 10:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),l.closeDetailsConfirmBox=function(){this.detailsConfirmBox.active=!1},l.closeDetailsBox=function(){this.detailsBox.active=!1},l.refreshPropItem=function(t,e){},l.processEvent=function(t,e){},l.onButtonClick=function(t,e){},l.onClickBtnGet=function(){console.log(123123)},l.onClickBg=function(){this.closeLayer()},l.onClickBtnClose=function(){console.log("关闭aaaa"),this.closeLayer()},e}(f)).prototype,"Notice",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),R=e(I.prototype,"Rewards",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),O=e(I.prototype,"Rewards_Click",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),z=e(I.prototype,"Notice_Click",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),A=e(I.prototype,"cloneBtn",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),P=e(I.prototype,"scrollView",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),V=e(I.prototype,"scrollView1",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),M=e(I.prototype,"clickBtn",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),U=e(I.prototype,"clickOpenBtn",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),F=e(I.prototype,"detailsBox",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),G=e(I.prototype,"detailsConfirmBox",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),H=e(I.prototype,"boxList",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),W=e(I.prototype,"boxTemplate",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),_=I))||_));l._RF.pop()}}}));

System.register("chunks:///_virtual/LoadingLayer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ServerCtr.ts","./constants.ts","./designManager.ts","./layerManager.ts","./resManager.ts","./playerModel.ts","./BaseLayer.ts","./UserData.ts"],(function(e){var r,s,t,n,o,i,a,l,c,u,g,d,h,p,f;return{setters:[function(e){r=e.inheritsLoose,s=e.asyncToGenerator,t=e.regeneratorRuntime},function(e){n=e.cclegacy,o=e._decorator,i=e.ProgressBar,a=e.Sprite},function(e){l=e.default},function(e){c=e.constants},function(e){u=e.designManager},function(e){g=e.layerManager},function(e){d=e.resManager},function(e){h=e.playerModel},function(e){p=e.BaseLayer},function(e){f=e.UserData}],execute:function(){var y;n._RF.push({},"bf333MQLIJKFoSmNUD9RvOw","LoadingLayer",void 0);var b=o.ccclass;o.property,e("LoadingLayer",b("LoadingLayer")(y=function(e){function n(){for(var r,s=arguments.length,t=new Array(s),n=0;n<s;n++)t[n]=arguments[n];return(r=e.call.apply(e,[this].concat(t))||this).progressBar=void 0,r.progress=0,r.percentNode=void 0,r.flagNode=void 0,r.progressLength=428,r.startGap=-202,r.designResProgress=0,r.designResPercent=.1,r.bundleArrProgress=0,r.bundleArrPercent=.8,r.bundleLoadingTime=-1,r.bundleLoadingMaxTime=6,r.layerProgress=0,r.layerPercent=.1,r.spriteFrameArr=[],r.isLogined=!1,r.version="v1.1.0",r}r(n,e);var o=n.prototype;return o.onLoad=function(){e.prototype.onLoad.call(this),this.percentNode=this.getNodeByPath("ui/progressBar/percent"),this.setString(this.percentNode,"0%"),this.progressBar=this.getNodeByPath("ui/progressBar").getComponent(i),this.setProgressBar(this.progressBar,this.progress),this.flagNode=this.getNodeByPath("ui/progressBar/flag");var r=this.flagNode.getPosition();r.x=this.startGap,this.flagNode.setPosition(r),this.screenAdapterBG(this.getNodeByPath("bg")),this.collectAllSpriteFrame(this.node),l.GetInstance(),f.getInstance()},o.onClickLoginBtn=function(){},o.onEnable=function(){var r=s(t().mark((function r(){var n=this;return t().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:e.prototype.onEnable.call(this),this.loadDesignRes((function(){n.bundleLoadingTime=0;var e=[c.bundles.common,c.bundles.hint,c.bundles.layer,c.bundles.monster,c.bundles.prefab,c.bundles.spine,c.bundles.ui,c.bundles.bullet,c.bundles.wwqVec,c.bundles.resources,c.bundles.icon,c.bundles.audio];d.loadBundleArr(e,(function(e){n.bundleArrProgress=e}),s(t().mark((function e(r){return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.bundleArrProgress=1,e.next=3,f.getInstance().onInit();case 3:n.loadCommonLayerRes();case 4:case"end":return e.stop()}}),e)}))))}));case 2:case"end":return r.stop()}}),r,this)})));return function(){return r.apply(this,arguments)}}(),o.onDisable=function(){e.prototype.onDisable.call(this)},o.onDestroy=function(){e.prototype.onDestroy.call(this),this.releaseAllSpriteFrame()},o.collectAllSpriteFrame=function(e){var r=e.getComponent(a);r&&r.spriteFrame&&this.spriteFrameArr.push(r.spriteFrame);for(var s=e.children,t=0;t<s.length;t++){var n=s[t];this.collectAllSpriteFrame(n)}},o.releaseAllSpriteFrame=function(){for(var e=0;e<this.spriteFrameArr.length;e++){this.spriteFrameArr[e].decRef()}this.spriteFrameArr=[]},o.loadDesignRes=function(e){var r=this;u.loadAllDesignTable((function(e){r.designResProgress=e}),(function(){r.designResProgress=1,e&&e()}))},o.loadCommonLayerRes=function(){var e=this;g.loadCommonLayers((function(r){e.layerProgress=r}),(function(r){e.layerProgress=1}))},o.openHomeLayer=function(){var e=s(t().mark((function e(){return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("进度条加载完成......"),console.log("你永远需要登陆。。。。。"),this.openLayer(c.layers.LoginLayer),this.closeLayer();case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),o.onButtonClick=function(e,r){},o.update=function(e){if(this.progressBar){if(this.bundleLoadingTime>=0){this.bundleLoadingTime+=e;var r=this.bundleLoadingTime/this.bundleLoadingMaxTime;r>1&&(r=1),r>this.bundleArrProgress&&(this.bundleArrProgress=r),this.bundleArrProgress>=1&&(this.bundleArrProgress=1)}var s=this.designResProgress*this.designResPercent+this.bundleArrProgress*this.bundleArrPercent+this.layerProgress*this.layerPercent;if((s=Math.ceil(1e4*s)/1e4)>this.progressBar.progress){this.setProgressBar(this.progressBar,s),this.setString(this.percentNode,Math.ceil(100*s)+"%");var t=this.flagNode.getPosition();t.x=s*this.progressLength+this.startGap,this.flagNode.setPosition(t)}s>=1&&(this.progressBar=void 0,h.init(),this.openHomeLayer())}},n}(p))||y);n._RF.pop()}}}));

System.register("chunks:///_virtual/localStorageManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./myLog.ts","./constants.ts"],(function(e){var t,n,a,o,i;return{setters:[function(e){t=e.createClass},function(e){n=e.cclegacy,a=e.sys},function(e){o=e.myLog},function(e){i=e.constants}],execute:function(){n._RF.push({},"843feR3HERCO4ZE2g+iR7sM","localStorageManager",void 0);var s=function(){function e(){this.uidKey=i.gameName+"_uid",this.openIdKey=i.gameName+"_openId"}var n=e.prototype;return n.getKey=function(){return i.gameName?i.gameName+"_gameData":"gameData"},n.getGameData=function(){var e=this.getKey(),t=a.localStorage.getItem(e);return t?t=JSON.parse(t):{}},n.setGameData=function(e){var t=this.getKey();a.localStorage.setItem(t,JSON.stringify(e))},t(e,[{key:"uid",get:function(){return a.localStorage.getItem(this.uidKey)},set:function(e){a.localStorage.setItem(this.uidKey,e+""),o.i("保存uid:"+e)}},{key:"openId",get:function(){return a.localStorage.getItem(this.openIdKey)},set:function(e){a.localStorage.setItem(this.openIdKey,e+""),o.i("保存openId："+e)}}],[{key:"instance",get:function(){return this._instance||(this._instance=new e),this._instance}}]),e}();s._instance=void 0;e("localStorageManager",s.instance);n._RF.pop()}}}));

System.register("chunks:///_virtual/localText.ts",["cc"],(function(t){var e;return{setters:[function(t){e=t.cclegacy}],execute:function(){e._RF.push({},"6baf2njhytK9KIt5/ZohKS5","localText",void 0);t("localText",{clickGameStart:"Click to start",adAwardHint:"no Ads",noRewardAd:"no Ads",noAd:"no Ads",defaultError:"Error st:%d",lackItemHint:"Insufficient %s",itemGet:"Get %sx%d",timeCd:"Get Back in %s",cd:"Try agin later",propGet:"%d %s",lv:"Lv",maxLv:"Max Lv",point:"Point",energyTimeHint:"Duration：%dd%dh",ci:"Times",daySignHasGet:"Signed",daySignOutdate:"Out of Date",daySignNoLeave:"Signed",dayIndex:"Day %d",daySignFinalAwardHint:"Claim after 7 days",hasGet:"Claimed",get:"Claim",notHas:"unobtainable",equipSuccess:"Success",full:"MAX",wei:"slots",ge:"items",notGet:"Cannot claim，quantity is %d",weaponEquipAdd:"Increase weapon AP by %d%",coinGetHint:"Get %d coins",lackDiamond:"Insufficient Diamond"});e._RF.pop()}}}));

System.register("chunks:///_virtual/LoginLayer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./BaseLayer.ts","./ServerCtr.ts","./UserData.ts","./constants.ts","./layerManager.ts"],(function(t){var e,n,i,r,o,a,s,c,l,u,d,p,g,h,f;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,i=t.initializerDefineProperty,r=t.assertThisInitialized,o=t.asyncToGenerator,a=t.regeneratorRuntime},function(t){s=t.cclegacy,c=t._decorator,l=t.EditBox,u=t.Node},function(t){d=t.BaseLayer},function(t){p=t.default},function(t){g=t.UserData},function(t){h=t.constants},function(t){f=t.layerManager}],execute:function(){var y,I,v,x,B,L,m,b,w;s._RF.push({},"ce6fbHOIedKEJIWQBOGtOWq","LoginLayer",void 0);var E=c.ccclass,S=c.property;t("LoginLayer",(y=E("LoginLayer"),I=S({type:l,tooltip:"输入框"}),v=S({type:l,tooltip:"输入框"}),x=S({type:u,tooltip:"loading框"}),y((m=e((L=function(t){function e(){for(var e,n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return e=t.call.apply(t,[this].concat(o))||this,i(e,"editBoxInput",m,r(e)),i(e,"editBoxInput1",b,r(e)),i(e,"loading",w,r(e)),e}n(e,t);var s=e.prototype;return s.start=function(){},s.onLoad=function(){this.setPlaceholder(),this.registerEvents();var t=localStorage.getItem("name"),e=localStorage.getItem("code");if(t&&e)this.editBoxInput.string=t,this.editBoxInput1.string=e;else{var n=new URLSearchParams(window.location.search).get("code");n?(console.log("Code:",n),this.editBoxInput1.string=n):console.error("Code 参数不存在")}},s.setPlaceholder=function(){this.editBoxInput.string=""},s.registerEvents=function(){this.editBoxInput.node.on("editing-did-began",this.onEditBegan,this),this.editBoxInput.node.on("editing-did-ended",this.onEditEnded,this)},s.onEditBegan=function(){console.log("输入框获得焦点")},s.onEditEnded=function(){var t=this.editBoxInput.string.trim();console.log("当前输入框内容:",t)},s.onClickLoign=function(){var t=o(a().mark((function t(){var e,n;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.loading.active=!0,t.prev=1,t.next=4,p.GetInstance().createUserWithReferralCode(this.editBoxInput.string,this.editBoxInput.string,this.editBoxInput1.string);case 4:if(!(e=t.sent)){t.next=13;break}return localStorage.setItem("name",this.editBoxInput.string),localStorage.setItem("code",this.editBoxInput1.string),window.userData=e,t.next=11,p.GetInstance().fetchUserServerData();case 11:(n=t.sent)&&(g.getInstance().setUserServerData(n),this.loading.active=!1,this.closeLayer(),this.openLayer(h.layers.HomeLayer));case 13:t.next=21;break;case 15:t.prev=15,t.t0=t.catch(1),console.log(t.t0),f.createNotice("Username or Code is used"),console.error("登录失败：",t.t0),this.loading.active=!1;case 21:case"end":return t.stop()}}),t,this,[[1,15]])})));return function(){return t.apply(this,arguments)}}(),e}(d)).prototype,"editBoxInput",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),b=e(L.prototype,"editBoxInput1",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),w=e(L.prototype,"loading",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),B=L))||B));s._RF.pop()}}}));

System.register("chunks:///_virtual/LuckyDrawLayer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./utilTools.ts","./constants.ts","./localText.ts","./msgac.ts","./designManager.ts","./mapModel.ts","./AnimationCtrl.ts","./BaseLayer.ts"],(function(t){var e,i,n,o,a,r,s,c,h,l,u,d,m,v,p,y,f,N,g,I,S,A;return{setters:[function(t){e=t.inheritsLoose,i=t.asyncToGenerator,n=t.regeneratorRuntime},function(t){o=t.cclegacy,a=t._decorator,r=t.find,s=t.tween,c=t.v3,h=t.macro,l=t.UIOpacity,u=t.sp,d=t.Tween,m=t.UITransform},function(t){v=t.cocosUtil},function(t){p=t.utilTools},function(t){y=t.constants},function(t){f=t.localText},function(t){N=t.msgac},function(t){g=t.designManager},function(t){I=t.mapModel},function(t){S=t.AnimationCtrl},function(t){A=t.BaseLayer}],execute:function(){var L;o._RF.push({},"9a419rDrwhAl6a5INizAZcz","LuckyDrawLayer",void 0);var w=a.ccclass;a.property,t("LuckyDrawLayer",w("LuckyDrawLayer")(L=function(t){function o(){for(var e,i=arguments.length,n=new Array(i),o=0;o<i;o++)n[o]=arguments[o];return(e=t.call.apply(t,[this].concat(n))||this).uiNode=void 0,e.itemLayer=void 0,e.circleNodeNum=16,e.choseNum=0,e.choseArr=[],e.starShineArr=[],e.starShineIndex=0,e.showChoseIndex=0,e.showChoseItemUI=void 0,e.startCircle=!1,e.circleEnd=!1,e.btnStart=void 0,e.hintNode=void 0,e.coinLayer=void 0,e.coinNumNode=void 0,e.coinNum=0,e.resultUILayer=void 0,e.resultBgNode=void 0,e.resultItemLayer=void 0,e.resultItemNode=void 0,e.resultBtnSure=void 0,e.pdNode=void 0,e.fireNode=void 0,e}e(o,t);var a=o.prototype;return a.onLoad=function(){t.prototype.onLoad.call(this),this.uiNode=this.getNodeByPath("ui"),this.btnStart=this.getNodeByPath("ui/btnStart"),this.hintNode=this.getNodeByPath("ui/hint"),this.itemLayer=this.getNodeByPath("ui/itemLayer");var e=this.itemLayer.children[0];e.parent=null;for(var i=[{x:0,y:100},{x:100,y:0},{x:0,y:-100},{x:-100,y:0}],n=e,o=0;o<i.length;o++)for(var a=i[o],r=1;r<=4;r++){var s=v.instantiate(e);s.parent=this.itemLayer;var c=n.getPosition();c.x+=a.x,c.y+=a.y,s.position=c,n=s}this.coinLayer=this.getNodeByPath("ui/coinLayer"),this.coinNumNode=this.getNodeByPath("ui/coinLayer/num"),this.pdNode=this.getNodeByPath("pd"),this.fireNode=this.getNodeByPath("fire"),this.resultUILayer=this.getNodeByPath("resultUi"),this.resultBgNode=this.getNodeByPath("resultUi/resultBg"),this.resultItemLayer=this.getNodeByPath("resultUi/itemLayer"),this.resultItemNode=this.resultItemLayer.children[0],this.resultItemNode.parent=null,this.resultBtnSure=this.getNodeByPath("resultUi/btnSure")},a.onEnable=function(){t.prototype.onEnable.call(this),this.addEventArr([N.mapLeave])},a.onDisable=function(){t.prototype.onDisable.call(this),this.removeEventArr([N.mapLeave])},a.initUI=function(){var t=this;this.resultUILayer.active=!1,this.pdNode.active=!1,this.fireNode.active=!1,this.hintNode.active=!1,this.setString(this.coinNumNode,this.coinNum),this.initItemArr(),this.btnStart.active=!1,v.tweenScaleIn(this.uiNode,.3,(function(){t.btnStart.active=!0,v.tweenScaleIn(t.btnStart)}))},a.initItemArr=function(){var t=this,e=[];this.choseArr=[],this.choseNum=Math.random()>.5?3:5;var i=[],n=[];for(p.forArr(I.weaponSystem.weaponArr,(function(t){var e={};e.name=y.tableName.weapon,e.info=t;var o=g.getRowById(e.name,t.id);if(o.lv==y.design.maxLv-1){var a=p.copyObj(e);return a.info.id++,void n.push(a)}for(var r=o.lv;r<y.design.maxLv;){var s=p.copyObj(e);i.push(s),r++}})),p.forArr(I.skillSystem.skillArr,(function(t){var e={};e.name=y.tableName.skill,e.info=t;var o=g.getRowById(e.name,t.id);if(o.lv==y.design.maxLv-1){var a=p.copyObj(e);return a.info.id++,void n.push(a)}for(var r=o.lv;r<y.design.maxLv;){var s=p.copyObj(e);i.push(s),r++}})),p.forArr(I.skillSystem.skill2Arr,(function(t){var e={};e.name=y.tableName.skill2,e.info=t;var o=g.getRowById(e.name,t.id);if(o.lv==y.design.maxLv-1){var a=p.copyObj(e);return a.info.id++,void n.push(a)}for(var r=o.lv;r<y.design.maxLv;){var s=p.copyObj(e);i.push(s),r++}})),e=e.concat(n);n.length>this.choseNum;)p.getRandomItemByArr(n,!0);for(this.choseArr=this.choseArr.concat(n);i.length<this.circleNodeNum-e.length;){var o={};o.name=y.tableName.prop,o.id=y.propIds.coin,o.num=Math.floor(100*Math.random())+1,i.push(o)}for(;this.choseArr.length<this.choseNum;){var a=p.getRandomItemByArr(i,!0);if(!a)break;this.choseArr.push(a),e.push(a)}for(;e.length<this.circleNodeNum;){var s=p.getRandomItemByArr(i,!0);if(!s)break;e.push(s)}e=p.randomArr(e,!0),this.choseArr=p.randomArr(this.choseArr,!0),p.forArr(this.itemLayer.children,(function(i,n){var o=e[n],a=t.getRowByItem(o);o.uiIndex=n,i.item=o,t.setSpriteFrame(r("icon",i),a.icon),r("shine",i).active=!1,r("star",i).active=!1,r("chose",i).active=!1,i.active=!1,t.scheduleOnce((function(){i.active=!0,v.tweenScaleIn(i)}),.2+.2*Math.random())}))},a.getRowByItem=function(t){var e=null;switch(t.name){case y.tableName.weapon:case y.tableName.skill:case y.tableName.skill2:e=g.getRowById(t.name,t.info.id);break;case y.tableName.prop:e=g.getRowById(t.name,t.id)}return e},a.startAnimation=function(){var t=this;p.waterfall([function(e,i){t.circleShineAnimation((function(){i()}))},function(e,i){t.circleShineAnimation((function(){i()}))},function(e,i){t.totalShineAnimation((function(){i()}))},function(e,i){t.choseNumAnimation((function(){i()}))},function(e,i){t.unscheduleAllCallbacks(),t.pdNode.active=!0,t.startCircle=!0,s(t.coinLayer).to(.2,{scale:c(1.1,1.1,1)}).to(.2,{scale:c(1,1,1)}).union().repeatForever().start(),t.schedule((function(){t.startCircle&&!t.circleEnd&&(t.coinNum+=2,t.setString(t.coinNumNode,t.coinNum))}),.02,h.REPEAT_FOREVER),t.scheduleOnce((function(){t.hintNode.active=!0,s(t.hintNode.getComponent(l)).delay(.5).to(.5,{opacity:0}).to(.5,{opacity:255}).union().repeatForever().start()}),.5),t.startShineStarCircle()}]);var e=[c(-100,200,0),c(0,-100,0),c(150,-250,0),c(300,-500,0),c(100,-450,0)];v.schedule(this,(function(){if(!(e.length<=0)){var i=Math.random()>.5?"huang":"lan",n=.8+.2*Math.random(),o=p.getRandomItemByArr(e,!0),a=v.instantiate(t.fireNode);a.parent=t.fireNode.parent,a.active=!0,a.position=o,a.scale=c(n,n,1),a.getComponent(u.Skeleton).setSkin(i),v.addComponentOnce(a,S).playAnimationOnce("animation",(function(){a.parent=null}))}}),1.5,h.REPEAT_FOREVER,0,!0)},a.startShineStarCircle=function(){var t=this.itemLayer.children,e=5;this.starShineArr=[],this.starShineIndex=e+this.choseNum-1,this.showChoseIndex=0,this.showChoseItemUI=null;for(var i=0;i<this.choseNum;i++){var n=t[e];e++,this.initStarShineItemUI(n),this.starShineArr.push(n)}this.schedule(this.addNextStarShine,.05,h.REPEAT_FOREVER),this.scheduleOnce(this.startShowChoseItem,3+2*Math.random())},a.startShowChoseItem=function(){var t=this.choseArr[this.showChoseIndex];t&&(this.showChoseItemUI=this.itemLayer.children[t.uiIndex],this.showChoseIndex++)},a.initStarShineItemUI=function(t){var e=r("shine",t).getComponent(l);e.node.active=!0,e.opacity=255;var i=r("star",t);i.angle=360*Math.random();var n=v.addComponentOnce(i,S);n.getComponent(l).opacity=255,n.node.active=!0,n.playAnimation("3",!1,(function(){n.node.active=!1}))},a.addNextStarShine=function(t){var e=this,i=this.itemLayer.children;this.starShineIndex++,this.starShineIndex>=this.circleNodeNum&&(this.starShineIndex=0);var n=i[this.starShineIndex];if(this.showChoseItemUI==n){this.showChoseItemUI=null,this.unschedule(this.addNextStarShine),r("chose",n).active=!0;var o=r("star",n);return o.active=!0,o.angle=0,o.getComponent(l).opacity=255,v.addComponentOnce(o,S).playAnimation("2",!1,(function(){o.active=!1})),this.playerAddItem(n.item),void s(n).to(.2,{scale:c(1.5,1.5,1)}).to(.2,{scale:c(1,1,1)}).call((function(){e.showChoseIndex>=e.choseArr.length?e.showChoseResult():(e.schedule(e.addNextStarShine,.05,h.REPEAT_FOREVER),e.startShowChoseItem())})).start()}this.initStarShineItemUI(n),this.starShineArr.push(n);var a=this.starShineArr.shift(),u=r("shine",a);s(u.getComponent(l)).to(6*t,{opacity:0}).start()},a.playerAddItem=function(t){var e=this.getRowByItem(t);switch(t.name){case y.tableName.weapon:I.weaponSystem.addWeapon(e.type),t.info=p.copyObj(I.weaponSystem.getWeaponInfoByType(e.type));break;case y.tableName.skill:I.skillSystem.addSkill(e.type),t.info=p.copyObj(I.skillSystem.getSkillInfoByType(e.type));break;case y.tableName.skill2:I.skillSystem.addSkill2(e.type),t.info=p.copyObj(I.skillSystem.getSkill2InfoByType(e.type));break;case y.tableName.prop:I.propSystem.getProp(t.id,t.num)}},a.showChoseResult=function(){var t=i(n().mark((function t(){var e,i,o,a,h,l=this;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.unscheduleAllCallbacks(),this.circleEnd=!0,I.propSystem.getProp(y.propIds.coin,this.coinNum),this.itemLayer.children.forEach((function(t){r("shine",t).active=!1,r("star",t).active=!1})),this.resultUILayer.active=!0,this.resultBtnSure.active=!1,this.resultItemLayer.removeAllChildren(),t.next=9,v.tweenFadeIn(this.resultBgNode,.5);case 9:e=this.resultItemNode.getComponent(m),i=e.height,20,o=this.itemLayer.children,a=n().mark((function t(e){var a;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a=l.choseArr[e],l.scheduleOnce((function(){var t=o[a.uiIndex],n=v.convertToWorldSpace(t);(t=v.instantiate(t)).parent=l.resultItemLayer,t.position=v.convertToNodeSpace(t,n);var h=c(0,0,0);h.y=.5*-i-(i+20)*e,s(t).to(.2,{position:h}).to(.1,{scale:c(.3,.3,1)}).call((function(){var t=v.instantiate(l.resultItemNode);t.parent=l.resultItemLayer,t.position=h,l.refreshResultItemUI(t,a);var i=r("shine",t);i.active=!0,v.tweenScaleIn2(t,.2,(function(){v.tweenFadeOut(i,.6),e==l.choseArr.length-1&&(l.resultBtnSure.active=!0,v.tweenScaleIn2(l.resultBtnSure))}))})).start()}),.3*e);case 2:case"end":return t.stop()}}),t)})),h=0;case 15:if(!(h<this.choseArr.length)){t.next=20;break}return t.delegateYield(a(h),"t0",17);case 17:h++,t.next=15;break;case 20:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),a.refreshResultItemUI=function(t,e){var i=this.getRowByItem(e);this.setSpriteFrame(r("icon",t),i.icon),this.setString(r("name",t),i.name);var n=i.info;e.name==y.tableName.prop&&(n=f.coinGetHint.format(e.num)),this.setString(r("info",t),n);var o=r("starLayer",t);e.name!=y.tableName.prop?(o.active=!0,this.setNumItemLayer(o,y.design.maxLv,(function(t,e){var n=r("icon",t),o=r("icon2",t),a=r("yin",t);i.lv>=e?(n.active=!0,o.active=!1,a.active=!1,i.lv>=y.design.maxLv&&(n.active=!1,o.active=!0)):(n.active=!1,a.active=!0)}))):o.active=!1},a.choseNumAnimation=function(t){for(var e=this,i=this.itemLayer.children,n=5,o=[],a=function(a){var c=i[n];o.push(c),n++,e.scheduleOnce((function(){var i=r("shine",c).getComponent(l);i.node.active=!0,i.opacity=0,s(i).to(.1,{opacity:255}).delay(.15).to(.1,{opacity:0}).union().repeatForever().start(),a==e.choseNum-1&&e.scheduleOnce((function(){p.forArr(o,(function(t){r("shine",t).active=!1,d.stopAllByTarget(r("shine",t).getComponent(l))})),t()}),.35)}),.35*a)},c=0;c<this.choseNum;c++)a(c)},a.totalShineAnimation=function(t){p.forArr(this.itemLayer.children,(function(e,i){var n=r("shine",e).getComponent(l);n.node.active=!0,n.opacity=0,s(n).to(.3,{opacity:255}).to(.3,{opacity:0}).union().repeat(3).call((function(){0==i&&t()})).start()}))},a.circleShineAnimation=function(t){for(var e=this,i=this.itemLayer.children,n=0,o=.1,a=function(a){var c=i[a],h=.05*n,u=r("shine",c);u.active=!0;var d=u.getComponent(l);if(d.opacity=0,e.scheduleOnce((function(){s(d).to(o,{opacity:255}).delay(.5).to(o,{opacity:0}).call((function(){5==a&&t()})).start()}),h),13!=a&&5!=a){var m=i[(26-a)%e.circleNodeNum],v=r("shine",m);v.active=!0;var p=v.getComponent(l);p.opacity=0,e.scheduleOnce((function(){s(p).to(o,{opacity:255}).delay(.5).to(o,{opacity:0}).start()}),h)}n++},c=13;c>=5;c--)a(c)},a.mapLeaveRet=function(){this.closeLayer()},a.processEvent=function(t,e){},a.onClickBtnStart=function(){this.btnStart.active=!1,this.startAnimation()},a.onButtonClick=function(t,e){},a.onClickBg=function(){if(this.hintNode.active&&(this.hintNode.active=!1,!(this.showChoseIndex>=1))){this.circleEnd=!0;var t=300;this.choseNum>=3&&(t=450),t+=100*Math.random(),(t=Math.floor(t))<=this.coinNum&&(t+=50*Math.random(),t=Math.floor(t)),this.coinNum=t,this.setString(this.coinNumNode,this.coinNum),this.unschedule(this.startShowChoseItem),this.startShowChoseItem()}},a.closeLayer=function(){t.prototype.closeLayer.call(this),this.layerCb&&this.layerCb()},a.onDestroy=function(){t.prototype.onDestroy.call(this)},a.onClickBtnSure=function(){this.closeLayer()},o}(A))||L);o._RF.pop()}}}));

System.register("chunks:///_virtual/main",["./debug-view-runtime-control.ts","./SingleInstance.ts","./myLog.ts","./redPointManager.ts","./GameLaunch.ts","./AnimationCtrl.ts","./AnimationTrack.ts","./BaseLayer.ts","./BtnLayer.ts","./ItemLayer.ts","./NodePoolUtil.ts","./NoticeLayer.ts","./ProgressCtrl.ts","./RenderChildBatch.ts","./ScrollViewUtil.ts","./GameCtrl.ts","./NewPropInfoLayer.ts","./Player.ts","./PropItem.ts","./PropItemPrefab.ts","./Bullet.ts","./Bullet1011.ts","./Bullet1021.ts","./Bullet1031.ts","./Bullet1041.ts","./Bullet1042.ts","./Bullet1051.ts","./Bullet1052.ts","./Bullet1061.ts","./Bullet1071.ts","./Bullet1081.ts","./Bullet1091.ts","./Bullet1101.ts","./Bullet1102.ts","./Bullet1103.ts","./Bullet12.ts","./Bullet13.ts","./Bullet14.ts","./Bullet17.ts","./Bullet18.ts","./Bullet19.ts","./Bullet20.ts","./Bullet21.ts","./Bullet22.ts","./Bullet4.ts","./Bullet5.ts","./Bullet6.ts","./Bullet8.ts","./Bullet9.ts","./bullet10170.ts","./bullet10180.ts","./bullet10190.ts","./bullet10200.ts","./bullet16.ts","./Hint.ts","./TargetPos.ts","./blockArrow.ts","./comeShine.ts","./feiBiao.ts","./targetPos2.ts","./targetPos3.ts","./Monster.ts","./Monster12.ts","./Monster13.ts","./Monster21.ts","./Monster22.ts","./Monster23.ts","./Monster3.ts","./Monster4.ts","./Monster5.ts","./Monster6.ts","./Monster9.ts","./Prop.ts","./Prop1001.ts","./Prop1002.ts","./Prop101.ts","./Prop201.ts","./Prop701.ts","./Skill.ts","./Skill1.ts","./Skill10.ts","./Skill2.ts","./Skill3.ts","./Skill4.ts","./Skill5.ts","./Skill6.ts","./Skill7.ts","./Skill8.ts","./Skill9.ts","./Weapon.ts","./Weapon1.ts","./Weapon2.ts","./Weapon3.ts","./Weapon4.ts","./Weapon5.ts","./Weapon6.ts","./Weapon7.ts","./Weapon8.ts","./AAModelLayer.ts","./AscendLayer.ts","./AwardInfoLayer.ts","./BackHomeLayer.ts","./BackLifeLayer.ts","./BackMaplLayer.ts","./Bag.ts","./BaseUILayer.ts","./BoxMonsterLayer.ts","./BuyLifeLayer.ts","./Daily.ts","./DaySignLayer.ts","./DayTaskLayer.ts","./DialogEffect.ts","./Earn.ts","./Events.ts","./ExChangeLayer.ts","./HandLayer.ts","./HeroLayer.ts","./HomeLayer.ts","./InviteLayer.ts","./LetterConfirmLayer.ts","./LetterDetailsLayer.ts","./LetterLayer.ts","./LoadingLayer.ts","./LoginLayer.ts","./LuckyDrawLayer.ts","./MainLayer.ts","./MapLayer.ts","./MoreGameLayer.ts","./MsgBoxLayer.ts","./NewShopLayer.ts","./PatrolFastLayer.ts","./PatrolLayer.ts","./PauseLayer.ts","./PreventTouchPropagation.ts","./PropInfoLayer.ts","./PropInfoLayer2.ts","./PyramidDrawLayer.ts","./Quests.ts","./RewardItemLayer.ts","./RewardLayer.ts","./SelectSummonLayer.ts","./SettingLayer.ts","./SettlementLayer.ts","./Shop.ts","./ShopLayer.ts","./SkillSelectLayer.ts","./SkinChangeLayer.ts","./SkinsDetailsLayer.ts","./SkinsLayer.ts","./Summon.ts","./TopUILayer.ts","./TransLayer.ts","./TributeLayer.ts","./Tutorial.ts","./VipLayer.ts","./WalletLayer.ts","./WalletLinkLayer.ts","./ShineColor.ts","./BulletSystem.ts","./HintSystem.ts","./MapSystem.ts","./MonsterSystem.ts","./NumSystem.ts","./PropSystem.ts","./SkillSystem.ts","./WeaponSystem.ts","./constants.ts","./localText.ts","./msgac.ts","./BoxColliderUtil.ts","./MotionStreakAssemblerUtil.ts","./MotionStreakUtil.ts","./PhysicsWorld.ts","./GParam.ts","./MapWrap.ts","./RedPointLogicMgr.ts","./audioManager.ts","./designManager.ts","./eventManager.ts","./layerManager.ts","./localStorageManager.ts","./resManager.ts","./UserData.ts","./devModel.ts","./mapModel.ts","./playerModel.ts","./physicsGroup.ts","./serverMsg.ts","./sdkManager.ts","./TyqBaseLayer.ts","./tyqLayerManager.ts","./tyqResManager.ts","./tyqConstants.ts","./CronCtr.ts","./GameMemoryStorage.ts","./ServerCtr.ts","./TimeCtr.ts","./conf.ts","./gameStorage.ts","./http.ts","./md5.ts","./wmsocket.ts","./WXCustomAd.ts","./wechat.ts","./tyqAdManager.ts","./tyqSDK.ts","./tyqSDKConfig.ts","./weHttp.ts","./weNetworkMgr.ts","./CountTimeUtil.ts","./FileUtils.ts","./cocosUtil.ts","./utilTools.ts"],(function(){return{setters:[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],execute:function(){}}}));

System.register("chunks:///_virtual/MainLayer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./myLog.ts","./utilTools.ts","./constants.ts","./audioManager.ts","./designManager.ts","./mapModel.ts","./playerModel.ts","./UserData.ts","./BaseLayer.ts","./TopUILayer.ts","./eventManager.ts","./msgac.ts","./layerManager.ts","./ServerCtr.ts"],(function(e){var t,n,i,a,o,r,s,l,c,p,u,h,g,y,d,f,m,v,b,C,k,L,B,N,S,M,I,w,T,x,P,E;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,i=e.initializerDefineProperty,a=e.assertThisInitialized,o=e.asyncToGenerator,r=e.regeneratorRuntime},function(e){s=e.cclegacy,l=e._decorator,c=e.sp,p=e.Node,u=e.Prefab,h=e.EditBox,g=e.VideoPlayer,y=e.v3,d=e.view,f=e.Vec3,m=e.tween,v=e.Label},function(e){b=e.myLog},function(e){C=e.utilTools},function(e){k=e.constants},function(e){L=e.audioManager},function(e){B=e.designManager},function(e){N=e.mapModel},function(e){S=e.playerModel},function(e){M=e.UserData},function(e){I=e.BaseLayer},function(e){w=e.TopUILayer},function(e){T=e.eventManager},function(e){x=e.msgac},function(e){P=e.layerManager},function(e){E=e.default}],execute:function(){var D,G,R,U,z,_,H,F,V,A,q,W,K,O,J,j,Q,X,Y;s._RF.push({},"b39d7yGzFVCnJAyJAjPMHKR","MainLayer",void 0);var Z=l.ccclass,$=l.property;e("MainLayer",(D=Z("MainLayer"),G=$({type:c.Skeleton,tooltip:"角色spine"}),R=$({type:p}),U=$({type:p,tooltip:"地图名字"}),z=$({type:p}),_=$({type:u,tooltip:"Home节点"}),H=$({type:p}),F=$({type:p,tooltip:"codeBox"}),V=$({type:p,tooltip:"Loading"}),D((W=t((q=function(e){function t(){for(var t,n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(t=e.call.apply(e,[this].concat(o))||this).toggles=[],t.togglesLock=[!0,!1,!1,!1,!0],i(t,"heroSk",W,a(t)),i(t,"btnRedBox",K,a(t)),i(t,"mapText",O,a(t)),i(t,"handNode",J,a(t)),i(t,"homeLayer",j,a(t)),i(t,"scrollView",Q,a(t)),i(t,"codeBox",X,a(t)),i(t,"Loading",Y,a(t)),t.emailRedPointNode=void 0,t.daySignRedPointNode=void 0,t.dayTaskRedPointNode=void 0,t.vipRedPointNode=void 0,t.duihuanBg=void 0,t.btnShare=void 0,t.videoPlayer=void 0,t.shurukuang=void 0,t.mapNum=1,t.listData=[],t}n(t,e);var s=t.prototype;return s.initUI=function(){var e=o(r().mark((function e(){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.listData&&this.listData.length>0&&this.scrollViewSetData(this.scrollView,this.listData,(function(e,t,n){e.getChildByPath("label/Label").getComponent(v).string=t.referralCode,t.isUsed?(e.getChildByName("used").active=!0,e.getChildByName("LINE").active=!1,e.getChildByName("TG").active=!1):(e.getChildByName("used").active=!1,e.getChildByName("LINE").active=!0,e.getChildByName("TG").active=!0),e.getChildByName("LINE").on(p.EventType.TOUCH_END,(function(e){try{navigator.clipboard.writeText("https://liff.line.me/2006640650-mJ8bydwe\nInvitation code:"+t.referralCode),P.createNotice("Invitation code has been copied"),console.log('已复制到剪贴板: "https://liff.line.me/2006640650-mJ8bydwe?code=" + item.referralCode')}catch(e){console.error("复制到剪贴板失败:",e)}})),e.getChildByName("TG").on(p.EventType.TOUCH_END,(function(e){try{navigator.clipboard.writeText("https://t.me/midnight_survivors_bot/game\nInvitation code:"+t.referralCode),P.createNotice("Invitation code has been copied"),console.log("已复制到剪贴板: "+t.referralCode)}catch(e){console.error("复制到剪贴板失败:",e)}}))})),this.Loading.active=!1;case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),s.closeCodeBox=function(){this.codeBox.active=!1},s.openCodeBox=function(){var e=o(r().mark((function e(){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.Loading.active=!0,this.codeBox.active=!0,e.next=4,E.GetInstance().getUserReferralCodeList();case 4:this.listData=e.sent,this.initUI();case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),s.onLoad=function(){this.heroSk.setSkin(M.getInstance().getHeroSkin()),this.btnShare=this.getNodeByPath("btnsRight/btnShare");this.getNodeByPath("btnsLeft/btnPyramid"),this.getNodeByPath("btnsLeft/btnDayTask"),this.getNodeByPath("btnsLeft/btnGuess")},s.onClickBtnDuihuan=function(){this.duihuanBg.active=!0,this.duihuanBg.getChildByName("tishilabel").active=!1},s.onClickBtnCloseTuihuan=function(){this.duihuanBg.active=!1},s.onClickBtnTuihuan=function(){var e=this.duihuanBg.getChildByName("tishilabel");e.active=!1;var t=this.shurukuang.getComponent(h).string.split("_");if(t.length>1)if("tyq"==t[0]){var n;n="https://oss.game.xmtyq.com/game/video_wxgame/bpxt/tyq_"+t[1]+".mp4?token=6d4ae1582d1f97a26ccf250d29313750",e.active=!1,this.videoPlayer.getComponent(g).remoteURL=n,this.videoPlayer.active=!0}else e.active=!0;else e.active=!0},s.onEnable=function(){e.prototype.onEnable.call(this)},s.onDisable=function(){e.prototype.onDisable.call(this)},s.onDestroy=function(){e.prototype.onDestroy.call(this)},s.goStartGame=function(){var e=o(r().mark((function e(){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,E.GetInstance().startGame(C.getUserId().toString());case 3:return e.abrupt("return",e.sent);case 6:e.prev=6,e.t0=e.catch(0),console.log("🚀 ~ MainLayer ~ goStartGame ~ error:",e.t0);case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(){return e.apply(this,arguments)}}(),s.start=function(){this.heroSk.setSkin(M.getInstance().getHeroSkin()),console.log("🚀 ~ MainLayer ~ start ~ 11111111:",M.getInstance().getHeroSkin());var e=this.getNodeByPath("btnSet"),t=this.getNodeByPath("btnLetter"),n=this.node.parent.parent.getChildByName("TopUILayer");e.position.y>n.position.y-84&&(e.position=y(e.position.x,n.position.y-84,e.position.z),t.position=y(t.position.x,n.position.y-84,t.position.z));var i=d.getVisibleSize();if(i.width/i.height>=.5){var a=this.getNodeByPath("btnGo");a.position=new f(a.position.x,-360,a.position.z);var o=this.getNodeByPath("Map");o.position=new f(o.position.x,30,o.position.z)}if(M.getInstance()._isShowOpenLevel&&M.getInstance().getCurMap()>1){M.getInstance()._isShowOpenLevel=!1,this.initMapLevel(M.getInstance().getCurMap()-1,!1);var r=this.getNodeByPath("Map/role");r.active=!1,m(r).delay(1).call((function(){r.active=!0})).start();var s=this;m(this.getNodeByPath("Map/btnMap")).delay(.35).to(.35,{scale:y(0,0,0)}).call((function(){s.initMapLevel(M.getInstance().getCurMap(),!0)})).to(.2,{scale:y(1,1,1)}).start()}else this.initMapLevel(M.getInstance().getCurMap(),!0);for(var l=[],c=B.getRowsByType(k.tableName.CNTM,1),p=0;p<c.length;p++){var u=c[p].award[0];l.push(u[0])}M.getInstance().isHaveProp(l)?this.btnRedBox.removeFromParent():m(this.btnRedBox).to(3,{position:y(180,220,0)}).to(3,{position:y(-180,120,0)}).to(3,{position:y(180,20,0)}).to(3,{position:y(-180,-90,0)}).to(3,{position:y(180,80,0)}).to(3,{position:y(-180,-80,0)}).to(3,{position:y(180,20,0)}).to(3,{position:y(-180,120,0)}).to(3,{position:y(180,220,0)}).to(3,{position:y(-180,350,0)}).union().repeatForever().start()},s.initMapLevel=function(e,t){var n=B.getTable(k.tableName.map);this.setSpriteFrame2(this.getNodeByPath("Map/map_name"),"homeLayer/map_name"+n[e-1].id,null,k.bundles.wwqVec);var i=(n[e-1].id-1)%2+1;this.setSpriteFrame2(this.getNodeByPath("Map/btnMap/icon"),"homeLayer/ui_map"+i,null,k.bundles.wwqVec),this.getNodeByPath("btnGo/Label").getComponent(v).string="X"+n[e-1].energy;var a=M.getInstance().getLevelData(M.getInstance().getCurMap());this.getNodeByPath("Map/timeLabel").getComponent(v).string="Best Time:"+C.getTimeStrChinese(1e3*a.Time);var o=this.getNodeByPath("Map/role");if(t){m(o).stop();var r="skin1";3!=e&&4!=e||(r="skin2"),1==e||3==e?(o.getComponent(c.Skeleton).setSkin(r),m(o).set({scale:y(1.5,1.5,0)}).to(2.5,{position:y(-138,-48,0)}).set({scale:y(-1.5,1.5,0)}).to(2.5,{position:y(90,-48,0)}).to(.8,{position:y(90,0,0)}).to(.8,{position:y(130,0,0)}).set({scale:y(1.5,1.5,0)}).to(.5,{position:y(90,0,0)}).to(.8,{position:y(90,-48,0)}).union().repeatForever().start()):2==e||4==e?(this.setSpineData2(o,k.bundles.monster,"monster22/ncg",(function(){o.getComponent(c.Skeleton).animation="walk",o.getComponent(c.Skeleton).loop=!0,o.getComponent(c.Skeleton).setSkin(r)})),m(o).set({scale:y(1.5,1.5,0)}).to(2.5,{position:y(-138,-48,0)}).set({scale:y(-1.5,1.5,0)}).to(2.5,{position:y(90,-48,0)}).union().repeatForever().start()):o.active=!1}this.handNode.active=!1;var s=M.getInstance().getCurMap()-1;M.getInstance().power>=n[s].energy&&(this.handNode.active=!0)},s.onClickBtnGo=function(){var e=this;L.playEffect("btnClick");try{this.goStartGame().then((function(t){console.log("🚀 ~ MainLayer ~ this.goStartGame ~ res:",t),console.log("🚀 ~ MainLayer ~ this.goStartGame ~ user:",M.getInstance().getUserServerData());var n=0,i=0,a=0,o=t.attributes;for(var r in o){var s,l,c;if(o[r])n+=null==(s=o[r])?void 0:s.details.atkAdd,i+=null==(l=o[r])?void 0:l.details.defenseAdd,a+=null==(c=o[r])?void 0:c.details.hpAdd}M.getInstance().gameKey=t.gameKey,M.getInstance().attack=n,M.getInstance().life=Number(M.getInstance().getUserServerData().baseHp)||0+a,M.getInstance().defense=i,console.log(M.getInstance().gameKey,"----------- gameKey");var p=M.getInstance().getCurMap()-1,u=B.getTable(k.tableName.map);M.getInstance().power<u[p].energy?e.createNotice("Low Stamina"):(M.getInstance().usePower(0-u[p].energy),e.node.parent.parent.getChildByName("TopUILayer").getComponent(w).showUseAnimal(1,0-u[p].energy),S.addDayTaskNum(7,u[p].energy),1===e.mapNum?N.enterMapWithMapId(101,e.mapNum):2===e.mapNum?N.enterMapWithMapId(102,e.mapNum):N.enterMapWithMapId(103,e.mapNum))}))}catch(e){console.log("🚀 ~ MainLayer ~ onClickBtnGo ~ error:",e)}},s.setLabelText=function(e){var t=this.mapText.getChildByName("level");t?t.getComponent(v).string=1===e?"Abyssal Forest":2===e?"Desolate Ruins":"Forgotten Catacombs":console.log("Label node not found")},s.onClickLeft=function(){this.mapNum>1&&(this.mapNum-=1,this.setLabelText(this.mapNum)),console.log(this.mapNum)},s.onClickRight=function(){this.mapNum<3&&(this.mapNum+=1,this.setLabelText(this.mapNum)),console.log(this.mapNum)},s.onClickBtnMap=function(){b.i("btnMap"),L.playEffect("btnClick"),this.closeLayer()},s.onClickBtnChapter=function(){L.playEffect("btnClick"),b.i("btnMap"),this.closeLayer()},s.onClickBtnSet=function(){L.playEffect("btnClick"),this.openLayer(k.layers.SettingLayer)},s.onClickBtnDayTask=function(){L.playEffect("btnClick"),this.openLayer(k.layers.Events)},s.onClickBtnDaySign=function(){L.playEffect("btnClick"),this.openLayer(k.layers.Daily)},s.onClickBtnWager=function(){L.playEffect("btnClick"),P.createNotice("Unlock With an Invite")},s.onClickBtnBag=function(){L.playEffect("btnClick"),this.openLayer(k.layers.Bag)},s.onClickBtnGuess=function(){L.playEffect("btnClick"),this.openLayer(k.layers.WalletLayer)},s.onClickBtnPyramid=function(){L.playEffect("btnClick"),this.openLayer(k.layers.Quests)},s.onClickOpenSkin=function(e,t){var n=this;L.playEffect("btnClick"),this.openLayer(k.layers.SkinsLayer,(function(e){n.heroSk.setSkin(M.getInstance().getHeroSkin())}))},s.onClickBtnClose=function(e){this.closeLayer()},s.onClickBtnLetter=function(){L.playEffect("btnClick"),this.openLayer(k.layers.LetterLayer)},s.onClickBtnEquipCompose=function(){L.playEffect("btnClick"),this.openLayer(k.layers.ExChangeLayer)},s.onClickBtnSkinChange=function(){var e=this;L.playEffect("btnClick"),this.openLayer(k.layers.HeroLayer,(function(t){"close"===t&&T.send(x.setTabPage,0),e.heroSk.setSkin(M.getInstance().getHeroSkin())}))},s.onCloseCallback=function(){this.heroSk.setSkin(M.getInstance().getHeroSkin())},s.onClickTribute=function(){L.playEffect("btnClick"),this.openLayer(k.layers.TributeLayer)},s.onClickBtnVip=function(){L.playEffect("btnClick"),this.openLayer(k.layers.AscendLayer)},s.onClickBtnShare=function(){L.playEffect("btnClick"),this.openLayer(k.layers.ShareLayer)},t}(I)).prototype,"heroSk",[G],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),K=t(q.prototype,"btnRedBox",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),O=t(q.prototype,"mapText",[U],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),J=t(q.prototype,"handNode",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),j=t(q.prototype,"homeLayer",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Q=t(q.prototype,"scrollView",[H],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),X=t(q.prototype,"codeBox",[F],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Y=t(q.prototype,"Loading",[V],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),A=q))||A));s._RF.pop()}}}));

System.register("chunks:///_virtual/MapLayer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./utilTools.ts","./constants.ts","./msgac.ts","./audioManager.ts","./designManager.ts","./mapModel.ts","./playerModel.ts","./UserData.ts","./serverMsg.ts","./BaseLayer.ts","./GameCtrl.ts","./Player.ts","./ShineColor.ts","./BulletSystem.ts","./HintSystem.ts","./MapSystem.ts","./MonsterSystem.ts","./NumSystem.ts","./PropSystem.ts","./SkillSystem.ts","./WeaponSystem.ts","./layerManager.ts","./eventManager.ts"],(function(e){var t,s,i,a,o,n,l,r,h,m,p,u,d,y,c,g,v,N,B,f,k,S,L,b,P,C,D,x,H,M,A,R,F;return{setters:[function(e){t=e.inheritsLoose},function(e){s=e.cclegacy,i=e._decorator,a=e.find,o=e.ProgressBar,n=e.sys,l=e.Tween,r=e.v3,h=e.tween},function(e){m=e.cocosUtil},function(e){p=e.utilTools},function(e){u=e.constants},function(e){d=e.msgac},function(e){y=e.audioManager},function(e){c=e.designManager},function(e){g=e.mapModel},function(e){v=e.playerModel},function(e){N=e.UserData},function(e){B=e.serverMsg},function(e){f=e.BaseLayer},function(e){k=e.GameCtrl},function(e){S=e.Player},function(e){L=e.ShineColor},function(e){b=e.BulletSystem},function(e){P=e.HintSystem},function(e){C=e.MapSystem},function(e){D=e.MonsterSystem},function(e){x=e.NumSystem},function(e){H=e.PropSystem},function(e){M=e.SkillSystem},function(e){A=e.WeaponSystem},function(e){R=e.layerManager},function(e){F=e.eventManager}],execute:function(){var I;s._RF.push({},"a41fcFlOgVCb4AMEKDOJ9z2","MapLayer",void 0);var w=i.ccclass;i.property,e("MapLayer",w("MapLayer")(I=function(e){function s(){for(var t,s=arguments.length,i=new Array(s),a=0;a<s;a++)i[a]=arguments[a];return(t=e.call.apply(e,[this].concat(i))||this).fightCapNode=void 0,t.mapSystem=void 0,t.player=void 0,t.gameCtrl=void 0,t.timeNode=void 0,t.expProgress=void 0,t.expLvNode=void 0,t.expBarColorArr=["#00FF00","#00C2FF","#FF00D6","#FF2900"],t.expBarColorIndex=0,t.expBarShineColor=void 0,t.expLvUpCount=0,t.coinNumNode=void 0,t.coinIconNode=void 0,t.diamondNumNode=void 0,t.killMonsterNumNode=void 0,t.bossHpLayer=void 0,t.bossDamProgressBar=void 0,t.bossHpProgress=void 0,t.skillBombIcon=void 0,t.skillBombAd=void 0,t.skillBombNum=void 0,t.skillBombCd=void 0,t.btnSkillHeal=void 0,t.skillHealIcon=void 0,t.skillHealAd=void 0,t.skillHealNum=void 0,t.skillHealCd=void 0,t.skillMagnetAd=void 0,t.skillMagnetNum=void 0,t.skillLifeAd=void 0,t.skillLifeNum=void 0,t.monsterNumNode=void 0,t.showNumNode=void 0,t.playerPosNode=void 0,t.expNumNode=void 0,t}t(s,e);var i=s.prototype;return i.onLoad=function(){e.prototype.onLoad.call(this),this.chooseDesignResolution(),this.getNodeByPath("bg").active=!1,this.getNodeByPath("ui/btns").active=v.isRecordAd||v.isInDevelopmentEnvironment(),this.fightCapNode=this.getNodeByPath("fightCap"),this.fightCapNode.active=!1,this.gameCtrl=this.getNodeByPath("gameCtrl").addComponent(k),this.mapSystem=g.mapFightLayer.addComponent(C);var t=a("map",g.mapFightLayer);this.player=a("player",t).addComponent(S);var s=a("monsterLayer",t).addComponent(D),i=a("bulletLayer",t).addComponent(b),n=a("numLayer",t).addComponent(x),l=a("player/skillLayer",t).addComponent(M),r=a("player/weaponLayer",t).addComponent(A),h=a("hintLayer",t).addComponent(P),m=a("propLayer",t).addComponent(H);g.setCompoments(this,this.player,this.mapSystem,s,i,n,r,l,h,m),this.coinIconNode=this.getNodeByPath("ui/top/coinLayer/icon"),this.coinNumNode=this.getNodeByPath("ui/top/coinLayer/num"),this.diamondNumNode=this.getNodeByPath("ui/top/diamondLayer/num"),this.killMonsterNumNode=this.getNodeByPath("ui/top/monsterLayer/num"),this.expProgress=this.getNodeByPath("ui/expProgress"),this.expLvNode=this.getNodeByPath("ui/expProgress/lv"),this.expBarShineColor=this.getNodeByPath("ui/expProgress/bar").addComponent(L),this.bossHpLayer=this.getNodeByPath("ui/bossHpLayer"),this.bossDamProgressBar=this.getNodeByPath("ui/bossHpLayer/damProgress").getComponent(o),this.bossHpProgress=this.getNodeByPath("ui/bossHpLayer/hpProgress"),this.bossHpLayer.active=!1,this.skillBombIcon=this.getNodeByPath("ui/skillBtns/btnSkillBomb/icon"),this.skillBombAd=this.getNodeByPath("ui/skillBtns/btnSkillBomb/icon/ad"),this.skillBombNum=this.getNodeByPath("ui/skillBtns/btnSkillBomb/icon/num"),this.skillBombCd=this.getNodeByPath("ui/skillBtns/btnSkillBomb/cd"),this.btnSkillHeal=this.getNodeByPath("ui/skillBtns/btnSkillHeal"),this.skillHealIcon=this.getNodeByPath("ui/skillBtns/btnSkillHeal/icon"),this.skillHealAd=this.getNodeByPath("ui/skillBtns/btnSkillHeal/icon/ad"),this.skillHealNum=this.getNodeByPath("ui/skillBtns/btnSkillHeal/icon/num"),this.skillHealCd=this.getNodeByPath("ui/skillBtns/btnSkillHeal/cd"),this.skillMagnetAd=this.getNodeByPath("ui/skillBtns/btnSkillMagnet/icon/ad"),this.skillMagnetNum=this.getNodeByPath("ui/skillBtns/btnSkillMagnet/icon/num"),this.skillLifeAd=this.getNodeByPath("ui/skillBtns/btnSkillLife/icon/ad"),this.skillLifeNum=this.getNodeByPath("ui/skillBtns/btnSkillLife/icon/num"),this.timeNode=this.getNodeByPath("ui/top/time"),this.getNodeByPath("ui/infoDev").active=v.isInDevelopmentEnvironment(),this.monsterNumNode=this.getNodeByPath("ui/infoDev/monsterNum"),this.showNumNode=this.getNodeByPath("ui/infoDev/showNum"),this.playerPosNode=this.getNodeByPath("ui/infoDev/playerPos"),this.expNumNode=this.getNodeByPath("ui/infoDev/expNum");var p=N.getInstance().mapData;p?this.loadSaveMapData(p):(g.player.initData(this.layerData),g.weaponSystem.initData(this.layerData)),this.openUpdateSecond=!0,y.playMusic(u.audioNames.map)},i.onEnable=function(){var t=this;e.prototype.onEnable.call(this),this.addEventArr([d.mapLeave,d.saveDataBefore,d.commonResRefresh,d.mapRefreshSkill]),F.on(d.mapGameResume,(function(e){e.data;console.log("恢复游戏"),t.gameFightResume()}),this)},i.onDisable=function(){e.prototype.onDisable.call(this)},i.onDestroy=function(){e.prototype.onDestroy.call(this)},i.start=function(){var e=this;N.getInstance().mapHand||(N.getInstance().mapHand=1,this.scheduleOnce((function(){e.popLayer(u.layers.HandLayer)})))},i.initUI=function(){var e=this;this.refreshExpLayer(),this.refreshBossHpLayer(),this.refreshResLayer(),setTimeout((function(){n.localStorage.getItem("hasTutorial")||(e.gameFightPause(),e.node.getChildByName("Tutorial").active=!0,n.localStorage.setItem("hasTutorial","true"))}),2e3),R.isShowingLayer(u.layers.PatrolLayer)&&R.closeLayer(u.layers.PatrolLayer),R.isShowingLayer(u.layers.PatrolFastLayer)&&R.closeLayer(u.layers.PatrolFastLayer)},i.refreshSkillLayer=function(){console.log(v,"???????????"),this.skillBombAd.active=!1,this.skillBombNum.active=!1,v.skillBombNum>0&&(this.skillBombNum.active=!0,this.setString(this.skillBombNum,v.skillBombNum)),this.skillHealAd.active=!1,this.skillHealNum.active=!1,v.skillHealNum>0&&(this.skillHealNum.active=!0,this.setString(this.skillHealNum,v.skillHealNum)),this.skillMagnetAd.active=!1,this.skillMagnetNum.active=!1,v.skillMagnetNum>0&&(this.skillMagnetNum.active=!0,this.setString(this.skillMagnetNum,v.skillMagnetNum)),this.skillLifeAd.active=!1,this.skillLifeNum.active=!1,v.skillLifeNum>0&&(this.skillLifeNum.active=!0,this.setString(this.skillLifeNum,v.skillLifeNum))},i.mapRefreshSkillRet=function(){this.refreshSkillLayer()},i.updateSecond=function(){g.player.hp/g.player.hpMax<.5&&!this.btnSkillHeal.isBreath&&(this.btnSkillHeal.isBreath=!0,m.tweenBreath(this.btnSkillHeal)),g.player.hp/g.player.hpMax>.5&&this.btnSkillHeal.isBreath&&(this.btnSkillHeal.isBreath=!1,l.stopAllByTarget(this.btnSkillHeal),this.btnSkillHeal.scale=r(1,1,1))},i.refreshBossHpLayer=function(){var e=g.monsterSystem.bossMonster;e?(this.setProgressBar(this.bossHpProgress,e.hp/e.hpMax),this.bossHpLayer.active||(this.bossHpLayer.active=!0,l.stopAllByTarget(this.bossDamProgressBar),this.bossDamProgressBar.progress=this.bossHpProgress.getComponent(o).progress)):this.bossHpLayer.active=!1},i.bossSubHp=function(e){var t=this.bossHpProgress.getComponent(o).progress;this.bossDamProgressBar.progress=t,g.mapLayer.refreshBossHpLayer();var s=this.bossHpProgress.getComponent(o).progress;l.stopAllByTarget(this.bossDamProgressBar),h(this.bossDamProgressBar).to(.5,{progress:s},{easing:"quadOut"}).start()},i.refreshResLayer=function(){this.setString(this.coinNumNode,g.coinNum),this.setString(this.diamondNumNode,N.getInstance().getUserRuntimeData().diamondCoin),this.setString(this.killMonsterNumNode,g.killMonsterNum)},i.refreshExpLayer=function(){var e=c.getRowById(u.tableName.expLv,g.expLv);if(e){var t=e.exp,s=g.expNum;if(g.expLv>1){var i=c.getRowById(u.tableName.expLv,g.expLv-1);t=e.exp-i.exp,s=g.expNum-i.exp}this.setProgressBar(this.expProgress,s/t),this.setString(this.expLvNode,g.expLv),this.expBarShineColor.startShine(u.materials.shineColor,null,.2),g.expNum>=e.exp&&g.player.hp>0&&(this.expLvUpCount++,g.expLv++,g.expLv%c.config.check==0&&g.skillAllNum++,this.expBarColorIndex++,this.expBarColorIndex>=this.expBarColorArr.length&&(this.expBarColorIndex=0),m.setRenderableColor(a("bar",this.expProgress),this.expBarColorArr[this.expBarColorIndex]),this.refreshExpLayer(),this.unschedule(this.onSkillSelect),this.scheduleOnce(this.onSkillSelect,.5))}},i.onSkillSelect=function(){var e=this;if(!(this.expLvUpCount<=0)){if(g.player.hp>0){this.expProgress.active=!1;var t={};t.lvCount=this.expLvUpCount,this.popLayer(u.layers.SkillSelectLayer,t,(function(){e.expProgress.active=!0}))}g.player.hp>0&&(this.expLvUpCount=0)}},i.popLayer=function(e,t,s){var i=this;this.isShowingLayer(e)||(this.gameFightPause(),this.openLayer(e,t,(function(){i.gameFightResume(),s&&s()})))},i.refreshTimeNode=function(){var e=p.getTimeStr(24e4-1e3*g.time,!0);this.setString(this.timeNode,e)},i.gameFightPause=function(){this.mapSystem.fightPause()},i.gameFightResume=function(){this.mapSystem.fightResume()},i.mapLeaveRet=function(e){N.getInstance().mapData=null,this.closeLayer(),this.openLayer(u.layers.HomeLayer,e)},i.commonResRefreshRet=function(e){this.refreshResLayer()},i.loadSaveMapData=function(e){g.loadSaveData(e.mapModel),g.mapSystem.loadSaveData(e.mapData),g.propSystem.loadSaveData(e.propData),g.weaponSystem.loadSaveData(e.weaponData),g.skillSystem.loadSaveData(e.skillData),g.player.loadSaveData(e.player),g.monsterSystem.loadSaveData(e.monsterData)},i.saveDataBeforeRet=function(e){if(!(g.player.hp<=0)){g.propSystem.saveDataBefore();var t={};t.mapModel=g.getSaveData(),t.mapData=g.mapSystem.getSaveData(),t.propData=g.propSystem.getSaveData(),t.weaponData=g.weaponSystem.getSaveData(),t.skillData=g.skillSystem.getSaveData(),t.player=g.player.getSaveData(),t.monsterData=g.monsterSystem.getSaveData(),N.getInstance().mapData=t}},i.onClickBtnPause=function(e){this.popLayer(u.layers.PauseLayer)},i.onClickBtnClose=function(e){B.send(d.mapLeave)},i.onClickBtnSkillSelectLayer=function(){this.popLayer(u.layers.SkillSelectLayer)},i.onClickBtnResume=function(){this.gameFightResume()},i.onClickBtnBoss=function(){g.time<300?g.time=295:g.time<600&&g.time>305?g.time=595:g.time>605&&(g.time=895)},i.onClickBtnLuckyDraw=function(){this.popLayer(u.layers.BoxMonsterLayer)},i.onClickBtnAccountClear=function(){N.getInstance().clearAccountData()},i.onClickBtnMonsterAdd=function(){this.monsterAddFlag||(this.monsterAddFlag=0),this.monsterAddFlag++},s}(f))||I);s._RF.pop()}}}));

System.register("chunks:///_virtual/mapModel.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./utilTools.ts","./constants.ts","./msgac.ts","./designManager.ts","./resManager.ts","./serverMsg.ts","./playerModel.ts"],(function(t){var i,e,s,o,a,n,r,h,l,u,m,p,d,c,f,v;return{setters:[function(t){i=t.createClass},function(t){e=t.cclegacy,s=t.view,o=t.find,a=t.Camera,n=t.Prefab,r=t.UITransform,h=t.SpriteFrame},function(t){l=t.cocosUtil},function(t){u=t.utilTools},function(t){m=t.constants},function(t){p=t.msgac},function(t){d=t.designManager},function(t){c=t.resManager},function(t){f=t.serverMsg},function(t){v=t.playerModel}],execute:function(){e._RF.push({},"fac70kABNtOmop0VyXqqBln","mapModel",void 0);var y=function(){function t(){this.visibleHalfSize=void 0,this.mapFightLayer=void 0,this.mapFightCamera=void 0,this.cameraOrthoHeight=void 0,this.mapLayer=void 0,this.player=void 0,this.mapSystem=void 0,this.monsterSystem=void 0,this.bulletSystem=void 0,this.numSystem=void 0,this.skillSystem=void 0,this.weaponSystem=void 0,this.hintSystem=void 0,this.propSystem=void 0,this.mapId=void 0,this.floor=void 0,this.time=void 0,this.expPool=void 0,this.expTypeRow=void 0,this.expNum=void 0,this.expLv=void 0,this.equipIdArr=[],this.coinNum=void 0,this.killMonsterNum=void 0,this.APnum=void 0,this.mapLevelArr=void 0,this.skillAllNum=void 0,this.monsterPrefabObj={},this.bulletPrefabObj={},this.dataRadius=void 0,this.destroyRadius=void 0,this.healAdCount=0}var e=t.prototype;return e.initData=function(t,i){var e=s.getVisibleSize();this.visibleHalfSize={width:.5*e.width,height:.5*e.height},this.dataRadius=.6*e.height,this.destroyRadius=1.5*e.height,this.mapFightCamera=o("CanvasMapFight/Camera").getComponent(a),this.cameraOrthoHeight=this.mapFightCamera.orthoHeight},e.getSaveData=function(){var t={};return t.mapId=this.mapId,t.floor=this.floor,t.time=this.time,t.expPool=this.expPool,t.expTypeRow=this.expTypeRow,t.expNum=this.expNum,t.expLv=this.expLv,t.coinNum=this.coinNum,t.killMonsterNum=this.killMonsterNum,t.mapLevelArr=this.mapLevelArr,t.skillAllNum=this.skillAllNum,t.equipIdArr=this.equipIdArr,t.healAdCount=this.healAdCount,t.APnum=this.APnum,t},e.loadSaveData=function(t){this.mapId=t.mapId,this.floor=t.floor,this.time=t.time,this.expPool=t.expPool,this.expTypeRow=t.expTypeRow,this.expNum=t.expNum,this.expLv=t.expLv,this.coinNum=t.coinNum,this.killMonsterNum=t.killMonsterNum,this.mapLevelArr=t.mapLevelArr,this.skillAllNum=t.skillAllNum,this.equipIdArr=t.equipIdArr,this.healAdCount=t.healAdCount,this.APnum=t.APnum},e.enterMapWithMapId=function(t,i){void 0===i&&(i=0);var e={};e.mapId=t,e.floor=i,f.send(p.mapEnter,e)},e.loadMapFightLayer=function(){var t=this;return new Promise((function(i){t.mapFightLayer?i(1):c.loadAsset(m.bundles.layer,m.layers.MapFightLayer,n,(function(){}),(function(e,s){t.mapFightLayer=l.instantiate(s),t.mapFightLayer.parent=o("CanvasMapFight"),i(1)}))}))},e.setCompoments=function(t,i,e,s,o,a,n,r,h,l){this.mapLayer=t,this.player=i,this.mapSystem=e,this.monsterSystem=s,this.bulletSystem=o,this.numSystem=a,this.weaponSystem=n,this.skillSystem=r,this.hintSystem=h,this.propSystem=l},e.isInScreenVisible=function(t){if(!t||!t.parent)return!1;var i=l.convertToWorldSpace(t),e=l.convertToWorldSpace(this.player.node),s=t.getComponent(r),o=s.width+s.height;return Math.abs(i.x-e.x)<=this.visibleHalfSize.width+o+150&&Math.abs(i.y-e.y)<=this.visibleHalfSize.height+o},e.mapEnter=function(t){if(this.mapId)t.st=2;else{this.mapFightCamera.orthoHeight=this.cameraOrthoHeight;var i=t.mapId;this.mapId=i,this.floor=t.floor;var e=d.getRowById(m.tableName.map,i);this.time=0,this.expPool=0,this.expTypeRow=d.getRowById(m.tableName.expType,100*e.expType+1),this.expNum=0,this.expLv=1,this.coinNum=0,this.killMonsterNum=0,this.APnum=0,this.healAdCount=0,this.skillAllNum=0,this.equipIdArr=[],v.skillBombNum=2,v.skillHealNum=2,v.skillMagnetNum=1,v.skillLifeNum=0,this.createMapLevelArr(),t.st=1}},e.createMapLevelArr=function(){var t=this;this.mapLevelArr=[];var i=d.getRowsByType(m.tableName.level,this.mapId);i&&(console.log(i,"----------rowrowrowrowrowrowrowrowrowrow"),i.forEach((function(i){if(!(i.startTime<=g.time)){var e={};e.id=i.id,e.row=i,e.timeCount=0,e.createCount=0,t.mapLevelArr.push(e)}})))},e.mapLeave=function(t){this.mapId?(this.mapFightLayer.destroy(),this.mapFightLayer=null,this.mapId=0,this.floor=0,t.st=1):t.st=2},e.loadMapRes=function(t,i){var e=this;this.loadMonsterAndBulletRes((function(i){t(i)}),(function(){e.loadMapFightLayer().then((function(){i()}))}))},e.loadMonsterAndBulletRes=function(t,i){var e=1/3,s=0,o=0,a=0,n=function(){t(s*e+o*e+a*e)},r=function(){s+o+a==3&&i()};this.loadMonsterPrefabArr((function(t){s=t,n()}),(function(){s=1,r()})),this.loadBulletRes((function(t){o=t,n()}),(function(){o=1,r()})),this.loadOtherRes((function(t){a=t,n()}),(function(){a=1,r()}))},e.loadOtherRes=function(t,i){var e=d.getRowById(m.tableName.map,this.mapId),s=["map/"+e.bg,"wall/"+e.wall+"_v","wall/"+e.wall+"_h"];c.loadAssetByPathArr(m.bundles.icon,s,h,t,i)},e.loadBulletRes=function(t,i){var e=this;this.bulletPrefabObj={};var s=[];[].forEach((function(t){var i=d.getRowById(m.tableName.bullet,t).prefab;s.push(i)})),c.loadAssetByPathArr(m.bundles.bullet,s,n,t,(function(t){t.forEach((function(t){e.bulletPrefabObj[t.name]=t})),i()}))},e.loadMonsterPrefabArr=function(t,i){var e=this;this.monsterPrefabObj={};var s=[],o=d.getRowsByType(m.tableName.level,this.mapId);u.forArr(o,(function(t){-1==s.indexOf(t.monsterId)&&s.push(t.monsterId)})),s.push(14);var a=[];s.forEach((function(t){var i=d.getRowById(m.tableName.monster,t).prefab+"/monster";a.push(i)})),c.loadAssetByPathArr(m.bundles.monster,a,n,t,(function(t){t.forEach((function(t){var i=t.path.split("/")[0];e.monsterPrefabObj[i]=t})),i()}))},e.parseDesignPropArr=function(t){var i=[];return t.forEach((function(t){var e={Id:t[0],Num:t[1]};i.push(e)})),i},i(t,null,[{key:"instance",get:function(){return this._instance||(this._instance=new t),this._instance}}]),t}();y._instance=void 0;var g=t("mapModel",y.instance);e._RF.pop()}}}));

System.register("chunks:///_virtual/MapSystem.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./utilTools.ts","./constants.ts","./PhysicsWorld.ts","./designManager.ts","./mapModel.ts","./playerModel.ts","./UserData.ts","./AnimationCtrl.ts","./BaseLayer.ts","./ServerCtr.ts"],(function(t){var e,o,i,a,n,s,l,r,h,p,m,d,c,g,u,y,f,v,w,C,b,N,x,P,B,S,L,M,k,T,A,I,R;return{setters:[function(t){e=t.inheritsLoose,o=t.asyncToGenerator,i=t.regeneratorRuntime},function(t){a=t.cclegacy,n=t._decorator,s=t.macro,l=t.instantiate,r=t.Vec3,h=t.BoxCollider2D,p=t.UITransform,m=t.v3,d=t.Vec2,c=t.tween,g=t.view,u=t.Node,y=t.UIOpacity,f=t.Tween,v=t.RenderTexture,w=t.find,C=t.director,b=t.SpriteFrame,N=t.Sprite},function(t){x=t.cocosUtil},function(t){P=t.utilTools},function(t){B=t.constants},function(t){S=t.physicsWorld},function(t){L=t.designManager},function(t){M=t.mapModel},function(t){k=t.playerModel},function(t){T=t.UserData},function(t){A=t.AnimationCtrl},function(t){I=t.BaseLayer},function(t){R=t.default}],execute:function(){var H;a._RF.push({},"c2f8bkzNcBJiq/l+SnYqOo5","MapSystem",void 0);var V=n.ccclass;n.property,t("MapSystem",V("MapSystem")(H=function(t){function a(){for(var e,o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return(e=t.call.apply(t,[this].concat(i))||this).generatedGrids=new Set,e.lastPlayerGridId="",e.mapFightBgLayer=void 0,e.staticNode=void 0,e.bombAnimationCtrl=void 0,e.warnAnimationCtrl=void 0,e.skillBombAniCtrl=void 0,e.bossPosHintAnimationCtrl=void 0,e.boxHintNode=void 0,e.boxArrowNode=void 0,e.mapRow=void 0,e.pauseVal=void 0,e.wallLayer=void 0,e.wallShineNode=void 0,e.wallTopNode=void 0,e.wallBottomNode=void 0,e.wallLeftNode=void 0,e.wallRightNode=void 0,e.wallTopVal=void 0,e.wallBottomVal=void 0,e.wallLeftVal=void 0,e.wallRightVal=void 0,e.wallCenterPos=void 0,e.stopTimeCount=void 0,e.expTimeCount=void 0,e.killMonsterCount=void 0,e.backlifeCount=0,e.skillBombCd=0,e.skillHealCd=0,e.nineForArr=[{x:-1,y:1},{x:0,y:1},{x:1,y:1},{x:-1,y:0},{x:0,y:0},{x:1,y:0},{x:-1,y:-1},{x:0,y:-1},{x:1,y:-1}],e.vec3Obj={nodePos:m(0,0,0)},e}e(a,t);var n=a.prototype;return n.onLoad=function(){t.prototype.onLoad.call(this),101===M.mapId?(this.getNodeByPath("map/bg11").active=!0,this.getNodeByPath("map/bg12").active=!1,this.getNodeByPath("map/bg13").active=!1,this.mapFightBgLayer=this.getNodeByPath("map/bg11")):102===M.mapId?(this.getNodeByPath("map/bg11").active=!1,this.getNodeByPath("map/bg12").active=!0,this.getNodeByPath("map/bg13").active=!1,this.mapFightBgLayer=this.getNodeByPath("map/bg12")):(this.getNodeByPath("map/bg11").active=!1,this.getNodeByPath("map/bg12").active=!1,this.getNodeByPath("map/bg13").active=!0,this.mapFightBgLayer=this.getNodeByPath("map/bg13")),this.wallLayer=this.getNodeByPath("map/wallLayer"),this.wallTopNode=this.getNodeByPath("map/wallLayer/top"),this.wallBottomNode=this.getNodeByPath("map/wallLayer/bottom"),this.wallLeftNode=this.getNodeByPath("map/wallLayer/left"),this.wallRightNode=this.getNodeByPath("map/wallLayer/right"),this.wallShineNode=this.getNodeByPath("map/wallLayer/shine"),this.wallLayer.active=!1,this.staticNode=this.getNodeByPath("static"),this.bombAnimationCtrl=this.getNodeByPath("static/bomb").addComponent(A),this.bombAnimationCtrl.node.active=!1,this.skillBombAniCtrl=this.getNodeByPath("static/skillBomb").addComponent(A),this.skillBombAniCtrl.node.active=!1,this.warnAnimationCtrl=this.getNodeByPath("static/warn").addComponent(A),this.warnAnimationCtrl.node.active=!1,this.screenAdapterBG(this.warnAnimationCtrl.node),this.bossPosHintAnimationCtrl=this.getNodeByPath("map/bossPosHint").addComponent(A),this.bossPosHintAnimationCtrl.node.active=!1,this.boxHintNode=this.getNodeByPath("static/boxHint"),this.boxHintNode.active=!1,this.boxArrowNode=this.getNodeByPath("static/boxHint/arrow"),x.tweenBreath(this.getNodeByPath("static/boxHint/icon"),.4,1.2),x.tweenBreath(this.getNodeByPath("static/boxHint/arrow/icon"),.2,1.2),this.mapRow=L.getRowById(B.tableName.map,M.mapId),this.expTimeCount=0,this.pauseVal=0,this.killMonsterCount=0,this.stopTimeCount=!1,this.schedule(this.refreshCamera,.5,s.REPEAT_FOREVER),this.schedule(this.updateLogic,.1,s.REPEAT_FOREVER)},n.getGridId=function(t){return Math.floor(t.x/1500)+","+Math.floor(t.y/1500)},n.generatePlantsForGrid=function(t){var e=this;if(!this.generatedGrids.has(t)){this.generatedGrids.add(t);var o=t.split(",").map(Number),i=o[0],a=o[1],n=1500,s=i*n+750,h=a*n+750,p=this.getNodeByPath("map/player/mask"),m=[];101===this.mapRow.id?(p.active=!1,m=[{path:"map/cao",count:5},{path:"map/cao1",count:15},{path:"map/cao2",count:20},{path:"map/gen",count:1},{path:"map/gen1",count:1},{path:"map/gen2",count:1},{path:"map/gu",count:3},{path:"map/gu1",count:2},{path:"map/shu",count:2}]):102===this.mapRow.id?(p.active=!0,m=[{path:"map/cao-001",count:5},{path:"map/cao3",count:5},{path:"map/cao4",count:5},{path:"map/gen-001",count:1},{path:"map/gen3",count:1},{path:"map/gen4",count:1},{path:"map/gu2",count:2},{path:"map/pool",count:1},{path:"map/lion",count:1}]):(p.active=!0,m=[{path:"map/cao5",count:5},{path:"map/cao6",count:5},{path:"map/stone",count:5},{path:"map/hole1",count:1},{path:"map/hole2",count:1}]),m.forEach((function(t){for(var o=t.path,i=t.count,a=0;a<i;a++){var p=s+Math.random()*n-750,m=h+Math.random()*n-750,d=l(e.getNodeByPath(o));d.setPosition(new r(p,m,0)),o.includes("shu")||o.includes("stone")||o.includes("lion")||o.includes("hole")?e.getNodeByPath("map").addChild(d):e.mapFightBgLayer.addChild(d)}}))}},n.showWallLayerTest=function(t,e,o){void 0===o&&(o=200);var i=30,a=2*o,n=2*o,s=l(this.getNodeByPath("map/cao7"));if(s){var r=s.getComponent(h);if(r){s.getComponent(p).width=a,s.getComponent(p).height=i,r.size.width=a,r.size.height=i,s.setPosition(m(t,e+o,0)),this.mapFightBgLayer.addChild(s);var d=l(this.getNodeByPath("map/cao7"));if(d){var c=d.getComponent(h);if(c){d.getComponent(p).width=a,d.getComponent(p).height=i,c.size.width=a,c.size.height=i,d.setPosition(m(t,e-o,0)),this.mapFightBgLayer.addChild(d);var g=l(this.getNodeByPath("map/cao7"));if(g){var u=g.getComponent(h);if(u){g.getComponent(p).width=i,g.getComponent(p).height=n,u.size.width=i,u.size.height=n,g.setPosition(m(t-o,e,0)),this.mapFightBgLayer.addChild(g);var y=l(this.getNodeByPath("map/cao7"));if(y){var f=y.getComponent(h);f?(y.getComponent(p).width=i,y.getComponent(p).height=n,f.size.width=i,f.size.height=n,y.setPosition(m(t+o,e,0)),this.mapFightBgLayer.addChild(y)):console.error("BoxCollider2D not found on right node")}else console.error("Node not found: map/cao2")}else console.error("BoxCollider2D not found on left node")}else console.error("Node not found: map/cao2")}else console.error("BoxCollider2D not found on bottom node")}else console.error("Node not found: map/cao2")}else console.error("BoxCollider2D not found on top node")}else console.error("Node not found: map/cao2")},n.generatePlantsAround=function(t){for(var e=t.split(",").map(Number),o=e[0],i=e[1],a=-1;a<=1;a++)for(var n=-1;n<=1;n++){var s=o+a+","+(i+n);this.generatePlantsForGrid(s)}},n.onEnable=function(){t.prototype.onEnable.call(this)},n.start=function(){var t=this;console.log("---------------- start() ----------------"),this.scheduleOnce((function(){if(!T.getInstance().mapData)for(var e=0;e<20;e++){var o=x.getRectPos(M.player.node,400,700,600,1e3,!0);t.createExp(1,o,!0)}}),1),this.refreshMapFightWindow()},n.onDestroy=function(){t.prototype.onDestroy.call(this)},n.initUI=function(){this.initWallLayer()},n.initWallLayer=function(){var t="wall/"+this.mapRow.wall+"_h";this.setSpriteFrame2(this.wallTopNode,t),this.setSpriteFrame2(this.wallBottomNode,t),t="wall/"+this.mapRow.wall+"_v",this.setSpriteFrame2(this.wallLeftNode,t),this.setSpriteFrame2(this.wallRightNode,t)},n.refreshMapFightWindow=function(){if(M.player){var t=M.player.node.getPosition();t.z=M.mapFightCamera.node.getPosition().z,M.mapFightCamera.node.setPosition(t),this.refreshMapBgLayer()}},n.refreshMapBgLayer=function(){var t=this,e=Math.floor((M.player.node.getPosition().x+512)/1024),o=Math.floor((M.player.node.getPosition().y+512)/1024);this.nineForArr.forEach((function(i,a){var n=t.mapFightBgLayer.children[a];if(n){var s=1024*(e+i.x),l=1024*(o+i.y);n.setPosition(s,l)}}));var i=M.player.node.position,a=this.getGridId(i);this.lastPlayerGridId!==a&&(this.lastPlayerGridId=a,this.generatePlantsAround(a))},n.getSaveData=function(){var t={};t.expTimeCount=this.expTimeCount,t.killMonsterCount=this.killMonsterCount,t.backlifeCount=this.backlifeCount,t.skillBombCd=this.skillBombCd,t.skillHealCd=this.skillHealCd,t.stopTimeCount=this.stopTimeCount,t.orthoHeight=M.mapFightCamera.orthoHeight;var e=null;return this.wallLayer.active&&((e={}).centerPos=this.wallCenterPos),t.wall=e,t},n.loadSaveData=function(t){if(this.expTimeCount=t.expTimeCount,this.killMonsterCount=t.killMonsterCount,this.backlifeCount=t.backlifeCount,this.skillBombCd=t.skillBombCd,this.skillHealCd=t.skillHealCd,this.stopTimeCount=t.stopTimeCount,M.mapFightCamera.orthoHeight=t.orthoHeight,t.wall){var e=t.wall;this.showWallLayer(e.centerPos)}},n.bossDead=function(){this.stopTimeCount=!1,M.mapSystem.hideWallLayer(),2==M.monsterSystem.bossMonster.isBoss?M.mapSystem.doSettlement(!0):M.createMapLevelArr(),M.monsterSystem.bossMonster=null,M.mapLayer.refreshBossHpLayer()},n.doSettlement=function(t){void 0===t&&(t=!1);L.getRowById(B.tableName.map,M.mapId);var e=[],o=M.coinNum;e.push({Id:B.propIds.coin,Num:o}),P.sortArr(e,(function(t,e){var o=L.getRowById(B.tableName.prop,t.Id),i=L.getRowById(B.tableName.prop,e.Id);return o.quality<i.quality}));var i={},a=Math.floor(M.time);i.time=a;var n=T.getInstance().getLevelData(M.mapId);a>=n.Time&&(n.Time=a,T.getInstance().setLevelData(n),i.isBest=!0),i.bestTime=n.Time,T.getInstance().getRewardProp(e),i.isWin=t,i.award=e,console.log("最后的结算奖励！！！！！！",i),console.log("coinNum！！！！！！",M.coinNum),console.log("APnum！！！！！！",M.APnum),console.log("killMonsterNum！！！！！！",M.killMonsterNum);try{this.goEndGame(P.getUserId().toString(),T.getInstance().gameKey,M.coinNum,M.killMonsterNum).then((function(t){M.mapLayer.popLayer(B.layers.SettlementLayer,i)}))}catch(t){console.log("🚀 ~ MapSystem ~ doSettlement ~ error:",t)}},n.goEndGame=function(){var t=o(i().mark((function t(e,o,a,n){return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,R.GetInstance().endGame(e,o,a,n);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e,o,i,a){return t.apply(this,arguments)}}(),n.getMinDisTargetNode=function(t){var e=999999,o=null;return M.monsterSystem.forVisibleMonster((function(i){if(i.node.activeInHierarchy){var a=i.distancePlayer;t&&(a=d.distance(t,i.node.position)),a<e&&(e=i.distancePlayer,o=i.node)}})),M.propSystem.forVisiblePropCollider((function(i){var a=i.node,n=a.getPosition();t||(t=M.player.node.position);var s=d.distance(t,n);s>e||(e=s,o=a)})),o},n.startWarning=function(t){var e=this;t&&(this.warnAnimationCtrl.node.active=!0,this.warnAnimationCtrl.playAnimation(t,!1,(function(){e.warnAnimationCtrl.node.active=!1,"11"==t&&e.cameraMove(M.cameraOrthoHeight+200)})))},n.cameraMove=function(t){t!=M.mapFightCamera.orthoHeight&&c(M.mapFightCamera).to(3,{orthoHeight:t}).start()},n.useSkillHeal=function(){k.skillHealNum--,M.player.useSkillHeal(.25)},n.useSkillMagnet=function(){k.skillMagnetNum--,M.propSystem.getProp(B.propIds.magnet)},n.useSkillBomb=function(){var t=o(i().mark((function t(){var e,o=this;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return k.skillBombNum--,this.skillBombAniCtrl.node.active=!0,this.skillBombAniCtrl.playAnimation("1",!1,(function(){o.skillBombAniCtrl.node.active=!1})),t.next=5,x.waitTimeAsync(this,.8);case 5:e=[],M.monsterSystem.forVisibleMonster((function(t){if(t.row.type==B.monsterTypes.common){var o=t.hp;t.waitHit=!0;var i={};i.monster=t,i.dam=o,e.push(i)}})),M.monsterSystem.batchHitMonster(e),M.bulletSystem.forVisibleMonsterBullet((function(t){t.recycleSelf()}));case 9:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),n.bomb=function(){var t=this;this.bombAnimationCtrl.node.active=!0,this.bombAnimationCtrl.playAnimationOnce("bomb",(function(){t.bombAnimationCtrl.node.active=!1}));var e=[];M.monsterSystem.forVisibleMonster((function(t){if(t.row.type==B.monsterTypes.common&&!(t.distancePlayer>300)){var o=t.hp;t.waitHit=!0;var i={};i.monster=t,i.dam=o,e.push(i)}})),M.monsterSystem.batchHitMonster(e),M.bulletSystem.forVisibleMonsterBullet((function(t){t.recycleSelf()}))},n.monsterDead=function(t,e){var o=L.getRowById(B.tableName.monster,t);if(console.log("🚀 ~ MapSystem ~ monsterDead ~ row:",o),console.log("🚀🚀🚀🚀🚀🚀🚀",o.expProb,P.isProb(o.expProb)),P.isProb(o.expProb)){var i=P.getFloatValue(o.expMin,o.expMax,!0);Math.random()<.2&&this.createExp(i,e,!0)}M.killMonsterNum++,M.APnum++,M.mapLayer.refreshResLayer(),console.log("消灭了一个怪物: ",M.killMonsterNum),console.log("AP数量: ",M.APnum),M.killMonsterNum<=200?M.mapSystem.addCoin(1):(M.killMonsterNum,M.mapSystem.addCoin(2)),31===o.id&&(M.mapSystem.addCoin(10),Math.random()<.1&&M.mapSystem.addCoin(50)),13===o.id&&(M.mapSystem.addCoin(750),Math.random()<.2&&M.mapSystem.addCoin(Math.floor(1001*Math.random())+500)),4===o.id&&(M.mapSystem.addCoin(3e3),M.mapSystem.addCoin(Math.floor(3001*Math.random())+2e3)),this.killMonsterCount++;var a=Math.random(),n=x.getAroundPos(M.player.node,300,g.getVisibleSize().height,!0);a<=.05?M.propSystem.addProp(B.propIds.coin,n):a<=.1&&M.propSystem.addProp(B.propIds.box1,n)},n.createExp=function(t,e,o){if(void 0===o&&(o=!1),!o){if(t>M.expPool&&(t=M.expPool),t<=0)return;M.expPool-=t}var i={};i.num=t,M.propSystem.addProp(B.propIds.exp,e,i)},n.addExp=function(t){M.expNum+=t,M.mapLayer.refreshExpLayer()},n.addCoin=function(t){M.coinNum+=t,M.mapLayer.refreshResLayer()},n.getBoxCollider2DCenterPosition=function(t){var e=t.getComponent(h);if(!e)return console.warn("该节点没有 BoxCollider2D 组件"),null;var o=e.offset,i=(e.size,t.worldScale),a=new r(o.x*i.x,o.y*i.y,0),n=t.getWorldPosition();return new r(n.x+a.x,n.y+a.y,n.z)},n.adjustObstacle=function(t,e){e.parent.setSiblingIndex(M.player.node.getSiblingIndex()+9);var o=null,i=null;t instanceof u?(i=t.getComponent(p),o=t.getPosition()):o=t;var a=e.getComponent(p),n=e.getPosition();if(a&&o){var s=i?i.width/2:0,l=i?i.height/2:0,r=a.width/2,h=a.height/2,m=o.x-s,d=o.x+s,c=o.y+l,g=o.y-l,y=n.x-r,f=n.x+r,v=n.y,w=n.y-h;if(d>y&&m<f&&c>w&&g<v){var C=Math.abs(d-y),b=Math.abs(m-f),N=Math.abs(g-v),x=Math.abs(c-w);C<b&&C<N&&C<x?o.x=y-s-1:b<C&&b<N&&b<x?o.x=f+s+1:N<C&&N<b&&N<x?o.y=v+l+1:x<C&&x<b&&x<N&&(o.y=w-l-1)}t instanceof u&&t.setPosition(o)}},n.adjustFullObstacle=function(t,e){e.parent.setSiblingIndex(M.player.node.getSiblingIndex()+9);var o=null,i=null;t instanceof u?(i=t.getComponent(p),o=t.getPosition()):o=t;var a=e.getComponent(p),n=e.getPosition();if(a&&o){var s=i?i.width/2:0,l=i?i.height/2:0,r=a.width/2,h=a.height/2,m=o.x-s,d=o.x+s,c=o.y+l,g=o.y-l,y=n.x-r,f=n.x+r,v=n.y+h,w=n.y-h;if(d>y&&m<f&&c>w&&g<v){var C=Math.abs(d-y),b=Math.abs(m-f),N=Math.abs(g-v),x=Math.abs(c-w);C<b&&C<N&&C<x?o.x=y-s-1:b<C&&b<N&&b<x?o.x=f+s+1:N<C&&N<b&&N<x?o.y=v+l+1:x<C&&x<b&&x<N&&(o.y=w-l-1)}t instanceof u&&t.setPosition(o)}},n.adjustInWall=function(t,e){if(void 0===e&&(e=0),this.wallLayer.active){var o=null,i=null;t instanceof u?(o=t.getComponent(p),i=t.getPosition(this.vec3Obj.nodePos)):i=t,i.x>=this.wallRightVal&&(i.x=this.wallRightVal),i.x<=this.wallLeftVal&&(i.x=this.wallLeftVal),i.y>=this.wallTopVal&&(i.y=this.wallTopVal),o&&(e=o.height),i.y<=this.wallBottomVal+.4*e&&(i.y=this.wallBottomVal+.4*e),t instanceof u&&(t.position=i)}},n.showWallLayer=function(t){var e=this;this.wallLayer.active=!0;var o=33,i=51,a=32,n=27;2==M.mapId&&(o=36,i=32,a=43,n=55);var s=Math.ceil(1200/o)*o,l=Math.ceil(1500/n)*n;t||((t=M.player.node.getPosition().clone()).y+=400),this.wallCenterPos=t;var r=this.wallTopNode;r.getComponent(p).width=s,r.getComponent(p).height=i,r.getComponent(h).size.width=s,r.getComponent(h).size.height=i;var d=m(t.x,t.y+.5*l,0);r.setPosition(d);var g=this.wallBottomNode;g.getComponent(p).width=r.getComponent(p).width,g.getComponent(p).height=r.getComponent(p).height,g.getComponent(h).size.width=r.getComponent(h).size.width,g.getComponent(h).size.height=r.getComponent(h).size.height,d=m(t.x,t.y-.5*l,0),g.setPosition(d);var u=this.wallLeftNode;u.getComponent(p).width=a,u.getComponent(p).height=l,u.getComponent(h).size.width=a,u.getComponent(h).size.height=l,d=m(t.x-.5*s+.5*a,t.y,0),u.setPosition(d);var v=this.wallRightNode;v.getComponent(p).width=u.getComponent(p).width,v.getComponent(p).height=u.getComponent(p).height,v.getComponent(h).size.width=u.getComponent(h).size.width,v.getComponent(h).size.height=u.getComponent(h).size.height,d=m(t.x+.5*s-.5*a,t.y,0),v.setPosition(d),this.refreshWallSideVal(),this.wallTopNode.getComponent(y).opacity=0,this.wallBottomNode.getComponent(y).opacity=0,this.wallLeftNode.getComponent(y).opacity=0,this.wallRightNode.getComponent(y).opacity=0,this.wallShineNode.active=!0,this.wallShineNode.position=m(t.x,t.y-15),this.wallShineNode.getComponent(p).width=.5*s+10,this.wallShineNode.getComponent(p).height=.5*l+10;var w=this.wallShineNode.getComponent(y);f.stopAllByTarget(w),c(w).to(.3,{opacity:255}).to(.3,{opacity:0}).union().repeat(3).call((function(){e.wallShineNode.active=!1,e.wallTopNode.getComponent(y).opacity=255,e.wallBottomNode.getComponent(y).opacity=255,e.wallLeftNode.getComponent(y).opacity=255,e.wallRightNode.getComponent(y).opacity=255})).start()},n.refreshWallSideVal=function(){this.wallTopVal=this.wallTopNode.position.y-20,this.wallBottomVal=this.wallBottomNode.position.y+30,this.wallLeftVal=this.wallLeftNode.position.x+20,this.wallRightVal=this.wallRightNode.position.x-20},n.hideWallLayer=function(){this.wallLayer.active=!1},n.fightPause=function(){if(this.pauseVal++,!(this.pauseVal>1)){var t=M.mapFightCamera,e=g.getVisibleSize().width,o=g.getVisibleSize().height,i=new v;i.reset({width:e,height:o}),w("Canvas/Camera").active=!1,t.targetTexture=i,C.root.frameMove(0),t.targetTexture=null,w("Canvas/Camera").active=!0;var a=new b;a.texture=i,M.mapLayer.fightCapNode.getComponent(N).spriteFrame=a,M.mapLayer.fightCapNode.active=!0,this.node.active=!1}},n.fightResume=function(){(this.pauseVal--,this.pauseVal>0)||(M.mapFightCamera.targetTexture=null,this.node.active=!0,M.mapLayer.fightCapNode.active=!1,M.player.stopMove())},n.updateLogic=function(t){if(!this.stopTimeCount)for(M.time+=t,this.expTimeCount+=t;this.expTimeCount>=1;)this.expTimeCount--,M.expTypeRow&&(M.time>=M.expTypeRow.startTime&&M.time<=M.expTypeRow.endTime?M.expPool+=M.expTypeRow.expSpeed:M.expTypeRow=L.getRowById(B.tableName.expType,M.expTypeRow.id+1),this.setString(M.mapLayer.expNumNode,M.expPool));M.mapLayer&&M.mapLayer.refreshTimeNode(),M.weaponSystem&&M.weaponSystem.updateLogic(t),M.monsterSystem&&M.monsterSystem.updateLogic(t),M.skillSystem&&M.skillSystem.updateLogic(t),M.propSystem&&M.propSystem.updateLogic(t),M.bulletSystem&&M.bulletSystem.updateLogic(t)},n.updatePhysicsWorld=function(){S.step(M.mapFightLayer)},n.updateBoxHintLayer=function(t){var e=999999,o=null;if(M.player&&M.player.node){var i=M.player.node.position;if(M.propSystem.forAllPropById(B.propIds.box2,(function(t){var a=t.node,n=a.position,s=a.getComponent(p),l=.5*(s.width+s.height);if(!(Math.abs(n.x-i.x)<=M.visibleHalfSize.width+l&&Math.abs(n.y-i.y)<=M.visibleHalfSize.height+l)){var r=d.distance(n,i);r<e&&(e=r,o=t)}})),!o)return void(this.boxHintNode.active=!1);this.boxHintNode.active=!0;var a=o.node.getPosition().subtract(i),n=P.radianToAngle(Math.atan2(a.y,a.x));this.boxArrowNode.angle=n;var s=o.node.position,l=s.x-i.x,r=.5*g.getVisibleSize().width-80;l>r?l=r:l<-r&&(l=-r);var h=s.y-i.y,c=.5*g.getVisibleSize().height-80;h>c-320?h=c-320:h<-c&&(h=-c),this.boxHintNode.position=m(l,h)}},n.getSelectItemArr=function(){var t=[],e=!1;M.weaponSystem.weaponArr.length>=B.design.weaponNum&&(e=!0);for(var o=L.getLastRow(B.tableName.weapon),i=1;i<=o.type;i++){var a=M.weaponSystem.getWeaponInfoByType(i);if(a){if(L.getRowById(B.tableName.weapon,a.id).lv>=B.design.maxLv)continue}else if(e)continue;var n={};n.name=B.tableName.weapon,n.weight=1,n.type=i,n.info=a,t.push(n)}e=!1,M.skillSystem.skillArr.length>=B.design.skillNum&&(e=!0),o=L.getLastRow(B.tableName.skill);for(var s=1;s<=o.type;s++){var l=M.skillSystem.getSkillInfoByType(s);if(l){if(L.getRowById(B.tableName.skill,l.id).lv>=B.design.maxLv)continue}else if(e)continue;var r={};r.name=B.tableName.skill,r.weight=1,r.type=s,r.info=l,t.push(r)}e=!1,M.skillSystem.skill2Arr.length>=B.design.skillNum&&(e=!0),o=L.getLastRow(B.tableName.skill2);for(var h=1;h<=o.type;h++){var p=M.skillSystem.getSkill2InfoByType(h);if(p){if(L.getRowById(B.tableName.skill2,p.id).lv>=B.design.maxLv)continue}else if(e)continue;var m={};m.name=B.tableName.skill2,m.weight=1,m.type=h,m.info=p,t.push(m)}for(t=P.getRowsByWeightAndNum(t,3);t.length<3;){var d={};d.name=B.tableName.prop,d.id=B.propIds.addHpPercent,t.push(d)}return t},n.refreshCamera=function(t){M.mapFightCamera.orthoHeight<=M.cameraOrthoHeight||M.mapFightCamera.orthoHeight--},n.update=function(t){this.updateBoxHintLayer(t)},a}(I))||H);a._RF.pop()}}}));

System.register("chunks:///_virtual/MapWrap.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var e,s,i;return{setters:[function(t){e=t.createClass},function(t){s=t.cclegacy,i=t.js}],execute:function(){s._RF.push({},"4fbd1NgK1VKrJqal2BpBTty","MapWrap",void 0);t("MapWrap",function(){function t(t){if(this._objects=void 0,this._size=0,this._objects=i.createMap(!0),this._size=0,t)for(var e=0;e<t.length;e++)this.set(t[e][0],t[e][1])}var s=t.prototype;return s.clear=function(){this._objects=i.createMap(!0),this._size=0},s.has=function(t){return t in this._objects},s.set=function(t,e){this.has(t)||this._size++,this._objects[t]=e},s.get=function(t){return this.has(t)?this._objects[t]:null},s.delete=function(t){this.has(t)&&(delete this._objects[t],this._size--)},s.keys=function(){var t=Object.keys(this._objects);return t},s.values=function(){var t=this,e=this.keys(),s=[];return e.forEach((function(e){s.push(t.get(e))})),s},s.toArray=function(t){var e=this,s=[];return this.keys().forEach((function(i){s.push([t?parseInt(i):i,e.get(i)])})),s},s.forEach=function(t){for(var e=this.keys(),s=0;s<e.length;s++){var i=t(this._objects[e[s]],e[s]);if(i)return i}},s.rforEach=function(t){for(var e=this.keys(),s=e.length-1;s>=0;s--){var i=t(this._objects[e[s]],e[s]);if(i)return i}},e(t,[{key:"size",get:function(){return this._size},set:function(t){this._size=t}},{key:"objects",set:function(t){this._objects=t}}]),t}());s._RF.pop()}}}));

System.register("chunks:///_virtual/md5.ts",["cc"],(function(n){var r;return{setters:[function(n){r=n.cclegacy}],execute:function(){n("default",(function(n){function r(n){var r=(n>>>24).toString(16),t=(16777215&n).toString(16);return"00".substr(0,2-r.length)+r+"000000".substr(0,6-t.length)+t}function t(n,r,t){return n&r|~n&t}function e(n,r,t){return t&n|~t&r}function u(n,r,t){return n^r^t}function o(n,r,t){return r^(n|~t)}function f(n,r){return n[r+3]<<24|n[r+2]<<16|n[r+1]<<8|n[r]}function c(n){for(var r=[],t=0;t<n.length;t++)if(n.charCodeAt(t)<=127)r.push(n.charCodeAt(t));else for(var e=encodeURIComponent(n.charAt(t)).substr(1).split("%"),u=0;u<e.length;u++)r.push(parseInt(e[u],16));return r}var i=null;if("string"==typeof n)i=c(n);else{if(n.constructor!=Array)return null;if(0===n.length)i=n;else if("string"==typeof n[0])i=function(n){for(var r=[],t=0;t<n.length;t++)r=r.concat(c(n[t]));return r}(n);else{if("number"!=typeof n[0])return null;i=n}}var s=i.length;i.push(128);var a=i.length%64;if(a>56){for(var l=0;l<64-a;l++)i.push(0);a=i.length%64}for(l=0;l<56-a;l++)i.push(0);i=i.concat(function(n){for(var r=[],t=0;t<8;t++)r.push(255&n),n>>>=8;return r}(8*s));var h=1732584193,v=4023233417,g=2562383102,p=271733878,b=0,d=0,y=0,m=0;function A(n,r){return 4294967295&n+r}var R=function(n,r,t,e){var u,o,f=m;m=y,y=d,d=A(d,(u=A(b,A(n,A(r,t))))<<(o=e)&4294967295|u>>>32-o),b=f};for(l=0;l<i.length/64;l++){b=h;var C=64*l;R(t(d=v,y=g,m=p),3614090360,f(i,C),7),R(t(d,y,m),3905402710,f(i,C+4),12),R(t(d,y,m),606105819,f(i,C+8),17),R(t(d,y,m),3250441966,f(i,C+12),22),R(t(d,y,m),4118548399,f(i,C+16),7),R(t(d,y,m),1200080426,f(i,C+20),12),R(t(d,y,m),2821735955,f(i,C+24),17),R(t(d,y,m),4249261313,f(i,C+28),22),R(t(d,y,m),1770035416,f(i,C+32),7),R(t(d,y,m),2336552879,f(i,C+36),12),R(t(d,y,m),4294925233,f(i,C+40),17),R(t(d,y,m),2304563134,f(i,C+44),22),R(t(d,y,m),1804603682,f(i,C+48),7),R(t(d,y,m),4254626195,f(i,C+52),12),R(t(d,y,m),2792965006,f(i,C+56),17),R(t(d,y,m),1236535329,f(i,C+60),22),R(e(d,y,m),4129170786,f(i,C+4),5),R(e(d,y,m),3225465664,f(i,C+24),9),R(e(d,y,m),643717713,f(i,C+44),14),R(e(d,y,m),3921069994,f(i,C),20),R(e(d,y,m),3593408605,f(i,C+20),5),R(e(d,y,m),38016083,f(i,C+40),9),R(e(d,y,m),3634488961,f(i,C+60),14),R(e(d,y,m),3889429448,f(i,C+16),20),R(e(d,y,m),568446438,f(i,C+36),5),R(e(d,y,m),3275163606,f(i,C+56),9),R(e(d,y,m),4107603335,f(i,C+12),14),R(e(d,y,m),1163531501,f(i,C+32),20),R(e(d,y,m),2850285829,f(i,C+52),5),R(e(d,y,m),4243563512,f(i,C+8),9),R(e(d,y,m),1735328473,f(i,C+28),14),R(e(d,y,m),2368359562,f(i,C+48),20),R(u(d,y,m),4294588738,f(i,C+20),4),R(u(d,y,m),2272392833,f(i,C+32),11),R(u(d,y,m),1839030562,f(i,C+44),16),R(u(d,y,m),4259657740,f(i,C+56),23),R(u(d,y,m),2763975236,f(i,C+4),4),R(u(d,y,m),1272893353,f(i,C+16),11),R(u(d,y,m),4139469664,f(i,C+28),16),R(u(d,y,m),3200236656,f(i,C+40),23),R(u(d,y,m),681279174,f(i,C+52),4),R(u(d,y,m),3936430074,f(i,C),11),R(u(d,y,m),3572445317,f(i,C+12),16),R(u(d,y,m),76029189,f(i,C+24),23),R(u(d,y,m),3654602809,f(i,C+36),4),R(u(d,y,m),3873151461,f(i,C+48),11),R(u(d,y,m),530742520,f(i,C+60),16),R(u(d,y,m),3299628645,f(i,C+8),23),R(o(d,y,m),4096336452,f(i,C),6),R(o(d,y,m),1126891415,f(i,C+28),10),R(o(d,y,m),2878612391,f(i,C+56),15),R(o(d,y,m),4237533241,f(i,C+20),21),R(o(d,y,m),1700485571,f(i,C+48),6),R(o(d,y,m),2399980690,f(i,C+12),10),R(o(d,y,m),4293915773,f(i,C+40),15),R(o(d,y,m),2240044497,f(i,C+4),21),R(o(d,y,m),1873313359,f(i,C+32),6),R(o(d,y,m),4264355552,f(i,C+60),10),R(o(d,y,m),2734768916,f(i,C+24),15),R(o(d,y,m),1309151649,f(i,C+52),21),R(o(d,y,m),4149444226,f(i,C+16),6),R(o(d,y,m),3174756917,f(i,C+44),10),R(o(d,y,m),718787259,f(i,C+8),15),R(o(d,y,m),3951481745,f(i,C+36),21),h=A(h,b),v=A(v,d),g=A(g,y),p=A(p,m)}return function(n,t,e,u){for(var o="",f=0,c=0,i=3;i>=0;i--)f=255&(c=arguments[i]),f<<=8,f|=255&(c>>>=8),f<<=8,f|=255&(c>>>=8),f<<=8,o+=r(f|=c>>>=8);return o}(p,g,v,h)})),r._RF.push({},"3249aWV0bVIlbczR66bh5KU","md5",void 0),r._RF.pop()}}}));

System.register("chunks:///_virtual/Monster.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./constants.ts","./designManager.ts","./mapModel.ts","./physicsGroup.ts","./AnimationCtrl.ts","./ShineColor.ts"],(function(t){var e,i,s,o,n,a,h,r,c,l,d,p,m,u,v,y,b,g,f,P,S,M,k;return{setters:[function(t){e=t.inheritsLoose},function(t){i=t.cclegacy,s=t._decorator,o=t.find,n=t.BoxCollider2D,a=t.ProgressBar,h=t.sp,r=t.v3,c=t.Tween,l=t.view,d=t.macro,p=t.Vec2,m=t.Vec3,u=t.PhysicsSystem2D,v=t.v2,y=t.Component},function(t){b=t.cocosUtil},function(t){g=t.constants},function(t){f=t.designManager},function(t){P=t.mapModel},function(t){S=t.physicsGroup},function(t){M=t.AnimationCtrl},function(t){k=t.ShineColor}],execute:function(){var C;i._RF.push({},"078f39vCbpFAImUpwpfNSnW","Monster",void 0);var O=s.ccclass;s.property,t("Monster",O("Monster")(C=function(t){function i(){for(var e,i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return(e=t.call.apply(t,[this].concat(s))||this).id=void 0,e.hp=0,e.hpMax=void 0,e.atk=0,e.speed=0,e.row=void 0,e.isBoss=0,e.isPauseMove=void 0,e.canFace=!0,e.distancePlayer=void 0,e.bodyNode=void 0,e.collider=void 0,e.hpProgress=void 0,e.isSpine=void 0,e.shineColor=void 0,e.animationCtrl=void 0,e.direction=void 0,e.touchPlayerTimeCount=0,e.targetDirection=void 0,e.vec3Obj={playerPos:r(0,0,0),nodePos:r(0,0,0),nodeScale:r(0,0,0),hpScale:r(0,0,0),bodyNodeScale:r(0,0,0),outVec3:r(0,0,0),vec3Temp:r(0,0,0)},e.raycastDis=0,e.sideRadian=0,e.waitHit=void 0,e.monsterUtil=void 0,e}e(i,t);var s=i.prototype;return s.onLoad=function(){this.bodyNode=o("body",this.node),this.collider=this.node.getComponent(n);var t=o("hpProgress",this.node);t&&(this.hpProgress=t.getComponent(a)),this.bodyNode.getComponent(h.Skeleton)?this.isSpine=!0:this.isSpine=!1,this.shineColor=this.bodyNode.addComponent(k),this.animationCtrl=this.bodyNode.addComponent(M),this.vec3Obj.bodyNodeScale=this.bodyNode.getScale().clone()},s.onEnable=function(){},s.onDisable=function(){},s.onDestroy=function(){},s.setBodySkin=function(){var t=this.bodyNode.getComponent(h.Skeleton);if(t&&this.row.type==g.monsterTypes.boss){var e=1;3!=P.mapId&&4!=P.mapId||(e=2),t.setSkin("skin"+e)}},s.init=function(t){this.bodyNode||this.onLoad(),this.node.setScale(r(1,1,1)),this.unscheduleAllCallbacks(),c.stopAllByTarget(this.node),this.shineColor&&this.shineColor.removeShineColorMaterial(),this.canFace=!0,this.isPauseMove=!1,this.distancePlayer=0,this.touchPlayerTimeCount=0,this.targetDirection=null,this.collider.enabled=!0,this.animationCtrl.playAnimation(g.animations.walk);var e=f.getRowById(g.tableName.monster,t);this.row=e,this.waitHit=!1,this.raycastDis=this.collider.size.width/2,this.sideRadian=Math.random()>.5?Math.PI/2:-Math.PI/2;var i=l.getVisibleSize(),s=b.getRectPos(P.player.node,i.width+100,i.height+100);if(this.node.position=s,this.id=t,this.atk=e.atk,this.hp=e.hp,this.speed=e.speed,P.floor>0){var o=f.getRowById(g.tableName.towerFloor,P.floor),n=this.hp*(1+o.hp/100);this.hp=Math.ceil(n),this.atk=Math.ceil(this.atk*(1+o.atk/100))}if(e.type!=g.monsterTypes.boss){var a=f.getRowById(g.tableName.map,P.mapId),h=1;a&&a.atk>0&&(h=a.atk);var d=1;a&&a.hp>0&&(d=a.hp),this.atk=this.atk*h,this.hp=this.hp*d;for(var p=f.getTable(g.tableName.monsterTimeAdd),m=null,u=0;u<p.length;u++){var v=p[u];if(P.time<=v.time){m=v;break}}m||(m=f.getLastRow(g.tableName.monsterTimeAdd)),this.speed=Math.ceil(this.speed*m.speed),this.hp=Math.ceil(this.hp*m.hp),this.atk=Math.ceil(this.atk*m.atk)}this.hpMax=this.hp,this.isBoss=0,this.refreshHpLayer(),this.setBodySkin();try{var y="Monster"+t;switch(t){case 13:case 16:case 17:y="Monster13";break;case 12:case 18:y="Monster12";break;case 25:y="Monster4";break;case 26:y="Monster5";break;case 27:y="Monster6";break;case 28:y="Monster23";break;case 29:y="Monster22";break;case 30:y="Monster21"}var S=b.addComponentOnce(this,y);S.unscheduleAllCallbacks(),this.monsterUtil=S,S.init(this)}catch(t){}},s.getSaveData=function(){var t={};return t.id=this.id,t.hp=this.hp,t.atk=this.atk,t.pos=this.node.position,t.isBoss=this.isBoss,t},s.loadSaveData=function(t){this.hp=t.hp,this.atk=t.atk,this.node.position=t.pos,this.isBoss=t.isBoss,this.refreshHpLayer(),this.isBoss&&(P.monsterSystem.bossMonster=this,P.mapLayer.refreshBossHpLayer())},s.animationEndCallback=function(t){this.recycleSelf()},s.recycleSelf=function(){P.monsterSystem.recycleMonsterNode(this.node)},s.contactBeginPlayer=function(){this.touchPlayer(),this.unschedule(this.touchPlayer),this.schedule(this.touchPlayer,this.row.touchTime,d.REPEAT_FOREVER)},s.contactEndPlayer=function(){this.unschedule(this.touchPlayer)},s.touchPlayer=function(){this.touchPlayerTimeCount<this.row.touchTime||(this.touchPlayerTimeCount=0,P.player.hitWithDam(this.atk))},s.playerForceMove=function(t){var e=P.player.node.getPosition(),i=this.node.getPosition();e.subtract(i).negative(),p.angle(e,t)>.7*Math.PI||(e.normalize().multiplyScalar(t.length()),i.add(e),this.node.setPosition(i))},s.monsterForceMove=function(t,e){if(!this.isPauseMove){var i=t.node.getPosition(),s=this.node.getPosition();i.subtract(s).negative(),p.angle(i,e)>.7*Math.PI||(i.normalize().multiplyScalar(e.length()),s.add(i),this.node.setPosition(s))}},s.hitWithDam=function(t,e){var i=this;if(!(this.hp<=0||t<=0)){if(t+=P.player.atk,this.bodyNode.scale=this.vec3Obj.bodyNodeScale,b.tweenHitScale(this.bodyNode,.05),this.shineColor&&this.row.type!=g.monsterTypes.boss){var s=g.materials.shineColor;this.isSpine&&(s=g.materials.shineColorSpine),this.shineColor.startShine(s,e)}this.hp-=t,this.hp<0&&(this.hp=0),this.refreshHpLayer(),this.isBoss&&P.mapLayer.bossSubHp(t),this.hp<=0&&(P.mapSystem.monsterDead(this.id,b.convertToWorldSpace(this.node)),this.unschedule(this.touchPlayer),this.collider.enabled=!1,this.animationCtrl.playAnimation(g.animations.die,!1,(function(t){P.monsterSystem.monsterDead(i.id),i.animationEndCallback(t),i.monsterUtil&&i.monsterUtil.selfDead&&i.monsterUtil.selfDead()})),this.monsterUtil&&this.monsterUtil.unscheduleAllCallbacks());var o=null;t>=f.config.damColor2?o="#f56d0a":t>=f.config.damColor1&&(o="#e1b600"),P.numSystem.addNum(t,b.convertToWorldSpace(this.node),o)}},s.refreshHpLayer=function(){this.hpProgress&&(this.hpProgress.progress=this.hp/this.hpMax)},s.setDirection=function(t){this.direction=t.normalize()},s.getBulletDirection=function(){return this.node.getScale().x>0?r(-1,0,0):r(1,0,0)},s.getInfoPosition=function(t,e){var i=this.node.getPosition(),s=o("info",this.node);if(t>0&&(s=o("info"+t,this.node)),s){s.active=!1;var n=s.getPosition();this.node.scale.x<0&&(n.x=-n.x),i.x+=n.x,i.y+=n.y}return e&&(i=b.convertToWorldSpaceWithPos(this.node,i)),i},s.getMoveSpeed=function(){return this.speed},s.updateLogic=function(t){P.player.node.getPosition(this.vec3Obj.playerPos),this.node.getPosition(this.vec3Obj.nodePos);var e=null;e=this.monsterUtil&&this.monsterUtil.getDirection?this.monsterUtil.getDirection():this.vec3Obj.playerPos.subtract(this.vec3Obj.nodePos).normalize();for(var i=null,s=0;s<2;s++){var o=e;1==s&&(o=(o=m.rotateZ(this.vec3Obj.outVec3,e,m.ZERO,this.sideRadian)).normalize());var n=o.multiplyScalar(this.raycastDis);b.vec3CopyVal(this.vec3Obj.vec3Temp,this.vec3Obj.nodePos);var a=this.vec3Obj.vec3Temp.add(n);a=b.convertToWorldSpaceWithPos(this.node,a);for(var h=u.instance.testPoint(v(a.x,a.y)),r=!1,c=0;c<h.length;c++){var l=h[c];if(l!=this.collider&&l.node!=this.node&&l.group==S.MONSTER){r=!0;break}}if(!r){i=o;break}}this.targetDirection=i,this.targetDirection&&(this.targetDirection=this.targetDirection.clone())},s.move=function(t){if(this.touchPlayerTimeCount+=t,!(this.hp<=0)){P.player.node.getPosition(this.vec3Obj.playerPos),this.node.getPosition(this.vec3Obj.nodePos),this.distancePlayer=p.distance(this.vec3Obj.nodePos,this.vec3Obj.playerPos),P.player.hp>0&&this.canFace&&(this.node.getScale(this.vec3Obj.nodeScale),this.hpProgress&&this.hpProgress.node.getScale(this.vec3Obj.hpScale),this.vec3Obj.nodePos.x>=this.vec3Obj.playerPos.x?(this.vec3Obj.nodeScale.x=Math.abs(this.vec3Obj.nodeScale.x),this.hpProgress&&(this.vec3Obj.hpScale.x=1)):(this.vec3Obj.nodeScale.x=-Math.abs(this.vec3Obj.nodeScale.x),this.hpProgress&&(this.vec3Obj.hpScale.x=-1)),this.node.scale=this.vec3Obj.nodeScale,this.hpProgress&&(this.hpProgress.node.scale=this.vec3Obj.hpScale));var e=this.getMoveSpeed();if(!(e<=0||this.isPauseMove)&&(!this.monsterUtil||!this.monsterUtil.moveStop)&&!(this.monsterUtil&&this.monsterUtil.minDisPlayer>0&&this.distancePlayer<=this.monsterUtil.minDisPlayer)&&this.targetDirection){var i=e*t,s=this.targetDirection.normalize().multiplyScalar(i);this.direction=s,this.node.position=this.vec3Obj.nodePos.add(s),this.row.type==g.monsterTypes.boss&&P.mapSystem.adjustInWall(this.node)}}},i}(y))||C);i._RF.pop()}}}));

System.register("chunks:///_virtual/Monster12.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./mapModel.ts","./physicsGroup.ts"],(function(t){var o,n,e,s,i,r,c,l;return{setters:[function(t){o=t.inheritsLoose},function(t){n=t.cclegacy,e=t._decorator,s=t.v3,i=t.Component},function(t){r=t.cocosUtil},function(t){c=t.mapModel},function(t){l=t.physicsGroup}],execute:function(){var u;n._RF.push({},"490d0bRnW5Pn43FXE128xBJ","Monster12",void 0);var a=e.ccclass;e.property,t("Monster12",a("Monster12")(u=function(t){function n(){for(var o,n=arguments.length,e=new Array(n),i=0;i<n;i++)e[i]=arguments[i];return(o=t.call.apply(t,[this].concat(e))||this).monster=void 0,o.moveStop=void 0,o.bulletId=1012,o.outVec3=s(0,0,0),o}o(n,t);var e=n.prototype;return e.init=function(t){var o=this;this.monster=t,this.moveStop=!1,18==this.monster.id&&(this.bulletId=1016),this.scheduleOnce((function(){o.useSkill()}),1+4*Math.random())},e.startSkillLogic=function(){var t=this,o=3+2*Math.random();this.scheduleOnce((function(){t.useSkill()}),o)},e.useSkill=function(){if(!(this.monster.hp<=0)){var t=this.monster.getInfoPosition(),o=c.player.node.getPosition().subtract(t);t=r.convertToWorldSpaceWithPos(this.node,t),c.bulletSystem.addBullet(this.bulletId,l.MONSTER_BULLET,t,o),this.startSkillLogic()}},n}(i))||u);n._RF.pop()}}}));

System.register("chunks:///_virtual/Monster13.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./mapModel.ts","./physicsGroup.ts"],(function(t){var o,e,s,i,n,r,c,l;return{setters:[function(t){o=t.inheritsLoose},function(t){e=t.cclegacy,s=t._decorator,i=t.v3,n=t.Component},function(t){r=t.cocosUtil},function(t){c=t.mapModel},function(t){l=t.physicsGroup}],execute:function(){var u;e._RF.push({},"a63cfrFt9BErbNZKvW8LFyP","Monster13",void 0);var a=s.ccclass;s.property,t("Monster13",a("Monster13")(u=function(t){function e(){for(var o,e=arguments.length,s=new Array(e),n=0;n<e;n++)s[n]=arguments[n];return(o=t.call.apply(t,[this].concat(s))||this).monster=void 0,o.moveStop=void 0,o.bulletId=1013,o.outVec3=i(0,0,0),o}o(e,t);var s=e.prototype;return s.init=function(t){var o=this;this.monster=t,this.moveStop=!1,16==this.monster.id?this.bulletId=1014:17==this.monster.id&&(this.bulletId=1015),this.scheduleOnce((function(){o.useSkill()}),1+2*Math.random())},s.startSkillLogic=function(){var t=this,o=2+Math.random();this.scheduleOnce((function(){t.useSkill()}),o)},s.useSkill=function(){if(!(this.monster.hp<=0)){var t=this.monster.getInfoPosition(),o=c.player.node.getPosition().subtract(t);t=r.convertToWorldSpaceWithPos(this.node,t),c.bulletSystem.addBullet(this.bulletId,l.MONSTER_BULLET,t,o),this.startSkillLogic()}},e}(n))||u);e._RF.pop()}}}));

System.register("chunks:///_virtual/Monster21.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./utilTools.ts","./mapModel.ts","./physicsGroup.ts","./Hint.ts"],(function(t){var o,e,i,n,s,r,l,a,c,h,d,u;return{setters:[function(t){o=t.inheritsLoose},function(t){e=t.cclegacy,i=t._decorator,n=t.find,s=t.BoxCollider2D,r=t.tween,l=t.Component},function(t){a=t.cocosUtil},function(t){c=t.utilTools},function(t){h=t.mapModel},function(t){d=t.physicsGroup},function(t){u=t.HintNames}],execute:function(){var m;e._RF.push({},"a9b34fAHwBDCLZD4fzme57X","Monster21",void 0);var p=i.ccclass;i.property,t("Monster21",p("Monster21")(m=function(t){function e(){for(var o,e=arguments.length,i=new Array(e),n=0;n<e;n++)i[n]=arguments[n];return(o=t.call.apply(t,[this].concat(i))||this).monster=void 0,o.moveStop=void 0,o.bulletId=1017,o.otherCollider1=void 0,o.otherCollider2=void 0,o.otherCollider3=void 0,o}o(e,t);var i=e.prototype;return i.init=function(t){this.monster=t,this.moveStop=!1,this.otherCollider1=n("collider1",this.node).getComponent(s),this.otherCollider2=n("collider2",this.node).getComponent(s),this.otherCollider3=n("collider3",this.node).getComponent(s),this.resetColliders(),this.startSkillLogic()},i.resetColliders=function(){this.otherCollider1.enabled=!1,this.otherCollider2.enabled=!1,this.otherCollider3.enabled=!1},i.startSkillLogic=function(){var t=this;this.scheduleOnce((function(){var o=[{id:2,weight:10},{id:3,weight:10}],e=t.getSkill1Tag();e>0&&o.push({id:1,weight:100,tag:e});var i=c.getRowByWeight(o);i?t["useSkill"+i.id](i):t.startSkillLogic()}),1.5+Math.random())},i.getSkill1Tag=function(){if(this.monster.distancePlayer>=560)return 0;var t=h.player.node.position.clone().subtract(this.node.position),o=a.vec2XAngle(t);return o>=345||o<=15||o>=165&&o<=195?1:o>=30&&o<=60||o>=120&&o<=150?2:o>=300&&o<=330||o>=210&&o<=240?3:0},i.useSkill1=function(t){var o=this;if(!(this.monster.hp<=0)){this.moveStop=!0,this.monster.canFace=!1;var e=this["otherCollider"+t.tag];e.enabled=!0,this.monster.animationCtrl.playAnimationOnce("attackHand"+t.tag,(function(){e.enabled=!1,o.monster.canFace=!0,o.moveStop=!1,o.startSkillLogic()}))}},i.useSkill2=function(){var t=this;if(!(this.monster.hp<=0)){var o=500+100*Math.random(),e={duration:1};e.monster=this.monster,e.dis=o,h.hintSystem.addHint(u.blockArrow,a.convertToWorldSpace(this.node),0,e),this.scheduleOnce((function(){t.moveStop=!0,t.monster.canFace=!1;var e=h.player.node.position.clone();e.subtract(t.node.position).normalize().multiplyScalar(o);var i=t.node.position.clone().add(e);r(t.node).to(1,{position:i},{easing:"smooth",onUpdate:function(){h.mapSystem.adjustInWall(t.node)}}).start(),t.monster.animationCtrl.playAnimationOnce("attack2",(function(){t.monster.canFace=!0,t.moveStop=!1,t.startSkillLogic()}))}),1)}},i.useSkill3=function(){var t=this;if(!(this.monster.hp<=0)){this.moveStop=!0,this.monster.canFace=!1;var o=this.monster.getBulletDirection();this.scheduleOnce((function(){for(var e=function(e){t.scheduleOnce((function(){var i=t.monster.getInfoPosition(e,!0);h.bulletSystem.addBullet(t.bulletId,d.MONSTER_BULLET,i,o)}),.2*e)},i=0;i<4;i++)e(i)}),.45),this.monster.animationCtrl.playAnimationOnce("attack3",(function(){t.moveStop=!1,t.monster.canFace=!0,t.startSkillLogic()}))}},e}(l))||m);e._RF.pop()}}}));

System.register("chunks:///_virtual/Monster22.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./utilTools.ts","./mapModel.ts","./physicsGroup.ts"],(function(t){var o,e,i,n,l,s,r,c;return{setters:[function(t){o=t.inheritsLoose},function(t){e=t.cclegacy,i=t._decorator,n=t.Component},function(t){l=t.cocosUtil},function(t){s=t.utilTools},function(t){r=t.mapModel},function(t){c=t.physicsGroup}],execute:function(){var u;e._RF.push({},"04153lCIxRPN58SJlMutwJu","Monster22",void 0);var a=i.ccclass;i.property,t("Monster22",a("Monster22")(u=function(t){function e(){for(var o,e=arguments.length,i=new Array(e),n=0;n<e;n++)i[n]=arguments[n];return(o=t.call.apply(t,[this].concat(i))||this).monster=void 0,o.moveStop=void 0,o.bulletId=1018,o.bulletId2=1019,o.bulletId3=1020,o}o(e,t);var i=e.prototype;return i.init=function(t){this.monster=t,this.moveStop=!1,this.startSkillLogic()},i.startSkillLogic=function(){var t=this;this.scheduleOnce((function(){var o=s.getRowByWeight([{id:1,weight:10},{id:2,weight:10}]);o?t["useSkill"+o.id]():t.startSkillLogic()}),1.5+Math.random())},i.useSkill1=function(){var t=this;this.monster.hp<=0||(this.moveStop=!0,this.monster.canFace=!1,this.monster.animationCtrl.playAnimationOnce("attack1",(function(){t.monster.canFace=!0,t.moveStop=!1,t.startSkillLogic()})),this.scheduleOnce((function(){r.bulletSystem.addBullet(t.bulletId,c.MONSTER_BULLET,l.convertToWorldSpace(t.node))}),.5))},i.useSkill2=function(){var t=this;if(!(this.monster.hp<=0)){var o=l.getCircleDirectionArr(8);s.forArr(o,(function(o){r.bulletSystem.addBullet(t.bulletId2,c.MONSTER_BULLET,l.convertToWorldSpace(t.node),o,t.bulletId3)})),this.startSkillLogic()}},i.selfDead=function(){r.bulletSystem.addBullet(this.bulletId3,c.MONSTER_BULLET,l.convertToWorldSpace(this.node),null,2)},e}(n))||u);e._RF.pop()}}}));

System.register("chunks:///_virtual/Monster23.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./utilTools.ts","./mapModel.ts","./Hint.ts"],(function(t){var o,i,e,n,s,l,r,c,a;return{setters:[function(t){o=t.inheritsLoose},function(t){i=t.cclegacy,e=t._decorator,n=t.BoxCollider2D,s=t.Component},function(t){l=t.cocosUtil},function(t){r=t.utilTools},function(t){c=t.mapModel},function(t){a=t.HintNames}],execute:function(){var h;i._RF.push({},"5cf27RV66tLlKtXXvh9WZ1E","Monster23",void 0);var d=e.ccclass;e.property,t("Monster23",d("Monster23")(h=function(t){function i(){for(var o,i=arguments.length,e=new Array(i),n=0;n<i;n++)e[n]=arguments[n];return(o=t.call.apply(t,[this].concat(e))||this).monster=void 0,o.moveStop=void 0,o.otherCollider=void 0,o.isFollow=void 0,o.monsterId=14,o}o(i,t);var e=i.prototype;return e.init=function(t){this.monster=t,this.moveStop=!1,this.isFollow=!1,this.otherCollider=this.getComponents(n)[1],this.resetCollider(),this.startSkillLogic()},e.resetCollider=function(){this.otherCollider.enabled=!1},e.startSkillLogic=function(){var t=this;this.scheduleOnce((function(){var o=r.getRowByWeight([{id:1,weight:10},{id:2,weight:10}]);o?t["useSkill"+o.id]():t.startSkillLogic()}),1.5+Math.random())},e.useSkill1=function(){var t=this;this.monster.hp<=0||(this.moveStop=!0,this.monster.canFace=!1,this.isFollow=!0,this.monster.collider.enabled=!1,this.scheduleOnce((function(){t.isFollow=!1}),1),this.scheduleOnce((function(){t.otherCollider.enabled=!0,t.monster.collider.enabled=!0}),1.5),this.monster.animationCtrl.playAnimationOnce("attack1",(function(){t.monster.canFace=!0,t.moveStop=!1,t.resetCollider(),t.startSkillLogic()})))},e.useSkill2=function(){var t=this;if(!(this.monster.hp<=0)){for(var o=0;o<3;o++)this.scheduleOnce((function(){var o=l.getAroundPos(t.node,150+50*Math.random(),300);c.mapSystem.adjustInWall(o,160);var i=l.convertToWorldSpaceWithPos(t.node,o),e={};e.monsterId=t.monsterId,c.hintSystem.addHint(a.targetPos3,i,0,e)}),.6*o);this.startSkillLogic()}},e.update=function(t){this.isFollow&&(this.node.position=c.player.node.getPosition())},i}(s))||h);i._RF.pop()}}}));

System.register("chunks:///_virtual/Monster3.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./mapModel.ts","./physicsGroup.ts"],(function(t){var o,e,n,s,i,r,c,l;return{setters:[function(t){o=t.inheritsLoose},function(t){e=t.cclegacy,n=t._decorator,s=t.v3,i=t.Component},function(t){r=t.cocosUtil},function(t){c=t.mapModel},function(t){l=t.physicsGroup}],execute:function(){var u;e._RF.push({},"44611e5u/BGl7Id3LZROzRs","Monster3",void 0);var a=n.ccclass;n.property,t("Monster3",a("Monster3")(u=function(t){function e(){for(var o,e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return(o=t.call.apply(t,[this].concat(n))||this).monster=void 0,o.moveStop=void 0,o.bulletId=1001,o.outVec3=s(0,0,0),o}o(e,t);var n=e.prototype;return n.init=function(t){var o=this;this.monster=t,this.moveStop=!1,this.scheduleOnce((function(){o.useSkill()}),1+5*Math.random())},n.startSkillLogic=function(){var t=this,o=4+2*Math.random();this.scheduleOnce((function(){t.useSkill()}),o)},n.useSkill=function(){if(!(this.monster.hp<=0)){var t=this.monster.getInfoPosition(),o=c.player.node.getPosition().subtract(t);t=r.convertToWorldSpaceWithPos(this.node,t),c.bulletSystem.addBullet(this.bulletId,l.MONSTER_BULLET,t,o),this.startSkillLogic()}},e}(i))||u);e._RF.pop()}}}));

System.register("chunks:///_virtual/Monster4.ts",["./rollupPluginModLoBabelHelpers.js","cc","./utilTools.ts","./mapModel.ts","./physicsGroup.ts"],(function(t){var e,o,n,i,l,s,r,u,c;return{setters:[function(t){e=t.inheritsLoose},function(t){o=t.cclegacy,n=t._decorator,i=t.Vec3,l=t.v3,s=t.Component},function(t){r=t.utilTools},function(t){u=t.mapModel},function(t){c=t.physicsGroup}],execute:function(){var a;o._RF.push({},"5e9e085vcxPeYkzY2qlwIgU","Monster4",void 0);var h=n.ccclass;n.property,t("Monster4",h("Monster4")(a=function(t){function o(){for(var e,o=arguments.length,n=new Array(o),i=0;i<o;i++)n[i]=arguments[i];return(e=t.call.apply(t,[this].concat(n))||this).monster=void 0,e.moveStop=void 0,e.bulletId1=1002,e.bulletId2=1003,e.minDisPlayer=300,e.outVec3=l(0,0,0),e}e(o,t);var n=o.prototype;return n.init=function(t){this.monster=t,this.moveStop=!1,this.startSkillLogic()},n.startSkillLogic=function(){var t=this;this.scheduleOnce((function(){var e=Math.random();e<.4?t.useSkill1():e<.7?t.useSkill1(3):t.useSkill2()}),2)},n.useSkill2=function(){var t=this;this.monster.hp<=0||(this.moveStop=!0,this.monster.animationCtrl.playAnimationOnce("attack",(function(){t.startSkillLogic(),t.moveStop=!1})),this.scheduleOnce((function(){var e=t.monster.getInfoPosition(0,!0),o=t.monster.getBulletDirection();u.bulletSystem.addBullet(t.bulletId2,c.MONSTER_BULLET,e,o)}),.5))},n.useSkill1=function(t){var e=this;void 0===t&&(t=1),this.monster.hp<=0||(this.monster.animationCtrl.playAnimationOnce("attack",(function(){e.startSkillLogic()})),this.scheduleOnce((function(){var o=e.monster.getInfoPosition(0,!0),n=e.monster.getBulletDirection();if(u.bulletSystem.addBullet(e.bulletId1,c.MONSTER_BULLET,o,n),3==t){var l=r.angleToRadian(50),s=i.rotateZ(e.outVec3,n,i.ZERO,l);u.bulletSystem.addBullet(e.bulletId1,c.MONSTER_BULLET,o,s);var a=i.rotateZ(e.outVec3,n,i.ZERO,-l);u.bulletSystem.addBullet(e.bulletId1,c.MONSTER_BULLET,o,a)}}),.5))},o}(s))||a);o._RF.pop()}}}));

System.register("chunks:///_virtual/Monster5.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./utilTools.ts","./constants.ts","./mapModel.ts","./physicsGroup.ts"],(function(t){var o,e,i,n,r,s,l,a,c,h,d;return{setters:[function(t){o=t.inheritsLoose},function(t){e=t.cclegacy,i=t._decorator,n=t.BoxCollider2D,r=t.tween,s=t.Component},function(t){l=t.cocosUtil},function(t){a=t.utilTools},function(t){c=t.constants},function(t){h=t.mapModel},function(t){d=t.physicsGroup}],execute:function(){var u;e._RF.push({},"90aa12+8vBIH4eHQiBCHUgL","Monster5",void 0);var m=i.ccclass;i.property,t("Monster5",m("Monster5")(u=function(t){function e(){for(var o,e=arguments.length,i=new Array(e),n=0;n<e;n++)i[n]=arguments[n];return(o=t.call.apply(t,[this].concat(i))||this).monster=void 0,o.moveStop=void 0,o.otherCollider1=void 0,o.otherCollider2=void 0,o.bulletId=1004,o.otherColliderOffset=void 0,o.otherColliderSize=void 0,o}o(e,t);var i=e.prototype;return i.init=function(t){this.monster=t,this.moveStop=!1,this.otherCollider1=t.getComponents(n)[1],this.otherCollider2=t.getComponents(n)[2],this.resetOtherCollider(),this.startSkillLogic()},i.resetOtherCollider=function(){this.otherCollider1.enabled=!0,this.otherCollider2.enabled=!1},i.startSkillLogic=function(){var t=this,o=2+2*Math.random();this.scheduleOnce((function(){t.monster.hp<=0||(Math.random()<.6?t.attackWithSkill1():t.attackWithSkill2())}),o)},i.attackWithSkill1=function(){var t=this;this.otherCollider1.enabled=!1,this.otherCollider2.enabled=!0,this.monster.animationCtrl.playAnimation("attack1",!0);var o=this.monster.speed;this.monster.speed+=2*o,this.scheduleOnce((function(){t.resetOtherCollider(),t.monster.animationCtrl.playAnimation(c.animations.walk,!0),t.monster.speed=o,t.startSkillLogic()}),3)},i.attackWithSkill2=function(){var t=this;this.monster.animationCtrl.playAnimationOnce("attack2",(function(){t.startSkillLogic()}));var o=this.monster.node.getPosition(),e=h.player.node.getPosition().subtract(o).normalize();e.multiplyScalar(200),o.add(e),r(this.monster.node).to(.5,{position:o},{easing:"quadOut"}).start(),this.scheduleOnce((function(){var o=t.monster.getInfoPosition(),e=l.getCircleDirectionArr(10);o=l.convertToWorldSpaceWithPos(t.monster.node,o),a.forArr(e,(function(e){h.bulletSystem.addBullet(t.bulletId,d.MONSTER_BULLET,o,e)}))}),.5)},e}(s))||u);e._RF.pop()}}}));

System.register("chunks:///_virtual/Monster6.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./utilTools.ts","./mapModel.ts","./physicsGroup.ts"],(function(t){var o,i,n,e,l,s,r,a,c,u,h;return{setters:[function(t){o=t.inheritsLoose},function(t){i=t.cclegacy,n=t._decorator,e=t.BoxCollider2D,l=t.macro,s=t.v3,r=t.Component},function(t){a=t.cocosUtil},function(t){c=t.utilTools},function(t){u=t.mapModel},function(t){h=t.physicsGroup}],execute:function(){var m;i._RF.push({},"d1277cfcSVMebPwJHxH+Lod","Monster6",void 0);var d=n.ccclass;n.property,t("Monster6",d("Monster6")(m=function(t){function i(){for(var o,i=arguments.length,n=new Array(i),e=0;e<i;e++)n[e]=arguments[e];return(o=t.call.apply(t,[this].concat(n))||this).monster=void 0,o.moveStop=void 0,o.bulletId1=1006,o.bulletId2=1007,o.bulletId3=1009,o.numCount=0,o.otherCollider1=void 0,o.outVec3=s(0,0,0),o}o(i,t);var n=i.prototype;return n.init=function(t){this.monster=t,this.moveStop=!1,this.otherCollider1=t.getComponents(e)[1],this.otherCollider1.enabled=!1,this.startSkillLogic()},n.getDirection=function(){var t=this.monster.node.getPosition(),o=u.player.node.getPosition();return t.x<o.x?o.x-=150:o.x+=150,o.subtract(t).normalize(),o},n.startSkillLogic=function(){var t=this,o=1+Math.random();this.scheduleOnce((function(){var o=[{id:3,weight:10},{id:4,weight:20}];t.monster.distancePlayer<=260&&o.push({id:1,weight:20}),t.monster.distancePlayer<=460&&o.push({id:2,weight:10});var i=c.getRowByWeight(o);t["useSkill"+i.id]()}),o)},n.useSkill4=function(){var t=this;this.monster.hp<=0||(this.moveStop=!0,this.monster.animationCtrl.playAnimation("attack4",!0),this.numCount=0,this.schedule((function(){t.numCount++;for(var o=t.monster.getInfoPosition(3,!0),i=a.getCircleDirectionArr(6,150),n=0;n<1;n++){var e=Math.floor(Math.random()*i.length),l=u.player.node.getPosition().add(i[e]);i.splice(e,1),u.bulletSystem.addBullet(t.bulletId3,h.MONSTER_BULLET,o,null,l)}t.numCount>=3&&(t.moveStop=!1,t.monster.animationCtrl.playAnimation("walk",!0),t.unscheduleAllCallbacks(),t.startSkillLogic())}),2,l.REPEAT_FOREVER,0))},n.useSkill3=function(){var t=this;if(!(this.monster.hp<=0)){this.moveStop=!0,this.monster.animationCtrl.playAnimationOnce("attack3",(function(){t.moveStop=!1,t.startSkillLogic()}));var o=this.monster.getInfoPosition(2,!0);u.bulletSystem.addBullet(this.bulletId2,h.MONSTER_BULLET,o,null)}},n.useSkill2=function(){var t=this;this.monster.hp<=0||(this.moveStop=!0,this.monster.canFace=!1,this.monster.animationCtrl.playAnimationOnce("attack2",(function(){t.moveStop=!1,t.monster.canFace=!0,t.startSkillLogic()})),this.scheduleOnce((function(){var o=t.monster.getInfoPosition(0,!0);u.bulletSystem.addBullet(t.bulletId1,h.MONSTER_BULLET,o)}),1))},n.useSkill1=function(){var t=this;this.monster.hp<=0||(this.moveStop=!0,this.monster.animationCtrl.playAnimationOnce("attack1",(function(){t.moveStop=!1,t.otherCollider1.enabled=!1,t.startSkillLogic()})),this.scheduleOnce((function(){t.otherCollider1.enabled=!0}),.05))},i}(r))||m);i._RF.pop()}}}));

System.register("chunks:///_virtual/Monster9.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./mapModel.ts","./physicsGroup.ts"],(function(t){var o,n,e,s,i,r,c,l;return{setters:[function(t){o=t.inheritsLoose},function(t){n=t.cclegacy,e=t._decorator,s=t.v3,i=t.Component},function(t){r=t.cocosUtil},function(t){c=t.mapModel},function(t){l=t.physicsGroup}],execute:function(){var u;n._RF.push({},"b228bANq/1HwZcJHQi6DMzs","Monster9",void 0);var a=e.ccclass;e.property,t("Monster9",a("Monster9")(u=function(t){function n(){for(var o,n=arguments.length,e=new Array(n),i=0;i<n;i++)e[i]=arguments[i];return(o=t.call.apply(t,[this].concat(e))||this).monster=void 0,o.moveStop=void 0,o.bulletId=1011,o.outVec3=s(0,0,0),o}o(n,t);var e=n.prototype;return e.init=function(t){var o=this;this.monster=t,this.moveStop=!1,this.scheduleOnce((function(){o.useSkill()}),1+3*Math.random())},e.startSkillLogic=function(){var t=this,o=3+1*Math.random();this.scheduleOnce((function(){t.useSkill()}),o)},e.useSkill=function(){if(!(this.monster.hp<=0)){var t=this.monster.getInfoPosition(),o=c.player.node.getPosition().subtract(t);t=r.convertToWorldSpaceWithPos(this.node,t),c.bulletSystem.addBullet(this.bulletId,l.MONSTER_BULLET,t,o),this.startSkillLogic()}},n}(i))||u);n._RF.pop()}}}));

System.register("chunks:///_virtual/MonsterSystem.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./utilTools.ts","./constants.ts","./designManager.ts","./mapModel.ts","./playerModel.ts","./BaseLayer.ts","./NodePoolUtil.ts","./Monster.ts"],(function(e){var t,o,r,n,s,i,a,c,m,u,f,d,h,l,p,y,v;return{setters:[function(e){t=e.inheritsLoose,o=e.asyncToGenerator,r=e.regeneratorRuntime},function(e){n=e.cclegacy,s=e._decorator,i=e.macro,a=e.Node,c=e.UITransform},function(e){m=e.cocosUtil},function(e){u=e.utilTools},function(e){f=e.constants},function(e){d=e.designManager},function(e){h=e.mapModel},function(e){l=e.playerModel},function(e){p=e.BaseLayer},function(e){y=e.NodePoolUtil},function(e){v=e.Monster}],execute:function(){var M;n._RF.push({},"91a8cbgectOgIg5lZnN8xP/","MonsterSystem",void 0);var b=s.ccclass;s.property,e("MonsterSystem",b("MonsterSystem")(M=function(e){function n(){for(var t,o=arguments.length,r=new Array(o),n=0;n<o;n++)r[n]=arguments[n];return(t=e.call.apply(e,[this].concat(r))||this).idMonsterLayerObj={},t.monsterCreateArr=[],t.bossMonster=void 0,t.bossCreateInfo=void 0,t.monsterNum=0,t.showMonsterNum=0,t}t(n,e);var s=n.prototype;return s.onLoad=function(){e.prototype.onLoad.call(this),this.schedule(this.refreshMonsterShow,.5,i.REPEAT_FOREVER),this.schedule(this.createMonsterLogic,.1,i.REPEAT_FOREVER)},s.onEnable=function(){e.prototype.onEnable.call(this)},s.getSaveData=function(){var e={arr:[]};return e.bossCreateInfo=this.bossCreateInfo,this.forAliveMonster((function(t){var o=t.getSaveData();e.arr.push(o)})),e},s.loadSaveData=function(e){var t=this;u.forArr(e.arr,(function(e){t.createMonster(e.id).loadSaveData(e)})),this.bossCreateInfo=e.bossCreateInfo,this.bossCreateInfo&&this.createMonsterWithInfo(this.bossCreateInfo.id,this.bossCreateInfo.isBoss,this.bossCreateInfo.warn)},s.refreshMonsterShow=function(e){var t=1,o=3,r=1,n=0,s=[];this.forAliveMonster((function(e,i){var a=d.getRowById(f.tableName.monster,e.id);e.distancePlayer<h.dataRadius||!a.isData?(n++,!i.active&&o>0&&(i.active=!0,o--)):e.distancePlayer<h.destroyRadius?i.active&&r>0&&(r--,i.active=!1):a.type==f.monsterTypes.common&&t>0&&(t--,s.push(i))})),u.forArr(s,(function(e){e.getComponent(v).recycleSelf()})),this.setString(h.mapLayer.showNumNode,n),this.showMonsterNum=n},s.updateMapLevel=function(e){var t=this,o=[];u.forArr(h.mapLevelArr,(function(r){if(r.row.maxNum>0&&r.createCount>=r.row.maxNum)o.push(r.id);else if(r.row.endTime>0&&h.time>r.row.endTime+.5)o.push(r.id);else if(r.row.warn&&!r.hasWarn&&h.time>=r.row.startTime&&!r.row.isBoss&&(r.hasWarn=!0,h.mapSystem.startWarning(r.row.warn)),!(h.time<r.row.startTime)&&(r.timeCount+=e,r.timeCount>=r.row.createTime||0==r.createCount)){if(r.timeCount-=r.row.createTime,r.createCount++,r.row.isBoss)return t.createMonsterWithInfo(r.row.monsterId,r.row.isBoss,r.row.warn),!0;if(t.monsterCreateArr.push({monsterId:r.row.monsterId,isBoss:r.row.isBoss}),l.isRecordAd&&h.mapLayer.monsterAddFlag>0)for(var n=0;n<h.mapLayer.monsterAddFlag;n++)t.monsterCreateArr.push({monsterId:r.row.monsterId,isBoss:r.row.isBoss})}}));var r=[];u.forArr(h.mapLevelArr,(function(e){-1==o.indexOf(e.id)&&r.push(e)})),h.mapLevelArr=r},s.createMonsterLogic=function(e){if(l.isRecordAd||!(this.showMonsterNum>=200))for(var t=Math.ceil(this.monsterCreateArr.length/10),o=0;o<t;o++){var r=this.monsterCreateArr.shift();if(!r)return;this.createMonsterWithInfo(r.monsterId,r.isBoss)}},s.getMonsterLayerNameById=function(e){return"monsterLayer"+e},s.getMonsterLayerById=function(e){var t=this.idMonsterLayerObj[e];if(!t){(t=new a(this.getMonsterLayerNameById(e))).addComponent(c),t.setPosition(0,0),t.parent=this.node,this.idMonsterLayerObj[e]=t;var o=d.getRowById(f.tableName.monster,e);t.addComponent(y).init(h.monsterPrefabObj[o.prefab])}return t},s.createMonster=function(e,t){var o=this.getMonsterLayerById(e).getComponent(y).getNode(),r=m.addComponentOnce(o,v);return r.init(e),t&&(r.node.position=m.convertToNodeSpace(r.node,t)),this.monsterNum++,this.setString(h.mapLayer.monsterNumNode,this.monsterNum),r},s.createMonsterWithInfo=function(){var e=o(r().mark((function e(t,o,n){var s,i,a;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!o){e.next=11;break}if(h.mapSystem.stopTimeCount=!0,h.mapLevelArr=[],this.monsterCreateArr=[],this.bossCreateInfo={id:t,isBoss:o,warn:n},!(this.getMonsterNumByType(f.monsterTypes.elite)>0)){e.next=7;break}return e.abrupt("return");case 7:return h.mapSystem.startWarning(n),e.next=10,m.waitTimeAsync(this,2);case 10:this.bossCreateInfo=void 0;case 11:return s=this.createMonster(t),o&&(s.isBoss=o,(i=h.player.node.getPosition()).y+=400,s.node.position=i,s.monsterUtil.moveStop=!0,s.canFace=!1,s.node.parent.active=!1,s.collider.enabled=!1,this.scheduleOnce((function(){s.node.parent.active=!0,m.tweenScaleIn(s.node,.5,(function(){s.monsterUtil.moveStop=!1,s.canFace=!0,s.collider.enabled=!0}))}),.8),h.mapSystem.bossPosHintAnimationCtrl.node.active=!0,h.mapSystem.bossPosHintAnimationCtrl.node.position=i,h.mapSystem.bossPosHintAnimationCtrl.playAnimation("aa",!1,(function(){h.mapSystem.bossPosHintAnimationCtrl.node.active=!1})),a=[],this.forAliveMonster((function(e){if(e.row.type==f.monsterTypes.common){e.waitHit=!0;var t={};t.monster=e,a.push(t)}})),this.batchHitMonster(a),h.bulletSystem.forVisibleMonsterBullet((function(e){e.recycleSelf()})),h.mapSystem.showWallLayer(),this.bossMonster=s,h.mapLayer.refreshBossHpLayer()),e.abrupt("return",s);case 14:case"end":return e.stop()}}),e,this)})));return function(t,o,r){return e.apply(this,arguments)}}(),s.getMonsterNumByType=function(e){void 0===e&&(e=0);var t=0;return this.forAliveMonster((function(o){e?o.row.type==e&&t++:t++})),t},s.monsterDead=function(e){var t=d.getRowById(f.tableName.monster,e);t.type==f.monsterTypes.boss&&h.mapSystem.bossDead(),e==f.monsterIds.boxMonster&&h.mapLayer.popLayer(f.layers.BoxMonsterLayer),t.type==f.monsterTypes.elite&&this.bossCreateInfo&&this.createMonsterWithInfo(this.bossCreateInfo.id,this.bossCreateInfo.isBoss,this.bossCreateInfo.warn)},s.batchHitMonster=function(e,t){var o=this;void 0===t&&(t=2);!function r(){for(var n=0;n<t;n++){var s=e.shift();if(!s)return;var i=s.monster;if(i.waitHit){var a=i.hp;s.dam&&(a=s.dam),i.hitWithDam(a),i.waitHit=!1}}o.scheduleOnce((function(){r()}))}()},s.recycleMonsterNode=function(e){var t=e.getComponent(v);t.hp=0;var o=t.id;this.getMonsterLayerById(o).getComponent(y).recycleNode(e)},s.forVisibleMonster=function(e){u.forArr(this.node.children,(function(t){u.forArr(t.children,(function(t){if(t.active&&h.isInScreenVisible(t)){var o=t.getComponent(v);o.hp<=0||e(o)}}))}))},s.forAliveMonster=function(e){u.forArr(this.node.children,(function(t){u.forArr(t.children,(function(t){var o=t.getComponent(v);o.hp<=0||e(o,t)}))}))},s.updateLogic=function(e){this.updateMapLevel(e),this.forAliveMonster((function(t){t.updateLogic(e)}))},s.update=function(e){this.forAliveMonster((function(t){t.move(e)}))},n}(p))||M);n._RF.pop()}}}));

System.register("chunks:///_virtual/MoreGameLayer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./msgac.ts","./audioManager.ts","./serverMsg.ts","./BaseUILayer.ts"],(function(e){var o,t,n,i,r,a,c,s,u,l,f;return{setters:[function(e){o=e.applyDecoratedDescriptor,t=e.inheritsLoose,n=e.initializerDefineProperty,i=e.assertThisInitialized},function(e){r=e.cclegacy,a=e._decorator,c=e.Node},function(e){s=e.msgac},function(e){u=e.audioManager},function(e){l=e.serverMsg},function(e){f=e.BaseUILayer}],execute:function(){var p,y,d,h,m,b,g,v,L;r._RF.push({},"388bfp8gIJJB4UpVIPXh61e","MoreGameLayer",void 0);var I=a.ccclass,M=a.property;e("MoreGameLayer",(p=I("MoreGameLayer"),y=M({type:c}),d=M({type:c}),h=M({type:c}),p((g=o((b=function(e){function o(){for(var o,t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return o=e.call.apply(e,[this].concat(r))||this,n(o,"btnClose",g,i(o)),n(o,"audioIconOpen",v,i(o)),n(o,"audioIconClose",L,i(o)),o}t(o,e);var r=o.prototype;return r.onLoad=function(){},r.onEnable=function(){},r.onDisable=function(){e.prototype.onDisable.call(this),this.refreshAudioLayer()},r.onDestroy=function(){e.prototype.onDestroy.call(this)},r.start=function(){},r.closeBless=function(){this.closeLayer()},r.refreshAudioLayer=function(){u.musicVolume>0?(this.audioIconOpen.active=!0,this.audioIconClose.active=!1):(this.audioIconOpen.active=!1,this.audioIconClose.active=!0)},r.onClickBtnHome=function(){l.send(s.mapLeave)},r.onClickBtnAudio=function(){u.musicVolume>0?(u.setMusicVolume(0),u.setEffectVolume(0)):(u.setMusicVolume(1),u.setEffectVolume(1)),this.refreshAudioLayer()},o}(f)).prototype,"btnClose",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),v=o(b.prototype,"audioIconOpen",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),L=o(b.prototype,"audioIconClose",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),m=b))||m));r._RF.pop()}}}));

System.register("chunks:///_virtual/MotionStreakAssemblerUtil.ts",["cc","./cocosUtil.ts","./MotionStreakUtil.ts"],(function(t){var e,r,a,n,i,o;return{setters:[function(t){e=t.cclegacy,r=t.Vec2,a=t.v3,n=t.Color},function(t){i=t.cocosUtil},function(t){o=t.MotionStreakUtil}],execute:function(){e._RF.push({},"56d1c1YouZLQJ6kjxlzyHMV","MotionStreakAssemblerUtil",void 0);new r;var s,u=new r,c=new r;function f(t,e){return t.x=-e.y,t.y=e.x,t}var l=t("MotionStreakAssemblerUtil",{createData:function(t){var e=t.requestRenderData();return e.dataLength=4,e.resize(16,42),e},tmpVec3:a(0,0,0),update:function(t,e){var a,n=t.stroke/2,s=t.node,l=s.getPosition().x,d=s.getPosition().y,v=t.points;if(v.length>1){var x=v[0],p=x.point.x-l,y=x.point.y-d;p*p+y*y<t.minSeg&&(a=x)}a||(a=new o.Point,v.unshift(a)),a.setPoint(l,d),a.time=t.fadeTime+e;var h,m=0;if(!(v.length<2)){var D=t.renderData;this.updateRenderDataCache(t,D);var g=t.color,k=g.r,b=g.g,S=g.b,A=g.a,V=v[1];V.distance=r.subtract(c,a.point,V.point).length(),c.normalize(),V.setDir(c.x,c.y),a.setDir(c.x,c.y),D.dataLength=2*v.length;for(var M=D.data,U=t.fadeTime,C=!1,P=v.length-1;P>=0;P--){var R=v[P],z=R.point,w=R.dir;if(R.time-=e,R.time<0)v.splice(P,1);else{var T=R.time/U,W=v[P-1];if(!C){if(!W){v.splice(P,1);continue}z.x=W.point.x-w.x*T,z.y=W.point.y-w.y*T}C=!0,f(u,w);var _=(T*A<<24>>>0)+(S<<16)+(b<<8)+k,B=m,O=z.x+u.x*n,L=z.y+u.y*n;this.tmpVec3.x=O,this.tmpVec3.y=L;var F=i.convertToWorldSpaceWithPos(s,this.tmpVec3);M[B].x=F.x,M[B].y=F.y,M[B].u=1,M[B].v=T,M[B].color._val=_,B+=1,O=z.x-u.x*n,L=z.y-u.y*n,this.tmpVec3.x=O,this.tmpVec3.y=L,F=i.convertToWorldSpaceWithPos(s,this.tmpVec3),M[B].x=F.x,M[B].y=F.y,M[B].u=0,M[B].v=T,M[B].color._val=_,m+=2}}h=m<=2?0:3*(m-2),D.resize(m,h)}},updateWorldVertexAllData:function(t){for(var e=t.renderData,r=e.floatStride,a=e.data,i=e.chunk.vb,o=0;o<a.length;o++){var s=o*r;i[s+0]=a[o].x,i[s+1]=a[o].y,i[s+2]=a[o].z,i[s+3]=a[o].u,i[s+4]=a[o].v,n.toArray(i,a[o].color,s+5)}},createQuadIndices:function(t,e){var r=t.renderData.chunk.meshBuffer.indexOffset;s=null,s=new Uint16Array(e);for(var a=0,n=e;a<n;a+=2){var i=0+a;s[r++]=i,s[r++]=i+2,s[r++]=i+1,s[r++]=i+1,s[r++]=i+2,s[r++]=i+3}},updateRenderDataCache:function(t,e){e.passDirty&&e.updatePass(t),e.nodeDirty&&e.updateNode(t),e.textureDirty&&t.texture&&(e.updateTexture(t.texture),e.material=t.getRenderMaterial(0)),e.hashDirty&&e.updateHash()},updateRenderData:function(t){},updateColor:function(t){},fillBuffers:function(t,e){for(var r=t.renderData,a=r.chunk,i=r.data,o=r.vertexCount,s=r.indexCount,u=a.vb,c=0,f=0;f<o;f++){var l=i[f];u[c++]=l.x,u[c++]=l.y,u[c++]=l.z,u[c++]=l.u,u[c++]=l.v,n.toArray(u,l.color,c),c+=4}a.bufferId;for(var d=a.vertexOffset,v=a.meshBuffer,x=a.meshBuffer.iData,p=v.indexOffset,y=0,h=s;y<h;y+=2){var m=d+y;x[p++]=m,x[p++]=m+2,x[p++]=m+1,x[p++]=m+1,x[p++]=m+2,x[p++]=m+3}v.indexOffset+=r.indexCount,v.setDirty()}}),d=t("MotionStreakAssemblerManager",{getAssembler:function(t){return l}});o.Assembler=d,e._RF.pop()}}}));

System.register("chunks:///_virtual/MotionStreakUtil.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var e,i,r,n,s,a,o,l,u,c;return{setters:[function(t){e=t.applyDecoratedDescriptor,i=t.inheritsLoose,r=t.initializerDefineProperty,n=t.assertThisInitialized,s=t.createClass},function(t){a=t.cclegacy,o=t._decorator,l=t.Texture2D,u=t.UIRenderer,c=t.Vec2}],execute:function(){var h,p,f,b,d,m,_,y,g,D;a._RF.push({},"bd481rJ0FVFF62OVb/xaLFl","MotionStreakUtil",void 0);var x=o.ccclass,v=o.property,k=function(){function t(t,e){this.point=new c,this.dir=new c,this.distance=0,this.time=0,t&&this.point.set(t),e&&this.dir.set(e)}var e=t.prototype;return e.setPoint=function(t,e){this.point.x=t,this.point.y=e},e.setDir=function(t,e){this.dir.x=t,this.dir.y=e},t}();t("MotionStreakUtil",(h=x("MotionStreakUtil"),p=v(l),h(((D=function(t){function e(){for(var e,i=arguments.length,s=new Array(i),a=0;a<i;a++)s[a]=arguments[a];return e=t.call.apply(t,[this].concat(s))||this,r(e,"fadeTime",d,n(e)),r(e,"minSeg",m,n(e)),r(e,"stroke",_,n(e)),r(e,"texture",y,n(e)),r(e,"fastMode",g,n(e)),e._points=[],e}i(e,t);var a=e.prototype;return a.onLoad=function(){this.texture},a.onEnable=function(){t.prototype.onEnable.call(this),this.reset()},a._flushAssembler=function(){var t=e.Assembler.getAssembler(this);this._assembler!==t&&(this._assembler=t),this.renderData||this._assembler&&this._assembler.createData&&(this._renderData=this._assembler.createData(this),this.renderData.material=this.material,this._updateColor())},a.reset=function(){this._points.length=0,this.renderData&&this.renderData.clear()},a.lateUpdate=function(t){this._assembler&&this._assembler.update(this,t)},a._render=function(t){this.texture&&t.commitComp(this,this.renderData,this.texture,this._assembler,null)},s(e,[{key:"points",get:function(){return this._points}}]),e}(u)).Point=k,d=e((b=D).prototype,"fadeTime",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),m=e(b.prototype,"minSeg",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 10}}),_=e(b.prototype,"stroke",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 10}}),y=e(b.prototype,"texture",[p],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),g=e(b.prototype,"fastMode",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),f=b))||f));a._RF.pop()}}}));

System.register("chunks:///_virtual/msgac.ts",["cc"],(function(e){var a;return{setters:[function(e){a=e.cclegacy}],execute:function(){a._RF.push({},"8d1eemYIMJGs7d1DwDd8wBH","msgac",void 0);var r=e("msgac",{openLayer:101,showNotice:102,overDay:103,joystick:104,commonResRefresh:105,globalTouchStart:121,globalTouchMove:122,globalTouchEnd:123,jumpLayer:124,refreshRedPoint:125,saveDataBefore:201,saveDataAfter:202,updateDropData:301,wearDrop:302,playerMsgStart:1e3,energyObjRefresh:1001,playerMsgEnd:1999,mapMsgStart:2e3,mapEnter:2001,mapLeave:2002,mapRefreshSkill:2003,mapMsgEnd:2999,mapGameResume:30004,redPointEvent:30001,homeHideMenu:30002,setTabPage:30003,ac2KeyObj:{},init:function(){for(var e in r){var a=r[e];"number"==typeof a&&(r.ac2KeyObj[a]=e)}}});a._RF.pop()}}}));

System.register("chunks:///_virtual/MsgBoxLayer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./BaseLayer.ts"],(function(t){var o,n,e,r;return{setters:[function(t){o=t.inheritsLoose},function(t){n=t.cclegacy,e=t._decorator},function(t){r=t.BaseLayer}],execute:function(){var i;n._RF.push({},"4fb1d7/p+xFCr60VCYR+/QB","MsgBoxLayer",void 0);var s=e.ccclass;e.property,t("MsgBoxLayer",s("MsgBoxLayer")(i=function(t){function n(){return t.apply(this,arguments)||this}o(n,t);var e=n.prototype;return e.onLoad=function(){t.prototype.onLoad.call(this)},e.onEnable=function(){t.prototype.onEnable.call(this)},e.onDisable=function(){t.prototype.onDisable.call(this)},e.onDestroy=function(){t.prototype.onDestroy.call(this)},e.initUI=function(){var t=this.layerData.hint;this.setString(this.getNodeByPath("ui/hint"),t)},e.processEvent=function(t,o){},e.onButtonClick=function(t,o){},n}(r))||i);n._RF.pop()}}}));

System.register("chunks:///_virtual/myLog.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(n){var e,t;return{setters:[function(n){e=n.createClass},function(n){t=n.cclegacy}],execute:function(){t._RF.push({},"49bd1nqTqNChbAN3BXD0yoE","myLog",void 0);var o=function(){function n(){this.isOpen=!0}var t=n.prototype;return t.i=function(){if(this.isOpen){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];e.unshift((new Date).toLocaleTimeString()),console.info.apply(console,e)}},t.w=function(){if(this.isOpen){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];e.unshift((new Date).toLocaleTimeString()),console.warn.apply(console,e)}},t.e=function(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];e.unshift((new Date).toLocaleTimeString()),console.error.apply(console,e)},e(n,null,[{key:"instance",get:function(){return this._instance||(this._instance=new n),this._instance}}]),n}();o._instance=void 0;n("myLog",o.instance);t._RF.pop()}}}));

System.register("chunks:///_virtual/NewPropInfoLayer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./BaseUILayer.ts"],(function(t){var e,r,n,o,a,i,p,l;return{setters:[function(t){e=t.applyDecoratedDescriptor,r=t.inheritsLoose,n=t.initializerDefineProperty,o=t.assertThisInitialized},function(t){a=t.cclegacy,i=t._decorator,p=t.Label},function(t){l=t.BaseUILayer}],execute:function(){var s,c,u,f,y,h,d,D,b;a._RF.push({},"9c37c7fPeBH4qAxnEKbIF/P","NewPropInfoLayer",void 0);var g=i.ccclass,L=i.property;t("NewPropInfoLayer",(s=g("NewPropInfoLayer"),c=L({type:p,tooltip:"血量"}),u=L({type:p,tooltip:"伤害"}),f=L({type:p,tooltip:"防御"}),s((d=e((h=function(t){function e(){for(var e,r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a))||this,n(e,"HP",d,o(e)),n(e,"Attack",D,o(e)),n(e,"Defense",b,o(e)),e.propData=null,e}r(e,t);var a=e.prototype;return a.onLoad=function(){this.propData=this.layerData.data,console.log(this.propData,"------------ this.propData"),this.HP.string=this.propData.hpAdd,this.Attack.string=this.propData.atkAdd,this.Defense.string=this.propData.defenseAdd},a.start=function(){},a.update=function(t){},a.onClose=function(){this.closeLayer()},e}(l)).prototype,"HP",[c],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),D=e(h.prototype,"Attack",[u],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),b=e(h.prototype,"Defense",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),y=h))||y));a._RF.pop()}}}));

System.register("chunks:///_virtual/NewShopLayer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./BaseUILayer.ts","./audioManager.ts","./ServerCtr.ts","./layerManager.ts","./UserData.ts"],(function(e){var t,a,n,r,o,s,i,c,u,l,h,p,f,y,d;return{setters:[function(e){t=e.applyDecoratedDescriptor,a=e.inheritsLoose,n=e.initializerDefineProperty,r=e.assertThisInitialized,o=e.asyncToGenerator,s=e.regeneratorRuntime},function(e){i=e.cclegacy,c=e._decorator,u=e.Node,l=e.Label},function(e){h=e.BaseUILayer},function(e){p=e.audioManager},function(e){f=e.default},function(e){y=e.layerManager},function(e){d=e.UserData}],execute:function(){var g,m,v,b,D,S,P,B,k;i._RF.push({},"c8400ki689H4ZVF8zy8yXxb","NewShopLayer",void 0);var w=c.ccclass,N=c.property;e("NewShopLayer",(g=w("NewShopLayer"),m=N([u]),v=N([u]),b=N({type:l}),g((P=t((S=function(e){function t(){for(var t,a=arguments.length,o=new Array(a),s=0;s<a;s++)o[s]=arguments[s];return t=e.call.apply(e,[this].concat(o))||this,n(t,"buttons",P,r(t)),n(t,"bodys",B,r(t)),n(t,"detailsText",k,r(t)),t.bgNodes=[],t.rootNode=void 0,t.navTabs=["BUNDLES","GEMSHOP","SPECIALDEALS","VIPPASS"],t.BUNDLES_Data=[],t.GEMSHOP_Data=[],t.SPECIALDEALS_Data=[],t.VIPPASS_Data=[],t}a(t,e);var i=t.prototype;return i.start=function(){var e=o(s().mark((function e(){var t=this;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.rootNode.getChildByName("Loading").active=!0,this.buttons.forEach((function(e,a){var n=e.getChildByName("checked");n&&t.bgNodes.push(n),e.on(u.EventType.TOUCH_END,(function(e){t.onButtonClick(e,a)}),t)})),this.getAllData();case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),i.onLoad=function(){this.rootNode=this.node},i.getDataByType=function(){var e=o(s().mark((function e(t){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,f.GetInstance().getShopListByType(t);case 3:return e.abrupt("return",e.sent);case 6:e.prev=6,e.t0=e.catch(0),console.log("🚀 ~ NewShopLayer ~ getDataByType ~ error:",e.t0);case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t){return e.apply(this,arguments)}}(),i.getAllData=function(){var e=o(s().mark((function e(){var t=this;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.all([this.getDataByType(this.navTabs[0]),this.getDataByType(this.navTabs[1]),this.getDataByType(this.navTabs[2]),this.getDataByType(this.navTabs[3])]).then((function(e){console.log("res",e),t.BUNDLES_Data=e[0],t.GEMSHOP_Data=e[1],t.SPECIALDEALS_Data=e[2],t.VIPPASS_Data=e[3],t.rootNode.getChildByName("Loading").active=!1})));case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),i.onButtonClick=function(e,t){console.log(123),p.playEffect("btnClick");var a=e.target;switch(this.bgNodes.forEach((function(e,a){e.active=a===t})),a.name){case"Bundles":this.showBody("Bundles_body");break;case"GemShop":this.showBody("GemShop_body");break;case"SpecialDeals":this.showBody("SpecialDeals_body");break;case"VIPPass":this.showBody("VIPPass_body")}},i.showBody=function(e){console.log(e),this.bodys.forEach((function(t,a){var n=t.name;t.active=n===e}))},i.clickBtn=function(e,t){console.log(t,"--------????????"),this.rootNode.getChildByName("pleaseconfirm").active=!0,this.detailsText.string='"'+t+'"'},i.shopConFirm=function(){var e=o(s().mark((function e(){var t,a,n,r,o,i,c;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("-=-=-=-=-=-=-=-=--=--=000000"),t=new Map([['"MP Booster Park"',1],['"Energy Refill Pack"',2],['"Starter Pack"',3],['"Holiday Starter Pack"',4],['"Limited-Time Mega Pack"',5],['"Royal Rewards Pass"',6],['"Small Gem Pack"',7],['"Medium Gem Pack"',8],['"Large Gem Pack"',9],['"Mega Gem Pack"',10],['"Ultra Gem Pack"',11],['"Ultimate Gem Pack"',12]]),a=this.detailsText.string,!(n=t.get(a))){e.next=22;break}return r=d.getInstance().getUserWeb3Data(),o=d.getInstance().getUserAddress(),console.log("provider--------交易:",r),i={from:o,to:"0xD2c4d741c7aA1AC568853E7e8B745D0DabDa49dB",value:"0x10"},e.prev=9,e.next=12,r.request({method:"kaia_sendTransaction",params:[i]});case 12:c=e.sent,console.log("Transaction successful, hash:",c),e.next=19;break;case 16:e.prev=16,e.t0=e.catch(9),console.error("Transaction failed:",e.t0);case 19:this.purchaseItem(n),e.next=23;break;case 22:console.warn("Item with name "+a+" not found in itemMap.");case 23:case"end":return e.stop()}}),e,this,[[9,16]])})));return function(){return e.apply(this,arguments)}}(),i.purchaseItem=function(){var e=o(s().mark((function e(t){var a=this;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{f.GetInstance().buyShopItem(t).then((function(){d.getInstance().updateUserData(),y.createNotice("Purchase Successful"),a.rootNode.getChildByName("pleaseconfirm").active=!1})).catch((function(e){console.error("Purchase failed:",e)}))}catch(e){console.log("🚀 ~ NewShopLayer ~ purchaseItem ~ error:",e)}case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),i.closeConfirm=function(){this.rootNode.getChildByName("pleaseconfirm").active=!1},i.update=function(e){},i.onDestroy=function(){e.prototype.onDestroy.call(this)},t}(h)).prototype,"buttons",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),B=t(S.prototype,"bodys",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),k=t(S.prototype,"detailsText",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),D=S))||D));i._RF.pop()}}}));

System.register("chunks:///_virtual/NodePoolUtil.ts",["./rollupPluginModLoBabelHelpers.js","cc","./myLog.ts","./cocosUtil.ts","./utilTools.ts"],(function(e){var o,t,i,n,r,c,s,l;return{setters:[function(e){o=e.inheritsLoose},function(e){t=e.cclegacy,i=e._decorator,n=e.Prefab,r=e.Component},function(e){c=e.myLog},function(e){s=e.cocosUtil},function(e){l=e.utilTools}],execute:function(){var u;t._RF.push({},"84610XoI4JE3psEDQhJyjiP","NodePoolUtil",void 0);var d=i.ccclass;i.property,e("NodePoolUtil",d("NodePoolUtil")(u=function(e){function t(){for(var o,t=arguments.length,i=new Array(t),n=0;n<t;n++)i[n]=arguments[n];return(o=e.call.apply(e,[this].concat(i))||this).itemNode=void 0,o.freeNodeArr=[],o.itemNodeArr=[],o}o(t,e);var i=t.prototype;return i.onLoad=function(){},i.init=function(e){e instanceof n&&(e=s.instantiate(e)),this.itemNode=e},i.getNode=function(){var e=this.freeNodeArr.shift();return e||(this.itemNode||c.e(this.node),(e=s.instantiate(this.itemNode)).parent=this.node),e.active||(e.active=!0),e.use=!0,e},i.recycleNode=function(e){this.itemNode||(this.itemNode=e),e.active=!1,-1==this.freeNodeArr.indexOf(e)&&this.freeNodeArr.push(e),e.use=!1},i.recycleAllNode=function(){var e=this;l.forArr(this.node.children,(function(o){e.recycleNode(o)}))},i.forEachUseNode=function(e){l.forArr(this.node.children,(function(o,t){o.use&&e(o,t)}))},t}(r))||u);t._RF.pop()}}}));

System.register("chunks:///_virtual/NoticeLayer.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var e,o,n,i,s,a,h,r,c,d,p;return{setters:[function(t){e=t.inheritsLoose},function(t){o=t.cclegacy,n=t._decorator,i=t.find,s=t.NodePool,a=t.instantiate,h=t.UITransform,r=t.Label,c=t.v3,d=t.UIOpacity,p=t.Component}],execute:function(){var m;o._RF.push({},"dc0e5fXhFFDZaZfHn86Ba++","NoticeLayer",void 0);var y=n.ccclass;n.property,t("NoticeLayer",y("NoticeLayer")(m=function(t){function o(){for(var e,o=arguments.length,n=new Array(o),i=0;i<o;i++)n[i]=arguments[i];return(e=t.call.apply(t,[this].concat(n))||this).contentLayer=void 0,e.textPool=void 0,e.textItem=void 0,e.maxContentWidth=580,e.minContentWidth=150,e.contentBGAdd=150,e.orignHeight=0,e.spaceY=5,e.status={fadeIn:1,delay:2,fadeOut:3},e.speedY=300,e.speedOpacity=850,e.delayTime=.5,e.moveDy=150,e.fadeOutNode=null,e}e(o,t);var n=o.prototype;return n.onLoad=function(){this.contentLayer=i("contentLayer",this.node),this.textItem=i("contentLayer/textItem",this.node),this.textPool=new s,this.textPool.put(this.textItem),this.textItem=a(this.textItem),this.orignHeight=i("content",this.textItem).getComponent(h).height},n.noticeShow=function(t){var e=this.textPool.get();e||(e=a(this.textItem)),e.active=!0;var o=i("content",e);o.getComponent(h).height=this.orignHeight,o.getComponent(r).overflow=r.Overflow.NONE,o.getComponent(r).string=t+"",o.getComponent(r).updateRenderData(!0);var n=o.getComponent(h).width;n>this.maxContentWidth?(o.getComponent(r).overflow=r.Overflow.SHRINK,o.getComponent(h).width=this.maxContentWidth,o.getComponent(h).height=2*this.orignHeight+10,n=this.maxContentWidth):n<this.minContentWidth&&(n=this.minContentWidth),e.getComponent(h).width=n+this.contentBGAdd,e.getComponent(h).height=o.getComponent(h).height+10,e.setPosition(0,-this.moveDy),e.moveY=this.moveDy,e.moveDy=0,e.setScale(c(1,1,1)),e.getComponent(d).opacity=0,e.status=this.status.fadeIn,e.parent=this.contentLayer},n.createNotice=function(t){this.noticeShow(t+"")},n.update=function(t){var e=this.contentLayer.children,o=[];for(var n in e){var i=e[n];switch(i.status){case this.status.fadeIn:var s=t*this.speedY;(a=i.getPosition()).y+=s,i.setPosition(a),i.moveDy+=s,(r=i.getComponent(d).opacity+this.speedOpacity*t)>255&&(r=255),i.getComponent(d).opacity=r,i.moveDy>=i.moveY&&(i.moveDy=0,i.getComponent(d).opacity=255,i.status=this.status.delay,i.time=0,i.delayTime=this.delayTime);break;case this.status.delay:i.delayTime-=t,i.delayTime<=0&&(i.delayTime=0,i.status=this.status.fadeOut);break;case this.status.fadeOut:if(this.fadeOutNode&&this.fadeOutNode!=i)break;this.fadeOutNode=i;var a,r;s=t*this.speedY;(a=i.getPosition()).y+=s,i.setPosition(a),(r=i.getComponent(d).opacity-this.speedOpacity*t)<0&&(r=0),i.getComponent(d).opacity=r,r<=0&&(o.push(i),this.fadeOutNode=null)}}for(var c in o){var p=o[c];p.parent=null,this.textPool.put(p)}if((e=this.contentLayer.children).length>=2)for(var m=e[e.length-1],y=e.length-2;y>=0;y--){var g=e[y],u=.5*(g.getComponent(h).height+m.getComponent(h).height)+this.spaceY;if(g.position.y-m.position.y<u){var l=g.getPosition();l.y=m.position.y+u,g.setPosition(l)}m=g}},o}(p))||m);o._RF.pop()}}}));

System.register("chunks:///_virtual/NumSystem.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./NodePoolUtil.ts"],(function(o){var t,e,n,i,c,l,s,r,a,d,u,m;return{setters:[function(o){t=o.inheritsLoose},function(o){e=o.cclegacy,n=o._decorator,i=o.find,c=o.v3,l=o.UIOpacity,s=o.Label,r=o.Color,a=o.tween,d=o.Component},function(o){u=o.cocosUtil},function(o){m=o.NodePoolUtil}],execute:function(){var p;e._RF.push({},"0b3cf9KfFVL27ZleqxUIIbA","NumSystem",void 0);var h=n.ccclass;n.property,o("NumSystem",h("NumSystem")(p=function(o){function e(){for(var t,e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return(t=o.call.apply(o,[this].concat(n))||this).numNode=void 0,t.nodePoolUtil=void 0,t}t(e,o);var n=e.prototype;return n.onLoad=function(){this.numNode=i("num",this.node),this.nodePoolUtil=this.addComponent(m),this.nodePoolUtil.recycleNode(this.numNode)},n.addNum=function(o,t,e){var n=this,i=this.nodePoolUtil.getNode(),d=u.convertToNodeSpace(i,t),m=20*Math.random();m=Math.random()>.5?m:-m,d.x+=m,i.setPosition(d),i.setScale(c(1,1,1)),i.getComponent(l).opacity=255,i.getComponent(s).string=""+o,e||(e=r.WHITE),u.setRenderableColor(i,e);var p=20+10*Math.random();a(i).by(.3,{position:c(0,p,0),scale:c(.5,.5,0)}).by(.3,{scale:c(-.3,-.3,0)},{onUpdate:function(o,t){i.getComponent(l).opacity=255*(1-t)}}).call((function(){n.nodePoolUtil.recycleNode(i)})).start()},e}(d))||p);e._RF.pop()}}}));

System.register("chunks:///_virtual/PatrolFastLayer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./sdkManager.ts","./constants.ts","./audioManager.ts","./designManager.ts","./playerModel.ts","./UserData.ts","./PropItemPrefab.ts","./BaseUILayer.ts"],(function(e){var r,t,a,n,o,i,s,c,p,l,d,u,y,f,g,h,w;return{setters:[function(e){r=e.applyDecoratedDescriptor,t=e.inheritsLoose,a=e.initializerDefineProperty,n=e.assertThisInitialized},function(e){o=e.cclegacy,i=e._decorator,s=e.Prefab,c=e.Node,p=e.instantiate},function(e){l=e.sdkManager},function(e){d=e.constants},function(e){u=e.audioManager},function(e){y=e.designManager},function(e){f=e.playerModel},function(e){g=e.UserData},function(e){h=e.PropItemPrefab},function(e){w=e.BaseUILayer}],execute:function(){var L,P,m,I,b,k,v;o._RF.push({},"94dd2Eq0ipFdKO47fygl7FK","PatrolFastLayer",void 0);var _=i.ccclass,A=i.property;e("PatrolFastLayer",(L=_("PatrolFastLayer"),P=A({type:s}),m=A({type:c}),L((k=r((b=function(e){function r(){for(var r,t=arguments.length,o=new Array(t),i=0;i<t;i++)o[i]=arguments[i];return r=e.call.apply(e,[this].concat(o))||this,a(r,"propIten",k,n(r)),a(r,"addPropLayer",v,n(r)),r._rewardArr=[],r}t(r,e);var o=r.prototype;return o.onLoad=function(){e.prototype.onLoad.call(this)},o.start=function(){var e=g.getInstance().getPatrolRewardByTime(60*y.config.towerPressTime);this._rewardArr=e;for(var r=0;r<e.length&&r<2;r++){var t=e[r],a=p(this.propIten);a.getComponent(h).setView(t.Id,t.Num,h.Type_UnWear),a.getComponent(h).setScale(100),this.addPropLayer.addChild(a)}var n=p(this.propIten);n.getComponent(h).setView(0,0,h.Type_UnKnow),n.getComponent(h).setScale(100),this.addPropLayer.addChild(n)},o.onGetRewardTili=function(){u.playEffect("btnClick"),g.getInstance().power<y.config.quickEarn?this.toast("体力不足"):(g.getInstance().usePower(0-y.config.quickEarn),g.getInstance().getRewardProp(this._rewardArr),f.addDayTaskNum(7,y.config.quickEarn),f.addDayTaskNum(8),this.openLayer(d.layers.RewardLayer,{propArr:this._rewardArr}),this.closeLayer())},o.onGetRewardVideo=function(){var e=this;u.playEffect("btnClick"),l.openAd("Quick Pat",(function(r){1==r&&(g.getInstance().getRewardProp(e._rewardArr),e.closeLayer(),e.openLayer(d.layers.RewardLayer,{propArr:e._rewardArr}),f.addDayTaskNum(8))}))},o.closeLayer=function(){u.playEffect("btnClick"),e.prototype.closeLayer.call(this)},r}(w)).prototype,"propIten",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),v=r(b.prototype,"addPropLayer",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),I=b))||I));o._RF.pop()}}}));

System.register("chunks:///_virtual/PatrolLayer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./CountTimeUtil.ts","./utilTools.ts","./constants.ts","./audioManager.ts","./designManager.ts","./RedPointLogicMgr.ts","./UserData.ts","./PropItemPrefab.ts","./BaseUILayer.ts"],(function(t){var e,n,a,r,i,o,l,s,u,c,p,b,d,g,f,m,h,y,P,C,w,L,T,v;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,a=t.initializerDefineProperty,r=t.assertThisInitialized},function(t){i=t.cclegacy,o=t._decorator,l=t.Node,s=t.Label,u=t.Prefab,c=t.instantiate,p=t.tween,b=t.v3,d=t.sp,g=t.Button,f=t.Sprite},function(t){m=t.CountTimeUtil},function(t){h=t.utilTools},function(t){y=t.constants},function(t){P=t.audioManager},function(t){C=t.designManager},function(t){w=t.RedPointLogicMgr},function(t){L=t.UserData},function(t){T=t.PropItemPrefab},function(t){v=t.BaseUILayer}],execute:function(){var I,N,z,B,R,k,S,x,E,M,_,D,U,V,A,F,G,J,j,H,W,X,Y;i._RF.push({},"e1aabDu4XBJPLTRY3gJflVk","PatrolLayer",void 0);var q=o.ccclass,K=o.property;t("PatrolLayer",(I=q("PatrolLayer"),N=K({type:l}),z=K({type:s}),B=K({type:s}),R=K({type:s}),k=K({type:l}),S=K({type:s}),x=K({type:s}),E=K({type:u}),M=K({type:l}),_=K({type:l}),I((V=e((U=function(t){function e(){for(var e,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i))||this,a(e,"btnPatrol",V,r(e)),a(e,"patrolTimelabel",A,r(e)),a(e,"addCoinlabel",F,r(e)),a(e,"addExplabel",G,r(e)),a(e,"addPropLayer",J,r(e)),a(e,"maxPatrolTimelabel",j,r(e)),a(e,"curPatrolTimelabel",H,r(e)),a(e,"propIten",W,r(e)),a(e,"monster",X,r(e)),a(e,"handNode",Y,r(e)),e._rewardArr=[],e}n(e,t);var i=e.prototype;return i.onLoad=function(){t.prototype.onLoad.call(this),this.handNode.active=!1},i.start=function(){var t=this;this.initBtnPatrol(),this.addCoinlabel.string=60*C.config.towerCoin+"/hr",this.addExplabel.string=60*C.config.towerExp+"/hr",this.maxPatrolTimelabel.string="Max Patrol"+C.config.towerTop/60+"hr",this.curPatrolTimelabel.string="Patrol:"+h.getTimeStrChinese(1e3*L.getInstance().getPatrolTime(),!1);var e=L.getInstance().getPatrolReward();this._rewardArr=e,e.forEach((function(e){var n=c(t.propIten);n.getComponent(T).setView(e.Id,e.Num,T.Type_UnWear),n.getComponent(T).setScale(100),t.addPropLayer.addChild(n)}));var n=this.monster;p(this.monster).show().set({position:b(222,-95,0)}).call((function(){n.getComponent(d.Skeleton).animation="walk",n.getComponent(d.Skeleton).loop=!0})).to(1,{position:b(50,-95,0)}).call((function(){n.getComponent(d.Skeleton).animation="die",n.getComponent(d.Skeleton).loop=!1})).delay(.3).hide().delay(.8).union().repeatForever().start()},i.initBtnPatrol=function(){var t=L.getInstance().getPatrolState();if(t>0){this.btnPatrol.getComponent(g).interactable=!1,this.btnPatrol.getComponent(f).grayscale=!0;var e=this;this.btnPatrol.getChildByName("Label").getComponent(m).setTime(t,(function(){e.btnPatrol.getComponent(g).interactable=!0,e.btnPatrol.getComponent(f).grayscale=!1,e.btnPatrol.getChildByName("Label").getComponent(s).string="Claim"})),w.ins().setRPointView(this.btnPatrol,null,!1)}else w.ins().setRPointView(this.btnPatrol,null,!0),this.btnPatrol.getChildByName("Label").getComponent(s).string="Claim",this.handNode.active=!0},i.onGetRewardNormal=function(){P.playEffect("btnClick"),this.handNode.active=!1,L.getInstance().getCurPatrolData(),this.showGetReward(this._rewardArr),this.initBtnPatrol(),this.curPatrolTimelabel.string="Patrol Time:"+h.getTimeStrChinese(1e3*L.getInstance().getPatrolTime(),!1)},i.onGetRewardVideo=function(){P.playEffect("btnClick"),this.handNode.active||this.openLayer(y.layers.PatrolFastLayer)},i.closeLayer=function(){P.playEffect("btnClick"),this.handNode.active||t.prototype.closeLayer.call(this)},e}(v)).prototype,"btnPatrol",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),A=e(U.prototype,"patrolTimelabel",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),F=e(U.prototype,"addCoinlabel",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),G=e(U.prototype,"addExplabel",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),J=e(U.prototype,"addPropLayer",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),j=e(U.prototype,"maxPatrolTimelabel",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),H=e(U.prototype,"curPatrolTimelabel",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),W=e(U.prototype,"propIten",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),X=e(U.prototype,"monster",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Y=e(U.prototype,"handNode",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),D=U))||D));i._RF.pop()}}}));

System.register("chunks:///_virtual/PauseLayer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./constants.ts","./msgac.ts","./audioManager.ts","./designManager.ts","./mapModel.ts","./serverMsg.ts","./BaseLayer.ts","./ItemLayer.ts"],(function(e){var t,i,a,o,n,s,r,l,c,u,h,y;return{setters:[function(e){t=e.inheritsLoose},function(e){i=e.cclegacy,a=e._decorator,o=e.find},function(e){n=e.constants},function(e){s=e.msgac},function(e){r=e.audioManager},function(e){l=e.designManager},function(e){c=e.mapModel},function(e){u=e.serverMsg},function(e){h=e.BaseLayer},function(e){y=e.ItemLayer}],execute:function(){var m;i._RF.push({},"5ccffM3vLNFzaO424mauG8D","PauseLayer",void 0);var d=a.ccclass;a.property,e("PauseLayer",d("PauseLayer")(m=function(e){function i(){for(var t,i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return(t=e.call.apply(e,[this].concat(a))||this).weaponItemLayer=void 0,t.skill1ItemLayer=void 0,t.skill2ItemLayer=void 0,t.audioIconOpen=void 0,t.audioIconClose=void 0,t}t(i,e);var a=i.prototype;return a.onLoad=function(){e.prototype.onLoad.call(this),this.weaponItemLayer=this.getNodeByPath("ui/weaponLayer/bg/itemLayer").addComponent(y),this.skill1ItemLayer=this.getNodeByPath("ui/skill1Layer/itemLayer").addComponent(y),this.skill2ItemLayer=this.getNodeByPath("ui/skill2Layer/itemLayer").addComponent(y),this.audioIconOpen=this.getNodeByPath("btnAudio/open"),this.audioIconClose=this.getNodeByPath("btnAudio/close")},a.onEnable=function(){e.prototype.onEnable.call(this),this.addEventArr([s.mapLeave])},a.onDisable=function(){e.prototype.onDisable.call(this),this.removeEventArr([s.mapLeave])},a.onDestroy=function(){e.prototype.onDestroy.call(this)},a.initUI=function(){this.refreshWeaponLayer(),this.refreshSkill1Layer(),this.refreshSkill2Layer(),this.refreshAudioLayer()},a.refreshAudioLayer=function(){r.musicVolume>0?(this.audioIconOpen.active=!0,this.audioIconClose.active=!1):(this.audioIconOpen.active=!1,this.audioIconClose.active=!0)},a.refreshSkill2Layer=function(){var e=this;this.setNumItemLayer(this.skill2ItemLayer.node,n.design.skillNum,(function(t,i){e.refreshItem(t,i,n.tableName.skill2)}))},a.refreshSkill1Layer=function(){var e=this;this.setNumItemLayer(this.skill1ItemLayer.node,n.design.skillNum,(function(t,i){e.refreshItem(t,i,n.tableName.skill)}))},a.refreshWeaponLayer=function(){var e=this;this.setNumItemLayer(this.weaponItemLayer.node,n.design.weaponNum,(function(t,i){e.refreshItem(t,i,n.tableName.weapon)}))},a.refreshItem=function(e,t,i){var a=null;switch(i){case n.tableName.weapon:a=c.weaponSystem.weaponArr[t-1];break;case n.tableName.skill:a=c.skillSystem.skillArr[t-1];break;case n.tableName.skill2:a=c.skillSystem.skill2Arr[t-1]}var s=o("icon",e),r=o("starLayer",e);if(!a)return s.active=!1,void(r.active=!1);s.active=!0,r.active=!0;var u=l.getRowById(i,a.id);this.setSpriteFrame(s,u.icon),this.setNumItemLayer(r,u.lv,(function(e){var t=o("icon",e),i=o("icon2",e);u.lv>=n.design.maxLv?(t.active=!1,i.active=!0):(t.active=!0,i.active=!1)}))},a.mapLeaveRet=function(e){this.closeLayer()},a.closeLayer=function(){e.prototype.closeLayer.call(this),this.layerCb&&this.layerCb()},a.onClickBtnGoOn=function(e){this.closeLayer()},a.onClickBtnHome=function(){u.send(s.mapLeave)},a.onClickBtnAudio=function(){r.musicVolume>0?(r.setMusicVolume(0),r.setEffectVolume(0)):(r.setMusicVolume(1),r.setEffectVolume(1)),this.refreshAudioLayer()},i}(h))||m);i._RF.pop()}}}));

System.register("chunks:///_virtual/physicsGroup.ts",["cc"],(function(L){var E;return{setters:[function(L){E=L.cclegacy}],execute:function(){E._RF.push({},"7abfb/MfGJL5r7iKar3kd+i","physicsGroup",void 0);L("physicsGroup",function(L){return L[L.DEFAULT=1]="DEFAULT",L[L.PLAYER=2]="PLAYER",L[L.MONSTER=4]="MONSTER",L[L.PLAYER_BULLET=8]="PLAYER_BULLET",L[L.MONSTER_BULLET=16]="MONSTER_BULLET",L[L.PROP=32]="PROP",L[L.WALL=64]="WALL",L[L.PLAYER_BULLET2=128]="PLAYER_BULLET2",L}({}));E._RF.pop()}}}));

System.register("chunks:///_virtual/PhysicsWorld.ts",["cc","./utilTools.ts","./BoxColliderUtil.ts"],(function(o){var r,t,i,e,l,n;return{setters:[function(o){r=o.cclegacy,t=o._decorator,i=o.PhysicsSystem2D,e=o.Intersection2D},function(o){l=o.utilTools},function(o){n=o.BoxColliderUtil}],execute:function(){r._RF.push({},"3f2ff/lDDdLSruB5HOM+uuJ","PhysicsWorld",void 0);t.ccclass,t.property;var c=function(){function o(){this.cellSize=100,this.colliderArr=void 0,this.posToColliderArr={}}o.getInstance=function(){return null==this._instance&&(this._instance=new o),this._instance};var r=o.prototype;return r.getPosKey=function(o,r){return o+"_"+r},r.forColliderRectKeyArr=function(o,r){for(var t=o.worldAabb,i=Math.floor(t.x/this.cellSize),e=Math.ceil((t.x+t.width)/this.cellSize),l=Math.floor(t.y/this.cellSize),n=Math.ceil((t.y+t.height)/this.cellSize),c=i;c<=e;c++)for(var s=l;s<=n;s++){r(this.getPosKey(c,s))}},r.addIntoPosToColliderArr=function(o){var r=this;this.forColliderRectKeyArr(o,(function(t){var i=r.posToColliderArr[t];i||(i=[],r.posToColliderArr[t]=i),i.push(o)}))},r.collectCollider=function(o){var r=this;if(o.active&&o.activeInHierarchy){var t=o.getComponents(n);l.forArr(t,(function(o){o.enabled&&(o.updateCollider(),r.colliderArr.push(o),r.addIntoPosToColliderArr(o))})),l.forArr(o.children,(function(o){r.collectCollider(o)}))}},r.step=function(o){var r=this;this.colliderArr=[],this.posToColliderArr={},this.collectCollider(o),l.forArr(this.colliderArr,(function(o){r.forColliderRectKeyArr(o,(function(t){var i=r.posToColliderArr[t];i&&l.forArr(i,(function(t){r.doIntersection(o,t)}))}))}))},r.doIntersection=function(o,r){if(o!=r&&o.node!=r.node){var t=i.instance.collisionMatrix;if(t[o.group]&r.group&&t[r.group]&o.group)e.polygonPolygon(o.worldPoints,r.worldPoints)?o.contactBegin(r):o.contactEnd(r)}},o}();c._instance=null;o("physicsWorld",c.getInstance());r._RF.pop()}}}));

System.register("chunks:///_virtual/Player.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./utilTools.ts","./constants.ts","./msgac.ts","./designManager.ts","./mapModel.ts","./physicsGroup.ts","./AnimationCtrl.ts","./BaseLayer.ts","./ShineColor.ts","./Monster.ts"],(function(t){var i,e,o,n,s,a,h,r,l,p,d,c,u,m,f,y,g,v,M;return{setters:[function(t){i=t.inheritsLoose},function(t){e=t.cclegacy,o=t._decorator,n=t.Collider2D,s=t.Contact2DType,a=t.Color,h=t.macro,r=t.v3},function(t){l=t.cocosUtil},function(t){p=t.utilTools},function(t){d=t.constants},function(t){c=t.msgac},function(t){u=t.designManager},function(t){m=t.mapModel},function(t){f=t.physicsGroup},function(t){y=t.AnimationCtrl},function(t){g=t.BaseLayer},function(t){v=t.ShineColor},function(t){M=t.Monster}],execute:function(){var S;e._RF.push({},"cf7c7EXLGBBJYgKGeHmF0f7","Player",void 0);var C=o.ccclass;o.property,t("Player",C("Player")(S=function(t){function e(){for(var i,e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return(i=t.call.apply(t,[this].concat(o))||this).moveSpeed=350,i.hp=100,i.hpMax=100,i.hpMaxOrign=100,i.atk=0,i.bodyNode=void 0,i.lightShine=!1,i.collider=void 0,i.animationCtrl=void 0,i.shineColor=void 0,i.hpProgress=void 0,i.movePos=void 0,i.outVec3=r(0,0,0),i.monsterArr=[],i.wallCollider=void 0,i}i(e,t);var o=e.prototype;return o.onLoad=function(){t.prototype.onLoad.call(this),this.collider=this.getComponent(n),this.bodyNode=this.getNodeByPath("body"),this.hpProgress=this.getNodeByPath("hpProgress"),this.animationCtrl=this.bodyNode.addComponent(y),this.shineColor=this.bodyNode.addComponent(v),this.collider.on(s.BEGIN_CONTACT,this.contactBegin,this),this.collider.on(s.END_CONTACT,this.contactEnd,this),this.moveSpeed=u.config.roleSpeed,this.setRoleSkin(this.bodyNode)},o.onEnable=function(){t.prototype.onEnable.call(this),this.addEventArr([c.joystick])},o.onDestroy=function(){},o.initData=function(t){this.hp=t.hp,this.hpMax=this.hp,this.hpMaxOrign=this.hp,this.atk=t.atk,this.initUI()},o.initUI=function(){this.collider.enabled=!0,this.refreshHpLayer()},o.getSaveData=function(){var t={};return t.moveSpeed=this.moveSpeed,t.hp=this.hp,t.hpMax=this.hpMax,t.hpMaxOrign=this.hpMaxOrign,t.atk=this.atk,t.pos=this.node.position,t},o.loadSaveData=function(t){this.moveSpeed=t.moveSpeed,this.hp=t.hp,this.hpMax=t.hpMax,this.hpMaxOrign=t.hpMaxOrign,this.atk=t.atk,this.node.position=t.pos,this.refreshHpLayer()},o.addHpMaxPercent=function(t){var i=this.hpMax,e=this.hpMaxOrign*(1+t),o=(e=Math.round(e))-i;this.hpMax=e,this.addHp(o)},o.addHpPercent=function(t){var i=this.hpMax*t;this.addHp(i)},o.addHp=function(t){this.hp<=0||(t=Math.ceil(t),this.hp+=t,t>0?m.numSystem.addNum(t,l.convertToWorldSpace(this.node),a.GREEN):m.numSystem.addNum(t,l.convertToWorldSpace(this.node),a.RED),this.hp>this.hpMax&&(this.hp=this.hpMax),this.hp<0&&(this.hp=0),this.refreshHpLayer())},o.refreshHpLayer=function(){this.setProgressBar(this.hpProgress,this.hp/this.hpMax)},o.useSkillHeal=function(t){this.addHpPercent(t)},o.backLife=function(){var t=this;this.hp=this.hpMax,this.animationCtrl.playAnimation(d.animations.walk,!0),this.lightShine=!0,this.scheduleOnce((function(){t.lightShine=!1}),3),this.refreshHpLayer(),m.mapLayer.gameFightResume(),m.mapLayer.onSkillSelect()},o.hitWithDam=function(t,i){t<=0||this.hp<=0||this.lightShine||(t*=1-m.skillSystem.getSkill2DamSubPercent(),t=Math.ceil(t),this.addHp(-t),this.shineColor.startShine(d.materials.shineColorSpine,i),this.hp<=0&&(this.collider.enabled=!1,this.animationCtrl.playAnimation(d.animations.die,!1,(function(){m.mapLayer.popLayer(d.layers.BackLifeLayer)}))))},o.addMonster=function(t){if(0==t.tag){var i=t.getComponent(M);-1==this.monsterArr.indexOf(i)&&(i.isPauseMove=!0,this.monsterArr.push(i))}},o.removeMonster=function(t){if(0==t.tag){var i=t.getComponent(M),e=this.monsterArr.indexOf(i);-1!=e&&(i.isPauseMove=!1,this.monsterArr.splice(e,1))}},o.playerForceMove=function(t){var i=m.player.node.getPosition(),e=t.getPosition(),o=i.subtract(e).normalize(),n=e.add(o.multiplyScalar(5));m.player.node.setPosition(n)},o.contactBegin=function(t,i){if(i.group==f.MONSTER){var e=i.getComponent(M);return e||(e=i.node.parent.getComponent(M)),this.addMonster(i),void e.contactBeginPlayer()}if(i.group==f.WALL){if(this.wallCollider=i,[88,99].includes(i.tag))return;return this.touchWall(),this.unschedule(this.touchWall),void this.schedule(this.touchWall,.5,h.REPEAT_FOREVER,0)}},o.contactEnd=function(t,i){if(l.isValid(i)){if(i.group==f.MONSTER){var e=i.getComponent(M);return e||(e=i.node.parent.getComponent(M)),this.removeMonster(i),void e.contactEndPlayer()}if(i.group!=f.WALL);else{if([88,99].includes(i.tag))return;this.wallCollider==i&&this.unschedule(this.touchWall)}}},o.touchWall=function(){var t=.05*this.hpMax;t=Math.ceil(t),this.hitWithDam(t)},o.joystickRet=function(t){if("start"!=t.type)"move"!=t.type?"end"==t.type&&this.stopMove():this.movePos=t.pos;else{if(this.hp<=0)return;this.animationCtrl.playAnimation(d.animations.walk,!0)}},o.stopMove=function(){this.movePos=null,this.hp>0&&this.animationCtrl.playAnimation(d.animations.standBy,!0)},o.getMoveSpeed=function(){return this.moveSpeed*(1+m.skillSystem.getSkill2PlayerSpeedAddPercent())},o.move=function(t){var i,e;if(this.movePos&&!(this.hp<=0)){var o=this.node.getPosition(this.outVec3),n=this.getMoveSpeed()*t,s=this.movePos.clone().multiplyScalar(n);o.add(s),this.node.setPosition(o),m.mapSystem.adjustInWall(this.node),99===(null==(i=this.wallCollider)?void 0:i.tag)?m.mapSystem.adjustObstacle(this.node,this.wallCollider.node):88===(null==(e=this.wallCollider)?void 0:e.tag)&&m.mapSystem.adjustFullObstacle(this.node,this.wallCollider.node);var a=this.bodyNode.getScale();s.x>=0?this.bodyNode.setScale(-Math.abs(a.x),a.y):this.bodyNode.setScale(Math.abs(a.x),a.y),m.mapSystem.refreshMapFightWindow(),this.monsterArr.length>0&&p.forArr(this.monsterArr,(function(t){t.playerForceMove(s.clone())})),this.setString(m.mapLayer.playerPosNode,Math.floor(o.x)+","+Math.floor(o.y))}},o.update=function(t){this.move(t)},e}(g))||S);e._RF.pop()}}}));

System.register("chunks:///_virtual/playerModel.ts",["./rollupPluginModLoBabelHelpers.js","cc","./utilTools.ts","./constants.ts","./msgac.ts","./audioManager.ts","./designManager.ts","./eventManager.ts","./localStorageManager.ts","./mapModel.ts","./UserData.ts"],(function(e){var t,a,i,s,n,r,d,l,o,u,h;return{setters:[function(e){t=e.createClass},function(e){a=e.cclegacy},function(e){i=e.utilTools},function(e){s=e.constants},function(e){n=e.msgac},function(e){r=e.audioManager},function(e){d=e.designManager},function(e){l=e.eventManager},function(e){o=e.localStorageManager},function(e){u=e.mapModel},function(e){h=e.UserData}],execute:function(){a._RF.push({},"49378vbq+FDaLOtxpJMRyYQ","playerModel",void 0);var m=function(){function e(){this.now=new Date,this.secondInterval=void 0,this.saveTime=void 0,this.skillFreeRefreshCount=0,this.isOpenDev=!1,this.isRecordAd=!1,this.dayTaskObj={},this.energyObj={},this.daySignObj={},this.vipObj={},this.shareObj={},this.isLetterAward=0,this.skillBombNum=2,this.skillHealNum=0,this.skillMagnetNum=1,this.skillLifeNum=0}var a=e.prototype;return a.init=function(){var e=new Date,t=h.getInstance().playerData;i.timeStrToDate(t),r.initData(t.audio),this.initData(t.player,e),u.initData(t.fight,e),this.openSecondInterval(),l.on(n.saveDataBefore,this.onSaveData,this)},a.initData=function(e,t){if(console.log(e,"--------datadatadatadatadata"),e||(e={}),e.saveTime?this.saveTime=e.saveTime:this.saveTime=t,e.skillFreeRefreshCount?this.skillFreeRefreshCount=e.skillFreeRefreshCount:this.skillFreeRefreshCount=0,e.dayTaskObj?this.dayTaskObj=e.dayTaskObj:this.dayTaskObj={awardFlagArr:[],taskObj:{}},e.energyObj?this.energyObj=e.energyObj:this.energyObj={num:0,awardObj:{}},this.energyObj.endTime||(this.energyObj.endTime=new Date(t.getTime()+7*s.times.day)),e.daySignObj)this.daySignObj=e.daySignObj;else{var a=new Date(t.getTime());a.setHours(0),a.setMinutes(0),a.setSeconds(0),a.setMilliseconds(0),this.daySignObj={startTime:a,awardDayArr:[],finalAward:0}}e.isLetterAward?this.isLetterAward=e.isLetterAward:this.isLetterAward=0,e.vipObj?this.vipObj=e.vipObj:this.vipObj={vip:1,adNum:0,dayAward:0,onceObj:{}},e.shareObj?this.shareObj=e.shareObj:this.shareObj={dayNum:0,idAwardObj:{},friendNum:0,friendAdNum:0,friendPassNum:0},null==e.skillBombNum?this.skillBombNum=2:this.skillBombNum=e.skillBombNum,null==e.skillHealNum?this.skillHealNum=1:this.skillHealNum=e.skillHealNum,null==e.skillMagnetNum?this.skillMagnetNum=1:this.skillMagnetNum=e.skillMagnetNum,null==e.skillLifeNum?this.skillLifeNum=1:this.skillLifeNum=e.skillLifeNum,this.addDayTaskNum(1)},a.getSaveData=function(e){var t={};return t.saveTime=this.saveTime,t.skillFreeRefreshCount=this.skillFreeRefreshCount,t.dayTaskObj=this.dayTaskObj,t.energyObj=this.energyObj,t.daySignObj=this.daySignObj,t.isLetterAward=this.isLetterAward,t.vipObj=this.vipObj,t.shareObj=this.shareObj,t.skillBombNum=this.skillBombNum,t.skillHealNum=this.skillHealNum,t.skillMagnetNum=this.skillMagnetNum,t.skillLifeNum=this.skillLifeNum,t},a.onSaveData=function(){var e=new Date,t={};t.player=this.getSaveData(e),t.audio=r.getSaveData(e),h.getInstance().playerData=t},a.openSecondInterval=function(){this.secondInterval&&clearInterval(this.secondInterval),this.secondInterval=setInterval(this.updateSecond.bind(this),1e3),this.updateSecond()},a.updateSecond=function(){var e=new Date;this.now=e,i.overDay(this.saveTime,e)&&(this.saveTime=e,this.overDay(e),l.send(n.overDay)),e.getTime()>=this.energyObj.endTime&&(this.energyObj={num:0,awardObj:{},endTime:new Date(e.getTime()+7*s.times.day)},l.send(n.energyObjRefresh))},a.isInDevelopmentEnvironment=function(){return this.isOpenDev},a.overDay=function(e){this.skillFreeRefreshCount=0,this.dayTaskObj={awardFlagArr:[],taskObj:{}},this.vipObj.dayAward=0,this.shareObj.dayNum=0,h.getInstance().dayAct=0},a.clearGameData=function(){o.setGameData({}),this.init()},a.sendToUINotice=function(e){l.send(n.showNotice,e)},a.getTaskInfoById=function(e){var t=this.dayTaskObj.taskObj[e];return t||(t={num:0,getAward:0},this.dayTaskObj.taskObj[e]=t),t},a.addDayTaskNum=function(e,t){void 0===t&&(t=1);var a=this.getTaskInfoById(e);a.num+=t;var i=d.getRowById(s.tableName.dayTask,e);if(a.num>=i.needNum&&!a.getAward)switch(e){case 4:case 5:case 6:break;default:l.send(n.refreshRedPoint)}},a.getEnergyAwardInfoById=function(e){var t=this.energyObj.awardObj[e];return t||(t={},this.energyObj.awardObj[e]=t),t},a.hasLetterAward=function(){return!b.isLetterAward},a.hasDaySignAward=function(){var e=new Date,t=Math.floor((e.getTime()-b.daySignObj.startTime)/s.times.day);return!!d.getRowById(s.tableName.daySign,t+1)&&-1==b.daySignObj.awardDayArr.indexOf(t)},a.hasDayTaskAward=function(){var e=d.getTable(s.tableName.dayTask);for(var t in e){var a=e[t],i=b.getTaskInfoById(a.id);if(i.num>=a.needNum&&!i.getAward)return!0}return!1},a.hasEnergyAward=function(){var e=d.getTable(s.tableName.energyAward);for(var t in e){var a=e[t];if(h.getInstance().energy<a.num)break;if(!b.getEnergyAwardInfoById(a.id).award1)return!0}return!1},a.addVipAdNum=function(){this.vipObj.adNum++;var e=d.getRowById(s.tableName.vip,this.vipObj.vip);if(this.vipObj.adNum>=e.adNum&&d.getRowById(s.tableName.vip,this.vipObj.vip+1))return this.vipObj.vip++,this.vipObj.adNum=0,this.vipObj.dayAward=0,!0},a.hasVipAward=function(){return!this.vipObj.dayAward||!this.vipObj.onceObj[this.vipObj.vip]},t(e,null,[{key:"instance",get:function(){return this._instance||(this._instance=new e),this._instance}}]),e}();m._instance=void 0;var b=e("playerModel",m.instance);a._RF.pop()}}}));

System.register("chunks:///_virtual/PreventTouchPropagation.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var o,e,n,i,r;return{setters:[function(t){o=t.inheritsLoose},function(t){e=t.cclegacy,n=t._decorator,i=t.Node,r=t.Component}],execute:function(){var p;e._RF.push({},"220b4uqe0pD1KxxxgDzwiKU","PreventTouchPropagation",void 0);var s=n.ccclass;n.property,t("PreventTouchPropagation",s("PreventTouchPropagation")(p=function(t){function e(){return t.apply(this,arguments)||this}o(e,t);var n=e.prototype;return n.onLoad=function(){this.node.on(i.EventType.TOUCH_START,this.preventPropagation,this),this.node.on(i.EventType.TOUCH_MOVE,this.preventPropagation,this),this.node.on(i.EventType.TOUCH_END,this.preventPropagation,this),this.node.on(i.EventType.TOUCH_CANCEL,this.preventPropagation,this)},n.preventPropagation=function(t){t.propagationStopped=!0},n.onDestroy=function(){this.node.off(i.EventType.TOUCH_START,this.preventPropagation,this),this.node.off(i.EventType.TOUCH_MOVE,this.preventPropagation,this),this.node.off(i.EventType.TOUCH_END,this.preventPropagation,this),this.node.off(i.EventType.TOUCH_CANCEL,this.preventPropagation,this)},e}(r))||p);e._RF.pop()}}}));

System.register("chunks:///_virtual/ProgressCtrl.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var r,s,e,o,i;return{setters:[function(t){r=t.inheritsLoose},function(t){s=t.cclegacy,e=t._decorator,o=t.ProgressBar,i=t.Component}],execute:function(){var n;s._RF.push({},"70366vUiUVK84CeSgjAYxbQ","ProgressCtrl",void 0);var u=e.ccclass;e.property,t("ProgressCtrl",u("ProgressCtrl")(n=function(t){function s(){for(var r,s=arguments.length,e=new Array(s),o=0;o<s;o++)e[o]=arguments[o];return(r=t.call.apply(t,[this].concat(e))||this).progressBar=void 0,r.time=void 0,r.timeCount=void 0,r.endCb=void 0,r}r(s,t);var e=s.prototype;return e.onLoad=function(){this.progressBar=this.getComponent(o),this.progressBar||(this.progressBar=this.getComponentInChildren(o))},e.startLoadProgress=function(t,r){null==this.timeCount&&(this.time=t,this.endCb=r,this.timeCount=0)},e.update=function(t){if(null!=this.timeCount&&this.progressBar){this.timeCount+=t;var r=this.timeCount/this.time;this.progressBar.progress=r,r>=1&&(this.timeCount=void 0,this.endCb&&this.endCb())}},s}(i))||n);s._RF.pop()}}}));

System.register("chunks:///_virtual/Prop.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./utilTools.ts","./constants.ts","./designManager.ts","./mapModel.ts","./physicsGroup.ts","./AnimationCtrl.ts","./BaseLayer.ts"],(function(t){var o,i,e,n,r,s,l,a,c,d,p,h,u,y,f;return{setters:[function(t){o=t.inheritsLoose},function(t){i=t.cclegacy,e=t._decorator,n=t.BoxCollider2D,r=t.find,s=t.Contact2DType,l=t.Vec2},function(t){a=t.cocosUtil},function(t){c=t.utilTools},function(t){d=t.constants},function(t){p=t.designManager},function(t){h=t.mapModel},function(t){u=t.physicsGroup},function(t){y=t.AnimationCtrl},function(t){f=t.BaseLayer}],execute:function(){var v;i._RF.push({},"b480cN5zOtEI7gfMoQqAALv","Prop",void 0);var m=e.ccclass;e.property,t("Prop",m("Prop")(v=function(t){function i(){for(var o,i=arguments.length,e=new Array(i),n=0;n<i;n++)e[n]=arguments[n];return(o=t.call.apply(t,[this].concat(e))||this).id=void 0,o.row=void 0,o.extraObj=void 0,o.bodyNode=void 0,o.aniNode=void 0,o.collider=void 0,o.animationCtrl=void 0,o.propUtil=void 0,o.isFollowPlayer=void 0,o.followSpeed=void 0,o}o(i,t);var e=i.prototype;return e.onLoad=function(){this.collider=this.getComponent(n),this.animationCtrl=this.addComponent(y),this.bodyNode=r("body",this.node),this.aniNode=r("ani",this.node),this.collider&&this.collider.on(s.BEGIN_CONTACT,this.contactBegin,this)},e.onEnable=function(){},e.init=function(t,o,i){this.bodyNode||this.onLoad(),this.id=t,this.row=p.getRowById(d.tableName.prop,t),this.extraObj=i,this.unscheduleAllCallbacks(),this.collider&&(this.collider.enabled=!0),this.isFollowPlayer=!1,this.followSpeed=-1e3;var e=a.convertToNodeSpace(this.node,o);this.node.setPosition(e),this.aniNode&&(this.aniNode.active=!0),this.setSpriteFrame(this.bodyNode,this.row.icon);try{this.propUtil=a.addComponentOnce(this,"Prop"+t),this.propUtil.unscheduleAllCallbacks(),this.propUtil.init(this)}catch(t){}},e.contactBegin=function(t,o){var i=this;if(o.group==u.PLAYER_BULLET&&this.id==d.propIds.box1)return this.collider.enabled=!1,void this.animationCtrl.playAnimationOnce("ani",(function(){i.recycleSelf();var t=p.getTable(d.tableName.box1),o=[];for(var e in t){var n=t[e];0==n.mapId&&o.push(n)}var r=c.getRowByWeight(o),s=c.getFloatValue(r.minNum,r.maxNum,!0),l={};l.num=s,l.propId=r.propId;var u=r.propId,y=p.getRowById(d.tableName.prop,u);8!=y.type&&11!=y.type||(u=d.propIds.equip),h.propSystem.addProp(u,a.convertToWorldSpace(i.node),l)}))},e.contactPlayer=function(){this.propUtil&&this.propUtil.notContact||this.propUtil&&this.propUtil.autoGet||(this.node.active=!0,this.collider&&(this.collider.enabled=!1),this.isFollowPlayer=!0,this.aniNode&&(this.aniNode.active=!1),this.propUtil&&this.propUtil.contactStart&&this.propUtil.contactStart())},e.doDisPlayerGet=function(t){this.collider||t>100+h.skillSystem.getSkill2PropGetAddDis()||this.contactPlayer()},e.playerGetProp=function(){this.recycleSelf(),this.isFollowPlayer=!1;var t=1;this.extraObj&&this.extraObj.num>0&&(t=this.extraObj.num);var o=this.id;this.id==d.propIds.equip&&(o=this.extraObj.propId),h.propSystem.getProp(o,t)},e.recycleSelf=function(){h.propSystem.recyclePropNode(this.node)},e.update=function(t){if(this.isFollowPlayer){var o=h.player.node.getPosition(),i=this.node.getPosition();this.followSpeed+=50;var e=this.followSpeed*t,n=o.subtract(i).normalize().multiplyScalar(e);if(i.add(n),this.node.setPosition(i),e>0){var r=(o=h.player.node.getPosition()).subtract(i);if(c.radianToAngle(l.angle(n,r))>90)return void this.playerGetProp()}}},i}(f))||v);i._RF.pop()}}}));

System.register("chunks:///_virtual/Prop1001.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./AnimationTrack.ts"],(function(t){var o,n,r,i,c,a;return{setters:[function(t){o=t.inheritsLoose},function(t){n=t.cclegacy,r=t._decorator,i=t.Component},function(t){c=t.cocosUtil},function(t){a=t.AnimationTrack}],execute:function(){var e;n._RF.push({},"7560dwr4i1A6LAme6E7aqDt","Prop1001",void 0);var p=r.ccclass;r.property,t("Prop1001",p("Prop1001")(e=function(t){function n(){for(var o,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(o=t.call.apply(t,[this].concat(r))||this).prop=void 0,o.autoGet=!0,o.animationTrack=void 0,o}return o(n,t),n.prototype.init=function(t){var o=this;this.prop=t,this.animationTrack=c.addComponentOnce(this.node,a),this.animationTrack.startShowThrow((function(){o.prop.playerGetProp()}))},n}(i))||e);n._RF.pop()}}}));

System.register("chunks:///_virtual/Prop1002.ts",["./rollupPluginModLoBabelHelpers.js","cc","./constants.ts","./designManager.ts"],(function(t){var o,r,n,e,p,i;return{setters:[function(t){o=t.inheritsLoose},function(t){r=t.cclegacy,n=t._decorator,e=t.Component},function(t){p=t.constants},function(t){i=t.designManager}],execute:function(){var s;r._RF.push({},"2417aZWpORBWYRBYefZ1EuS","Prop1002",void 0);var c=n.ccclass;n.property,t("Prop1002",c("Prop1002")(s=function(t){function r(){for(var o,r=arguments.length,n=new Array(r),e=0;e<r;e++)n[e]=arguments[e];return(o=t.call.apply(t,[this].concat(n))||this).prop=void 0,o}return o(r,t),r.prototype.init=function(t){this.prop=t;var o=i.getRowById(p.tableName.prop,this.prop.extraObj.propId);this.prop.setSpriteFrame2(this.prop.bodyNode,"prop/"+o.icon)},r}(e))||s);r._RF.pop()}}}));

System.register("chunks:///_virtual/Prop101.ts",["./rollupPluginModLoBabelHelpers.js","cc","./myLog.ts","./utilTools.ts","./constants.ts","./designManager.ts"],(function(o){var t,n,r,e,i,p,s,c;return{setters:[function(o){t=o.inheritsLoose},function(o){n=o.cclegacy,r=o._decorator,e=o.Component},function(o){i=o.myLog},function(o){p=o.utilTools},function(o){s=o.constants},function(o){c=o.designManager}],execute:function(){var u;n._RF.push({},"00c51R5Hj9Fm5HudkQ22u64","Prop101",void 0);var a=r.ccclass;r.property,o("Prop101",a("Prop101")(u=function(o){function n(){for(var t,n=arguments.length,r=new Array(n),e=0;e<n;e++)r[e]=arguments[e];return(t=o.call.apply(o,[this].concat(r))||this).prop=void 0,t}return t(n,o),n.prototype.init=function(o){this.prop=o;var t=this.prop.extraObj.num,n=c.getRowsByType(s.tableName.prop,s.propTypes.coin),r=null;p.forArr(n,(function(o){if(t>=o.p1&&t<=o.p2)return r=o,!0})),r?this.prop.setSpriteFrame(this.prop.bodyNode,r.icon):i.e("coin num:"+t+" not in prop table")},n}(e))||u);n._RF.pop()}}}));

System.register("chunks:///_virtual/Prop201.ts",["./rollupPluginModLoBabelHelpers.js","cc","./myLog.ts","./utilTools.ts","./constants.ts","./designManager.ts"],(function(o){var t,n,r,e,p,i,s,c,a;return{setters:[function(o){t=o.inheritsLoose},function(o){n=o.cclegacy,r=o._decorator,e=o.v3,p=o.Component},function(o){i=o.myLog},function(o){s=o.utilTools},function(o){c=o.constants},function(o){a=o.designManager}],execute:function(){var u;n._RF.push({},"589beHTgXtCGJjDX4C17557","Prop201",void 0);var l=r.ccclass;r.property,o("Prop201",l("Prop201")(u=function(o){function n(){for(var t,n=arguments.length,r=new Array(n),e=0;e<n;e++)r[e]=arguments[e];return(t=o.call.apply(o,[this].concat(r))||this).prop=void 0,t}return t(n,o),n.prototype.init=function(o){this.prop=o;var t=this.prop.extraObj.num,n=a.getRowsByType(c.tableName.prop,c.propTypes.exp),r=null;if(s.forArr(n,(function(o){if(t>=o.p1&&t<=o.p2)return r=o,!0})),r){var p=.8*(r.p2-r.p1),u=1;t-r.p1>p&&(u=1.3),this.prop.bodyNode.setScale(e(u,u,1)),this.prop.setSpriteFrame(this.prop.bodyNode,r.icon)}else i.e("exp num:"+t+" not in prop table")},n}(p))||u);n._RF.pop()}}}));

System.register("chunks:///_virtual/Prop701.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./AnimationCtrl.ts"],(function(t){var n,o,i,a,r,c,e,s,p;return{setters:[function(t){n=t.inheritsLoose},function(t){o=t.cclegacy,i=t._decorator,a=t.find,r=t.v3,c=t.Animation,e=t.Component},function(t){s=t.cocosUtil},function(t){p=t.AnimationCtrl}],execute:function(){var l;o._RF.push({},"7b3c0Dk5rJItYvaImNFjUUe","Prop701",void 0);var u=i.ccclass;i.property,t("Prop701",u("Prop701")(l=function(t){function o(){for(var n,o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return(n=t.call.apply(t,[this].concat(i))||this).prop=void 0,n.notContact=void 0,n.animationCtrl=void 0,n}n(o,t);var i=o.prototype;return i.init=function(t){var n=this;this.prop=t,this.notContact=!0,this.animationCtrl=s.addComponentOnce(a("ani",this.node),p),this.animationCtrl.node.active=!0,this.animationCtrl.playAnimationOnce("1",(function(){n.animationCtrl.playAnimation("2",!0),n.notContact=!1})),this.prop.bodyNode.scale=r(0,0,1),this.prop.bodyNode.getComponent(c).play("boxAni")},i.contactStart=function(){this.animationCtrl.node.active=!1},o}(e))||l);o._RF.pop()}}}));

System.register("chunks:///_virtual/PropInfoLayer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./constants.ts","./msgac.ts","./designManager.ts","./eventManager.ts","./UserData.ts","./PropItemPrefab.ts","./BaseUILayer.ts","./ServerCtr.ts","./utilTools.ts","./audioManager.ts"],(function(t){var e,i,r,n,a,o,u,l,p,s,c,f,b,y,h,g,m,d,w,v;return{setters:[function(t){e=t.applyDecoratedDescriptor,i=t.inheritsLoose,r=t.initializerDefineProperty,n=t.assertThisInitialized,a=t.asyncToGenerator,o=t.regeneratorRuntime},function(t){u=t.cclegacy,l=t._decorator,p=t.Node,s=t.Label},function(t){c=t.constants},function(t){f=t.msgac},function(t){b=t.designManager},function(t){y=t.eventManager},function(t){h=t.UserData},function(t){g=t.PropItemPrefab},function(t){m=t.BaseUILayer},function(t){d=t.default},function(t){w=t.utilTools},function(t){v=t.audioManager}],execute:function(){var L,I,_,N,D,E,A,S,z,P,q,T,C,B,U,k,R,W,M,F,H,x,G,O,j,K,V,Z,J,Q,X,Y,$,tt,et,it,rt,nt,at;u._RF.push({},"0e500nZEB1BLK5g1Nf5CtGr","PropInfoLayer",void 0);var ot=l.ccclass,ut=l.property;t("PropInfoLayer",(L=ot("PropInfoLayer"),I=ut({type:p,tooltip:"道具节点"}),_=ut({type:p,tooltip:"按钮"}),N=ut({type:p,tooltip:"属性图标"}),D=ut({type:s,tooltip:"属性"}),E=ut({type:s,tooltip:"属性值"}),A=ut({type:s,tooltip:"装备详情"}),S=ut({type:s,tooltip:"装备名字"}),z=ut({type:s,tooltip:"套装名字"}),P=ut({type:s,tooltip:"3套属性"}),q=ut({type:p,tooltip:"穿3件"}),T=ut({type:s,tooltip:"5套属性"}),C=ut({type:p,tooltip:"穿5件"}),B=ut({type:s,tooltip:"套装数量"}),U=ut({type:p,tooltip:"套装节点"}),k=ut({type:s,tooltip:"血量数值"}),R=ut({type:s,tooltip:"伤害数值"}),W=ut({type:s,tooltip:"防御数值"}),M=ut({type:p,tooltip:"套装详情弹窗"}),L((x=e((H=function(t){function e(){for(var e,i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a))||this,r(e,"propItem",x,n(e)),r(e,"btnWear",G,n(e)),r(e,"attrIcon",O,n(e)),r(e,"attrlabel",j,n(e)),r(e,"attrNumLab",K,n(e)),r(e,"propInfoLab",V,n(e)),r(e,"propNameLab",Z,n(e)),r(e,"suitNameLab",J,n(e)),r(e,"suitAttr3",Q,n(e)),r(e,"isSuitAttr3",X,n(e)),r(e,"suitAttr5",Y,n(e)),r(e,"isSuitAttr5",$,n(e)),r(e,"suitNum",tt,n(e)),r(e,"suitNode",et,n(e)),r(e,"hpLabel",it,n(e)),r(e,"atkLabel",rt,n(e)),r(e,"defLabel",nt,n(e)),r(e,"suitDetails",at,n(e)),e._propId=0,e._propFlag=0,e._weaponLv=0,e._equipEntity=null,e._suitNum=0,e}i(e,t);var u=e.prototype;return u.formatSuitAttr=function(t){return[{value:t.hpAdd,label:"HP"},{value:t.atkAdd,label:"ATK"},{value:t.defenseAdd,label:"DEF"},{value:t.soulDropRateAdd,label:"SDR",isPercentage:!0}].filter((function(t){return t.value})).map((function(t){return"+"+t.value+(t.isPercentage?"%":"")+t.label})).join(", ")},u.onLoad=function(){var e=this;t.prototype.onLoad.call(this),this._equipEntity=this.layerData.data;var i=h.getInstance().getUserServerData().equipSet;for(var r in i)i[r].suitName===this._equipEntity.name&&(this._suitNum=i[r].count);this.suitNum.string="Bloodforge Set ("+this._suitNum+"/5)",this._suitNum>=3?this.isSuitAttr3.active=!0:this._suitNum>=5&&(this.isSuitAttr5.active=!0),this.suitAttr3.string=this.formatSuitAttr(this._equipEntity.set3Info),this.suitAttr5.string=this.formatSuitAttr(this._equipEntity.set5Info),this._propId=this.layerData.propId,this._propFlag=this.layerData.flag,this._weaponLv=this.layerData.weaponLv;b.getRowById(c.tableName.prop,this._propId);this.attrNumLab.string="+???",this.setSpriteFrame2(this.attrIcon,"heroLayer/ui_sm",null,c.bundles.wwqVec),this.attrlabel.string="Attr",this.attrNumLab.color=c.colors.green.parseColor(),this.propInfoLab.string=""+this._equipEntity.desc,this.propNameLab.string=""+this._equipEntity.name,this.hpLabel.string="+ "+this._equipEntity.hpAdd,this.atkLabel.string="+ "+this._equipEntity.atkAdd,this.defLabel.string="+ "+this._equipEntity.defenseAdd,this.propItem.getComponent(g).setViewSuper(this._equipEntity,0,g.Type_HideNum|g.Type_ShowType),this.btnWear.off(p.EventType.TOUCH_END,this.unWearProp,this),this.btnWear.off(p.EventType.TOUCH_END,this.wearProp,this),this.btnWear.on(p.EventType.TOUCH_END,(function(){e.wearEquipSuper(e._equipEntity)}),this)},u.initBtnInfo=function(){},u.wearEquipSuper=function(){var t=a(o().mark((function t(e){var i;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("🚀 ~ PropInfoLayer ~ wearEquipSuper ~ equipEntity:",e),v.playEffect("btnClick"),t.prev=2,t.next=5,d.GetInstance().wearEquipment(w.getUserId().toString(),null==e||null==(i=e.inventoryRes)?void 0:i.id);case 5:return t.next=7,h.getInstance().updateUserData();case 7:y.send(f.wearDrop),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(2),console.log(t.t0);case 13:this.onClose();case 14:case"end":return t.stop()}}),t,this,[[2,10]])})));return function(e){return t.apply(this,arguments)}}(),u.wearProp=function(){var t=b.getRowById(c.tableName.prop,this._propId);h.getInstance().setWearProp(t),y.send(f.wearDrop),this.onClose()},u.unWearProp=function(){var t=b.getRowById(c.tableName.prop,this._propId);h.getInstance().unWearProp(t),y.send(f.wearDrop),this.onClose()},u.openSuitDetails=function(){this.suitDetails.active=!0},u.closeSuitDetails=function(){this.suitDetails.active=!1},u.onClose=function(){this.closeLayer()},u.onDestroy=function(){t.prototype.onDestroy.call(this)},e}(m)).prototype,"propItem",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),G=e(H.prototype,"btnWear",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),O=e(H.prototype,"attrIcon",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),j=e(H.prototype,"attrlabel",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),K=e(H.prototype,"attrNumLab",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),V=e(H.prototype,"propInfoLab",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Z=e(H.prototype,"propNameLab",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),J=e(H.prototype,"suitNameLab",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Q=e(H.prototype,"suitAttr3",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),X=e(H.prototype,"isSuitAttr3",[q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Y=e(H.prototype,"suitAttr5",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),$=e(H.prototype,"isSuitAttr5",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),tt=e(H.prototype,"suitNum",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),et=e(H.prototype,"suitNode",[U],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),it=e(H.prototype,"hpLabel",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),rt=e(H.prototype,"atkLabel",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),nt=e(H.prototype,"defLabel",[W],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),at=e(H.prototype,"suitDetails",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),F=H))||F));u._RF.pop()}}}));

System.register("chunks:///_virtual/PropInfoLayer2.ts",["./rollupPluginModLoBabelHelpers.js","cc","./constants.ts","./designManager.ts","./BaseLayer.ts"],(function(t){var n,o,e,i,a,r,s;return{setters:[function(t){n=t.inheritsLoose},function(t){o=t.cclegacy,e=t._decorator,i=t.find},function(t){a=t.constants},function(t){r=t.designManager},function(t){s=t.BaseLayer}],execute:function(){var c;o._RF.push({},"a0b33/wThhFnLP+QJRzeEWB","PropInfoLayer2",void 0);var u=e.ccclass;e.property,t("PropInfoLayer2",u("PropInfoLayer2")(c=function(t){function o(){return t.apply(this,arguments)||this}n(o,t);var e=o.prototype;return e.onLoad=function(){t.prototype.onLoad.call(this)},e.onEnable=function(){t.prototype.onEnable.call(this)},e.onDisable=function(){t.prototype.onDisable.call(this)},e.onDestroy=function(){t.prototype.onDestroy.call(this)},e.initUI=function(){var t=r.getRowById(a.tableName.prop,this.layerData.id);this.setString(this.getNodeByPath("ui/info"),t.info),this.setString(this.getNodeByPath("ui/name/text"),t.name),this.setPropItem(t.id,this.getNodeByPath("ui/propItem/icon"),0,this.getNodeByPath("ui/propItem/bg"));var n=this.getNodeByPath("ui/propItem/num");null!=this.layerData.num?(n.active=!0,this.setString(i("val",n),this.layerData.num)):n.active=!1},e.processEvent=function(t,n){},e.onButtonClick=function(t,n){},e.onClickBg=function(){this.closeLayer()},o}(s))||c);o._RF.pop()}}}));

System.register("chunks:///_virtual/PropItem.ts",["./rollupPluginModLoBabelHelpers.js","cc","./BaseUILayer.ts"],(function(e){var t,r,n,i,o,a,c,l;return{setters:[function(e){t=e.applyDecoratedDescriptor,r=e.inheritsLoose,n=e.initializerDefineProperty,i=e.assertThisInitialized},function(e){o=e.cclegacy,a=e._decorator,c=e.Node},function(e){l=e.BaseUILayer}],execute:function(){var p,u,s,f,y,I,m;o._RF.push({},"22763sgKEFIUphPG//ZwRzn","PropItem",void 0);var h=a.ccclass,b=a.property;e("PropItem",(p=h("PropItem"),u=b({type:c,tooltip:"皮肤名字"}),s=b({type:c,tooltip:"皮肤样式"}),p((I=t((y=function(e){function t(){for(var t,r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return t=e.call.apply(e,[this].concat(o))||this,n(t,"skinName",I,i(t)),n(t,"skinIcon",m,i(t)),t}r(t,e);var o=t.prototype;return o.start=function(){},o.update=function(e){},t}(l)).prototype,"skinName",[u],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),m=t(y.prototype,"skinIcon",[s],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),f=y))||f));o._RF.pop()}}}));

System.register("chunks:///_virtual/PropItemPrefab.ts",["./rollupPluginModLoBabelHelpers.js","cc","./myLog.ts","./constants.ts","./audioManager.ts","./designManager.ts","./BaseUILayer.ts","./ServerCtr.ts"],(function(e){var t,i,n,o,r,p,s,a,l,c,u,h,d,b,y,g,m,f,T,v;return{setters:[function(e){t=e.applyDecoratedDescriptor,i=e.inheritsLoose,n=e.initializerDefineProperty,o=e.assertThisInitialized,r=e.extends,p=e.createClass},function(e){s=e.cclegacy,a=e._decorator,l=e.Sprite,c=e.Node,u=e.Label,h=e.Vec2,d=e.v3,b=e.UITransform},function(e){y=e.myLog},function(e){g=e.constants},function(e){m=e.audioManager},function(e){f=e.designManager},function(e){T=e.BaseUILayer},function(e){v=e.default}],execute:function(){var I,_,w,S,C,L,k,U,F,E,P,z,R,O,N,H;s._RF.push({},"b4670hainVGb5mnYowtXuj5","PropItemPrefab",void 0);var x=a.ccclass,D=a.property;e("PropItemPrefab",(I=x("PropItemPrefab"),_=D({type:l,tooltip:"图标"}),w=D({type:l,tooltip:"图标背景"}),S=D({type:c,tooltip:"灰色遮罩"}),C=D({type:l,tooltip:"装备级别"}),L=D({type:u,tooltip:"装备等级"}),k=D({type:u,tooltip:"数量"}),I(((H=function(e){function t(){for(var t,i=arguments.length,r=new Array(i),p=0;p<i;p++)r[p]=arguments[p];return t=e.call.apply(e,[this].concat(r))||this,n(t,"icon",E,o(t)),n(t,"bg",P,o(t)),n(t,"greybg",z,o(t)),n(t,"typeIcon",R,o(t)),n(t,"level",O,o(t)),n(t,"numLabel",N,o(t)),t._propId=0,t._propFlag=0,t.doubleSubTime=200,t.longSubTime=600,t.startClick=!1,t.clickTime=0,t.startClickTime=0,t.endClickTime=0,t}i(t,e);var s=t.prototype;return s.start=function(){},s.setViewSuper=function(e,i,n,o){var p=this;void 0===n&&(n=0),void 0===o&&(o={}),console.log("🚀 ~ PropItemPrefab ~ setViewSuper ~ item:",e),console.log("🚀 ~ PropItemPrefab ~ setViewSuper ~ details:",o);var s=this,a=function(e){s.setImageCustomSize(e,95)};this.node.off(c.EventType.TOUCH_START),this.node.off(c.EventType.TOUCH_MOVE),this.node.off(c.EventType.TOUCH_END);var l=null,u=!1;if(this.node.on(c.EventType.TOUCH_START,(function(e){p.startClickTime=(new Date).getTime(),p.startClick=!0,u=!1,l=e.getLocation(),setTimeout((function(){p.startClick&&!u&&(console.log("长按事件"),p.startClick=!1)}),p.longSubTime)})),this.node.on(c.EventType.TOUCH_MOVE,(function(e){if(l){var t=e.getLocation();h.subtract(new h,t,l).length()>10&&(u=!0,p.startClick=!1)}})),this.node.on(c.EventType.TOUCH_END,(function(){p.endClickTime=(new Date).getTime();var e=p.endClickTime-p.startClickTime;!u&&e<p.longSubTime&&(p.clickTime++,setTimeout((function(){1===p.clickTime?(console.log("单击事件"),console.log(o,"-----------------  detailsdetailsdetails"),m.playEffect("btnClick"),v.GetInstance().getEquipmentDetail(o.details.id).then((function(e){if(e){var t=r({},e,{inventoryRes:o});p.openLayer(g.layers.PropInfoLayer,{data:t})}}))):2===p.clickTime&&console.log("双击事件"),p.clickTime=0}),p.doubleSubTime)),p.startClick=!1})),n&t.Type_UnKnow)return this.numLabel.string="x??",this.setSpriteFrame2(this.icon.node,"prop/prop_unknow",a,g.bundles.icon),this.greybg.active=!1,void(this.typeIcon.node.active=!1);if(!e)return this.setSpriteFrame2(this.bg.node,"heroLayer/propbg",null,g.bundles.wwqVec),this.setSpriteFrame2(this.icon.node,"prop/prop_seat_"+i,a,g.bundles.icon),this.level.node.active=!1,this.numLabel.node.active=!1,this.greybg.active=!1,void(this.typeIcon.node.active=!1);this.level.string="+"+e.level;var d="",b="",y="";if(e.rarity)switch(e.rarity){case"N":y="prop/propType1",b="prop/propbg1";break;case"R":y="prop/R_z",b="prop/propbg3";break;case"SR":y="prop/SR_z",b="prop/propbg4";break;case"UR":y="prop/UR_z",b="prop/propbg5"}else y="prop/UR_z",b="prop/propbg5";this.setSpriteFrame2(this.bg.node,b,null,g.bundles.icon),this.setSpriteFrame2(this.typeIcon.node,y,null,g.bundles.icon),"COIN"===e.wearTypeName?(d="prop/prop_coin4",b="prop/propbg5",y="prop/propType4"):e.wearIndex||0===e.wearIndex?0===e.wearIndex?(d="prop/weapon/"+e.icon,this.setSpriteFrame2(this.icon.node,d,a,g.bundles.icon),this.numLabel.string=""):(99===e.wearIndex||e.wearIndex<=5&&e.wearIndex>=1)&&(d="prop/"+e.icon,this.setSpriteFrame2(this.icon.node,d,a,g.bundles.icon),this.numLabel.string=""):(d="prop/"+e.icon,this.setSpriteFrame2(this.icon.node,d,a,g.bundles.icon),this.numLabel.string="")},s.setView=function(e,i,n){void 0===n&&(n=0),this._propId=e;var o=f.getRowById(g.tableName.prop,e),r=this,p=function(e){r.setImageCustomSize(e,95)};if(this.node.off(c.EventType.TOUCH_END,this.openInfo,this),n&t.Type_UnKnow)return this.numLabel.string="x??",this.setSpriteFrame2(this.icon.node,"prop/prop_unknow",p,g.bundles.icon),this.greybg.active=!1,void(this.typeIcon.node.active=!1);if(!o)return this.setSpriteFrame2(this.bg.node,"heroLayer/propbg",null,g.bundles.wwqVec),this.setSpriteFrame2(this.icon.node,"prop/prop_seat_"+i,p,g.bundles.icon),this.numLabel.node.active=!1,this.greybg.active=!1,void(this.typeIcon.node.active=!1);var s="prop/"+o.icon;return 11==o.type&&(s="weapon/"+f.getRowById(g.tableName.weapon,o.weaponid).icon),this.setSpriteFrame2(this.bg.node,"prop/propbg"+o.quality,null,g.bundles.icon),this.setSpriteFrame2(this.typeIcon.node,"prop/propType"+o.quality,null,g.bundles.icon),this.setSpriteFrame2(this.icon.node,s,p,g.bundles.icon),n&t.Type_UnTouch||8!=o.type&&11!=o.type||this.node.on(c.EventType.TOUCH_END,this.openInfo,this),n&t.Type_OnlyIcon?(this.bg.node.active=!1,this.greybg.active=!1,this.typeIcon.node.active=!1,void(this.numLabel.node.active=!1)):n&t.Type_BigIcon?(this.greybg.active=!1,this.typeIcon.node.active=!1,this.bg.node.active=!1,this.node.scale=d(3,3,3),void(this.numLabel.node.active=!1)):(this.numLabel.string="X"+i,this._propFlag=n,n&t.Type_HideNum&&(this.numLabel.node.active=!1),void(n&t.Type_Grey?this.greybg.active=!0:this.greybg.active=!1))},s.openInfo=function(e){y.i("点击装备"),m.playEffect("btnClick"),this.openLayer(g.layers.PropInfoLayer,{equipment:e})},s.setScale=function(e){var t=this.bg.getComponent(b).width,i=this.bg.getComponent(b).height,n=e/t;this.node.scale=d(n,n,1),this.node.getComponent(b).width=t*n,this.node.getComponent(b).height=i*n},s.changeBg=function(e,t){this.setSpriteFrame2(this.bg.node,e,null,t)},p(t,[{key:"propId",get:function(){return this._propId}}]),t}(T)).Type_HideNum=1,H.Type_UnWear=2,H.Type_ToWear=4,H.Type_Bless=8,H.Type_UnTouch=16,H.Type_Grey=32,H.Type_ShowType=64,H.Type_UnKnow=128,H.Type_BigIcon=256,H.Type_OnlyIcon=512,E=t((F=H).prototype,"icon",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),P=t(F.prototype,"bg",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),z=t(F.prototype,"greybg",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),R=t(F.prototype,"typeIcon",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),O=t(F.prototype,"level",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),N=t(F.prototype,"numLabel",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),U=F))||U));s._RF.pop()}}}));

System.register("chunks:///_virtual/PropSystem.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./utilTools.ts","./constants.ts","./designManager.ts","./resManager.ts","./mapModel.ts","./BaseLayer.ts","./NodePoolUtil.ts","./Prop.ts"],(function(o){var e,r,t,n,i,a,s,p,c,d,l,f,u,y,P,h;return{setters:[function(o){e=o.inheritsLoose},function(o){r=o.cclegacy,t=o._decorator,n=o.Node,i=o.UITransform,a=o.Prefab,s=o.Vec2},function(o){p=o.cocosUtil},function(o){c=o.utilTools},function(o){d=o.constants},function(o){l=o.designManager},function(o){f=o.resManager},function(o){u=o.mapModel},function(o){y=o.BaseLayer},function(o){P=o.NodePoolUtil},function(o){h=o.Prop}],execute:function(){var m;r._RF.push({},"da5bcFxzQ1DAoJmyXVA6IfZ","PropSystem",void 0);var g=t.ccclass;t.property,o("PropSystem",g("PropSystem")(m=function(o){function r(){for(var e,r=arguments.length,t=new Array(r),n=0;n<r;n++)t[n]=arguments[n];return(e=o.call.apply(o,[this].concat(t))||this).idPropLayerObj={},e.idPrefabObj={},e}e(r,o);var t=r.prototype;return t.onLoad=function(){o.prototype.onLoad.call(this)},t.onEnable=function(){o.prototype.onEnable.call(this)},t.onDestroy=function(){o.prototype.onDestroy.call(this)},t.getPropLayerNameById=function(o){return"propLayer"+o},t.getPropLayerById=function(o){var e=this.idPropLayerObj[o];e||((e=new n(this.getPropLayerNameById(o))).addComponent(i),e.setPosition(0,0),e.parent=this.node,this.idPropLayerObj[o]=e,e.addComponent(P).init(this.idPrefabObj[o]));return e},t.saveDataBefore=function(){c.forArr(this.node.children,(function(o){o.getComponent(P).forEachUseNode((function(o){var e=o.getComponent(h);e.id!=d.propIds.boxMonsterCoin||e.playerGetProp()}))}))},t.getSaveData=function(){var o={arr:[]};return c.forArr(this.node.children,(function(e){e.getComponent(P).forEachUseNode((function(e){var r=e.getComponent(h);if(r.id!=d.propIds.boxMonsterCoin){var t={};t.id=r.id,t.worldPos=p.convertToWorldSpace(e),t.extraObj=r.extraObj,o.arr.push(t)}else r.playerGetProp()}))})),o},t.loadSaveData=function(o){var e=this;c.forArr(o.arr,(function(o){e.addProp(o.id,o.worldPos,o.extraObj)}))},t.addProp=function(o,e,r){var t=this,n=this.getPropLayerById(o).getComponent(P),i=function(){var t=n.getNode();p.addComponentOnce(t,h).init(o,e,r)};if(this.idPrefabObj[o])i();else{var s="prop"+o;f.loadAsset(d.bundles.prefab,"prop/"+s+"/"+s,a,null,(function(e,r){p.isValid(t)&&(t.idPrefabObj[o]=r,n.init(r),i())}))}},t.getProp=function(o,e,r){if(void 0===e&&(e=1),!(u.player.hp<=0)){var t=l.getRowById(d.tableName.prop,o);switch(o){case d.propIds.exp:u.mapSystem.addExp(e+u.skillSystem.getSkill2AddExp());break;case d.propIds.coin:u.mapSystem.addCoin(e+u.skillSystem.getSkill2AddCoin());break;case d.propIds.magnet:u.propSystem.forAllPropById(d.propIds.exp,(function(o){o.contactPlayer()}));break;case d.propIds.addHpPercent:u.player.addHpPercent(t.p1);break;case d.propIds.bomb:u.mapSystem.bomb();break;case d.propIds.box2:u.player.hp;break;case d.propIds.diamond:}}},t.forAllPropById=function(o,e){this.getPropLayerById(o).getComponent(P).forEachUseNode((function(o){var r=o.getComponent(h);r.isFollowPlayer||e(r)}))},t.forVisiblePropCollider=function(o){c.forArr(this.node.children,(function(e){c.forArr(e.children,(function(e){if(e.active&&u.isInScreenVisible(e)){var r=e.getComponent(h);r.collider&&o(r)}}))}))},t.forVisiblePropContact=function(o){c.forArr(this.node.children,(function(e){c.forArr(e.children,(function(e){if(e.active&&u.isInScreenVisible(e)){var r=e.getComponent(h);r.collider||o(r)}}))}))},t.forAllPropContact=function(o){c.forArr(this.node.children,(function(e){c.forArr(e.children,(function(e){if(e.use){var r=e.getComponent(h);r.collider||o(r)}}))}))},t.recyclePropNode=function(o){var e=o.getComponent(h);this.getPropLayerById(e.id).getComponent(P).recycleNode(o)},t.updateLogic=function(o){for(var e in this.idPropLayerObj){this.getPropLayerById(parseFloat(e)).getComponent(P).forEachUseNode((function(o){var e=s.distance(o.getPosition(),u.player.node.getPosition()),r=o.getComponent(h);if(e<=u.dataRadius||r.propUtil&&r.propUtil.autoGet)return o.active=!0,void r.doDisPlayerGet(e);r.isFollowPlayer||(o.active=!1)}))}},r}(y))||m);r._RF.pop()}}}));

System.register("chunks:///_virtual/PyramidDrawLayer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./constants.ts","./designManager.ts","./UserData.ts","./PropItemPrefab.ts","./BaseUILayer.ts"],(function(t){var e,i,n,a,r,s,o,c,l,u,d,m,p,y,h;return{setters:[function(t){e=t.applyDecoratedDescriptor,i=t.inheritsLoose,n=t.initializerDefineProperty,a=t.assertThisInitialized},function(t){r=t.cclegacy,s=t._decorator,o=t.Node,c=t.Label,l=t.instantiate,u=t.v3},function(t){d=t.constants},function(t){m=t.designManager},function(t){p=t.UserData},function(t){y=t.PropItemPrefab},function(t){h=t.BaseUILayer}],execute:function(){var g,f,I,w,b,D,_,v,L,x,T;r._RF.push({},"0be3fNof/RKgZVm96nTa8+r","PyramidDrawLayer",void 0);var S=s.ccclass,C=s.property;t("PyramidDrawLayer",(g=S("PyramidDrawLayer"),f=C({type:o}),I=C({type:o}),w=C({type:o}),b=C({type:c}),g((v=e((_=function(t){function e(){for(var e,i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return e=t.call.apply(t,[this].concat(r))||this,n(e,"btnClose",v,a(e)),n(e,"propItem",L,a(e)),n(e,"itemLayer",x,a(e)),n(e,"coinLabel",T,a(e)),e.items=[],e._index=0,e._dtTime=0,e._isStartRun=!1,e._endIndex=0,e._drawItemArr=[],e._isDoubleDraw=!1,e}i(e,t);var r=e.prototype;return r.onLoad=function(){},r.onDisable=function(){t.prototype.onDisable.call(this)},r.onDestroy=function(){t.prototype.onDestroy.call(this)},r.start=function(){this.initItems()},r.closeBless=function(){this.closeLayer()},r.initItems=function(){for(var t=m.getRowsByType(d.tableName.CNTM,3),e=0;e<t.length;e++){this._drawItemArr.push(t[e].award);var i=l(this.propItem);this.itemLayer.getChildByName("node"+(e+1)).addChild(i),this.items[e]=i,i.position=u(0,0,0),i.getComponent(y).setView(t[e].award[0][0],t[e].award[0][1],y.Type_UnTouch),i.getComponent(y).setScale(109),i.getChildByName("xuanzhong").active=!1}this.initItemState()},r.initItemState=function(){for(var t=0;t<10&&t<this.items.length;t++){var e=this.items[t];e.getChildByName("grayMask").active=1==p.getInstance().$pyramidState[t],e.getChildByName("xuanzhong").active=!1}var i=m.config.jinzita;this.coinLabel.string=i[p.getInstance().$pyramidDrawTime]},r.update=function(t){if(this._isStartRun&&(this._dtTime+=t,this._dtTime>.1)){this._dtTime=0,this._index++;for(var e=0;e<10;e++)this.items[e].getChildByName("xuanzhong").active=!1;var i=this.getDrawIndex(this._index,this._index>=this._endIndex);if(this.items[i].getChildByName("xuanzhong").active=!0,this._index>=this._endIndex){this._isStartRun=!1;var n=this._drawItemArr[i][0],a={Id:n[0],Num:this._isDoubleDraw?2*n[1]:n[1]};p.getInstance().getRewardProp([a]),this.openLayer(d.layers.RewardLayer,{propArr:[a]}),p.getInstance().setPyramidState(i),p.getInstance().$pyramidDrawTime++,p.getInstance().$pyramidDrawTime>=10&&(p.getInstance().$pyramidDrawTime=0,p.getInstance().$pyramidState=[0,0,0,0,0,0,0,0,0,0]),this.initItemState()}}},r.getDrawIndex=function(t,e){if(9==p.getInstance().$pyramidDrawTime)return 0;for(var i=[],n=e?1:0;n<p.getInstance().$pyramidState.length;n++)0==p.getInstance().$pyramidState[n]&&i.push(n);return i[t%i.length]},r.startDraw=function(){},r.doubleDraw=function(){},e}(h)).prototype,"btnClose",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),L=e(_.prototype,"propItem",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),x=e(_.prototype,"itemLayer",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),T=e(_.prototype,"coinLabel",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),D=_))||D));r._RF.pop()}}}));

System.register("chunks:///_virtual/Quests.ts",["./rollupPluginModLoBabelHelpers.js","cc","./constants.ts","./BaseUILayer.ts","./designManager.ts","./UserData.ts"],(function(t){var e,i,n,a,r,o,s,l,u,c,p,d,g,h,f;return{setters:[function(t){e=t.applyDecoratedDescriptor,i=t.inheritsLoose,n=t.initializerDefineProperty,a=t.assertThisInitialized},function(t){r=t.cclegacy,o=t._decorator,s=t.Node,l=t.Label,u=t.find,c=t.ProgressBar,p=t.Sprite},function(t){d=t.constants},function(t){g=t.BaseUILayer},function(t){h=t.designManager},function(t){f=t.UserData}],execute:function(){var m,b,y,w,k,C,B,S,v,L,T,V,N,M,z,_,D,P,F;r._RF.push({},"9d3aehWTvZE3qwo2TAeJMkh","Quests",void 0);var I=o.ccclass,Q=o.property;t("Quests",(m=I("Quests"),b=Q({type:s,tooltip:"任务列表View"}),y=Q({type:s,tooltip:"任务列表容器View"}),w=Q({type:s,tooltip:"排行榜列表View"}),k=Q({type:s,tooltip:"排行榜列表容器View"}),C=Q({type:s,tooltip:"切换任务按钮"}),B=Q({type:s,tooltip:"切换排行榜按钮"}),S=Q({type:s,tooltip:"任务界面"}),v=Q({type:s,tooltip:"排行榜界面"}),m((V=e((T=function(t){function e(){for(var e,i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return e=t.call.apply(t,[this].concat(r))||this,n(e,"taskScrollView",V,a(e)),n(e,"taskScrollContentView",N,a(e)),n(e,"userScrollView",M,a(e)),n(e,"userScrollContentView",z,a(e)),n(e,"btnMidnightTasks",_,a(e)),n(e,"btnLeaderBoard",D,a(e)),n(e,"uiMidnightTasks",P,a(e)),n(e,"uiLeaderBoard",F,a(e)),e}i(e,t);var r=e.prototype;return r.start=function(){this.initList()},r.onLoad=function(){t.prototype.onLoad.call(this),this.onChgTab(null,1)},r.initList=function(){var t=this,e=this.getTaskList();this.scrollViewSetData(this.taskScrollView,e,(function(e,i,n){t.setSpriteFrame2(e.getChildByName("icon"),"earn/"+i.icon,null,d.bundles.ui),e.getChildByName("center").getChildByName("desc").getComponent(l).string=i.description,u("center/ProgressBar",e).getComponent(c).progress=i.finish/i.total,u("center/ProgressBar/progress",e).getComponent(l).string=i.finish+"/"+i.total,u("awardNum",e).getComponent(l).string=i.awardNum,t.setTaskBtnSprite(u("btn",e),u("btnClaimed",e),i.status)}))},r.setTaskBtnSprite=function(t,e,i){if(console.log(i,"------ taskStatus"),2!==i){var n=0==i?"gobtn":"verify";this.setSpriteFrame2(t,"earn/"+n,null,d.bundles.ui)}else t.active=!1,e.active=!0},r.changeTaskStatus=function(){console.log(this.node)},r.getTaskList=function(){var t=f.getInstance().getPropSort(),e=[];return t.forEach((function(t){var i=1==t.iswear?t.num-1:t.num,n=h.getRowById(d.tableName.prop,t.id);if(8==n.type||11==n.type)for(var a=0;a<i;a++)e.push(t.id)})),[{icon:"ap_task",description:"Reach 100 enemy defeats",status:0,awardNum:500,total:100,finish:100},{icon:"ap_task",description:"30 minutes survival time",status:1,awardNum:300,total:30,finish:18},{icon:"ap_task",description:"Weekly challenge",status:2,awardNum:400,total:30,finish:30},{icon:"ap_task",description:"Complete 30 gacha pulls",status:1,awardNum:100,total:100,finish:30}]},r.update=function(t){},r.onClickBtnClose=function(){this.closeLayer()},r.onDestroy=function(){t.prototype.onDestroy.call(this)},r.onChgTab=function(t,e){var i=this;console.log(e,"1123123123datadata"),1==e?(this.uiMidnightTasks.active=!0,this.uiLeaderBoard.active=!1,this.btnMidnightTasks.getComponent(p).enabled=!0,this.btnLeaderBoard.getComponent(p).enabled=!1):(this.uiMidnightTasks.active=!1,this.uiLeaderBoard.active=!0,this.btnMidnightTasks.getComponent(p).enabled=!1,this.btnLeaderBoard.getComponent(p).enabled=!0,this.userScrollView&&(console.log(this.userScrollView,"------- this.userScrollView"),this.scrollViewSetData(this.userScrollView,[{icon:"ap_task",description:"Weekly challenge",status:2,awardNum:400,total:30,finish:30},{icon:"ap_task",description:"Complete 30 gacha pulls",status:1,awardNum:100,total:100,finish:30}],(function(t,e,n){i.setSpriteFrame2(t.getChildByName("icon"),"earn/"+e.icon,null,d.bundles.ui),t.getChildByName("center").getChildByName("desc").getComponent(l).string=e.description,u("center/ProgressBar",t).getComponent(c).progress=e.finish/e.total,u("center/ProgressBar/progress",t).getComponent(l).string=e.finish+"/"+e.total,u("awardNum",t).getComponent(l).string=e.awardNum,i.setTaskBtnSprite(u("btn",t),u("btnClaimed",t),e.status)}))))},e}(g)).prototype,"taskScrollView",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),N=e(T.prototype,"taskScrollContentView",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),M=e(T.prototype,"userScrollView",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),z=e(T.prototype,"userScrollContentView",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),_=e(T.prototype,"btnMidnightTasks",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),D=e(T.prototype,"btnLeaderBoard",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),P=e(T.prototype,"uiMidnightTasks",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),F=e(T.prototype,"uiLeaderBoard",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),L=T))||L));r._RF.pop()}}}));

System.register("chunks:///_virtual/RedPointLogicMgr.ts",["./rollupPluginModLoBabelHelpers.js","cc","./constants.ts","./msgac.ts","./UserData.ts","./eventManager.ts","./GParam.ts","./MapWrap.ts","./resManager.ts"],(function(t){var e,i,s,a,n,r,h,o,c,u,d,f,_,p;return{setters:[function(t){e=t.createForOfIteratorHelperLoose},function(t){i=t.cclegacy,s=t.find,a=t.Prefab,n=t.instantiate,r=t.UITransform,h=t.v3},function(t){o=t.constants},function(t){c=t.msgac},function(t){u=t.UserData},function(t){d=t.eventManager},function(t){f=t.default},function(t){_=t.MapWrap},function(t){p=t.resManager}],execute:function(){i._RF.push({},"0faa7hvRx1OMqT4CCzxOcdG","RedPointLogicMgr",void 0);var l=/^[0-9]+.?[0-9]*$/,g=t("RED_POINT_NAME","red_point"),k=(t("RED_POINT_LABEL_NAME","label"),t("RPointMask",function(t){return t[t.RPM_Client=300]="RPM_Client",t[t.RPM_PropWear=301]="RPM_PropWear",t[t.RPM_BlessProp=302]="RPM_BlessProp",t}({}))),v=t("RedpointPos",function(t){return t[t.Main=0]="Main",t[t.right=1]="right",t}({})),P=(t("INVALID_VALUE_ZERO",0),t("INVALID_VALUE",-1));t("INVALID_STRING_VALUE","-1");t("RedPointLogicMgr",function(){function t(){this._redPointMask=void 0,this._waitSends=void 0,this._waitChecks=void 0,this._updateHandler=P,this._unlockMasks=void 0,this._targets=void 0,this._targetWraps=void 0,this._masks=void 0}t.ins=function(){return null==this._instance&&(this._instance=new t,this._instance.initGame()),this._instance};var i=t.prototype;return i.update=function(){this.updateCheck(),this.updateVisit(),this.checkState()},i.initGame=function(){this.initEvent(),this._redPointMask=new _,this._waitSends=[],this._waitChecks=[],this._unlockMasks=[],this._targets=new _,this._targetWraps=new _,this._masks=new _,this.stopUpdate();for(var t=0,e=Object.keys(k);t<e.length;t++){var i=e[t];l.test(i)&&this._waitChecks.push(parseInt(i))}this.checkState()},i.initEvent=function(){d.on(c.redPointEvent,this.onCMSGRPValueSetting,this)},i.updateState=function(){for(var t=0,e=Object.keys(k);t<e.length;t++){var i=e[t];if(l.test(i))this._waitChecks.indexOf(parseInt(i))===P&&this._waitChecks.push(parseInt(i))}this.checkState()},i.on=function(t,i){var s,a=this._targets.get(t.uuid);a||(a=[],this._targets.set(t.uuid,a),this._targetWraps.set(t.uuid,t)),(s=a).push.apply(s,i);for(var n,r=e(i);!(n=r()).done;){for(var h,o=n.value,c=!1,u=e(o.mask);!(h=u()).done;){var d=h.value,f=this._masks.get(d);f||(f=[],this._masks.set(d,f)),f.indexOf(t)==P&&f.push(t),c=c||this._redPointMask.get(d)}this.setRPointView(t,o.subPath,c,o.effectType,o.posType,o.cb)}},i.off=function(t){var i=this._targets.get(t.uuid);if(i){for(var s,a=e(i);!(s=a()).done;)for(var n,r=s.value,h=e(r.mask);!(n=h()).done;){var o=n.value,c=this._masks.get(o);if(c){var u=c.indexOf(t);u!=P&&c.splice(u,1),0==c.length&&this._masks.delete(o)}}this._targets.delete(t.uuid),this._targetWraps.delete(t.uuid)}},i.loginOut=function(){this.stopUpdate(),d.offWithSender(this),this._waitChecks=[],this._waitSends=[],this._targets.clear(),this._targetWraps.clear(),this._masks.clear()},i.sendValueSettingMsg=function(t,e,i){var s={mask:t,value:e,forceStop:i};this.onCMSGRPValueSetting(this,new f(s))},i.sendValuesSettingMsgs=function(t,e,i){for(var s=0;s<t.length;s++)this.sendValueSettingMsg(t[s],e,i)},i.timingCheck=function(){},i.onCMSGRPValueSetting=function(t,e){var i=e.get();if(1==i.value){var s=this._waitChecks.indexOf(i.mask);if(s!=P&&this._waitChecks.splice(s,1),this._redPointMask.get(i.mask))return;if(this._redPointMask.set(i.mask,i.value),this._waitSends.indexOf(i.mask)!=P)return;this._waitSends.push(i.mask)}else if(1==i.forceStop){var a=this._waitChecks.indexOf(i.mask);if(a!=P&&this._waitChecks.splice(a,1),this._redPointMask.set(i.mask,i.value),this._waitSends.indexOf(i.mask)!=P)return;this._waitSends.push(i.mask)}else this._waitChecks.indexOf(i.mask)==P&&this._waitChecks.push(i.mask);this.checkState()},i.startUpdate=function(){this._updateHandler==P&&(this._updateHandler=setInterval(this.update.bind(this),100))},i.stopUpdate=function(){P!=this._updateHandler&&(clearInterval(this._updateHandler),this._updateHandler=P)},i.checkState=function(){this._waitChecks.length>0||this._waitSends.length>0?this._updateHandler==P&&this.startUpdate():0==this._waitChecks.length&&0==this._waitSends.length&&this._updateHandler!=P&&this.stopUpdate()},i.updateCheck=function(){if(0!=this._waitChecks.length){var t=this._waitChecks.shift(),e=!0;if(e)switch(e=!1,t){case k.RPM_Client:break;case k.RPM_PropWear:e=u.getInstance().checkBestPropToWear();break;default:e=!1}this._redPointMask.get(t)!=e&&(this._redPointMask.set(t,e),this._waitSends.indexOf(t)==P&&this._waitSends.push(t))}},i.updateVisit=function(){if(0!=this._waitSends.length){var t=this._waitSends.shift(),i=this._redPointMask.get(t),s=this._masks.get(t);if(s&&0!=s.length)for(var a,n=e(s);!(a=n()).done;){var r=a.value,h=this._targets.get(r.uuid);if(!h)return;for(var o,c=e(h);!(o=c()).done;){var u=o.value;if(u&&u.mask.indexOf(t)!=P)if(1==i)this.setRPointView(r,u.subPath,i,u.effectType,u.posType,u.cb);else{for(var d,f=!1,_=e(u.mask);!(d=_()).done;){var p=d.value;if(this._redPointMask.get(p)){f=!0;break}}this.setRPointView(r,u.subPath,f,u.effectType,u.posType,u.cb)}}}}},i.setRPointView=function(t,e,i,c,u,d){var f=t;if(e&&(f="string"==typeof e?s(e,t):e),f){var _=f.getChildByName(g);i?_?_.active=!0:(p.loadAsset(o.bundles.prefab,"redpoint/gth",a,(function(){}),(function(t,e){var i=n(e),s=f.getComponent(r)||f.addComponent(r);switch(u){case v.Main:i.position=h(s.width*(1-s.anchorX),s.height*(1-s.anchorY)-20,1);break;case v.right:i.position=h(s.width*(1-s.anchorX)-30,s.height*(1-s.anchorY)-0,1);break;default:i.position=h(s.width*(1-s.anchorX)-25,s.height*(1-s.anchorY)-10,1)}i.name=g,f.addChild(i)})),d&&d(f)):_&&(_.active=!1)}},i.getMaskRedpointState=function(t){for(var e=0;e<t.length;e++){var i=this._redPointMask.get(t[e]);if(i)return i}return!1},t}())._instance=null,i._RF.pop()}}}));

System.register("chunks:///_virtual/redPointManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./constants.ts","./msgac.ts","./eventManager.ts","./SingleInstance.ts"],(function(e){var t,n,r,i,a,s,o;return{setters:[function(e){t=e.inheritsLoose},function(e){n=e.cclegacy,r=e.sys},function(e){i=e.constants},function(e){a=e.msgac},function(e){s=e.eventManager},function(e){o=e.SingleInstance}],execute:function(){n._RF.push({},"d76b4ECTxFBeJW28SdyuHMm","redPointManager",void 0);e("redPointManager",function(e){function n(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return(t=e.call.apply(e,[this].concat(r))||this).key=i.gameName+"_redPoint",t}t(n,e);var o=n.prototype;return o.getRedPointByLayer=function(e){var t=r.localStorage.getItem(this.key),n=!1;t?t=JSON.parse(t):(t={},n=!0);var i=t[e];return i||(i={},t[e]=i,n=!0),n&&r.localStorage.setItem(this.key,JSON.stringify(t)),i},o.setRedPointByLayer=function(e,t){var n=r.localStorage.getItem(this.key);(n=n?JSON.parse(n):{})[e]=t,r.localStorage.setItem(this.key,JSON.stringify(n)),s.send(a.refreshRedPoint)},o.hasRedPointValue=function(e,t,n){var r=this.getRedPointByLayer(e);if(null!=n){if(Array.isArray(r[t]))if(-1!=r[t].indexOf(n))return!0;return!1}return Array.isArray(r[t])?r[t].length>0:!!r[t]},o.addRedPointValue=function(e,t,n){var r=this.getRedPointByLayer(e);n?(Array.isArray(r[t])||(r[t]=[]),-1==r[t].indexOf(n)&&(r[t].push(n),this.setRedPointByLayer(e,r))):(r[t]=1,this.setRedPointByLayer(e,r))},o.removeRedPointValue=function(e,t,n){var r=this.getRedPointByLayer(e),i=r[t];if(null!=n){if(Array.isArray(i)){var a=i.indexOf(n);if(-1!=a)return r[t].splice(a,1),this.setRedPointByLayer(e,r),!0}return!1}return!!i&&(delete r[t],this.setRedPointByLayer(e,r),!0)},o.clearRedPointLayer=function(e,t){var n=this.getRedPointByLayer(e);null==t?this.setRedPointByLayer(e,void 0):(delete n[t],this.setRedPointByLayer(e,n))},n}(o).getInstance());n._RF.pop()}}}));

System.register("chunks:///_virtual/RenderChildBatch.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts"],(function(e){var r,t,n,o,i;return{setters:[function(e){r=e.inheritsLoose},function(e){t=e.cclegacy,n=e._decorator,o=e.UIRenderer},function(e){i=e.cocosUtil}],execute:function(){var a;t._RF.push({},"90cc8pku5RGPpMncsL+g+VD","RenderChildBatch",void 0);var d=n.ccclass;n.property,e("RenderChildBatch",d("RenderChildBatch")(a=function(e){function t(){for(var r,t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(r=e.call.apply(e,[this].concat(n))||this).pathArr=[],r.path2RenderArr=new Map,r.rootNodeArr=[],r}r(t,e);var n=t.prototype;return n.addRootItemNode=function(e){-1==this.rootNodeArr.indexOf(e)&&(this.pauseRender(e,""),this.rootNodeArr.push(e))},n.pauseRender=function(e,r){var t=this;if(i.isValid(e)){var n=r+e.name,a=e.getComponent(o);if(a){-1==this.pathArr.indexOf(n)&&this.pathArr.push(n);var d=this.path2RenderArr.get(n);d||(d=[],this.path2RenderArr.set(n,d)),-1==d.indexOf(a)&&(a._realRender||(a._realRender=a._render,a._render=function(){}),d.push(a))}e.children.forEach((function(e){t.pauseRender(e,n+"/")}))}},n.removeRootItemNode=function(e){this.removeRender(e,"");var r=this.rootNodeArr.indexOf(e);r>=0&&this.rootNodeArr.splice(r,1)},n.removeRender=function(e,r){var t=this;if(i.isValid(e)){var n=r+e.name,a=this.path2RenderArr.get(n);if(a){var d=e.getComponent(o);if(d){d._realRender&&(d._render=d._realRender,delete d._realRender);var s=a.indexOf(d);-1!=s&&a.splice(s,1)}}e.children.forEach((function(e){t.removeRender(e,n+"/")}))}},n.updateAssembler=function(e){},n.postUpdateAssembler=function(e){var r=this;this.pathArr.forEach((function(t){var n=r.path2RenderArr.get(t),o=[];n.forEach((function(r){i.isValid(r)&&i.isValid(r.node)&&(o.push(r),r.node.activeInHierarchy&&r._renderFlag&&r._assembler&&r._realRender(e))})),r.path2RenderArr.set(t,o)}))},n.onDestroy=function(){var e=this;this.pathArr.forEach((function(r){e.path2RenderArr.get(r).forEach((function(e){i.isValid(e)&&e._realRender&&(e._render=e._realRender,delete e._realRender)}))})),this.path2RenderArr=void 0,this.pathArr=void 0,this.rootNodeArr=void 0},t}(o))||a);t._RF.pop()}}}));

System.register("chunks:///_virtual/resManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./myLog.ts"],(function(e){var n,t,s,a,o,r,i;return{setters:[function(e){n=e.createClass},function(e){t=e.cclegacy,s=e.assetManager,a=e.SpriteFrame,o=e.sp,r=e.Texture2D},function(e){i=e.myLog}],execute:function(){t._RF.push({},"455cfmCB5pAb4qrTZDbg6Un","resManager",void 0);var u=function(){function e(){}var t=e.prototype;return t.loadAsset=function(e,n,t,o,u){t==a?n+="/spriteFrame":t==r&&(n+="/texture");var l=s.getBundle(e);if(l&&l.get(n,t))u&&u(null,l.get(n,t));else{var d=function(){l.load(n,t,(function(e,n){o&&o(e/n)}),(function(t,s){if(t)return i.e("ResManager.loadAsset error:"+t.message,"bundleName:"+e,"path:"+n,t),void(u&&u(t));u&&u(null,s)}))};l?d():s.loadBundle(e,(function(e,n){e?u&&u(e):(l=n,d())}))}},t.loadAssetByPathArr=function(e,n,t,s,a){var o=this,r=n.length;if(r<=0)a&&a([]);else for(var i=0,u=1/r,l=new Map,d=0,c=[],f=function(){var f=n[h];o.loadAsset(e,f,t,(function(e){if(l.set(f,e),s){var n=0;l.forEach((function(e){n+=u*e})),n>=i&&(i=n,s(n))}}),(function(e,n){d++,!e&&n&&(n.path=f,c.push(n)),d>=r&&a&&a(c)}))},h=0;h<r;h++)f()},t.loadAssetByBundleDir=function(e,n,t,a,o){var r=s.getBundle(e),u=function(){r.loadDir(n,t,(function(e,n,t){a&&a(e/n,t)}),(function(e,n){e&&i.e("ResManager.loadAssetByBundleDir loadDir error:"+e.message,e),o&&o(n)}))};r?u():s.loadBundle(e,(function(e,n){e?i.e("ResManager.loadAssetByBundleDir loadBundle error:"+e.message,e):(r=n,u())}))},t.loadBundleArr=function(e,n,t){var a=e.length;if(a<=0)t&&t();else for(var o=0,r=[],i=0;i<a;i++){var u=e[i];s.loadBundle(u,(function(e,s){o++,e||r.push(s),o>=a&&t&&t(r),n&&n(o/a)}))}},t.releaseAsset=function(e){s.releaseAsset(e)},t.loadAssetConfigArr=function(e,n,t,s){var a=this;void 0===n&&(n=!1);var o=0;if(e&&e.length>0&&(o=e.length),o<=0)s&&s();else{var r=0,i=[];!function u(){var l=e[r];l?a.loadAsset(l.bundle,l.path,l.type,null,(function(e,s){!e&&s&&(i.push(s),n&&s.addRef(),l.asset=s),r++,u(),t&&t(r/o)})):s&&s(i)}()}},t.loadSpriteFrame=function(e,n,t){this.loadAsset(e,n,a,null,(function(e,n){t&&t(e,n)}))},t.loadSpineData=function(e,n,t){this.loadAsset(e,n,o.SkeletonData,null,(function(e,n){t&&t(e,n)}))},n(e,null,[{key:"instance",get:function(){return this._instance||(this._instance=new e),this._instance}}]),e}();u._instance=void 0;e("resManager",u.instance),e("ResLoader",function(){function e(){this.loadedAssetArr=[]}var n=e.prototype;return n.addAsset=function(e){e&&-1==this.loadedAssetArr.indexOf(e)&&(e.addRef(),this.loadedAssetArr.push(e))},n.releaseAllAsset=function(){this.loadedAssetArr.forEach((function(e){e.decRef()})),this.loadedAssetArr=[]},e}()),e("AssetConfig",(function(){this.bundle=void 0,this.path=void 0,this.type=void 0,this.asset=void 0}));t._RF.pop()}}}));

System.register("chunks:///_virtual/RewardItemLayer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./sdkManager.ts","./constants.ts","./audioManager.ts","./designManager.ts","./UserData.ts","./PropItemPrefab.ts","./BaseUILayer.ts"],(function(t){var e,n,a,r,o,i,s,c,l,p,u,y,f,d;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,a=t.initializerDefineProperty,r=t.assertThisInitialized},function(t){o=t.cclegacy,i=t._decorator,s=t.Node},function(t){c=t.sdkManager},function(t){l=t.constants},function(t){p=t.audioManager},function(t){u=t.designManager},function(t){y=t.UserData},function(t){f=t.PropItemPrefab},function(t){d=t.BaseUILayer}],execute:function(){var g,h,I,m,b,D,L;o._RF.push({},"9da75dBS1FHWIYJMlL73pxg","RewardItemLayer",void 0);var w=i.ccclass,v=i.property;t("RewardItemLayer",(g=w("RewardItemLayer"),h=v({type:s}),I=v({type:s}),g((D=e((b=function(t){function e(){for(var e,n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return e=t.call.apply(t,[this].concat(o))||this,a(e,"btnClose",D,r(e)),a(e,"propItem",L,r(e)),e}n(e,t);var o=e.prototype;return o.onLoad=function(){t.prototype.onLoad.call(this)},o.onEnable=function(){var t=this.layerData.propId,e=this.layerData.num;this.propItem.getComponent(f).setView(t,e,f.Type_UnTouch)},o.getRewardProp=function(){p.playEffect("btnClick");var t={Id:this.layerData.propId,Num:this.layerData.num},e=this,n=u.getRowById(l.tableName.prop,this.layerData.propId);c.openAd("获得道具"+n.name,(function(n){1==n&&(y.getInstance().getRewardProp([t]),e.closeLayer())}))},o.onDisable=function(){t.prototype.onDisable.call(this)},o.onDestroy=function(){t.prototype.onDestroy.call(this)},o.start=function(){},o.closeLayer=function(){p.playEffect("btnClick"),t.prototype.closeLayer.call(this)},e}(d)).prototype,"btnClose",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),L=e(b.prototype,"propItem",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),m=b))||m));o._RF.pop()}}}));

System.register("chunks:///_virtual/RewardLayer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./utilTools.ts","./audioManager.ts","./AnimationCtrl.ts","./PropItemPrefab.ts","./BaseUILayer.ts"],(function(t){var e,n,o,a,i,r,l,s,c,u,p,h,y,f,d,m,b,g,w;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,o=t.initializerDefineProperty,a=t.assertThisInitialized},function(t){i=t.cclegacy,r=t._decorator,l=t.Prefab,s=t.Node,c=t.UITransform,u=t.instantiate,p=t.v3,h=t.sp,y=t.macro},function(t){f=t.cocosUtil},function(t){d=t.utilTools},function(t){m=t.audioManager},function(t){b=t.AnimationCtrl},function(t){g=t.PropItemPrefab},function(t){w=t.BaseUILayer}],execute:function(){var L,v,R,I,C,D,P,A,E;i._RF.push({},"beb79qFxopP26nxiIZWSe0F","RewardLayer",void 0);var M=r.ccclass,T=r.property;t("RewardLayer",(L=M("RewardLayer"),v=T({type:l}),R=T({type:s}),I=T({type:s}),L((P=e((D=function(t){function e(){for(var e,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=t.call.apply(t,[this].concat(i))||this,o(e,"propItem",P,a(e)),o(e,"listLayer",A,a(e)),o(e,"yanhua",E,a(e)),e}n(e,t);var i=e.prototype;return i.onLoad=function(){t.prototype.onLoad.call(this)},i.onEnable=function(){t.prototype.onEnable.call(this),this.showReward(),this.showYanhua()},i.showReward=function(){var t=this.layerData.propArr,e=this;this.layerData.notMoveAni||this.scheduleOnce((function(){e.showGetReward(t)}),.5),this.listLayer.getComponent(c).width=Math.min(135*t.length,675);for(var n=0;n<t.length;n++){var o=t[n],a=u(this.propItem);this.listLayer.addChild(a),a.getComponent(g).setViewSuper(o,n,g.Type_UnTouch),a.getComponent(g).setScale(120)}},i.showYanhua=function(){var t=this,e=[p(-100,200,0),p(0,-100,0),p(150,-250,0),p(300,-500,0),p(100,-450,0)];f.schedule(this,(function(){if(!(e.length<=0)){var n=Math.random()>.5?"huang":"lan",o=.8+.2*Math.random(),a=d.getRandomItemByArr(e,!0),i=f.instantiate(t.yanhua);i.parent=t.node,i.active=!0,i.position=a,i.scale=p(o,o,1),i.getComponent(h.Skeleton).setSkin(n),f.addComponentOnce(i,b).playAnimationOnce("animation",(function(){i.parent=null}))}}),1.5,y.REPEAT_FOREVER,0,!0)},i.onDisable=function(){t.prototype.onDisable.call(this)},i.onDestroy=function(){t.prototype.onDestroy.call(this)},i.start=function(){},i.closeLayer=function(){m.playEffect("btnClick"),t.prototype.closeLayer.call(this)},e}(w)).prototype,"propItem",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),A=e(D.prototype,"listLayer",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),E=e(D.prototype,"yanhua",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),C=D))||C));i._RF.pop()}}}));

System.register("chunks:///_virtual/ScrollViewUtil.ts",["./rollupPluginModLoBabelHelpers.js","cc","./myLog.ts","./RenderChildBatch.ts"],(function(t){var e,i,s,r,h,n,o,a,l,d,c,m,f,g,v,u,p;return{setters:[function(t){e=t.inheritsLoose,i=t.createForOfIteratorHelperLoose},function(t){s=t.cclegacy,r=t._decorator,h=t.ScrollView,n=t.UITransform,o=t.Layout,a=t.find,l=t.sys,d=t.instantiate,c=t.isValid,m=t.game,f=t.v3,g=t.tween,v=t.Component},function(t){u=t.myLog},function(t){p=t.RenderChildBatch}],execute:function(){var I;s._RF.push({},"474e7yR1ohEFZ+vBo1l4dgO","ScrollViewUtil",void 0);var w=r.ccclass;r.property,t("ScrollViewUtil",w("ScrollViewUtil")(I=function(t){function s(){for(var e,i=arguments.length,s=new Array(i),r=0;r<i;r++)s[r]=arguments[r];return(e=t.call.apply(t,[this].concat(s))||this).scrollView=void 0,e.vertical=!0,e.gapX=0,e.gapY=0,e.paddingLeft=0,e.paddingRight=0,e.paddingTop=0,e.paddingBottom=0,e.contentNode=void 0,e.contentTransform=void 0,e.viewNode=void 0,e.viewWidth=void 0,e.viewHeight=void 0,e.viewTransform=void 0,e.itemUI=void 0,e.itemUITransform=void 0,e.itemUIWidth=0,e.itemUIHeight=0,e.itemUIFreeArr=[],e.startPosX=0,e.startPosY=0,e.viewNum=0,e.changeNum=1,e.maxLines=1,e.frameUpdateArr=[],e.frameTime=Math.floor(1e3/(m.getFrameRate()+10)),e.itemArr=[],e.refreshItemFunc=void 0,e.itemTween=!1,e.setDataFlag=!1,e.startIndex=0,e.stopIndex=0,e.renderChildBatch=null,e}e(s,t);var r=s.prototype;return r.onLoad=function(){var t=this;this.scrollView=this.node.getComponent(h),this.contentNode=this.scrollView.content,this.itemUI=this.contentNode.children[0],this.itemUI||u.e("=============ScrollViewUtil itemUI is null:"+this.node.name),this.itemUITransform=this.itemUI.getComponent(n),this.itemUIWidth=this.itemUITransform.width,this.itemUIHeight=this.itemUITransform.height,this.vertical=this.scrollView.vertical;var e=this.contentNode.getComponent(o);this.gapX=e.spacingX,this.gapY=e.spacingY,this.paddingLeft=e.paddingLeft,this.paddingRight=e.paddingRight,this.paddingTop=e.paddingTop,this.paddingBottom=e.paddingBottom,e.enabled=!1,this.contentTransform=this.contentNode.getComponent(n);var i=this.contentTransform.width,s=this.contentTransform.height;this.viewNode=a("view",this.node),this.viewTransform=this.viewNode.getComponent(n),this.viewWidth=this.viewTransform.width,this.viewHeight=this.viewTransform.height,this.itemUIFreeArr=[],this.contentNode.children.forEach((function(e){e.active=!1,t.itemUIFreeArr.push(e)})),this.vertical?(this.viewTransform.anchorX=.5,this.viewTransform.anchorY=1,this.contentTransform.anchorX=.5,this.contentTransform.anchorY=1,this.viewNum=Math.ceil(this.viewHeight/(this.itemUIHeight+this.gapY))+1,this.changeNum=Math.floor((i+this.gapX-this.paddingLeft-this.paddingRight)/(this.itemUIWidth+this.gapX))):(this.viewTransform.anchorX=0,this.viewTransform.anchorY=.5,this.contentTransform.anchorX=0,this.contentTransform.anchorY=.5,this.viewNum=Math.ceil(this.viewWidth/(this.itemUIWidth+this.gapX))+1,this.changeNum=Math.floor((s+this.gapY-this.paddingTop-this.paddingBottom)/(this.itemUIHeight+this.gapY))),this.changeNum<1&&(this.changeNum=1),this.startPosX=this.itemUIWidth*this.itemUITransform.anchorX-this.contentTransform.width*this.contentTransform.anchorX+this.paddingLeft,this.startPosY=s*(1-this.contentTransform.anchorY)-this.itemUIHeight*(1-this.itemUITransform.anchorY)-this.paddingTop,this.node.on("scrolling",this.onScrolling,this),this.frameUpdateArr=[],this.addRenderChildBatch()},r.addRenderChildBatch=function(){l.isNative||this.renderChildBatch||(this.renderChildBatch=this.contentNode.addComponent(p))},r.onScrolling=function(){if(!(this.itemArr.length<=0)){var t=0;if(this.vertical){var e=this.contentNode.getPosition().y;e>this.contentTransform.height-this.viewHeight&&(e=this.contentTransform.height-this.viewHeight),e<0&&(e=0),t=Math.floor((e+this.gapY-this.paddingTop)/(this.itemUIHeight+this.gapY))}else{var i=this.contentNode.getPosition().x;i<this.viewWidth-this.contentTransform.width&&(i=this.viewWidth-this.contentTransform.width),i>0&&(i=0),i=Math.abs(i),t=Math.floor((i+this.gapX-this.paddingLeft)/(this.itemUIWidth+this.gapX))}t<0&&(t=0),t>this.maxLines-1&&(t=this.maxLines-1);var s=t+this.viewNum;s>this.maxLines-1&&(s=this.maxLines-1),t==this.startIndex&&s==this.stopIndex||(this.startIndex=t,this.stopIndex=s,this.renderItemArr())}},r.renderItemArr=function(){for(var t=null,e=this.startIndex*this.changeNum,i=0;i<e;i++)t=this.itemArr[i],this.recycleItem(t);for(var s=e=(this.stopIndex+1)*this.changeNum;s<this.itemArr.length;s++)t=this.itemArr[s],this.recycleItem(t);for(var r=this.startIndex;r<=this.stopIndex;r++)for(var h=r*this.changeNum,n=h+this.changeNum,o=h;o<n;o++)this.itemArr[o]&&((t=this.itemArr[o]).node||(t.needUpdate=!0,this.frameUpdateArr.push(t)));this.startFrameUpdate()},r.createNode=function(){var t=null;return(t=this.itemUIFreeArr.length>0?this.itemUIFreeArr.shift():d(this.itemUI)).parent=this.contentNode,this.renderChildBatch&&this.renderChildBatch.addRootItemNode(t),t},r.startFrameUpdate=function(){for(var t=this,e=(new Date).getTime(),i=function(){if(!t.frameUpdateArr||t.frameUpdateArr.length<=0)return t.setDataFlag=!1,0;var i=t.frameUpdateArr.shift();if(!i.needUpdate)return 1;if(i.node||(i.node=t.createNode()),i.node.active||(i.node.active=!0),i.node.setPosition(i.x,i.y),i.node.item=i.data,i.node.index=i.index,i.node.scale=f(1,1,1),i.node.showTween&&(i.node.showTween.stop(),i.node.showTween=void 0),t.refreshItemFunc(i.node,i.data,i.index),t.itemTween&&t.setDataFlag){i.node.setScale(0,0,1);var s=g(i.node).to(.2,{scale:f(1.2,1.2,1)}).to(.1,{scale:f(1,1,1)}).call((function(){i.node.showTween=void 0})).start();return i.node.showTween=s,t.scheduleOnce((function(){t.startFrameUpdate()}),.05),0}return(new Date).getTime()-e>=t.frameTime?(t.scheduleOnce(t.startFrameUpdate.bind(t)),0):void 0};0!==i(););},r.recycleItem=function(t){t.node&&c(t.node)&&(-1==this.itemUIFreeArr.indexOf(t.node)&&this.itemUIFreeArr.push(t.node),t.node.active=!1,t.node.showTween=void 0,t.node=null,t.needUpdate=void 0)},r.clearAllItems=function(){for(var t,e=i(this.itemArr);!(t=e()).done;){var s=t.value;this.recycleItem(s)}},r.initItem=function(t,e){return{node:null,data:t,index:e,x:0,y:0}},r.refreshItemIndex=function(t,e){t.index=e,t.node&&(t.node.index=e)},r.setData=function(t,e,i,s){if(void 0===i&&(i=!0),void 0===s&&(s=!1),this.scrollView){this.itemTween=s,this.setDataFlag=!0,this.frameUpdateArr=[],this.unscheduleAllCallbacks(),this.clearAllItems(),this.itemArr=[],t||(t=[]),this.refreshItemFunc=e;for(var r=0;r<t.length;r++){var h=t[r],n=this.initItem(h,r);this.itemArr.push(n)}this.maxLines=Math.ceil(this.itemArr.length/this.changeNum),this.maxLines<1&&(this.maxLines=1),this.refreshItemArr(0,i)}},r.layoutItemArr=function(t){if(!(this.itemArr.length<=0))for(var e=t;e<this.itemArr.length;e++){var i=Math.floor(e/this.changeNum),s=e%this.changeNum,r=this.itemArr[e];this.vertical?(r.x=this.startPosX+s*(this.itemUIWidth+this.gapX),r.y=this.startPosY-i*(this.itemUIHeight+this.gapY)):(r.x=this.startPosX+i*(this.itemUIWidth+this.gapX),r.y=this.startPosY-s*(this.itemUIHeight+this.gapY))}},r.resizeContentNode=function(){if(this.contentNode&&this.itemUI){if(this.itemArr.length<=0)return this.contentTransform.width=0,void(this.contentTransform.height=0);var t=this.itemArr[this.itemArr.length-1];if(this.vertical){var e=-t.y+this.itemUIHeight*this.itemUITransform.anchorY;this.contentTransform.height=e+this.paddingBottom}else{var i=t.x+this.itemUIWidth*(1-this.itemUITransform.anchorX);this.contentTransform.width=i+this.paddingRight}}},r.refreshItemArr=function(t,e){if(void 0===e&&(e=!0),this.scrollView){this.layoutItemArr(t),this.resizeContentNode(),this.startIndex=-1,this.stopIndex=-1,this.scrollView.stopAutoScroll();var i=this.scrollView.getMaxScrollOffset(),s=this.scrollView.getScrollOffset();if(this.vertical){var r=0;e||((r=this.contentNode.getPosition().y)>i.y&&(r=i.y),r<0&&(r=0)),s.y=r,this.scrollView.scrollToOffset(s,0)}else{var h=0;e||((h=Math.abs(this.contentNode.getPosition().x))>Math.abs(i.x)&&(h=Math.abs(i.x)),h<0&&(h=0)),s.x=h,this.scrollView.scrollToOffset(s,0)}this.onScrolling()}},r.refreshList=function(){var t=this;this.refreshItemFunc&&this.itemArr.forEach((function(e){e.node&&t.refreshItemFunc(e.node,e.data,e.index)}))},r.removeByIndex=function(t,e){if(void 0===e&&(e=!1),t<0||t>=this.itemArr.length)console.log("无效的index",t);else{var i=this.itemArr[t];if(i&&this.refreshItemFunc){this.itemArr.splice(t,1),this.recycleItem(i);for(var s=t;s<this.itemArr.length;s++){var r=this.itemArr[s];this.refreshItemIndex(r,s)}this.maxLines=Math.ceil(this.itemArr.length/this.changeNum),this.maxLines<1&&(this.maxLines=1),this.refreshItemArr(t,e)}}},r.refreshIndex=function(t,e){if(null==t||t<0||t>=this.itemArr.length)console.log("无效的index",t);else{var i=this.itemArr[t];i&&(null!=e&&(i.data=e),i.node&&(i.node.item=i.data,this.refreshItemFunc&&this.refreshItemFunc(i.node,i.data,t)))}},r.insertData=function(t,e,i){if(void 0===i&&(i=!1),e&&0!=e.length)if(t<0||t>this.itemArr.length)console.log("无效的index",t);else if(this.refreshItemFunc){for(var s=0;s<e.length;s++){var r=t+s,h=this.initItem(e[s],r);this.itemArr.splice(r,0,h)}for(var n=t+e.length;n<this.itemArr.length;n++){var o=this.itemArr[n];this.refreshItemIndex(o,n)}this.maxLines=Math.ceil(this.itemArr.length/this.changeNum),this.maxLines<1&&(this.maxLines=1),this.refreshItemArr(t,i)}else console.log("首次请调用setData方法");else console.log("没有要添加的数据")},r.pushData=function(t,e){void 0===e&&(e=!1),this.insertData(this.itemArr.length,t,e)},r.isScrollEnd=function(){var t=this.scrollView.getMaxScrollOffset(),e=this.scrollView.getScrollOffset();return Math.abs(t.x)-Math.abs(e.x)<=10&&Math.abs(t.y)-Math.abs(e.y)<=10},r.scrollToEnd=function(t){this.scrollView.stopAutoScroll(),(null==t||t<0)&&(t=.5),this.vertical?this.scrollView.scrollToBottom(t):this.scrollView.scrollToRight(t)},r.scrollToIndex=function(t,e){if((null==e||e<0)&&(e=0),!(t<0)){var i=this.itemArr[t];if(i){this.scrollView.stopAutoScroll();var s=this.scrollView.getMaxScrollOffset(),r=this.scrollView.getScrollOffset();if(this.vertical){var h=Math.abs(i.y)+this.itemUIHeight-this.viewHeight;h<0&&(h=0),h>s.y&&(h=s.y),r.y=h,this.scrollView.scrollToOffset(r,e)}else{var n=Math.abs(i.x)+this.itemUIWidth-this.viewWidth;n<0&&(n=0),n>Math.abs(s.x)&&(n=Math.abs(s.x)),r.x=n,this.scrollView.scrollToOffset(r,e)}this.onScrolling()}}},r.onDestroy=function(){this.itemUIFreeArr=[],this.itemArr=[],this.frameUpdateArr=[],this.refreshItemFunc=null,this.node.off("scrolling",this.onScrolling,this),this.unscheduleAllCallbacks()},s}(v))||I);s._RF.pop()}}}));

System.register("chunks:///_virtual/sdkManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./localText.ts","./msgac.ts","./audioManager.ts","./eventManager.ts","./mapModel.ts","./playerModel.ts","./UserData.ts","./tyqAdManager.ts"],(function(n){var e,t,a,o,s,i,c,r,d,u,l;return{setters:[function(n){e=n.createClass},function(n){t=n.cclegacy},function(n){a=n.localText},function(n){o=n.msgac},function(n){s=n.audioManager},function(n){i=n.eventManager},function(n){c=n.mapModel},function(n){r=n.playerModel},function(n){d=n.UserData},function(n){u=n.tyqAdManager,l=n.Channel}],execute:function(){t._RF.push({},"93823ORdqxLXK57adD53UST","sdkManager",void 0);var g=function(){function n(){}return n.prototype.openAd=function(n,e){var t=function(n){0==n?i.send(o.showNotice,a.adAwardHint):-1==n?i.send(o.showNotice,a.noRewardAd):2==n&&i.send(o.showNotice,a.noAd),e(n),1==n&&(r.addDayTaskNum(11),d.getInstance().$videoCalCnt++),s.gameOnShow(!0)};r.isInDevelopmentEnvironment()||r.isRecordAd?t(1):u.getChannel()!=l.DEFAULT?c.mapId>0&&c.mapSystem.fightPause():t(1)},e(n,null,[{key:"instance",get:function(){return this._instance||(this._instance=new n),this._instance}}]),n}();g._instance=void 0;n("sdkManager",g.instance);t._RF.pop()}}}));

System.register("chunks:///_virtual/SelectSummonLayer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./constants.ts","./BaseUILayer.ts"],(function(t){var e,i,n,o,l,s,r,a,c,h,u,m,f;return{setters:[function(t){e=t.applyDecoratedDescriptor,i=t.inheritsLoose,n=t.initializerDefineProperty,o=t.assertThisInitialized},function(t){l=t.cclegacy,s=t._decorator,r=t.Node,a=t.UITransform,c=t.Size,h=t.find,u=t.Label},function(t){m=t.constants},function(t){f=t.BaseUILayer}],execute:function(){var p,y,g,d,w,v,b;l._RF.push({},"743a5F9tPFDrZaW7KMKhgBU","SelectSummonLayer",void 0);var S=s.ccclass,T=s.property;t("SelectSummonLayer",(p=S("SelectSummonLayer"),y=T({type:r,tooltip:"Events列表View"}),g=T({type:r,tooltip:"Events列表容器View"}),p((v=e((w=function(t){function e(){for(var e,i=arguments.length,l=new Array(i),s=0;s<i;s++)l[s]=arguments[s];return e=t.call.apply(t,[this].concat(l))||this,n(e,"scrollView",v,o(e)),n(e,"scrollContentView",b,o(e)),e}i(e,t);var l=e.prototype;return l.onLoad=function(){t.prototype.onLoad.call(this)},l.start=function(){var t=this;this.fitScrollView(this.scrollContentView,800,800),this.fitNodeWidget(this.scrollContentView,1100),this.scrollViewSetData(this.scrollView,[{eventName:"Holiday gift box",subTitle:"A hammer of storm's wrath",finish:1,total:7,lastTime:"24h08m",style:{width:223,height:33}},{eventName:"Holiday gift box",subTitle:"Gloves that grasp at the shadows",finish:2,total:7,lastTime:"23h08m",style:{width:330,height:33}},{eventName:"Holiday gift box",subTitle:"Storm-forged, crackling with power",finish:3,total:7,lastTime:"22h08m",style:{width:294,height:38}},{eventName:"Holiday gift box",subTitle:"Fearsome, ethereal, night-dominant",finish:4,total:7,lastTime:"21h08m",style:{width:334,height:38}}],(function(e,i,n){t.setSpriteFrame2(e,"events/eventsbg_0"+(n+1),null,m.bundles.ui),t.setSpriteFrame2(e.getChildByPath("left/eventName"),"events/title"+(n+1),null,m.bundles.ui);var o=i.style,l=o.width,s=o.height;e.getChildByPath("left/eventName").getComponent(a).setContentSize(new c(l,s)),h("left/subTitle",e).getComponent(u).string=i.subTitle,h("lastTime/time",e).getComponent(u).string=i.lastTime,e.on(r.EventType.TOUCH_END,(function(){t.openLayer(m.layers.Events)}))}))},l.onClickBtnClose=function(){this.closeLayer()},e}(f)).prototype,"scrollView",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),b=e(w.prototype,"scrollContentView",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),d=w))||d));l._RF.pop()}}}));

System.register("chunks:///_virtual/ServerCtr.ts",["./rollupPluginModLoBabelHelpers.js","cc","./conf.ts","./gameStorage.ts","./wmsocket.ts","./http.ts","./utilTools.ts","./UserData.ts"],(function(t){var r,n,e,a,u,o,s,c,i,p,f,l,d,h,v,g;return{setters:[function(t){r=t.inheritsLoose,n=t.createClass,e=t.asyncToGenerator,a=t.regeneratorRuntime},function(t){u=t.cclegacy,o=t._decorator,s=t.director,c=t.Component},function(t){i=t.GLoginState,p=t.GNetCmd,f=t.GNetConst},function(t){l=t.GameStorage},function(t){d=t.WmSocket},function(t){h=t.default},function(t){v=t.utilTools},function(t){g=t.UserData}],execute:function(){var w,m;u._RF.push({},"ab7d54qwyNKo5R4d+Nd8sTJ","ServerCtr",void 0);var I=t("ServerState",{Normal:"normal",New:"new",Hot:"hot",Maintain:"maintain"}),E=o.ccclass;o.property,t("default",E("ServerCtr")(((m=function(t){function u(){for(var r,n=arguments.length,e=new Array(n),a=0;a<n;a++)e[a]=arguments[a];return(r=t.call.apply(t,[this].concat(e))||this).serverId=1,r.account="",r.password="hsmnq2021",r.authCode="",r.token="",r.regionDataList=[],r.uid="",r.regionId="",r.nickName="测试账号",r.isLogin=!1,r.avatar="",r.loginState=i.noYet,r.serverDataVersion=0,r.serverData={},r.regionList={},r.serverList={},r}r(u,t),u.GetInstance=function(){return this.instance||(this.instance=new u,this.instance.InitServerCtr()),this.instance};var o=u.prototype;return o.InitServerCtr=function(){this.account=l.getStringDisk("login_account",""),this.password=l.getStringDisk("login_password",this.password),this.authCode=l.getStringDisk("login_authCode",this.authCode),this.serverId=parseInt(l.getStringDisk("login_serverId","")),s.on(p.GetInviteCode.toString(),this.onMessageEvent,this)},o.createUserData=function(){var t=e(a().mark((function t(r,n,e){var o;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=new Promise((function(t,n){h.getInstance().httpPost(u.BASE_URL+"/user/createUserServerData",{userId:r},(function(r){var n;t(null==r||null==(n=r.data)?void 0:n.user)}),(function(t){n(t)}))})),n&&(n(o),g.getInstance().setUserServerData(o)),e&&(e(o),g.getInstance().setUserServerData(o)),t.abrupt("return",o);case 4:case"end":return t.stop()}}),t)})));return function(r,n,e){return t.apply(this,arguments)}}(),o.createUserWithReferralCode=function(){var t=e(a().mark((function t(r,n,e,o,s){var c;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return c=new Promise((function(t,a){h.getInstance().httpPost(u.BASE_URL+"/user/createUserWithReferralCode",{userId:r,userName:n,code:e},(function(r){t(null==r?void 0:r.data)}),(function(t){a(t)}))})),o&&(o(c),g.getInstance().setUserServerData(c)),s&&(s(c),g.getInstance().setUserServerData(c)),t.abrupt("return",c);case 4:case"end":return t.stop()}}),t)})));return function(r,n,e,a,u){return t.apply(this,arguments)}}(),o.getUserReferralCodeList=function(){var t=e(a().mark((function t(){var r;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,new Promise((function(t,r){h.getInstance().httpGet(u.BASE_URL+"/user/getUserReferralCodeList",{userId:v.getUserId()},(function(r){t(null==r?void 0:r.data)}),(function(t){r(t)}))}));case 3:return r=t.sent,t.abrupt("return",r);case 7:return t.prev=7,t.t0=t.catch(0),console.error("Error fetching user server data:",t.t0),t.abrupt("return",null);case 11:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(){return t.apply(this,arguments)}}(),o.fetchUserServerData=function(){var t=e(a().mark((function t(){var r;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,new Promise((function(t,r){h.getInstance().httpGet(u.BASE_URL+"/user/fetchUserServerData",{userId:v.getUserId()},(function(r){t(null==r?void 0:r.data)}),(function(t){r(t)}))}));case 3:return r=t.sent,t.abrupt("return",r);case 7:return t.prev=7,t.t0=t.catch(0),console.error("Error fetching user server data:",t.t0),t.abrupt("return",null);case 11:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(){return t.apply(this,arguments)}}(),o.getEarnTaskMainList=function(){var t=e(a().mark((function t(r,n){var e;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,new Promise((function(t,e){h.getInstance().httpGet(u.BASE_URL+"/tasks",{userId:r,type:n},(function(r){null!=r&&r.data?t(r.data):e(new Error("Data not found in response"))}),(function(t){e(t)}))}));case 3:return e=t.sent,t.abrupt("return",e);case 7:return t.prev=7,t.t0=t.catch(0),console.error("Error fetching user server data:",t.t0),t.abrupt("return",null);case 11:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(r,n){return t.apply(this,arguments)}}(),o.getShopStaminaList=function(){var t=e(a().mark((function t(){var r;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,new Promise((function(t,r){h.getInstance().httpGet(u.BASE_URL+"/shop/products",{},(function(n){null!=n&&n.data?t(n.data):r(new Error("Data not found in response"))}),(function(t){r(t)}))}));case 3:return r=t.sent,t.abrupt("return",r);case 7:return t.prev=7,t.t0=t.catch(0),console.error("Error fetching shop product data:",t.t0),t.abrupt("return",null);case 11:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(){return t.apply(this,arguments)}}(),o.purchaseProductStamina=function(){var t=e(a().mark((function t(r,n){var e;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,new Promise((function(t,e){h.getInstance().httpPost(u.BASE_URL+"/shop/purchaseProduct",{userId:r,productId:n},(function(r){console.log("🚀 ~ ServerCtr ~ result ~ res:",r),null!=r&&r.data?t(r.data):e(new Error("Data not found in response"))}),(function(t){e(t)}))}));case 3:return e=t.sent,t.abrupt("return",e);case 7:return t.prev=7,t.t0=t.catch(0),console.error("Error fetching shop product data:",t.t0),t.abrupt("return",null);case 11:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(r,n){return t.apply(this,arguments)}}(),o.getDrawWeapons=function(){var t=e(a().mark((function t(r,n){var e;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,new Promise((function(t,e){h.getInstance().httpGet(u.BASE_URL+"/weapons/drawWeapon",{userId:r,type:n},(function(r){t(r.data)}),(function(t){e(t)}))}));case 3:return e=t.sent,t.abrupt("return",e);case 7:return t.prev=7,t.t0=t.catch(0),console.error("Error fetching drawEquipment data:",t.t0),t.abrupt("return",null);case 11:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(r,n){return t.apply(this,arguments)}}(),o.getDrawSkins=function(){var t=e(a().mark((function t(r,n){var e;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,new Promise((function(t,e){h.getInstance().httpGet(u.BASE_URL+"/skins/drawSkin",{userId:r,type:n},(function(r){t(r.data)}),(function(t){e(t)}))}));case 3:return e=t.sent,t.abrupt("return",e);case 7:return t.prev=7,t.t0=t.catch(0),console.error("Error fetching drawEquipment data:",t.t0),t.abrupt("return",null);case 11:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(r,n){return t.apply(this,arguments)}}(),o.getDrawEquipments=function(){var t=e(a().mark((function t(r,n){var e;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,new Promise((function(t,e){h.getInstance().httpGet(u.BASE_URL+"/equipments/drawEquipment",{userId:r,type:n},(function(r){t(r.data)}),(function(t){e(t)}))}));case 3:return e=t.sent,t.abrupt("return",e);case 7:return t.prev=7,t.t0=t.catch(0),console.error("Error fetching drawEquipment data:",t.t0),t.abrupt("return",null);case 11:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(r,n){return t.apply(this,arguments)}}(),o.startGame=function(){var t=e(a().mark((function t(r){var n;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,new Promise((function(t,n){h.getInstance().httpGet(u.BASE_URL+"/gameRecord/startGame",{userId:r},(function(r){null!=r&&r.data?t(r.data):n(new Error("Data not found in response"))}),(function(t){n(t)}))}));case 3:return n=t.sent,t.abrupt("return",n);case 7:return t.prev=7,t.t0=t.catch(0),console.error("Error fetching shop product data:",t.t0),t.abrupt("return",null);case 11:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(r){return t.apply(this,arguments)}}(),o.endGame=function(){var t=e(a().mark((function t(r,n,e,o){var s;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,new Promise((function(t,a){h.getInstance().httpPost(u.BASE_URL+"/gameRecord/endGame",{userId:r,gameKey:n,soulCoin:e,killNum:o},(function(r){null!=r&&r.data?t(r.data):a(new Error("Data not found in response"))}),(function(t){a(t)}))}));case 3:return s=t.sent,t.abrupt("return",s);case 7:return t.prev=7,t.t0=t.catch(0),console.error("Error fetching shop product data:",t.t0),t.abrupt("return",null);case 11:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(r,n,e,a){return t.apply(this,arguments)}}(),o.addEquipmentRewardToUser=function(){var t=e(a().mark((function t(r,n){var e;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,new Promise((function(t,e){h.getInstance().httpPost(u.BASE_URL+"/equipment/addEquipmentRewardToUser",{userId:r,equipArr:n},(function(r){null!=r&&r.data?t(r.data):e(new Error("Data not found in response"))}),(function(t){e(t)}))}));case 3:return e=t.sent,t.abrupt("return",e);case 7:return t.prev=7,t.t0=t.catch(0),console.error("Error fetching shop product data:",t.t0),t.abrupt("return",null);case 11:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(r,n){return t.apply(this,arguments)}}(),o.getEquipmentByUserId=function(){var t=e(a().mark((function t(r,n){var e;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,new Promise((function(t,e){h.getInstance().httpGet(u.BASE_URL+"/inventory/getEquipmentByUserId",{userId:r,type:n},(function(r){null!=r&&r.data?t(r.data):e(new Error("Data not found in response"))}),(function(t){e(t)}))}));case 3:return e=t.sent,t.abrupt("return",e);case 7:return t.prev=7,t.t0=t.catch(0),console.error("Error fetching shop product data:",t.t0),t.abrupt("return",null);case 11:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(r,n){return t.apply(this,arguments)}}(),o.getUserWearEquipment=function(){var t=e(a().mark((function t(r){var n;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,new Promise((function(t,n){h.getInstance().httpGet(u.BASE_URL+"/inventory/getUserWearEquipments",{userId:r},(function(r){null!=r&&r.data?t(r.data):n(new Error("Data not found in response"))}),(function(t){n(t)}))}));case 3:return n=t.sent,t.abrupt("return",n);case 7:return t.prev=7,t.t0=t.catch(0),console.error("Error fetching shop product data:",t.t0),t.abrupt("return",null);case 11:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(r){return t.apply(this,arguments)}}(),o.wearEquipment=function(){var t=e(a().mark((function t(r,n){var e;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,new Promise((function(t,e){h.getInstance().httpPost(u.BASE_URL+"/inventory/wearWeaponOrEquipment",{userId:r,inventoryId:n},(function(r){null!=r&&r.data?t(r.data):e(new Error("Data not found in response"))}),(function(t){e(t)}))}));case 3:return e=t.sent,t.abrupt("return",e);case 7:return t.prev=7,t.t0=t.catch(0),console.error("Error fetching shop product data:",t.t0),t.abrupt("return",null);case 11:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(r,n){return t.apply(this,arguments)}}(),o.getSkinsByUserId=function(){var t=e(a().mark((function t(r,n){var e;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,new Promise((function(t,e){h.getInstance().httpGet(u.BASE_URL+"/inventory/getEquipmentByUserId",{userId:r,type:n},(function(r){null!=r&&r.data?t(r.data):e(new Error("Data not found in response"))}),(function(t){e(t)}))}));case 3:return e=t.sent,t.abrupt("return",e);case 7:return t.prev=7,t.t0=t.catch(0),console.error("Error fetching shop product data:",t.t0),t.abrupt("return",null);case 11:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(r,n){return t.apply(this,arguments)}}(),o.levelUpCostSkin=function(){var t=e(a().mark((function t(r,n){var e;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,new Promise((function(t,e){h.getInstance().httpGet(u.BASE_URL+"/inventory/getLevelUpCost",{type:r,itemId:n},(function(r){null!=r&&r.data?t(r.data):e(new Error("Data not found in response"))}),(function(t){e(t)}))}));case 3:return e=t.sent,t.abrupt("return",e);case 7:return t.prev=7,t.t0=t.catch(0),console.error("Error fetching shop product data:",t.t0),t.abrupt("return",null);case 11:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(r,n){return t.apply(this,arguments)}}(),o.getEquipmentDetail=function(){var t=e(a().mark((function t(r){var n;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,new Promise((function(t,n){h.getInstance().httpGet(u.BASE_URL+"/equipments/getEquipmentDetail",{equipId:r},(function(r){null!=r&&r.data?t(r.data):n(new Error("Data not found in response"))}),(function(t){n(t)}))}));case 3:return n=t.sent,t.abrupt("return",n);case 7:return t.prev=7,t.t0=t.catch(0),console.error("Error fetching shop product data:",t.t0),t.abrupt("return",null);case 11:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(r){return t.apply(this,arguments)}}(),o.levelUpSkin=function(){var t=e(a().mark((function t(r,n){var e;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,new Promise((function(t,e){h.getInstance().httpPost(u.BASE_URL+"/skins/levelUpSkin",{userId:r,skinIds:n},(function(r){null!=r&&r.data?t(r.data):e(r.msg)}),(function(t){e(t)}))}));case 3:return e=t.sent,t.abrupt("return",e);case 7:return t.prev=7,t.t0=t.catch(0),console.error("Error fetching shop product data:",t.t0),t.abrupt("return",null);case 11:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(r,n){return t.apply(this,arguments)}}(),o.confirmMail=function(){var t=e(a().mark((function t(r){var n;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,new Promise((function(t,n){h.getInstance().httpPost(u.BASE_URL+"/mailbox/confirmMail",{userId:v.getUserId()+"",mailId:r},(function(r){null!=r&&r.data?t(r.data):n(r.msg)}),(function(t){n(t)}))}));case 3:return n=t.sent,t.abrupt("return",n);case 7:return t.prev=7,t.t0=t.catch(0),console.error("Error fetching confirmMail product data:",t.t0),t.abrupt("return",null);case 11:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(r){return t.apply(this,arguments)}}(),o.wearSkin=function(){var t=e(a().mark((function t(r,n){var e;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,new Promise((function(t,e){h.getInstance().httpPost(u.BASE_URL+"/inventory/wearSkin",{userId:r,skinId:n},(function(r){null!=r&&r.data?t(r.data):e(new Error("Data not found in response"))}),(function(t){e(t)}))}));case 3:return e=t.sent,t.abrupt("return",e);case 7:return t.prev=7,t.t0=t.catch(0),console.error("Error fetching shop product data:",t.t0),t.abrupt("return",null);case 11:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(r,n){return t.apply(this,arguments)}}(),o.updateSoulcoin=function(){var t=e(a().mark((function t(r,n){var e;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,new Promise((function(t,e){h.getInstance().httpPost(u.BASE_URL+"/user/updateSoulcoin",{userId:r,soulCoin:n},(function(r){null!=r&&r.data?t(r.data):e(new Error("Data not found in response"))}),(function(t){e(t)}))}));case 3:return e=t.sent,t.abrupt("return",e);case 7:return t.prev=7,t.t0=t.catch(0),console.error("Error fetching shop product data:",t.t0),t.abrupt("return",null);case 11:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(r,n){return t.apply(this,arguments)}}(),o.levelUpEquip=function(){var t=e(a().mark((function t(r,n){var e;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,new Promise((function(t,e){h.getInstance().httpPost(u.BASE_URL+"/equipments/levelUpEquipment",{userId:r,equipIds:n},(function(r){null!=r&&r.data?t(r.data):e(r.msg)}),(function(t){e(t)}))}));case 3:return e=t.sent,t.abrupt("return",e);case 7:return t.prev=7,t.t0=t.catch(0),console.error("Error fetching shop product data:",t.t0),t.abrupt("return",null);case 11:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(r,n){return t.apply(this,arguments)}}(),o.getUserCheckInList=function(){var t=e(a().mark((function t(r){var n;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,new Promise((function(t,n){h.getInstance().httpGet(u.BASE_URL+"/check-in/getUserCheckIn",{userId:r},(function(r){t(r.data)}),(function(t){n(t)}))}));case 3:return n=t.sent,t.abrupt("return",n);case 7:return t.prev=7,t.t0=t.catch(0),console.error("Error fetching getUserCheckInList data:",t.t0),t.abrupt("return",null);case 11:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(r){return t.apply(this,arguments)}}(),o.completeCheckIn=function(){var t=e(a().mark((function t(r,n){var e;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,new Promise((function(t,e){h.getInstance().httpPost(u.BASE_URL+"/check-in/completeCheckIn",{userId:r,checkInTaskId:n},(function(r){t(r.data)}),(function(t){e(t)}))}));case 3:return e=t.sent,t.abrupt("return",e);case 7:return t.prev=7,t.t0=t.catch(0),console.error("Error fetching completeCheckIn data:",t.t0),t.abrupt("return",null);case 11:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(r,n){return t.apply(this,arguments)}}(),o.getExchangeList=function(){var t=e(a().mark((function t(r){var n;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,new Promise((function(t,n){h.getInstance().httpGet(u.BASE_URL+"/exchangehub/getExchangeItemList",{type:r},(function(r){t(r.data)}),(function(t){n(t)}))}));case 3:return n=t.sent,t.abrupt("return",n);case 7:return t.prev=7,t.t0=t.catch(0),console.error("Error fetching getUserCheckInList data:",t.t0),t.abrupt("return",null);case 11:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(r){return t.apply(this,arguments)}}(),o.getUserBagList=function(){var t=e(a().mark((function t(r){var n;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,new Promise((function(t,n){h.getInstance().httpGet(u.BASE_URL+"/userbag/getUserBagList",{id:r},(function(r){t(r.data)}),(function(t){n(t)}))}));case 3:return n=t.sent,t.abrupt("return",n);case 7:return t.prev=7,t.t0=t.catch(0),console.error("Error fetching getUserCheckInList data:",t.t0),t.abrupt("return",null);case 11:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(r){return t.apply(this,arguments)}}(),o.getMailBoxByType=function(){var t=e(a().mark((function t(r){var n;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,new Promise((function(t,n){h.getInstance().httpGet(u.BASE_URL+"/mailbox/getMailBoxByType",{userId:v.getUserId(),type:r},(function(r){t(r.data)}),(function(t){n(t)}))}));case 3:return n=t.sent,t.abrupt("return",n);case 7:return t.prev=7,t.t0=t.catch(0),console.error("Error fetching getUserCheckInList data:",t.t0),t.abrupt("return",null);case 11:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(r){return t.apply(this,arguments)}}(),o.getShopListByType=function(){var t=e(a().mark((function t(r){var n;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,new Promise((function(t,n){h.getInstance().httpGet(u.BASE_URL+"/shop/getShopListByType",{type:r},(function(r){t(r.data)}),(function(t){n(t)}))}));case 3:return n=t.sent,t.abrupt("return",n);case 7:return t.prev=7,t.t0=t.catch(0),console.error("Error fetching getUserCheckInList data:",t.t0),t.abrupt("return",null);case 11:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(r){return t.apply(this,arguments)}}(),o.exchangeItem=function(){var t=e(a().mark((function t(r,n){var e;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,new Promise((function(t,e){h.getInstance().httpPost(u.BASE_URL+"/exchangehub/exchangeItem",{userId:r,itemId:n},(function(r){t(r.data)}),(function(t){e(t)}))}));case 3:return e=t.sent,t.abrupt("return",e);case 7:return t.prev=7,t.t0=t.catch(0),console.error("Error fetching completeCheckIn data:",t.t0),t.abrupt("return",null);case 11:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(r,n){return t.apply(this,arguments)}}(),o.buyShopItem=function(){var t=e(a().mark((function t(r){var n;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,new Promise((function(t,n){h.getInstance().httpPost(u.BASE_URL+"/shop/buyShopItem",{userId:v.getUserId()+"",shopListId:r},(function(r){t(r.data)}),(function(t){n(t)}))}));case 3:return n=t.sent,t.abrupt("return",n);case 7:return t.prev=7,t.t0=t.catch(0),console.error("Error fetching completeCheckIn data:",t.t0),t.abrupt("return",null);case 11:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(r){return t.apply(this,arguments)}}(),o.addDataVersion=function(t){void 0===t&&(t=1),l.setInt("dataVersion",l.getInt("dataVersion",0)+t)},o.CheckIsHaveAccount=function(){return!(!this.account||""==this.account)},o.CheckHaveDataById=function(t){for(var r=0;r<this.regionDataList.length;r++){if(this.regionDataList[r].regionId==t)return!0}return!1},o.GetServerData=function(t){for(var r in this.serverList){var n=this.serverList[r];if(n.id==t)return n}return null},o.GetStateIcon=function(t){switch(t){case I.Normal:return;case I.New:return"fm_tb_xin";case I.Hot:return"fm_tb_bao";case I.Maintain:return"fm_tb_wei"}},o.onMessageEvent=function(t){t&&(console.log("处理分享的消息:",t),t.status!=f.ResSuccess)&&console.error("服务端响应失败~!")},o.UnloadAvatarUrl=function(){var t={cmd:p.UploadAvatar,lang:"zh",token:this.token,avatar:this.avatar};d.getInstance().send({data:t})},n(u,[{key:"dataVersion",get:function(){return l.getInt("dataVersion",0)},set:function(t){t>this.dataVersion&&l.setInt("dataVersion",t)}},{key:"Account",get:function(){return this.account},set:function(t){this.account=t,l.setStringDisk("login_account",this.account)}},{key:"PassWord",get:function(){return this.password},set:function(t){this.password=t,l.setStringDisk("login_password",this.password)}},{key:"AuthCode",get:function(){return this.authCode},set:function(t){this.authCode=t,l.setStringDisk("login_authCode",this.authCode)}},{key:"ServerId",get:function(){return this.serverId},set:function(t){this.serverId=t,l.setStringDisk("login_serverId",this.serverId+"")}}]),u}(c)).instance=null,m.BASE_URL="https://prod.ms-game.midnight-survivors-backend.motions.gg",w=m))||w);u._RF.pop()}}}));

System.register("chunks:///_virtual/serverMsg.ts",["./rollupPluginModLoBabelHelpers.js","cc","./myLog.ts","./msgac.ts","./eventManager.ts","./mapModel.ts","./playerModel.ts"],(function(n){var e,t,s,a,c,o,r;return{setters:[function(n){e=n.createClass},function(n){t=n.cclegacy},function(n){s=n.myLog},function(n){a=n.msgac},function(n){c=n.eventManager},function(n){o=n.mapModel},function(n){r=n.playerModel}],execute:function(){t._RF.push({},"9acdeoqlPRAM5oguGl4n3Cp","serverMsg",void 0);var i=function(){function n(){}return n.prototype.send=function(n,e){var t=a.ac2KeyObj[n];e||(e={}),n>a.playerMsgStart&&n<a.playerMsgEnd&&r[t]&&r[t](e),n>a.mapMsgStart&&n<a.mapMsgEnd&&o[t]&&o[t](e),s.i(t+"Ret",e),e.notMyLog=!0,1==e.st&&c.send(n,e)},e(n,null,[{key:"instance",get:function(){return this._instance||(this._instance=new n),this._instance}}]),n}();i._instance=void 0;n("serverMsg",i.instance);t._RF.pop()}}}));

System.register("chunks:///_virtual/SettingLayer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./audioManager.ts","./BaseUILayer.ts"],(function(e){var t,i,n,o,r,c,u,l,a,s,g;return{setters:[function(e){t=e.applyDecoratedDescriptor,i=e.inheritsLoose,n=e.initializerDefineProperty,o=e.assertThisInitialized},function(e){r=e.cclegacy,c=e._decorator,u=e.Node,l=e.ProgressBar,a=e.Toggle},function(e){s=e.audioManager},function(e){g=e.BaseUILayer}],execute:function(){var p,f,y,h,m,b,d,C,v,L,k,B,M,T,z,S,w;r._RF.push({},"b7756A5YIhNEI1iqg1Luk/T","SettingLayer",void 0);var D=c.ccclass,N=c.property;e("SettingLayer",(p=D("SettingLayer"),f=N({type:u}),y=N({type:u}),h=N({type:u}),m=N({type:u}),b=N({type:u}),d=N({type:u}),C=N({type:u}),p((k=t((L=function(e){function t(){for(var t,i=arguments.length,r=new Array(i),c=0;c<i;c++)r[c]=arguments[c];return t=e.call.apply(e,[this].concat(r))||this,n(t,"musicToggle",k,o(t)),n(t,"effectToggle",B,o(t)),n(t,"music",M,o(t)),n(t,"sound",T,o(t)),n(t,"mute",z,o(t)),n(t,"notification",S,o(t)),n(t,"close",w,o(t)),t}i(t,e);var r=t.prototype;return r.onLoad=function(){e.prototype.onLoad.call(this)},r.onMusicSliderChanged=function(e){var t=e.progress;this.music.getComponent(l).progress=t,s.setMusicVolume(t)},r.onSoundSliderChanged=function(e){var t=e.progress;this.sound.getComponent(l).progress=t},r.onMuteBtnClick=function(){var e=this.mute.getComponent(a).isChecked;this.mute.getChildByName("btn-on").active=e,this.mute.getChildByName("btn-off").active=!e},r.onNotificationBtnClick=function(){var e=this.notification.getComponent(a).isChecked;this.notification.getChildByName("btn-on").active=e,this.notification.getChildByName("btn-off").active=!e},r.onDisable=function(){e.prototype.onDisable.call(this)},r.onDestroy=function(){e.prototype.onDestroy.call(this)},r.start=function(){s.getMusiceVolume(),s.getEffectVolume()},r.onMusicCheck=function(){console.log("onMusicCheck",this.musicToggle.getComponent(a).isChecked),s.setMusicVolume(this.musicToggle.getComponent(a).isChecked?1:0)},r.onSoundCheck=function(){s.setEffectVolume(this.musicToggle.getComponent(a).isChecked?1:0)},r.closeLayer=function(){e.prototype.closeLayer.call(this)},t}(g)).prototype,"musicToggle",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),B=t(L.prototype,"effectToggle",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),M=t(L.prototype,"music",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),T=t(L.prototype,"sound",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),z=t(L.prototype,"mute",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),S=t(L.prototype,"notification",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),w=t(L.prototype,"close",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),v=L))||v));r._RF.pop()}}}));

System.register("chunks:///_virtual/SettlementLayer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./utilTools.ts","./constants.ts","./msgac.ts","./audioManager.ts","./designManager.ts","./mapModel.ts","./playerModel.ts","./UserData.ts","./serverMsg.ts","./AnimationCtrl.ts","./BaseLayer.ts","./ServerCtr.ts","./eventManager.ts","./layerManager.ts"],(function(e){var t,i,n,o,a,r,s,c,l,d,u,m,h,f,p,N,y,v,b,g,w,S,L,D,B;return{setters:[function(e){t=e.inheritsLoose,i=e.asyncToGenerator,n=e.regeneratorRuntime},function(e){o=e.cclegacy,a=e._decorator,r=e.find,s=e.v3,c=e.tween,l=e.view,d=e.UITransform},function(e){u=e.cocosUtil},function(e){m=e.utilTools},function(e){h=e.constants},function(e){f=e.msgac},function(e){p=e.audioManager},function(e){N=e.designManager},function(e){y=e.mapModel},function(e){v=e.playerModel},function(e){b=e.UserData},function(e){g=e.serverMsg},function(e){w=e.AnimationCtrl},function(e){S=e.BaseLayer},function(e){L=e.default},function(e){D=e.eventManager},function(e){B=e.layerManager}],execute:function(){var M;o._RF.push({},"7026fGphVxC+bSB7DKVEyWa","SettlementLayer",void 0);var C=a.ccclass;a.property,e("SettlementLayer",C("SettlementLayer")(M=function(e){function o(){for(var t,i=arguments.length,n=new Array(i),o=0;o<i;o++)n[o]=arguments[o];return(t=e.call.apply(e,[this].concat(n))||this).winAniCtrl=void 0,t.winMapNameNode=void 0,t.failAniCtrl=void 0,t.failMapNameNode=void 0,t.winTitleNode=void 0,t.timeNode=void 0,t.bestTimeNode=void 0,t.monsterNode=void 0,t.lineNode=void 0,t.itemLayerBg=void 0,t.itemLayerNode=void 0,t.btnDouble=void 0,t.btnDoublePos=void 0,t.btnSure=void 0,t.btnSurePos=void 0,t.rootNode=void 0,t}t(o,e);var a=o.prototype;return a.onLoad=function(){e.prototype.onLoad.call(this),this.rootNode=this.node,this.winAniCtrl=this.getNodeByPath("bg2/win").addComponent(w),this.winMapNameNode=this.getNodeByPath("bg2/win/mapName"),this.failAniCtrl=this.getNodeByPath("bg2/fail").addComponent(w),this.failMapNameNode=this.getNodeByPath("bg2/fail/mapName"),this.winTitleNode=this.getNodeByPath("ui/winTitle"),this.timeNode=this.getNodeByPath("ui/time"),this.bestTimeNode=this.getNodeByPath("ui/bestTime"),this.monsterNode=this.getNodeByPath("ui/monster"),this.lineNode=this.getNodeByPath("ui/line"),this.itemLayerBg=this.getNodeByPath("ui/itemLayer/bg"),this.itemLayerNode=this.getNodeByPath("ui/itemLayer/itemLayer"),this.btnDouble=this.getNodeByPath("ui/btns/btnDouble"),this.btnDoublePos=this.btnDouble.position.clone(),this.btnSure=this.getNodeByPath("ui/btns/btnSure"),this.btnSurePos=this.btnSure.position.clone()},a.onEnable=function(){e.prototype.onEnable.call(this),b.getInstance().mapData=null,this.layerData.isWin&&p.playEffect(h.audioNames.win)},a.onDisable=function(){e.prototype.onDisable.call(this)},a.onDestroy=function(){e.prototype.onDestroy.call(this)},a.initUI=function(){var e=i(n().mark((function e(){var t,i,o=this;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.layerData.isWin&&v.addDayTaskNum(10),this.winAniCtrl.node.active=!1,this.winMapNameNode.active=!1,this.failAniCtrl.node.active=!1,this.failMapNameNode.active=!1,this.winTitleNode.active=!1,this.timeNode.active=!1,this.bestTimeNode.active=!1,this.monsterNode.active=!1,this.lineNode.active=!1,this.itemLayerBg.active=!1,this.itemLayerNode.active=!1,this.btnDouble.active=!1,this.btnSure.active=!1,m.waterfall([function(e,t){if(o.layerData.isWin)return o.winAniCtrl.node.active=!0,void o.winAniCtrl.playAnimation("a",!1,(function(){o.winAniCtrl.playAnimation("b",!0),t()}));o.failAniCtrl.node.active=!0,o.failAniCtrl.playAnimation("a",!1,(function(){o.failAniCtrl.playAnimation("b",!0),t()}))},function(e,t){var i=N.getRowById(h.tableName.map,y.mapId);if(o.layerData.isWin)return o.winMapNameNode.active=!0,o.setString(r("text",o.winMapNameNode),i.name),void u.tweenScaleIn2(o.winMapNameNode,.2,(function(){t()}));o.failMapNameNode.active=!0,o.setString(r("text",o.failMapNameNode),i.name),u.tweenScaleIn2(o.failMapNameNode,.2,(function(){t()}))},function(e,t){if(o.layerData.isWin)return o.winTitleNode.active=!0,void u.tweenScaleIn2(o.winTitleNode,.2,(function(){t()}));o.timeNode.active=!0,o.setString(r("time",o.timeNode),m.getTimeStr(1e3*o.layerData.time,!0)),r("new",o.timeNode).active=!1,u.tweenScaleIn2(o.timeNode,.2,(function(){o.bestTimeNode.active=!0,u.tweenScaleIn2(o.bestTimeNode,.2,(function(){o.setString(r("info/time",o.bestTimeNode),m.getTimeStr(1e3*o.layerData.bestTime,!0)),t()}))}))},function(e,t){o.monsterNode.active=!0,o.setString(r("info/num",o.monsterNode),y.killMonsterNum),u.tweenScaleIn2(o.monsterNode,.2,(function(){t()}))},function(e,t){o.lineNode.active=!0,u.tweenFadeIn(o.lineNode,.2,(function(){t()}))},function(e,t){o.itemLayerBg.active=!0,u.tweenFadeIn(o.itemLayerBg,.2,(function(){t()}))},function(e,t){o.itemLayerNode.active=!0,o.setItemLayer(o.itemLayerNode,o.layerData.award,o.refreshPropItem.bind(o));var i=o.itemLayerNode.children.length;m.forArr(o.itemLayerNode.children,(function(e,n){e.scale=s(0,0,0),o.scheduleOnce((function(){c(e).set({scale:s(2,2,1)}).to(.2,{scale:s(1,1,1)}).to(.05,{scale:s(1.1,1.1,1)}).to(.05,{scale:s(1,1)}).call((function(){n>=i-1&&t()})).start()}),.2*n)}))},function(e,t){var i=o.btnDoublePos.clone();i.x+=.5*l.getVisibleSize().width+o.btnDouble.getComponent(d).width,o.btnDouble.position=i,o.btnSure.active=!0,(i=o.btnSurePos.clone()).x-=.5*l.getVisibleSize().width+o.btnSure.getComponent(d).width,o.btnSure.position=i,c(o.btnDouble).to(.5,{position:o.btnDoublePos}).start(),c(o.btnSure).to(.5,{position:o.btnSurePos}).start()}]),this.rootNode.getChildByName("Loading").active=!0,e.prev=16,e.next=19,L.GetInstance().updateSoulcoin(m.getUserId().toString(),null==(t=this.layerData.award)||null==(t=t[0])?void 0:t.Num);case 19:(i=e.sent)?b.getInstance().setUserServerData(i):B.createNotice("Sync Error"),e.next=26;break;case 23:e.prev=23,e.t0=e.catch(16),console.log("🚀 ~ SettlementLayer ~ initUI ~ error:",e.t0);case 26:return e.prev=26,this.rootNode.getChildByName("Loading").active=!1,e.finish(26);case 29:case"end":return e.stop()}}),e,this,[[16,23,26,29]])})));return function(){return e.apply(this,arguments)}}(),a.refreshPropItem=function(e,t){var i=N.getRowById(h.tableName.prop,t.Id);this.setSpriteFrame2(r("bg",e),"prop/propbg"+i.quality),this.setSpriteFrame2(r("icon",e),"prop/"+i.icon);var n=r("num",e);8==i.type||11==i.type?n.active=!1:(n.active=!0,this.setNumString(r("num/num",e),t.Num))},a.processEvent=function(e,t){},a.onButtonClick=function(e,t){},a.closeLayer=function(){e.prototype.closeLayer.call(this),this.layerCb&&this.layerCb();var t={};t.mapId=y.mapId,t.floor=y.floor,t.isWin=this.layerData.isWin,g.send(f.mapLeave,t)},a.onClickBtnSure=function(){var e=i(n().mark((function e(t){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:D.send(f.commonResRefresh),this.closeLayer();case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),o}(S))||M);o._RF.pop()}}}));

System.register("chunks:///_virtual/ShineColor.ts",["./rollupPluginModLoBabelHelpers.js","cc","./constants.ts","./resManager.ts"],(function(e){var t,i,r,n,o,s,a,l,h,u;return{setters:[function(e){t=e.inheritsLoose},function(e){i=e.cclegacy,r=e._decorator,n=e.UIRenderer,o=e.sp,s=e.v4,a=e.Material,l=e.Component},function(e){h=e.constants},function(e){u=e.resManager}],execute:function(){var c;i._RF.push({},"51f17l4w0hAfKBU6Sgpl5Cc","ShineColor",void 0);var d=r.ccclass;r.property,e("ShineColor",d("ShineColor")(c=function(e){function i(){for(var t,i=arguments.length,r=new Array(i),n=0;n<i;n++)r[n]=arguments[n];return(t=e.call.apply(e,[this].concat(r))||this).duration=.3,t._median=0,t._time=0,t.isSpine=!1,t.uiRenderer=void 0,t.orignMaterial=void 0,t.vColor=void 0,t}t(i,e);var r=i.prototype;return r.onLoad=function(){this.uiRenderer=this.node.getComponent(n),this.orignMaterial=this.uiRenderer.customMaterial,this.node.getComponent(o.Skeleton)&&(this.isSpine=!0)},r.setMaterialProperty=function(e){if(this.isSpine){var t=this.uiRenderer._materialCache;for(var i in t){var r=t[i];r.setProperty("u_rate",e),this.vColor&&r.setProperty("u_color",this.vColor)}}else{var n=this.uiRenderer.getMaterialInstance(0),o=n.passes[0].getHandle("u_rate");if(n.passes[0].setUniform(o,e),this.vColor){s(1,0,0,1);var a=n.passes[0].getHandle("u_color");n.passes[0].setUniform(a,this.vColor)}this.uiRenderer.setMaterialInstance(n,0)}},r.update=function(e){if(this._time>0){this._time-=e,this._time=this._time<0?0:this._time;var t=2*Math.abs(this._time-this._median)/this.duration;this.setMaterialProperty(t)}else this.removeShineColorMaterial()},r.removeShineColorMaterial=function(){this.uiRenderer.customMaterial=this.orignMaterial,this.isSpine&&(this.uiRenderer.enabled=!1,this.uiRenderer.enabled=!0)},r.startShine=function(e,t,i){var r=this;void 0===i&&(i=.3),this.duration=i,this._median=this.duration/2,this.vColor=t?s(t.r/255,t.g/255,t.b/255,t.a/255):s(1,1,1,1),u.loadAsset(h.bundles.common,e,a,null,(function(e,t){r._time=r.duration,r.uiRenderer.customMaterial=t,r.setMaterialProperty(1)}))},i}(l))||c);i._RF.pop()}}}));

System.register("chunks:///_virtual/Shop.ts",["./rollupPluginModLoBabelHelpers.js","cc","./BaseUILayer.ts","./UserData.ts","./ServerCtr.ts","./audioManager.ts","./utilTools.ts"],(function(t){var e,n,o,r,i,a,c,s,u,l,p,d,h,f,g,y,v;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,o=t.initializerDefineProperty,r=t.assertThisInitialized,i=t.asyncToGenerator,a=t.regeneratorRuntime},function(t){c=t.cclegacy,s=t._decorator,u=t.Node,l=t.Prefab,p=t.instantiate,d=t.Label},function(t){h=t.BaseUILayer},function(t){f=t.UserData},function(t){g=t.default},function(t){y=t.audioManager},function(t){v=t.utilTools}],execute:function(){var m,b,C,L,S,w,k,B,I;c._RF.push({},"4307c9CpkZG7JM9C8PrBysK","Shop",void 0);var N=s.ccclass,D=s.property;t("Shop",(m=N("Shop"),b=D({type:u,tooltip:"View"}),C=D({type:u,tooltip:"列表容器View"}),L=D({type:l,tooltip:"shop item"}),m((k=e((w=function(t){function e(){for(var e,n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=t.call.apply(t,[this].concat(i))||this,o(e,"scrollView",k,r(e)),o(e,"ScrollContentView",B,r(e)),o(e,"ShopItem",I,r(e)),e.productList=void 0,e.rootNode=void 0,e}n(e,t);var c=e.prototype;return c.onLoad=function(){this.rootNode=this.node},c.onDestroy=function(){t.prototype.onDestroy.call(this)},c.onEnable=function(){},c.start=function(){var t=i(a().mark((function t(){var e=this;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,this.rootNode.getChildByName("Loading").active=!0,t.next=4,g.GetInstance().getShopStaminaList();case 4:this.productList=t.sent,this.productList&&this.productList.length>0&&this.productList.forEach((function(t,n){var o=p(e.ShopItem);o.getChildByPath("prise/number").getComponent(d).string=t.product.value,o.getChildByPath("btm/Label").getComponent(d).string=t.product.costVaule,o.setParent(e.ScrollContentView),e.addClickListener(o,t,n)})),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),console.log("🚀 ~ Shop ~ start ~ error:",t.t0);case 11:return t.prev=11,this.rootNode.getChildByName("Loading").active=!1,t.finish(11);case 14:case"end":return t.stop()}}),t,this,[[0,8,11,14]])})));return function(){return t.apply(this,arguments)}}(),c.onClickBtn=function(){y.playEffect("btnClick"),console.log("---------Buy---------")},c.addClickListener=function(t,e,n){var o=this;t.on(u.EventType.TOUCH_END,i(a().mark((function t(){var e,r,i;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=o.productList[n],y.playEffect("btnClick"),r=f.getInstance().getUserRuntimeData(),!(e.product.costVaule>r.diamondCoin)){t.next=7;break}o.toast("Lack of Diamond"),t.next=21;break;case 7:return t.prev=7,o.rootNode.getChildByName("Loading").active=!0,t.next=11,g.GetInstance().purchaseProductStamina(v.getUserId(),e.product.id);case 11:(i=t.sent)&&f.getInstance().setUserRuntimeData(i),t.next=18;break;case 15:t.prev=15,t.t0=t.catch(7),console.log("🚀 ~ Shop ~ itemUI.on ~ error:",t.t0);case 18:return t.prev=18,o.rootNode.getChildByName("Loading").active=!1,t.finish(18);case 21:case"end":return t.stop()}}),t,null,[[7,15,18,21]])}))))},e}(h)).prototype,"scrollView",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),B=e(w.prototype,"ScrollContentView",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),I=e(w.prototype,"ShopItem",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),S=w))||S));c._RF.pop()}}}));

System.register("chunks:///_virtual/ShopLayer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./constants.ts","./msgac.ts","./audioManager.ts","./designManager.ts","./eventManager.ts","./RedPointLogicMgr.ts","./UserData.ts","./PropItemPrefab.ts","./BaseUILayer.ts","./playerModel.ts"],(function(e){var t,n,i,a,o,r,l,s,h,p,g,u,c,m,y,d,b,f,S,C,w,_,L,N;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,i=e.initializerDefineProperty,a=e.assertThisInitialized},function(e){o=e.cclegacy,r=e._decorator,l=e.Node,s=e.sp,h=e.Label,p=e.PageView,g=e.instantiate,u=e.v3,c=e.UITransform,m=e.Button},function(e){y=e.constants},function(e){d=e.msgac},function(e){b=e.audioManager},function(e){f=e.designManager},function(e){S=e.eventManager},function(e){C=e.RedPointLogicMgr},function(e){w=e.UserData},function(e){_=e.PropItemPrefab},function(e){L=e.BaseUILayer},function(e){N=e.playerModel}],execute:function(){var B,I,v,V,T,z,M,D,P,k,A,F,j,q,x,G,R,U,$,E,H,Z,J,K,O,Q,W,X,Y;o._RF.push({},"f5fb7L1gGZDloukFZbgJ7r4","ShopLayer",void 0);var ee=r.ccclass,te=r.property;e("ShopLayer",(B=ee("ShopLayer"),I=te({type:l,tooltip:"道具节点"}),v=te({type:l,tooltip:"宣传页"}),V=te({type:s.Skeleton,tooltip:""}),T=te({type:l}),z=te({type:l}),M=te({type:l}),D=te({type:l}),P=te({type:l}),k=te({type:l}),A=te({type:h}),F=te({type:h}),j=te({type:l}),q=te({type:l}),B((R=t((G=function(e){function t(){for(var t,n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return t=e.call.apply(e,[this].concat(o))||this,i(t,"mangItem",R,a(t)),i(t,"pageView",U,a(t)),i(t,"mangheSpine",$,a(t)),i(t,"btnManghe",E,a(t)),i(t,"uiNode",H,a(t)),i(t,"btnSure",Z,a(t)),i(t,"propItem",J,a(t)),i(t,"btnVideo",K,a(t)),i(t,"btnSingle",O,a(t)),i(t,"num1",Q,a(t)),i(t,"num2",W,a(t)),i(t,"layer1",X,a(t)),i(t,"layer2",Y,a(t)),t._mangheType=0,t._curState=0,t._isDrawIng=!1,t.gaojiProp=[],t._rewardArr=[],t}n(t,e);var o=t.prototype;return o.onLoad=function(){},o.onEnable=function(){this.mangItem.active=!1,this.num1.string=f.config.extra2-w.getInstance().$drawNormalNum+"",this.num2.string=f.config.extra1-w.getInstance().$drawGradeNum+"",C.ins().setRPointView(this.btnManghe,null,!0),this.setSpriteFrame2(this.btnManghe,"shopLayer/mangheNormal",null,y.bundles.wwqVec),this.pageView.getComponent(p).scrollToPage(0,0),this._mangheType=0,this.mangheSpine.animation="purple1",this.mangheSpine.timeScale=1,this.btnSure.active=!1;var e=this;this.mangheSpine.setCompleteListener((function(){e.animalFinish()}));for(var t=[10082,10113,10010],n=[10066,10155,10118],i=0;i<t.length;i++){var a=g(e.propItem);this.layer1.addChild(a),a.position=u(0,0,0),a.getComponent(_).setView(t[i],1,_.Type_UnTouch|_.Type_HideNum),a.getComponent(_).setScale(100)}for(var o=0;o<n.length;o++){var r=g(e.propItem);this.layer2.addChild(r),r.position=u(0,0,0),r.getComponent(_).setView(n[o],1,_.Type_UnTouch|_.Type_HideNum),r.getComponent(_).setScale(100)}this.onClickChangeManghe()},o.start=function(){console.log("layerData = ",this.layerData),this.initVideoBtn()},o.initVideoBtn=function(){this.layerData.taskGo&&w.getInstance().$freeDraw<f.config.taskDoge||(1==this._mangheType?(this.btnVideo.getChildByName("Layout").getChildByName("zsLabel").getComponent(h).string=f.config.tenCard+"",this.btnSingle.getChildByName("Layout").getChildByName("zsLabel").getComponent(h).string=f.config.onceCard+"",this.setSpriteFrame2(this.btnSingle.getChildByName("Layout").getChildByName("prop_zs"),"prop/prop_diamond2"),this.setSpriteFrame2(this.btnVideo.getChildByName("Layout").getChildByName("prop_zs"),"prop/prop_diamond2")):(this.btnVideo.getChildByName("Layout").getChildByName("zsLabel").getComponent(h).string=f.config.tenCard2+"",this.btnSingle.getChildByName("Layout").getChildByName("zsLabel").getComponent(h).string=f.config.onceCard2+"",this.setSpriteFrame2(this.btnSingle.getChildByName("Layout").getChildByName("prop_zs"),"prop/prop_coin1"),this.setSpriteFrame2(this.btnVideo.getChildByName("Layout").getChildByName("prop_zs"),"prop/prop_coin1"),w.getInstance().coin>=f.config.tenCard2&&(this.btnVideo.getChildByName("Layout").active=!0)))},o.onClickChangeManghe=function(){b.playEffect("btnClick"),0==this.pageView.getComponent(p).getCurrentPageIndex()?this.pageView.getComponent(p).scrollToPage(1,.2):this.pageView.getComponent(p).scrollToPage(0,.2),this.updatebtnState()},o.updatebtnState=function(){this._isDrawIng||(1==this.pageView.getComponent(p).getCurrentPageIndex()?(this._mangheType=1,this.setSpriteFrame2(this.btnManghe,"shopLayer/manggaoji",null,y.bundles.wwqVec),this.mangheSpine.setAnimation(0,"qiehuan1",!1),this.mangheSpine.timeScale=1):(this.mangheSpine.setAnimation(0,"qiehuan2",!1),this.mangheSpine.timeScale=1,this._mangheType=0,this.setSpriteFrame2(this.btnManghe,"shopLayer/mangheNormal",null,y.bundles.wwqVec)),this.initVideoBtn())},o.showChouAnimale=function(){var e="purple";1==this._mangheType&&(e="yellow"),this.mangheSpine.setAnimation(0,e+"2",!1),this.mangheSpine.timeScale=1,this._curState=2},o.animalFinish=function(){this._mangheType,this.mangheSpine.loop=!1,2==this._curState?(this.uiNode.active=!1,this.mangheSpine.timeScale=1,this.mangheSpine.setAnimation(0,"bai3",!1),this._curState=3):3==this._curState?(this.checkShowGaoji(),this.mangItem.active=!0):this._curState},o.checkShowGaoji=function(){if(this.gaojiProp.length>0){var e=this.gaojiProp.shift();if(e&&e.quality>=4){this.mangheSpine.setAnimation(0,4==e.quality?"purple4":"yellow4",!0),this.mangheSpine.timeScale=1,this.mangItem.getChildByName("Layout").removeAllChildren();var t=g(this.propItem);return this.mangItem.getChildByName("Layout").getComponent(c).width=300,this.mangItem.getChildByName("Layout").getComponent(c).height=300,this.mangItem.getChildByName("Layout").addChild(t),t.getComponent(_).setView(e.id,1,_.Type_BigIcon),t.getComponent(_).setScale(300),this.btnSure.active=!0,void(this._curState=4)}}var n="purple";1==this._mangheType&&(n="yellow"),this.mangheSpine.setAnimation(0,n+"1",!1),this.mangheSpine.timeScale=1,this.mangItem.active=!1,this.mangItem.getChildByName("Layout").removeAllChildren(),w.getInstance().getRewardProp(this._rewardArr),this.openLayer(y.layers.RewardLayer,{propArr:this._rewardArr}),N.addDayTaskNum(3,this._rewardArr.length),this.drawFinish(),this._curState=5},o.onBtnClickSure=function(){b.playEffect("btnClick"),this.checkShowGaoji(),this.mangItem.active=!0},o.onClickBtn=function(){b.playEffect("btnClick"),console.log("🚀 ~ ShopLayer ~ onClickBtn ~ onClickBtn:")},o.drawFinish=function(){this.num1.string=f.config.extra2-w.getInstance().$drawNormalNum+"",this.num2.string=f.config.extra1-w.getInstance().$drawGradeNum+"",this.uiNode.active=!0,this.btnSure.active=!1,this.mangItem.active=!1,S.send(d.homeHideMenu,{hide:!1});var e="purple";1==this._mangheType&&(e="yellow"),this._curState=0,this.mangheSpine.setAnimation(0,e+"1",!1),this.cancelButtonTouch(!0),this._isDrawIng=!1},o.cancelButtonTouch=function(e){this.btnSingle.getComponent(m).interactable=e,this.btnVideo.getComponent(m).interactable=e,this.btnManghe.getComponent(m).interactable=e},o.onDisable=function(){e.prototype.onDisable.call(this)},o.onDestroy=function(){e.prototype.onDestroy.call(this)},o.closeLayer=function(){e.prototype.closeLayer.call(this)},t}(L)).prototype,"mangItem",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),U=t(G.prototype,"pageView",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),$=t(G.prototype,"mangheSpine",[V],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),E=t(G.prototype,"btnManghe",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),H=t(G.prototype,"uiNode",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Z=t(G.prototype,"btnSure",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),J=t(G.prototype,"propItem",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),K=t(G.prototype,"btnVideo",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),O=t(G.prototype,"btnSingle",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Q=t(G.prototype,"num1",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),W=t(G.prototype,"num2",[F],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),X=t(G.prototype,"layer1",[j],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Y=t(G.prototype,"layer2",[q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),x=G))||x));o._RF.pop()}}}));

System.register("chunks:///_virtual/SingleInstance.ts",["cc"],(function(n){var t;return{setters:[function(n){t=n.cclegacy}],execute:function(){t._RF.push({},"385c2e7ZDBH5qgn7YCLSLIp","SingleInstance",void 0),n("SingleInstance",function(){function n(){}return n.getInstance=function(){return null==this.instance&&(this.instance=new this),this.instance},n}()).instance=null,t._RF.pop()}}}));

System.register("chunks:///_virtual/Skill.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./constants.ts","./designManager.ts","./mapModel.ts"],(function(t){var i,n,l,e,o,s,r,c,a,u;return{setters:[function(t){i=t.inheritsLoose,n=t.asyncToGenerator,l=t.regeneratorRuntime},function(t){e=t.cclegacy,o=t._decorator,s=t.Component},function(t){r=t.cocosUtil},function(t){c=t.constants},function(t){a=t.designManager},function(t){u=t.mapModel}],execute:function(){var d;e._RF.push({},"dde34pvTzRH+5WvlfuMvxTK","Skill",void 0);var h=o.ccclass;o.property,t("Skill",h("Skill")(d=function(t){function e(){for(var i,n=arguments.length,l=new Array(n),e=0;e<n;e++)l[e]=arguments[e];return(i=t.call.apply(t,[this].concat(l))||this).info=void 0,i.id=void 0,i.row=void 0,i.skillUtil=void 0,i}i(e,t);var o=e.prototype;return o.onLoad=function(){},o.init=function(){var t=n(l().mark((function t(i){var n,e,o;return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.info=i,n=i.id,this.id=n,this.unscheduleAllCallbacks(),e=a.getRowById(c.tableName.skill,n),this.row=e;try{(o=r.addComponentOnce(this,"Skill"+e.type)).unscheduleAllCallbacks(),this.skillUtil=o,o.init(this)}catch(t){}case 7:case"end":return t.stop()}}),t,this)})));return function(i){return t.apply(this,arguments)}}(),o.getDuration=function(){var t=this.row.duration;return t*=1+u.skillSystem.getSkill2DurationAddPercent()},o.getAtkCd=function(){var t=this.row.cd;return t*=1-u.skillSystem.getSkill2AtkCdSubPercent()},o.updateLogic=function(t){this.skillUtil&&this.skillUtil.updateLogic&&this.skillUtil.updateLogic(t)},o.onDestroy=function(){this.unscheduleAllCallbacks(),this.skillUtil&&this.skillUtil.unscheduleAllCallbacks()},e}(s))||d);e._RF.pop()}}}));

System.register("chunks:///_virtual/Skill1.ts",["./rollupPluginModLoBabelHelpers.js","cc","./mapModel.ts","./physicsGroup.ts"],(function(t){var i,n,l,u,o,s;return{setters:[function(t){i=t.inheritsLoose},function(t){n=t.cclegacy,l=t._decorator,u=t.Component},function(t){o=t.mapModel},function(t){s=t.physicsGroup}],execute:function(){var e;n._RF.push({},"830f6qSuddKTprK/5yh1tKg","Skill1",void 0);var r=l.ccclass;l.property,t("Skill1",r("Skill1")(e=function(t){function n(){for(var i,n=arguments.length,l=new Array(n),u=0;u<n;u++)l[u]=arguments[u];return(i=t.call.apply(t,[this].concat(l))||this).skill=void 0,i.num=0,i.timeCount=0,i}i(n,t);var l=n.prototype;return l.init=function(t){this.skill=t},l.subNum=function(){this.num--},l.updateLogic=function(t){this.timeCount+=t,this.num>=this.skill.row.num||this.timeCount<this.skill.getAtkCd()||(this.timeCount=0,this.num++,o.bulletSystem.addBullet(this.skill.row.bulletId,s.PLAYER_BULLET2,null,null,this))},n}(u))||e);n._RF.pop()}}}));

System.register("chunks:///_virtual/Skill10.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./audioManager.ts","./mapModel.ts","./physicsGroup.ts"],(function(t){var i,o,l,s,n,e,r,u;return{setters:[function(t){i=t.inheritsLoose},function(t){o=t.cclegacy,l=t._decorator,s=t.Component},function(t){n=t.cocosUtil},function(t){e=t.audioManager},function(t){r=t.mapModel},function(t){u=t.physicsGroup}],execute:function(){var c;o._RF.push({},"2ec28RxfxxHDoN+BZbdSRbr","Skill10",void 0);var h=l.ccclass;l.property,t("Skill10",h("Skill10")(c=function(t){function o(){for(var i,o=arguments.length,l=new Array(o),s=0;s<o;s++)l[s]=arguments[s];return(i=t.call.apply(t,[this].concat(l))||this).skill=void 0,i.timeCount=0,i.isShoting=void 0,i.robotBullet=void 0,i}i(o,t);var l=o.prototype;return l.init=function(t){var i=this;this.skill=t,this.isShoting=!1,this.robotBullet=null;var o={endCb:function(t){n.isValid(i.node)?i.robotBullet=t:t.bullet.recycleSelf()},lv:this.skill.row.lv};r.bulletSystem.addBullet(this.skill.row.bulletId,u.PLAYER_BULLET,null,null,o)},l.forceDestroy=function(){n.isValid(this.robotBullet)&&this.robotBullet.bullet.recycleSelf()},l.startShoting=function(){var t=this,i=this.skill.getDuration();this.isShoting=!0,this.robotBullet.startShot(i),this.scheduleOnce((function(){t.isShoting=!1,t.timeCount=0}),i),e.playEffect(this.skill.row.audio)},l.updateLogic=function(t){this.robotBullet&&(this.timeCount+=t,this.timeCount<this.skill.getAtkCd()||this.isShoting||this.startShoting())},o}(s))||c);o._RF.pop()}}}));

System.register("chunks:///_virtual/Skill2.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./utilTools.ts","./mapModel.ts","./physicsGroup.ts"],(function(i){var t,s,o,l,n,e,r,u;return{setters:[function(i){t=i.inheritsLoose},function(i){s=i.cclegacy,o=i._decorator,l=i.Component},function(i){n=i.cocosUtil},function(i){e=i.utilTools},function(i){r=i.mapModel},function(i){u=i.physicsGroup}],execute:function(){var c;s._RF.push({},"cbd1f3j4KpGZ7/YK+g+k7hQ","Skill2",void 0);var h=o.ccclass;o.property,i("Skill2",h("Skill2")(c=function(i){function s(){for(var t,s=arguments.length,o=new Array(s),l=0;l<s;l++)o[l]=arguments[l];return(t=i.call.apply(i,[this].concat(o))||this).skill=void 0,t.isShowing=!1,t.timeCount=0,t.bulletArr=void 0,t}t(s,i);var o=s.prototype;return o.init=function(i){this.skill=i,this.bulletArr=[],this.isShowing=!1},o.showDisks=function(){var i=this,t=n.getCircleDirectionArr(this.skill.row.num,160);e.forArr(t,(function(t){var s={direction:t,endCb:function(t){n.isValid(i.node)?-1==i.bulletArr.indexOf(t)&&i.bulletArr.push(t):t.recycleSelf()}};r.bulletSystem.addBullet(i.skill.row.bulletId,u.PLAYER_BULLET2,null,null,s)}))},o.hideDisks=function(i){void 0===i&&(i=!1),this.bulletArr.forEach((function(t){n.isValid(t)&&t.bulletUtil.hide(i)}))},o.updateLogic=function(i){var t=this;this.isShowing||(this.timeCount+=i,this.timeCount<this.skill.getAtkCd()||(this.timeCount=0,this.isShowing=!0,this.scheduleOnce((function(){t.isShowing=!1,t.hideDisks()}),this.skill.getDuration()),this.showDisks()))},o.forceDestroy=function(){this.hideDisks(!0)},s}(l))||c);s._RF.pop()}}}));

System.register("chunks:///_virtual/Skill3.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./audioManager.ts","./mapModel.ts","./physicsGroup.ts"],(function(t){var i,o,n,e,s,l,u,r;return{setters:[function(t){i=t.inheritsLoose},function(t){o=t.cclegacy,n=t._decorator,e=t.Component},function(t){s=t.cocosUtil},function(t){l=t.audioManager},function(t){u=t.mapModel},function(t){r=t.physicsGroup}],execute:function(){var c;o._RF.push({},"93ff52gBgZOeqxxGLqzTtR0","Skill3",void 0);var a=n.ccclass;n.property,t("Skill3",a("Skill3")(c=function(t){function o(){for(var i,o=arguments.length,n=new Array(o),e=0;e<o;e++)n[e]=arguments[e];return(i=t.call.apply(t,[this].concat(n))||this).skill=void 0,i.num=0,i.timeCount=0,i}i(o,t);var n=o.prototype;return n.init=function(t){this.skill=t},n.subNum=function(){this.num--},n.updateLogic=function(t){if(this.timeCount+=t,!(this.num>=this.skill.row.num||this.timeCount<this.skill.getAtkCd())){var i=u.mapSystem.getMinDisTargetNode();if(i){this.timeCount=0,this.num++;var o=i.getPosition().subtract(u.player.node.getPosition());u.bulletSystem.addBullet(this.skill.row.bulletId,r.PLAYER_BULLET,s.convertToWorldSpace(u.player.node),o,this),l.playEffect(this.skill.row.audio)}}},o}(e))||c);o._RF.pop()}}}));

System.register("chunks:///_virtual/Skill4.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./utilTools.ts","./mapModel.ts","./physicsGroup.ts","./audioManager.ts"],(function(t){var i,o,n,s,l,e,r,u,c;return{setters:[function(t){i=t.inheritsLoose},function(t){o=t.cclegacy,n=t._decorator,s=t.Component},function(t){l=t.cocosUtil},function(t){e=t.utilTools},function(t){r=t.mapModel},function(t){u=t.physicsGroup},function(t){c=t.audioManager}],execute:function(){var a;o._RF.push({},"7217e9uGeFO7pt9q5S+9EL8","Skill4",void 0);var h=n.ccclass;n.property,t("Skill4",h("Skill4")(a=function(t){function o(){for(var i,o=arguments.length,n=new Array(o),s=0;s<o;s++)n[s]=arguments[s];return(i=t.call.apply(t,[this].concat(n))||this).skill=void 0,i.timeCount=0,i.isShowing=!1,i.moveDis=200,i}i(o,t);var n=o.prototype;return n.init=function(t){this.skill=t},n.throwFire=function(){var t=this,i=l.getCircleDirectionArr(this.skill.row.num);e.forArr(i,(function(i){var o={targetPos:r.player.node.getPosition().add(i.multiplyScalar(t.moveDis)),time:t.skill.getDuration()};r.bulletSystem.addBullet(t.skill.row.bulletId,u.PLAYER_BULLET,null,i,o)})),c.playEffect(this.skill.row.audio)},n.updateLogic=function(t){var i=this;this.isShowing||(this.timeCount+=t,this.timeCount<this.skill.getAtkCd()||(this.timeCount=0,this.isShowing=!0,this.scheduleOnce((function(){i.isShowing=!1}),this.skill.getDuration()),this.throwFire()))},o}(s))||a);o._RF.pop()}}}));

System.register("chunks:///_virtual/Skill5.ts",["./rollupPluginModLoBabelHelpers.js","cc","./audioManager.ts","./mapModel.ts","./physicsGroup.ts"],(function(t){var i,o,e,n,l,s,r;return{setters:[function(t){i=t.inheritsLoose},function(t){o=t.cclegacy,e=t._decorator,n=t.Component},function(t){l=t.audioManager},function(t){s=t.mapModel},function(t){r=t.physicsGroup}],execute:function(){var a;o._RF.push({},"382170aGEJCa4mWodqatRyD","Skill5",void 0);var u=e.ccclass;e.property,t("Skill5",u("Skill5")(a=function(t){function o(){for(var i,o=arguments.length,e=new Array(o),n=0;n<o;n++)e[n]=arguments[n];return(i=t.call.apply(t,[this].concat(e))||this).skill=void 0,i.timeCount=0,i}i(o,t);var e=o.prototype;return e.init=function(t){this.skill=t},e.updateLogic=function(t){if(this.timeCount+=t,!(this.timeCount<this.skill.getAtkCd())){var i=s.mapSystem.getMinDisTargetNode();if(i){this.timeCount=0;var o=i.getPosition().subtract(s.player.node.getPosition());s.bulletSystem.addBullet(this.skill.row.bulletId,r.PLAYER_BULLET2,null,o),l.playEffect(this.skill.row.audio)}}},o}(n))||a);o._RF.pop()}}}));

System.register("chunks:///_virtual/Skill6.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./mapModel.ts","./physicsGroup.ts","./audioManager.ts"],(function(t){var i,n,o,l,s,e,u,r;return{setters:[function(t){i=t.inheritsLoose},function(t){n=t.cclegacy,o=t._decorator,l=t.Component},function(t){s=t.cocosUtil},function(t){e=t.mapModel},function(t){u=t.physicsGroup},function(t){r=t.audioManager}],execute:function(){var c;n._RF.push({},"a25caRHG6FLQY2ATbAvASZS","Skill6",void 0);var a=o.ccclass;o.property,t("Skill6",a("Skill6")(c=function(t){function n(){for(var i,n=arguments.length,o=new Array(n),l=0;l<n;l++)o[l]=arguments[l];return(i=t.call.apply(t,[this].concat(o))||this).skill=void 0,i.num=0,i.timeCount=0,i}i(n,t);var o=n.prototype;return o.init=function(t){this.skill=t},o.subNum=function(){this.num--},o.updateLogic=function(t){if(this.timeCount+=t,!(this.num>=this.skill.row.num||this.timeCount<this.skill.getAtkCd())){var i=s.getCircleDirectionArr(1)[0];this.timeCount=0,this.num++;var n={invokeClass:this,time:this.skill.getDuration()};e.bulletSystem.addBullet(this.skill.row.bulletId,u.PLAYER_BULLET2,null,i,n),r.playEffect(this.skill.row.audio)}},n}(l))||c);n._RF.pop()}}}));

System.register("chunks:///_virtual/Skill7.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./audioManager.ts","./mapModel.ts","./physicsGroup.ts"],(function(l){var t,i,e,n,o,s,u,c;return{setters:[function(l){t=l.inheritsLoose},function(l){i=l.cclegacy,e=l._decorator,n=l.Component},function(l){o=l.cocosUtil},function(l){s=l.audioManager},function(l){u=l.mapModel},function(l){c=l.physicsGroup}],execute:function(){var r;i._RF.push({},"1597abY9IlGx4z+0CUwmicQ","Skill7",void 0);var a=e.ccclass;e.property,l("Skill7",a("Skill7")(r=function(l){function i(){for(var t,i=arguments.length,e=new Array(i),n=0;n<i;n++)e[n]=arguments[n];return(t=l.call.apply(l,[this].concat(e))||this).skill=void 0,t.bulletUtil=void 0,t}t(i,l);var e=i.prototype;return e.init=function(l){var t=this;this.skill=l,this.bulletUtil=null;var i={lv:this.skill.row.lv,endCb:function(l){o.isValid(t.node)?t.bulletUtil=l:l.bullet.recycleSelf()}};u.bulletSystem.addBullet(this.skill.row.bulletId,c.PLAYER_BULLET,null,null,i),s.playEffect(this.skill.row.audio)},e.initBulletScale=function(){o.isValid(this.bulletUtil)&&this.bulletUtil.initScale()},e.forceDestroy=function(){o.isValid(this.bulletUtil)&&this.bulletUtil.bullet.recycleSelf()},i}(n))||r);i._RF.pop()}}}));

System.register("chunks:///_virtual/Skill8.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./audioManager.ts","./mapModel.ts","./physicsGroup.ts"],(function(t){var i,o,e,n,l,s,r,a;return{setters:[function(t){i=t.inheritsLoose},function(t){o=t.cclegacy,e=t._decorator,n=t.Component},function(t){l=t.cocosUtil},function(t){s=t.audioManager},function(t){r=t.mapModel},function(t){a=t.physicsGroup}],execute:function(){var c;o._RF.push({},"4e67c7liWxNJYobtbo6ozbz","Skill8",void 0);var u=e.ccclass;e.property,t("Skill8",u("Skill8")(c=function(t){function o(){for(var i,o=arguments.length,e=new Array(o),n=0;n<o;n++)e[n]=arguments[n];return(i=t.call.apply(t,[this].concat(e))||this).skill=void 0,i.timeCount=0,i}i(o,t);var e=o.prototype;return e.init=function(t){this.skill=t},e.updateLogic=function(t){var i=this;if(this.timeCount+=t,!(this.timeCount<this.skill.getAtkCd())){var o=[];if(r.monsterSystem.forVisibleMonster((function(t){var i=t.node.position,e=r.player.node.position;Math.abs(i.x-e.x)>r.visibleHalfSize.width-100||Math.abs(i.y-e.y)>r.visibleHalfSize.height-150||o.push(t)})),!(o.length<=0)){this.timeCount=0;for(var e=0;e<this.skill.row.num;e++)this.scheduleOnce((function(){if(!(o.length<=0)){var t=Math.floor(Math.random()*o.length),e=o[t];if(!(e.hp<=0)){var n=l.convertToWorldSpace(e.node);r.bulletSystem.addBullet(i.skill.row.bulletId,a.PLAYER_BULLET,n),s.playEffect(i.skill.row.audio)}}}),.3*e)}}},o}(n))||c);o._RF.pop()}}}));

System.register("chunks:///_virtual/Skill9.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./audioManager.ts","./mapModel.ts","./physicsGroup.ts"],(function(t){var i,n,o,s,l,e,u,r;return{setters:[function(t){i=t.inheritsLoose},function(t){n=t.cclegacy,o=t._decorator,s=t.Component},function(t){l=t.cocosUtil},function(t){e=t.audioManager},function(t){u=t.mapModel},function(t){r=t.physicsGroup}],execute:function(){var c;n._RF.push({},"83a600LHRxHU6nY/tjbs/tt","Skill9",void 0);var a=o.ccclass;o.property,t("Skill9",a("Skill9")(c=function(t){function n(){for(var i,n=arguments.length,o=new Array(n),s=0;s<n;s++)o[s]=arguments[s];return(i=t.call.apply(t,[this].concat(o))||this).skill=void 0,i.num=0,i.timeCount=0,i}i(n,t);var o=n.prototype;return o.init=function(t){this.skill=t},o.subNum=function(){this.num--},o.updateLogic=function(t){if(this.timeCount+=t,!(this.num>=this.skill.row.num||this.timeCount<this.skill.getAtkCd())){this.timeCount=0,this.num++;var i=l.getCircleDirectionArr(1)[0],n={invokeClass:this,time:this.skill.getDuration()};u.bulletSystem.addBullet(this.skill.row.bulletId,r.PLAYER_BULLET,null,i,n),e.playEffect(this.skill.row.audio)}},n}(s))||c);n._RF.pop()}}}));

System.register("chunks:///_virtual/SkillSelectLayer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./myLog.ts","./sdkManager.ts","./cocosUtil.ts","./utilTools.ts","./constants.ts","./msgac.ts","./designManager.ts","./mapModel.ts","./playerModel.ts","./AnimationCtrl.ts","./BaseLayer.ts","./ItemLayer.ts"],(function(e){var t,i,a,n,o,l,s,r,c,h,y,d,v,m,f,u,p,S,k,g,L;return{setters:[function(e){t=e.inheritsLoose},function(e){i=e.cclegacy,a=e._decorator,n=e.find,o=e.Color,l=e.Tween,s=e.UIOpacity,r=e.tween,c=e.v3},function(e){h=e.myLog},function(e){y=e.sdkManager},function(e){d=e.cocosUtil},function(e){v=e.utilTools},function(e){m=e.constants},function(e){f=e.msgac},function(e){u=e.designManager},function(e){p=e.mapModel},function(e){S=e.playerModel},function(e){k=e.AnimationCtrl},function(e){g=e.BaseLayer},function(e){L=e.ItemLayer}],execute:function(){var I;i._RF.push({},"9230fuNiqpEvJ8HMtcAJSj/","SkillSelectLayer",void 0);var b=a.ccclass;a.property,e("SkillSelectLayer",b("SkillSelectLayer")(I=function(e){function i(){for(var t,i=arguments.length,a=new Array(i),n=0;n<i;n++)a[n]=arguments[n];return(t=e.call.apply(e,[this].concat(a))||this).skill1ItemLayer=void 0,t.skill2ItemLayer=void 0,t.selectItemLayer=void 0,t.hasSelect=void 0,t.uiNode=void 0,t.btnRefresh=void 0,t.btnGetAll=void 0,t.textHint=void 0,t.allHint=void 0,t}t(i,e);var a=i.prototype;return a.onLoad=function(){e.prototype.onLoad.call(this),this.uiNode=this.getNodeByPath("ui"),this.skill1ItemLayer=this.getNodeByPath("ui/skillLayer1/itemLayer").addComponent(L),this.skill2ItemLayer=this.getNodeByPath("ui/skillLayer2/itemLayer").addComponent(L),this.selectItemLayer=this.getNodeByPath("ui/selectLayer").addComponent(L),this.btnRefresh=this.getNodeByPath("ui/btns/btnRefresh"),this.btnGetAll=this.getNodeByPath("ui/btns/btnGetAll"),this.textHint=this.getNodeByPath("ui/textHint"),this.allHint=this.getNodeByPath("ui/allHint")},a.onEnable=function(){e.prototype.onEnable.call(this),this.addEventArr([f.mapLeave])},a.onDisable=function(){e.prototype.onDisable.call(this),this.removeEventArr([f.mapLeave])},a.initUI=function(){d.tweenScaleIn2(this.uiNode),this.hasSelect=!1,this.setString(this.getNodeByPath("expProgress/lv"),p.expLv),this.refreshSkillLayer(),this.refreshSelectLayer()},a.refreshSkillLayer=function(){this.setNumItemLayer(this.skill1ItemLayer.node,m.design.skillNum,this.refreshSkill1Item.bind(this)),this.setNumItemLayer(this.skill2ItemLayer.node,m.design.skillNum,this.refreshSkill2Item.bind(this))},a.refreshSkill1Item=function(e,t){var i=p.skillSystem.skillArr[t-1],a=n("icon",e);if(i){a.active=!0;var o=u.getRowById(m.tableName.skill,i.id);this.setSpriteFrame(a,o.icon)}else a.active=!1},a.refreshSkill2Item=function(e,t){var i=p.skillSystem.skill2Arr[t-1],a=n("icon",e);if(i){a.active=!0;var o=u.getRowById(m.tableName.skill2,i.id);this.setSpriteFrame(a,o.icon)}else a.active=!1},a.refreshSelectLayer=function(){var e=p.mapSystem.getSelectItemArr();this.selectItemLayer.initUI(this,e,this.refreshSelectItem.bind(this))},a.refreshSelectItem=function(e,t){d.setRenderableColor(e,o.WHITE,!0);var i=n("new",e),a=t.info;a?i.active=!1:(i.active=!0,l.stopAllByTarget(i),d.tweenBreath(i,.5,1.1));var y=null;switch(t.name){case m.tableName.weapon:case m.tableName.skill:case m.tableName.skill2:var f=u.getFirstIdByType(t.type);a&&(f=a.id+1),y=u.getRowById(t.name,f);break;case m.tableName.prop:y=u.getRowById(t.name,t.id)}y||h.e("row is undefined:",y,t),e.row=y,this.setString(n("name",e),y.name),this.setSpriteFrame(n("icon",e),y.icon),this.setString(n("info",e),y.info),n("btnDoubleSelect",e).active=!1;var S=n("selectEffect",e);S.active=!1,d.addComponentOnce(S,k);var g=n("starLayer",e),L=n("bg",e),I=n("bg2",e);y.lv>=m.design.maxLv?(L.active=!1,I.active=!0):(L.active=!0,I.active=!1),t.name==m.tableName.prop?g.active=!1:(g.active=!0,this.setNumItemLayer(g,m.design.maxLv,(function(t,i){var a=t.getComponent(s);a.opacity=255,l.stopAllByTarget(a);var o=n("icon",t),r=n("icon2",t),c=n("yin",t);y.lv>=i?(c.active=!1,y.lv==m.design.maxLv?(o.active=!1,r.active=!0):(o.active=!0,r.active=!1),y.lv==i&&(d.tweenBlink(t,.3),e.starNode=t)):(c.active=!0,o.active=!1,r.active=!1)})));var b=n("comb",e);if(y.skillArr){b.active=!0;var N=n("icon",b),B=0;v.forArr(y.skillArr,(function(e){var t=p.skillSystem.getSkillInfoByType(e);if(t)return B=t.id,!0})),0==B&&(B=u.getFirstIdByType(y.skillArr[0]));var A=u.getRowById(m.tableName.skill,B);this.setSpriteFrame(N,A.icon),l.stopAllByTarget(N),r(N).delay(1).to(.3,{scale:c(1.5,1.5,1)}).to(.15,{scale:c(1,1,1)}).union().repeatForever().start()}else b.active=!1},a.mapLeaveRet=function(){this.closeLayer()},a.onDestroy=function(){e.prototype.onDestroy.call(this)},a.processEvent=function(e,t){},a.onClickBtnRefresh=function(){this.hasSelect||(S.skillFreeRefreshCount++,this.refreshSelectLayer())},a.onClickBtnGetAll=function(){var e=this;this.hasSelect||y.openAd("3选1欧皇附体",(function(t){if(1==t){p.skillAllNum--,e.hasSelect=!0;var i=[];e.selectItemLayer.node.children.forEach((function(e){i.push(e)}));!function t(){var a=i.shift();a?e.doSelectItem(a,!1,(function(){t()})):e.goNext()}()}}))},a.doSelectItem=function(e,t,i,a){var o=this;void 0===t&&(t=!0),void 0===a&&(a=!1);var l=e.starNode,s=e.item,h=e.row;v.waterfall([function(i,s){if(t&&v.forArr(o.selectItemLayer.node.children,(function(t){e!=t&&d.setRenderableColor(t,m.colors.yin,!0)})),l&&l.activeInHierarchy){var y=n("selectEffect",e);y.active=!0;var f=d.convertToNodeSpace(y,d.convertToWorldSpace(l));if(y.setPosition(f),y.getComponent(k).playAnimationOnce("2",(function(){y.active=!1})),l.scale=c(1,1,1),r(l).to(.1,{scale:c(1.5,1.5,1)}).delay(.15).to(.15,{scale:c(1,1,1)}).call((function(){s()})).start(),a){var u=n("starLayer",e).children[h.lv];if(u){var p=d.instantiate(y);p.parent=y.parent,f=d.convertToNodeSpace(p,d.convertToWorldSpace(u)),p.position=f,p.getComponent(k).playAnimationOnce("2",(function(){p.removeFromParent()})),u.scale=c(1,1,1),n("icon",u).active=!0,r(u).to(.1,{scale:c(1.5,1.5,1)}).delay(.15).to(.15,{scale:c(1,1,1)}).start()}}}else o.scheduleOnce((function(){s()}),.2)},function(e,t){switch(s.name){case m.tableName.weapon:p.weaponSystem.addWeapon(s.type),a&&p.weaponSystem.addWeapon(s.type);break;case m.tableName.skill:p.skillSystem.addSkill(s.type),a&&p.skillSystem.addSkill(s.type);break;case m.tableName.skill2:p.skillSystem.addSkill2(s.type),a&&p.skillSystem.addSkill2(s.type);break;case m.tableName.prop:p.propSystem.getProp(s.id)}t()},function(e,t){i&&i()}])},a.goNext=function(){this.layerData.lvCount--,this.layerData.lvCount>0?this.initUI():(this.closeLayer(),this.layerCb&&this.layerCb())},a.onClickSelectItem=function(e){var t=this;this.hasSelect||(this.hasSelect=!0,this.doSelectItem(e,!0,(function(){t.goNext()})))},a.onClickBtnDoubleSelect=function(e){var t=this;this.hasSelect||y.openAd("3选1连升两星",(function(i){if(1==i){t.hasSelect=!0;var a=e.parent.starNode;l.stopAllByTarget(a.getComponent(s)),a.getComponent(s).opacity=255,n("yin",a).active=!0,n("icon",a).active=!1,t.scheduleOnce((function(){n("yin",a).active=!1,n("icon",a).active=!0,t.doSelectItem(e.parent,!0,(function(){t.goNext()}),!0)}),.3)}}))},i}(g))||I);i._RF.pop()}}}));

System.register("chunks:///_virtual/SkillSystem.ts",["./rollupPluginModLoBabelHelpers.js","cc","./utilTools.ts","./constants.ts","./designManager.ts","./mapModel.ts","./BaseLayer.ts","./Skill.ts"],(function(t){var e,l,i,n,r,o,s,a,d,u,c,k,p;return{setters:[function(t){e=t.inheritsLoose},function(t){l=t.cclegacy,i=t._decorator,n=t.find,r=t.Node,o=t.UITransform,s=t.macro},function(t){a=t.utilTools},function(t){d=t.constants},function(t){u=t.designManager},function(t){c=t.mapModel},function(t){k=t.BaseLayer},function(t){p=t.Skill}],execute:function(){var g;l._RF.push({},"a1c8eWHl3BPAKKbFdyYWh5P","SkillSystem",void 0);var f=i.ccclass;i.property,t("SkillSystem",f("SkillSystem")(g=function(t){function l(){for(var e,l=arguments.length,i=new Array(l),n=0;n<l;n++)i[n]=arguments[n];return(e=t.call.apply(t,[this].concat(i))||this).skillArr=[],e.skill2Arr=[],e.hasOpenScheculeAddHp=!1,e}e(l,t);var i=l.prototype;return i.onLoad=function(){t.prototype.onLoad.call(this)},i.onEnable=function(){t.prototype.onEnable.call(this)},i.onDestroy=function(){t.prototype.onDestroy.call(this)},i.getSaveData=function(){var t={};return t.skillArr=this.skillArr,t.skill2Arr=this.skill2Arr,t},i.loadSaveData=function(t){var e=this;a.forArr(t.skillArr,(function(t){e.addSkill(0,t.id)})),a.forArr(t.skill2Arr,(function(t){e.addSkill2(0,t.id)}))},i.addSkill=function(t,e){void 0===e&&(e=0),e>0&&(t=u.getRowById(d.tableName.skill,e).type);var l=this.getSkillInfoByType(t);if(l){var i=u.getRowById(d.tableName.skill,l.id+1);if(!i||i.lv>d.design.maxLv)return;l.id++}else{if(this.skillArr.length>=d.design.skillNum)return;(l={}).id=u.getFirstIdByType(t),this.skillArr.push(l)}e>0&&(l.id=e);var s=this.getSkillNodeNameByType(t),a=n(s,this.node);if(a){var c=a.getComponent(p).skillUtil;c&&c.forceDestroy&&c.forceDestroy(),a.destroy(),a.parent=null}(a=new r(s)).addComponent(o),a.parent=this.node;var k=a.addComponent(p);k.init(l),k.skillUtil&&(k.skillUtil.timeCount=k.row.cd)},i.getSkillInfoByType=function(t){for(var e in this.skillArr){var l=this.skillArr[e];if(u.getRowById(d.tableName.skill,l.id).type==t)return l}return null},i.getSkillNodeNameByType=function(t){return"skill"+t},i.getSkillCompomentByType=function(t){var e=this.getSkillNodeNameByType(t),l=n(e,this.node);return l?l.getComponent(p):null},i.getSkill2InfoByType=function(t){for(var e=0;e<this.skill2Arr.length;e++){var l=this.skill2Arr[e];if(t==u.getRowById(d.tableName.skill2,l.id).type)return l}return null},i.addSkill2=function(t,e){void 0===e&&(e=0),e>0&&(t=u.getRowById(d.tableName.skill2,e).type);var l=this.getSkill2InfoByType(t);if(l){var i=u.getRowById(d.tableName.skill2,l.id+1);if(!i||i.lv>d.design.maxLv)return;l.id++}else{if(this.skill2Arr.length>=d.design.skillNum)return;(l={}).id=u.getFirstIdByType(t),this.skill2Arr.push(l)}e>0&&(l.id=e);var n=u.getRowById(d.tableName.skill2,l.id);switch(n.type){case 6:var r=this.getSkillCompomentByType(7);r&&r.skillUtil.initBulletScale();break;case 7:this.hasOpenScheculeAddHp||(this.hasOpenScheculeAddHp=!0,this.schedule(this.playerHpAdd,5,s.REPEAT_FOREVER));break;case 8:c.player.addHpMaxPercent(n.p1)}},i.playerHpAdd=function(){var t=this.getSkill2Val(7);c.player.addHp(t)},i.getSkill2Val=function(t){var e=this.getSkill2InfoByType(t);return e?u.getRowById(d.tableName.skill2,e.id).p1:0},i.getSkill2AtkCdSubPercent=function(){return this.getSkill2Val(12)},i.getSkill2AtkAddPercent=function(){return this.getSkill2Val(11)},i.getSkill2PropGetAddDis=function(){return this.getSkill2Val(10)},i.getSkill2AddCoin=function(){return this.getSkill2Val(9)},i.getSkill2RangeAddScale=function(){return this.getSkill2Val(6)},i.getSkill2DamSubPercent=function(){return this.getSkill2Val(5)},i.getSkill2DurationAddPercent=function(){return this.getSkill2Val(4)},i.getSkill2AddExp=function(){return this.getSkill2Val(3)},i.getSkill2PlayerSpeedAddPercent=function(){return this.getSkill2Val(2)},i.getSkill2BulletSpeedAddPercent=function(){return this.getSkill2Val(1)},i.updateLogic=function(t){a.forArr(this.node.children,(function(e){e.getComponent(p).updateLogic(t)}))},l}(k))||g);l._RF.pop()}}}));

System.register("chunks:///_virtual/SkinChangeLayer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./localText.ts","./UserData.ts","./BaseLayer.ts","./ServerCtr.ts","./utilTools.ts"],(function(t){var e,i,n,o,s,r,a,c,l,h,u;return{setters:[function(t){e=t.inheritsLoose,i=t.asyncToGenerator,n=t.regeneratorRuntime},function(t){o=t.cclegacy,s=t._decorator,r=t.find},function(t){a=t.localText},function(t){c=t.UserData},function(t){l=t.BaseLayer},function(t){h=t.default},function(t){u=t.utilTools}],execute:function(){var p;o._RF.push({},"e7394qEzFdEHZl4XKRyeiOh","SkinChangeLayer",void 0);var d=s.ccclass;s.property,t("SkinChangeLayer",d("SkinChangeLayer")(p=function(t){function o(){for(var e,i=arguments.length,n=new Array(i),o=0;o<i;o++)n[o]=arguments[o];return(e=t.call.apply(t,[this].concat(n))||this).listResetPos=!0,e.btnEquip=void 0,e.btnGoGet=void 0,e.choseId=0,e.rootNode=void 0,e}e(o,t);var s=o.prototype;return s.onLoad=function(){t.prototype.onLoad.call(this),this.rootNode=this.node,this.btnEquip=this.getNodeByPath("ui/bottom/btns/btnEquip"),this.btnGoGet=this.getNodeByPath("ui/bottom/btns/btnGoGet"),this.choseId=c.getInstance().heroSkin,this.setLoadingActive(!1)},s.onEnable=function(){t.prototype.onEnable.call(this)},s.onDisable=function(){t.prototype.onDisable.call(this)},s.onDestroy=function(){t.prototype.onDestroy.call(this)},s.filterUniqueByDetailsId=function(t){var e=new Map;return t.forEach((function(t){e.has(t.details.icon)||e.set(t.details.icon,t)})),Array.from(e.values())},s.initUI=function(){var t=i(n().mark((function t(){var e,i;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.setLoadingActive(!0),t.prev=1,t.next=4,h.GetInstance().getEquipmentByUserId(u.getUserId().toString(),"skin");case 4:e=t.sent,i=this.filterUniqueByDetailsId(e),this.updateScrollView(i),this.updateRoleSkin(),this.btnEquip.active=!0,this.btnGoGet.active=!1,t.next=15;break;case 12:t.prev=12,t.t0=t.catch(1),console.error("Failed to initialize UI:",t.t0);case 15:return t.prev=15,this.setLoadingActive(!1),t.finish(15);case 18:case"end":return t.stop()}}),t,this,[[1,12,15,18]])})));return function(){return t.apply(this,arguments)}}(),s.updateScrollView=function(t){this.scrollViewSetData(this.getNodeByPath("ui/bottom/list"),t,this.refreshSkinItem.bind(this),this.listResetPos),this.listResetPos=!1},s.updateRoleSkin=function(){var t=this.choseId%2e3;this.setRoleSkin(this.getNodeByPath("ui/top/body"),this.choseId);try{this.setSpriteFrame2(this.getNodeByPath("ui/top/skin"),"skin/skin"+t,null,"ui")}catch(t){console.error("Failed to update role skin sprite:",t)}},s.refreshSkinItem=function(t,e){var i;this.setSpriteFrame2(r("icon",t),"prop/"+(null==e||null==(i=e.details)?void 0:i.icon)),r("chose",t).active=e.details.id===this.choseId},s.setLoadingActive=function(t){var e=this.rootNode.getChildByName("Loading");e&&(e.active=t)},s.onClickSkinItem=function(t){var e=t.item.details;this.choseId=e.id,this.initUI()},s.onClickBtnGoGet=function(){t.prototype.closeLayer.call(this),this.layerCb&&this.layerCb("close")},s.onClickBtnEquip=function(){var e=i(n().mark((function e(){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setLoadingActive(!0),e.prev=1,e.next=4,h.GetInstance().wearSkin(u.getUserId().toString(),this.choseId);case 4:e.sent&&(c.getInstance().heroSkin=this.choseId,this.createNotice(a.equipSuccess),this.layerCb&&this.layerCb(""),t.prototype.closeLayer.call(this)),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),console.error("Failed to equip skin:",e.t0);case 11:return e.prev=11,this.setLoadingActive(!1),e.finish(11);case 14:case"end":return e.stop()}}),e,this,[[1,8,11,14]])})));return function(){return e.apply(this,arguments)}}(),s.closeLayer=function(){t.prototype.closeLayer.call(this),this.layerCb&&this.layerCb()},o}(l))||p);o._RF.pop()}}}));

System.register("chunks:///_virtual/SkinsDetailsLayer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./BaseUILayer.ts","./UserData.ts","./localText.ts","./ServerCtr.ts","./utilTools.ts","./constants.ts"],(function(e){var t,n,i,a,r,o,l,s,u,c,p,d,b,f,h,y,g;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,i=e.initializerDefineProperty,a=e.assertThisInitialized,r=e.asyncToGenerator,o=e.regeneratorRuntime},function(e){l=e.cclegacy,s=e._decorator,u=e.Node,c=e.Label,p=e.sp},function(e){d=e.BaseUILayer},function(e){b=e.UserData},function(e){f=e.localText},function(e){h=e.default},function(e){y=e.utilTools},function(e){g=e.constants}],execute:function(){var L,k,D,S,m,v,w,A,I,z,R,U,N,C,x,B,T,F,_,H,P,q,G,M,O,V,Z;l._RF.push({},"ba7fddtm5RMZZJpdddEIOmV","SkinsDetailsLayer",void 0);var $=s.ccclass,j=s.property;e("SkinsDetailsLayer",(L=$("SkinsDetailsLayer"),k=j({type:u}),D=j({type:u}),S=j({type:u}),m=j({type:c}),v=j({type:c}),w=j({type:c}),A=j({type:c}),I=j({type:c}),z=j({type:c}),R=j({type:c}),U=j({type:c}),N=j({type:c}),L((B=t((x=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return t=e.call.apply(e,[this].concat(r))||this,i(t,"role",B,a(t)),i(t,"backgroundData",T,a(t)),i(t,"headerIcon",F,a(t)),i(t,"skinName",_,a(t)),i(t,"hpLabel",H,a(t)),i(t,"atkLabel",P,a(t)),i(t,"defenseLabel",q,a(t)),i(t,"soulDropRateLabel",G,a(t)),i(t,"hpLabelAdd",M,a(t)),i(t,"atkLabelAdd",O,a(t)),i(t,"defenseLabelAdd",V,a(t)),i(t,"soulDropRateLabelAdd",Z,a(t)),t.rootNode=null,t}n(t,e);var l=t.prototype;return l.onLoad=function(){this.rootNode=this.node},l.trimHeroSkin=function(e){return e.replace(/^skin_hero(\d+)$/,"skin$1")},l.start=function(){console.log(this.layerData,"--------------------- this.layerData"),this.initializeUI(),this.updateSkinDetails()},l.initializeUI=function(){this.rootNode.getChildByName("Loading").active=!1},l.updateSkinDetails=function(){var e,t,n,i,a=null==(e=this.layerData)?void 0:e.details;if(a){console.log("🚀 ~ SkinsDetailsLayer ~ updateSkinDetails ~ details:",a);var r=this.role.getComponent(p.Skeleton),o=this.trimHeroSkin(a.icon.toLowerCase());r.setSkin(o),r.setSlotsToSetupPose(),this.skinName.string=a.name||"",this.hpLabel.string=b.getInstance().getUserServerData().baseHp||"0",this.atkLabel.string=b.getInstance().getUserServerData().baseAtk||"0",this.defenseLabel.string=b.getInstance().getUserServerData().baseDefense||"0",this.soulDropRateLabel.string=b.getInstance().getUserServerData().baseSoulDropRate+"%",this.hpLabelAdd.string="+"+(null==(t=a.hpAdd)?void 0:t.toString())||"0",this.atkLabelAdd.string="+"+(null==(n=a.atkAdd)?void 0:n.toString())||"0",this.defenseLabelAdd.string="+"+(null==(i=a.defenseAdd)?void 0:i.toString())||"0",this.soulDropRateLabelAdd.string="+"+parseFloat(a.soulDropRateAdd)+"%";var l=b.getInstance().getUserSkinRes(a.element),s=l.headIcon,u=l.bgIconBig;this.setSpriteFrame2(this.headerIcon,"skins_ui/"+s,null,g.bundles.ui),this.setSpriteFrame2(this.backgroundData,"heroLayer/skin/"+u,null,g.bundles.wwqVec)}else console.warn("Details data is missing.")},l.getLastDigit=function(e){return e%10},l.onClickSkin=function(){var e=r(o().mark((function e(){var t,n=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(t=this.rootNode.getChildByName("Loading")).active=!0,e.prev=2,e.next=5,h.GetInstance().wearSkin(y.getUserId().toString(),this.layerData.details.id);case 5:return e.next=7,b.getInstance().updateUserData();case 7:this.toast(f.equipSuccess),this.scheduleOnce((function(){t.active=!1,n.closeLayer()}),2),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(2),console.error("Failed to wear skin:",e.t0),t.active=!1;case 15:case"end":return e.stop()}}),e,this,[[2,11]])})));return function(){return e.apply(this,arguments)}}(),l.onBtnAscendClick=function(){this.openLayer(g.layers.AscendLayer)},l.closeLayers=function(t){e.prototype.closeLayer.call(this),this.layerCb&&this.layerCb(t)},l.onDestroy=function(){e.prototype.onDestroy.call(this)},t}(d)).prototype,"role",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),T=t(x.prototype,"backgroundData",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),F=t(x.prototype,"headerIcon",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),_=t(x.prototype,"skinName",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),H=t(x.prototype,"hpLabel",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),P=t(x.prototype,"atkLabel",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),q=t(x.prototype,"defenseLabel",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),G=t(x.prototype,"soulDropRateLabel",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),M=t(x.prototype,"hpLabelAdd",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),O=t(x.prototype,"atkLabelAdd",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),V=t(x.prototype,"defenseLabelAdd",[U],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Z=t(x.prototype,"soulDropRateLabelAdd",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),C=x))||C));l._RF.pop()}}}));

System.register("chunks:///_virtual/SkinsLayer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./BaseUILayer.ts","./constants.ts","./ServerCtr.ts","./utilTools.ts","./UserData.ts"],(function(e){var t,n,i,r,o,s,a,l,c,u,p,d,y,h,f;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,i=e.initializerDefineProperty,r=e.assertThisInitialized,o=e.asyncToGenerator,s=e.regeneratorRuntime},function(e){a=e.cclegacy,l=e._decorator,c=e.Node,u=e.Label},function(e){p=e.BaseUILayer},function(e){d=e.constants},function(e){y=e.default},function(e){h=e.utilTools},function(e){f=e.UserData}],execute:function(){var g,v,L,k,S;a._RF.push({},"14bcdsoG79KfbpbOiUgpXnS","SkinsLayer",void 0);var b=l.ccclass,m=l.property;e("SkinsLayer",(g=b("SkinsLayer"),v=m({type:c}),g((S=t((k=function(e){function t(){for(var t,n=arguments.length,o=new Array(n),s=0;s<n;s++)o[s]=arguments[s];return t=e.call.apply(e,[this].concat(o))||this,i(t,"scrollView",S,r(t)),t.rootNode=void 0,t}n(t,e);var a=t.prototype;return a.onLoad=function(){this.rootNode=this.node},a.start=function(){this.initSkinList()},a.update=function(e){},a.onBoxClick=function(e){console.log(e)},a.onDestroy=function(){e.prototype.onDestroy.call(this)},a.initSkinList=function(){var e=o(s().mark((function e(){var t,n=this;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.rootNode.getChildByName("Loading").active=!0,e.prev=1,e.next=4,y.GetInstance().getEquipmentByUserId(h.getUserId().toString(),"skin");case 4:(t=e.sent)&&t.length>0&&this.scrollViewSetData(this.scrollView,t,(function(e,t,i){var r,o,s,a=e.getChildByName("icon"),l=e.getChildByName("headerIcon");e.getChildByName("Label-002").getComponent(u).string=(null==t||null==(r=t.details)||null==(r=r.name)||null==(r=r.split(" "))?void 0:r[0])||"Unknown";var c=null==t||null==(o=t.details)?void 0:o.element,p=f.getInstance().getUserSkinRes(c),y=p.bgIconSmall,h=p.headIcon;p.bgIconBig;n.setSpriteFrame2(e.getChildByName("propbg1"),"skins_ui/"+y,null,d.bundles.ui),n.setSpriteFrame2(l,"skins_ui/"+h,null,d.bundles.ui),n.setSpriteFrame2(a,"prop/"+(null==t||null==(s=t.details)?void 0:s.icon),null,d.bundles.icon),n.addClickListener(e,t,i)})),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),console.log("🚀 ~ SkinsLayer ~ initSkinList ~ error:",e.t0);case 11:return e.prev=11,this.rootNode.getChildByName("Loading").active=!1,e.finish(11);case 14:case"end":return e.stop()}}),e,this,[[1,8,11,14]])})));return function(){return e.apply(this,arguments)}}(),a.getLastDigit=function(e){var t=e.toString();return parseInt(t[t.length-1])},a.addClickListener=function(e,t,n){var i=this;e.on(c.EventType.TOUCH_END,(function(){i.openLayer(d.layers.SkinsDetailsLayer,t)}))},a.closeLayers=function(t){e.prototype.closeLayer.call(this),this.layerCb&&this.layerCb(t)},t}(p)).prototype,"scrollView",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),L=k))||L));a._RF.pop()}}}));

System.register("chunks:///_virtual/Summon.ts",["./rollupPluginModLoBabelHelpers.js","cc","./constants.ts","./BaseUILayer.ts","./UserData.ts","./audioManager.ts","./ServerCtr.ts","./utilTools.ts","./layerManager.ts"],(function(e){var t,r,n,i,o,a,s,p,u,c,l,m,h,d,b,f,g;return{setters:[function(e){t=e.applyDecoratedDescriptor,r=e.inheritsLoose,n=e.initializerDefineProperty,i=e.assertThisInitialized,o=e.asyncToGenerator,a=e.regeneratorRuntime},function(e){s=e.cclegacy,p=e._decorator,u=e.Node,c=e.find},function(e){l=e.constants},function(e){m=e.BaseUILayer},function(e){h=e.UserData},function(e){d=e.audioManager},function(e){b=e.default},function(e){f=e.utilTools},function(e){g=e.layerManager}],execute:function(){var y,v,S,w,k,I,N,x,_,C,L,D,F,U,B,z,T;s._RF.push({},"8c033vZ3zJCVZsWR1MQmMfm","Summon",void 0);var E=p.ccclass,P=p.property;e("Summon",(y=E("Summon"),v=P({type:u}),S=P({type:u}),w=P({type:u}),k=P({type:u}),I=P({type:u}),N=P({type:u}),x=P({type:u}),y((L=t((C=function(e){function t(){for(var t,r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return t=e.call.apply(e,[this].concat(o))||this,n(t,"prop1",L,i(t)),n(t,"prop2",D,i(t)),n(t,"prop3",F,i(t)),n(t,"prop4",U,i(t)),n(t,"prop5",B,i(t)),n(t,"prop6",z,i(t)),n(t,"levelBox",T,i(t)),t._mangheType=1,t._curState=0,t._isDrawIng=!1,t.gaojiProp=[],t._rewardArr=[],t.rootNode=void 0,t.summonType=void 0,t}r(t,e);var s=t.prototype;return s.onLoad=function(){this.rootNode=this.node,this.rootNode.getChildByName("Loading").active=!1},s.onEnable=function(){},s.start=function(){switch(console.log("🚀 ~ Summon ~ onLoad ~ onLoad:",this.layerData),this.layerData.type){case"Character":this.summonType="SKIN",this.setSpriteFrame2(c("item",this.prop1),"prop/skin/skin_0",null,l.bundles.icon),this.setSpriteFrame2(c("item",this.prop2),"prop/skin/skin_16",null,l.bundles.icon),this.setSpriteFrame2(c("item",this.prop3),"prop/skin/skin_25",null,l.bundles.icon),this.setSpriteFrame2(c("item",this.prop4),"prop/skin/skin_30",null,l.bundles.icon),this.setSpriteFrame2(c("item",this.prop5),"prop/skin/skin_21",null,l.bundles.icon),this.setSpriteFrame2(c("item",this.prop6),"prop/skin/skin_19",null,l.bundles.icon),this.levelBox.active=!0;break;case"Equipment":this.summonType="EQUIP",this.setSpriteFrame2(c("item",this.prop1),"prop/zb_5",null,l.bundles.icon),this.setSpriteFrame2(c("item",this.prop2),"prop/zb_11",null,l.bundles.icon),this.setSpriteFrame2(c("item",this.prop3),"prop/zb_22",null,l.bundles.icon),this.setSpriteFrame2(c("item",this.prop4),"prop/zb_24",null,l.bundles.icon),this.setSpriteFrame2(c("item",this.prop5),"prop/zb_29",null,l.bundles.icon),this.setSpriteFrame2(c("item",this.prop6),"prop/zb_28",null,l.bundles.icon),this.levelBox.active=!0;break;case"Weapon":this.summonType="WEAPON",this.setSpriteFrame2(c("item",this.prop1),"prop/weapon/weapon1_1",null,l.bundles.icon),this.setSpriteFrame2(c("item",this.prop2),"prop/weapon/weapon2_1",null,l.bundles.icon),this.setSpriteFrame2(c("item",this.prop3),"prop/weapon/weapon3_1",null,l.bundles.icon),this.setSpriteFrame2(c("item",this.prop4),"prop/weapon/weapon4_1",null,l.bundles.icon),this.setSpriteFrame2(c("item",this.prop5),"prop/weapon/weapon5_1",null,l.bundles.icon),this.setSpriteFrame2(c("item",this.prop6),"prop/weapon/weapon6_1",null,l.bundles.icon),this.levelBox.active=!1}},s.onOneCard=function(){var e=o(a().mark((function e(){var t,r=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(d.playEffect("btnClick"),!(h.getInstance().getUserRuntimeData().diamondCoin<1e3)){e.next=5;break}return g.createNotice("Insufficient Soul"),e.abrupt("return");case 5:this.rootNode.getChildByName("Loading").active=!0,t=null,e.prev=7,e.t0=this.summonType,e.next="WEAPON"===e.t0?11:"SKIN"===e.t0?15:"EQUIP"===e.t0?19:23;break;case 11:return e.next=13,b.GetInstance().getDrawWeapons(f.getUserId().toString(),1);case 13:return t=e.sent,e.abrupt("break",23);case 15:return e.next=17,b.GetInstance().getDrawSkins(f.getUserId().toString(),1);case 17:return t=e.sent,e.abrupt("break",23);case 19:return e.next=21,b.GetInstance().getDrawEquipments(f.getUserId().toString(),1);case 21:return t=e.sent,e.abrupt("break",23);case 23:if(this.rootNode.getChildByName("Loading").active=!1,t){e.next=26;break}return e.abrupt("return");case 26:t.map((function(e){return e.equipUniqueId})),this.openLayer(l.layers.RewardLayer,{propArr:t},null,o(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.rootNode.getChildByName("Loading").active=!0,e.next=3,h.getInstance().updateUserData();case 3:r.rootNode.getChildByName("Loading").active=!1;case 4:case"end":return e.stop()}}),e)})))),e.next=34;break;case 31:e.prev=31,e.t1=e.catch(7),console.log("🚀 ~ Summon ~ onOneCard ~ error:",e.t1);case 34:case"end":return e.stop()}}),e,this,[[7,31]])})));return function(){return e.apply(this,arguments)}}(),s.onDestroy=function(){e.prototype.onDestroy.call(this)},s.onTenCard=function(){var e=o(a().mark((function e(){var t,r=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(d.playEffect("btnClick"),!(h.getInstance().getUserRuntimeData().diamondCoin<10)){e.next=5;break}return g.createNotice("Insufficient Diamond"),e.abrupt("return");case 5:this.rootNode.getChildByName("Loading").active=!0,t=null,e.prev=7,e.t0=this.summonType,e.next="WEAPON"===e.t0?11:"SKIN"===e.t0?15:"EQUIP"===e.t0?19:23;break;case 11:return e.next=13,b.GetInstance().getDrawWeapons(f.getUserId().toString(),10);case 13:return t=e.sent,e.abrupt("break",23);case 15:return e.next=17,b.GetInstance().getDrawSkins(f.getUserId().toString(),10);case 17:return t=e.sent,e.abrupt("break",23);case 19:return e.next=21,b.GetInstance().getDrawEquipments(f.getUserId().toString(),10);case 21:return t=e.sent,e.abrupt("break",23);case 23:if(this.rootNode.getChildByName("Loading").active=!1,t){e.next=26;break}return e.abrupt("return");case 26:t.map((function(e){return e.equipUniqueId})),this.openLayer(l.layers.RewardLayer,{propArr:t},null,o(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.rootNode.getChildByName("Loading").active=!0,e.next=3,h.getInstance().updateUserData();case 3:r.rootNode.getChildByName("Loading").active=!1;case 4:case"end":return e.stop()}}),e)})))),e.next=34;break;case 31:e.prev=31,e.t1=e.catch(7),console.log("🚀 ~ Summon ~ onTenCard ~ error:",e.t1);case 34:case"end":return e.stop()}}),e,this,[[7,31]])})));return function(){return e.apply(this,arguments)}}(),s.closeLayers=function(t){e.prototype.closeLayer.call(this),this.layerCb&&this.layerCb(t)},t}(m)).prototype,"prop1",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),D=t(C.prototype,"prop2",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),F=t(C.prototype,"prop3",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),U=t(C.prototype,"prop4",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),B=t(C.prototype,"prop5",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),z=t(C.prototype,"prop6",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),T=t(C.prototype,"levelBox",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),_=C))||_));s._RF.pop()}}}));

System.register("chunks:///_virtual/TargetPos.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var o,e,i,n,r,c,a,s;return{setters:[function(t){o=t.inheritsLoose},function(t){e=t.cclegacy,i=t._decorator,n=t.find,r=t.UIOpacity,c=t.Tween,a=t.tween,s=t.Component}],execute:function(){var p;e._RF.push({},"fd808cYOr1C8a0AZJRh6bh6","TargetPos",void 0);var y=i.ccclass;i.property,t("targetPos",y("targetPos")(p=function(t){function e(){for(var o,e=arguments.length,i=new Array(e),n=0;n<e;n++)i[n]=arguments[n];return(o=t.call.apply(t,[this].concat(i))||this).hint=void 0,o.body2Opacity=void 0,o}return o(e,t),e.prototype.init=function(t){var o=this;this.hint=t,this.body2Opacity||(this.body2Opacity=n("body2",this.node).getComponent(r)),c.stopAllByTarget(this.body2Opacity),this.body2Opacity.opacity=80,a(this.body2Opacity).to(.2,{opacity:255}).to(.2,{opacity:80}).union().repeatForever().start();var e=this.hint.extraObj;this.scheduleOnce((function(){o.hint.recycleSelf()}),e)},e}(s))||p);e._RF.pop()}}}));

System.register("chunks:///_virtual/targetPos2.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var i,o,e,n,s,c,r,a,h;return{setters:[function(t){i=t.inheritsLoose},function(t){o=t.cclegacy,e=t._decorator,n=t.find,s=t.UIOpacity,c=t.Tween,r=t.tween,a=t.v3,h=t.Component}],execute:function(){var y;o._RF.push({},"9866dcdqCVBH7LK3VKub6sv","targetPos2",void 0);var p=e.ccclass;e.property,t("targetPos2",p("targetPos2")(y=function(t){function o(){for(var i,o=arguments.length,e=new Array(o),n=0;n<o;n++)e[n]=arguments[n];return(i=t.call.apply(t,[this].concat(e))||this).hint=void 0,i.body2Opacity=void 0,i}return i(o,t),o.prototype.init=function(t){var i=this;this.hint=t,this.body2Opacity||(this.body2Opacity=n("body2",this.node).getComponent(s)),c.stopAllByTarget(this.body2Opacity),this.body2Opacity.opacity=0,r(this.body2Opacity).to(.5,{opacity:255}).start(),this.node.scale=a(1,1,1),r(this.node).to(.6,{scale:a(.2,.2,1)}).start(),this.hint.extraObj(this),this.scheduleOnce((function(){i.hint.recycleSelf()}),1)},o}(h))||y);o._RF.pop()}}}));

System.register("chunks:///_virtual/targetPos3.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./mapModel.ts","./Hint.ts"],(function(t){var e,n,o,c,i,r,s,a,l,u;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy,o=t._decorator,c=t.v3,i=t.tween,r=t.UITransform,s=t.Component},function(t){a=t.cocosUtil},function(t){l=t.mapModel},function(t){u=t.HintNames}],execute:function(){var h;n._RF.push({},"25c7f6OwVNBUpx/MCLFCtec","targetPos3",void 0);var p=o.ccclass;o.property,t("targetPos3",p("targetPos3")(h=function(t){function n(){for(var e,n=arguments.length,o=new Array(n),c=0;c<n;c++)o[c]=arguments[c];return(e=t.call.apply(t,[this].concat(o))||this).hint=void 0,e}return e(n,t),n.prototype.init=function(t){var e=this;this.hint=t,this.node.scale=c(4,4,1),i(this.node).to(.3,{scale:c(.9,.9,1)}).to(.1,{scale:c(1.1,1.1,1)}).to(.1,{scale:c(1,1,1)}).call((function(){e.hint.recycleSelf();var t=a.convertToWorldSpace(e.node);t.y+=.5*e.node.getComponent(r).height,l.hintSystem.addHint(u.comeShine,t,0,e.hint.extraObj)})).start()},n}(s))||h);n._RF.pop()}}}));

System.register("chunks:///_virtual/TimeCtr.ts",["./rollupPluginModLoBabelHelpers.js","cc","./tyqSDK.ts"],(function(e){var t,r,n,i,s,u,a,c,o;return{setters:[function(e){t=e.inheritsLoose,r=e.createClass,n=e.asyncToGenerator,i=e.regeneratorRuntime},function(e){s=e.cclegacy,u=e._decorator,a=e.director,c=e.Component},function(e){o=e.tyqSDK}],execute:function(){var l,h;s._RF.push({},"85380QApjBE/5nzVaMu0fyo","TimeCtr",void 0);var f=u.ccclass;u.property,e("default",f("TimeCtr")(((h=function(e){function s(){for(var t,r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return(t=e.call.apply(e,[this].concat(n))||this).urls=[o.getUrl().httpUrl+"/isAlive"],t.serverTime=0,t.diffServerTime=0,t.isRunServerTime=!1,t.loginTime="",t.curSystemDate=0,t}t(s,e),s.GetInstance=function(){return this.instance||(this.instance=new s,this.instance.InitTimeCtr()),this.instance};var u=s.prototype;return u.InitTimeCtr=function(){},u.UpdateServerTime=function(e){a.getScheduler().unschedule(this.updateTimer,this),this.serverTime=e,this.curSystemDate=e,a.getScheduler().schedule(this.updateTimer,this,1)},u.UpdateServerTimeByHeartbeat=function(e){this.serverTime=e,this.curSystemDate=e},u.ReInit=function(){a.getScheduler().unschedule(this.updateTimer,this)},u.updateTimer=function(){this.isRunServerTime=!0},u.RequestTime=function(){var e=n(i().mark((function e(t){var r,n,s,u=this;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=i().mark((function e(){var r,n,a;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=u.urls[s],n=!1,a={},e.next=5,u.request(r).then((function(e){n=!0,a=e})).catch((function(e){n=!1,a=e}));case 5:if(!n){e.next=8;break}return t(a),e.abrupt("return",{v:void 0});case 8:case"end":return e.stop()}}),e)})),s=0;case 2:if(!(s<this.urls.length)){e.next=10;break}return e.delegateYield(r(),"t0",4);case 4:if(!(n=e.t0)){e.next=7;break}return e.abrupt("return",n.v);case 7:s++,e.next=2;break;case 10:t({result:!1});case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),u.request=function(e){return new Promise((function(t,r){var n=new XMLHttpRequest;n.timeout=3e3,n.onreadystatechange=function(){if(console.log("statusText:",n.statusText),4===n.readyState&&n.status>=200&&n.status<300){var e=n.responseText;if(!e)return void console.log("http error",e);console.log("收到的消息:",e);var i=JSON.parse(e);if(i.serverTime){var s=Number(i.serverTime);t({result:!0,time:s})}else r({result:!1})}},n.ontimeout=function(e){r({result:!1})},n.onerror=function(e){r({result:!1})},n.open("POST",e,!0),n.setRequestHeader("Content-Type","application/json"),n.send()}))},r(s,[{key:"ServerTime",get:function(){return 0!=this.serverTime?this.serverTime:Date.now()}},{key:"ServerDate",get:function(){if(0!=this.serverTime)return new Date(this.serverTime)}}]),s}(c)).instance=null,l=h))||l);s._RF.pop()}}}));

System.register("chunks:///_virtual/TopUILayer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./CountTimeUtil.ts","./constants.ts","./msgac.ts","./audioManager.ts","./designManager.ts","./eventManager.ts","./UserData.ts","./BaseUILayer.ts"],(function(e){var t,n,i,o,a,r,l,s,c,u,p,g,d,h,f,m,y,b,L,w,v,I;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,i=e.initializerDefineProperty,o=e.assertThisInitialized},function(e){a=e.cclegacy,r=e._decorator,l=e.Label,s=e.Node,c=e.ProgressBar,u=e.view,p=e.Vec3,g=e.tween,d=e.v3,h=e.Color},function(e){f=e.CountTimeUtil},function(e){m=e.constants},function(e){y=e.msgac},function(e){b=e.audioManager},function(e){L=e.designManager},function(e){w=e.eventManager},function(e){v=e.UserData},function(e){I=e.BaseUILayer}],execute:function(){var C,D,R,M,U,z,B,P,x,T,N,E,k,S,_,A,F,G,H,V,j;a._RF.push({},"dbf2aqp5zZNAYd/7F6SGaP7","TopUILayer",void 0);var q=r.ccclass,W=r.property;e("TopUILayer",(C=q("TopUILayer"),D=W({type:l,tooltip:"体力标签"}),R=W({type:l,tooltip:"MP标签"}),M=W({type:l,tooltip:"钻石diamond"}),U=W({type:l,tooltip:"金币标签"}),z=W({type:l,tooltip:"玩家等级"}),B=W({type:s,tooltip:"使用展示"}),P=W({type:c,tooltip:"经验进度条"}),x=W({type:l,tooltip:"体力时间"}),T=W({type:s}),C((k=t((E=function(e){function t(){for(var t,n=arguments.length,a=new Array(n),r=0;r<n;r++)a[r]=arguments[r];return t=e.call.apply(e,[this].concat(a))||this,i(t,"powerLabel",k,o(t)),i(t,"mpLabel",S,o(t)),i(t,"diamondLable",_,o(t)),i(t,"soulLable",A,o(t)),i(t,"lvLabel",F,o(t)),i(t,"showNode",G,o(t)),i(t,"expBar",H,o(t)),i(t,"tiliLabel",V,o(t)),i(t,"clearBtn",j,o(t)),t}n(t,e);var a=t.prototype;return a.onLoad=function(){e.prototype.onLoad.call(this),this.initLayout()},a.onEnable=function(){w.on(y.commonResRefresh,this.updateData,this),this.clearBtn.active=!1},a.initLayout=function(){var e=u.getVisibleSize(),t=this.getScreenScale();e.height/e.width>2?this.node.position=new p(this.node.position.x,e.height/t/2-220,this.node.position.z):this.node.position=new p(this.node.position.x,e.height/t/2-160,this.node.position.z)},a.start=function(){this.updateData()},a.showUseAnimal=function(e,t){this.showNode.active=!0,this.showNode.getChildByName("numLabel").getComponent(l).string=""+t,g(this.showNode).show().set({position:d(-88,-9,0)}).to(.5,{position:d(-88,-39,0)}).hide().start(),this.updateData()},a.onDisable=function(){w.off(y.commonResRefresh,this.updateData,this)},a.onDestroy=function(){e.prototype.onDestroy.call(this)},a.updateData=function(){var e,t,n,i,o;this.powerLabel.string=(null==(e=v.getInstance().getUserRuntimeData())?void 0:e.power)+"/"+L.config.energyMax,this.powerLabel.color=(null==(t=v.getInstance().getUserRuntimeData())?void 0:t.power)>L.config.energyMax?h.GREEN:h.WHITE,this.mpLabel.string=(null==(n=v.getInstance().getUserRuntimeData())?void 0:n.mpCoin)+"",this.diamondLable.string=(null==(i=v.getInstance().getUserRuntimeData())?void 0:i.diamondCoin)+"",this.soulLable.string=(null==(o=v.getInstance().getUserRuntimeData())?void 0:o.soulCoin)+"",this.lvLabel.string=v.getInstance().roleLv+"",this.expBar.progress=Math.min(1,v.getInstance().roleExp/v.getInstance().getNextLevelExp()),this.tiliLabel.node.getComponent(f)&&this.tiliLabel.node.getComponent(f).setTime(v.getInstance().getCountTime(),(function(){v.getInstance().checkPowerTime(),w.send(y.commonResRefresh)})),v.getInstance().saveData()},a.clearData=function(){v.getInstance().remove()},a.showRewardItem=function(e,t){b.playEffect("btnClick"),1==t?v.getInstance().power<L.config.energyMax&&this.openLayer(m.layers.RewardItemLayer,{propId:105,num:Math.min(L.config.adenergy,L.config.energyMax-v.getInstance().power)}):2==t?this.openLayer(m.layers.RewardItemLayer,{propId:801,num:L.config.adDiamond}):3==t&&this.openLayer(m.layers.RewardItemLayer,{propId:104,num:L.config.adCoin})},a.addMp=function(){this.node.getChildByPath("dialogPowerConfirm").active=!0},a.onClickRefills=function(){this.node.getChildByPath("dialogPowerConfirm").active=!1},a.onClickGetRefills=function(){this.node.getChildByPath("dialogPowerConfirm").active=!1,w.send(y.setTabPage,3)},a.closeMpDialog=function(){this.node.getChildByPath("dialogPowerConfirm").active=!1},t}(I)).prototype,"powerLabel",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),S=t(E.prototype,"mpLabel",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),_=t(E.prototype,"diamondLable",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),A=t(E.prototype,"soulLable",[U],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),F=t(E.prototype,"lvLabel",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),G=t(E.prototype,"showNode",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),H=t(E.prototype,"expBar",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),V=t(E.prototype,"tiliLabel",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),j=t(E.prototype,"clearBtn",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),N=E))||N));a._RF.pop()}}}));

System.register("chunks:///_virtual/TransLayer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./BaseLayer.ts"],(function(t){var o,e,n,a,r,c;return{setters:[function(t){o=t.inheritsLoose},function(t){e=t.cclegacy,n=t._decorator,a=t.v3,r=t.tween},function(t){c=t.BaseLayer}],execute:function(){var i;e._RF.push({},"1dfd8zP8FFNVqkhq8sr/YEs","TransLayer",void 0);var s=n.ccclass;n.property,t("TransLayer",s("TransLayer")(i=function(t){function e(){for(var o,e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];return(o=t.call.apply(t,[this].concat(n))||this).iconNode=void 0,o.blackNode=void 0,o}o(e,t);var n=e.prototype;return n.onLoad=function(){t.prototype.onLoad.call(this),this.iconNode=this.getNodeByPath("icon"),this.blackNode=this.getNodeByPath("black")},n.initUI=function(){var t=this;this.blackNode.active=!1,this.iconNode.scale=a(5,5,1),r(this.iconNode).to(.5,{scale:a(.05,.05,1)},{easing:"quadOut"}).call((function(){t.blackNode.active=!0})).start()},n.onDestroy=function(){t.prototype.onDestroy.call(this)},e}(c))||i);e._RF.pop()}}}));

System.register("chunks:///_virtual/TributeLayer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./BaseLayer.ts","./audioManager.ts","./ServerCtr.ts","./constants.ts","./layerManager.ts","./UserData.ts"],(function(t){var e,n,i,r,a,o,s,l,c,u,h,d,p,f,g,y,C,m;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,i=t.initializerDefineProperty,r=t.assertThisInitialized,a=t.asyncToGenerator,o=t.regeneratorRuntime},function(t){s=t.cclegacy,l=t._decorator,c=t.Node,u=t.Prefab,h=t.Label,d=t.instantiate},function(t){p=t.BaseLayer},function(t){f=t.audioManager},function(t){g=t.default},function(t){y=t.constants},function(t){C=t.layerManager},function(t){m=t.UserData}],execute:function(){var b,B,v,P,I,k,N,S,T,w,L,A,D,E,M,x,z,_,U,R,F,V,G,H,O,q,j,J,X,K,Q,W,Y;s._RF.push({},"c86cfuy0JdENa8TAOIwsFfX","TributeLayer",void 0);var Z=l.ccclass,$=l.property;t("TributeLayer",(b=Z("TributeLayer"),B=$({type:c,tooltip:"GrayMask"}),v=$({type:c,tooltip:"propagationStopped"}),P=$({type:c,tooltip:"btnBack"}),I=$({type:c,tooltip:"Mask"}),k=$({type:c,tooltip:"道具列表View"}),N=$({type:c,tooltip:"道具列表Content"}),S=$({type:c,tooltip:"confirmBox"}),T=$({type:c,tooltip:"confirmMask"}),w=$({type:u,tooltip:"选中角色卡片"}),L=$({type:c,tooltip:"升级信息"}),A=$({type:c,tooltip:"所需碎片数量"}),D=$({type:c,tooltip:"碎片数量提示"}),E=$({type:c,tooltip:"升级按钮"}),M=$({type:h,tooltip:"succRate"}),x=$([c]),b((U=e((_=function(t){function e(){for(var e,n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a))||this,i(e,"GrayMask",U,r(e)),i(e,"propagationStopped",R,r(e)),i(e,"btnBack",F,r(e)),i(e,"Mask",V,r(e)),i(e,"scrollView",G,r(e)),i(e,"scrollViewContent",H,r(e)),i(e,"confirmBox",O,r(e)),i(e,"confirmMask",q,r(e)),i(e,"ascendSel",j,r(e)),i(e,"ascendInfo",J,r(e)),i(e,"ascendNeed",X,r(e)),i(e,"ascendNeedTip",K,r(e)),i(e,"ascendBtn",Q,r(e)),i(e,"succRate",W,r(e)),i(e,"buttons",Y,r(e)),e.bgNodes=[],e.rootNode=void 0,e.allEquipmentList=[],e.rarityList=["R","SR","UR"],e.rarity=e.rarityList[0],e.selCharacter=[],e.ascendInfoData=null,e}n(e,t);var s=e.prototype;return s.onLoad=function(){t.prototype.onLoad.call(this),this.rootNode=this.node},s.start=function(){var t=this;this.initList(),this.buttons.forEach((function(e,n){var i=e.getChildByName("bg");i&&t.bgNodes.push(i),e.on(c.EventType.TOUCH_END,(function(e){t.onButtonIconClick(e,n)}),t)})),this.btnBack.on(c.EventType.TOUCH_END,(function(e){t.closeLayer()}),this),this.propagationStopped.on(c.EventType.TOUCH_END,(function(t){t.propagationStopped=!0}),this),this.GrayMask.on(c.EventType.TOUCH_END,(function(e){t.Mask.active=!1}),this)},s.onDestroy=function(){t.prototype.onDestroy.call(this)},s.onButtonIconClick=function(t,e){var n=this;f.playEffect("btnClick"),this.bgNodes.forEach((function(t,n){t.active=n===e})),this.rarity=this.rarityList[e];var i=this.allEquipmentList.filter((function(t){return t.details.rarity===n.rarity}));this.setScrollViewUi(i)},s.initList=function(){var t=a(o().mark((function t(){var e,n,i=this;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.renderAscendSelList(),t.prev=1,this.rootNode.getChildByName("Loading").active=!0,t.next=5,g.GetInstance().getSkinsByUserId(m.getInstance().getUserServerData().userId,"weaponAndEquipment");case 5:return e=t.sent,this.allEquipmentList=e,n=this.allEquipmentList.filter((function(t){return t.details.rarity===i.rarity})),this.setTopPorpItem(n[0]),this.setScrollViewUi(n),t.abrupt("return",e);case 13:t.prev=13,t.t0=t.catch(1),console.log("🚀 ~ TributeLayer ~ initList ~ error:",t.t0);case 16:return t.prev=16,this.rootNode.getChildByName("Loading").active=!1,t.finish(16);case 19:case"end":return t.stop()}}),t,this,[[1,13,16,19]])})));return function(){return t.apply(this,arguments)}}(),s.setPropBg=function(t,e){this.rarityList.forEach((function(n){t.getChildByPath(n+"bg").active=n===e}))},s.setScrollViewUi=function(t){var e=this;this.scrollViewSetData(this.scrollView,t,(function(n,i,r){e.setSpriteFrame2(n.getChildByPath("hero"),"prop/"+i.details.icon,null,y.bundles.icon),n.getChildByPath("level").getComponent(h).string=i.details.level,e.setSpriteFrame2(n.getChildByPath("icon"),"prop/"+i.details.rarity+"_z",null,y.bundles.icon),e.setPropBg(n,i.details.rarity),n.off(c.EventType.TOUCH_END),n.on(c.EventType.TOUCH_END,a(o().mark((function n(r){var a,s;return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!(e.selCharacter.length>=5)){n.next=2;break}return n.abrupt("return");case 2:if(!e.selCharacter.some((function(t){return t.id===i.id}))){n.next=4;break}return n.abrupt("return");case 4:return e.selCharacter.some((function(t){return t.details.id!==i.details.id}))&&(e.selCharacter=[]),n.next=7,e.renderAscendInfo(i.details.id);case 7:if(e.selCharacter.push(i),e.selCharacter.length<e.ascendInfoData.upgradeNeedNum)for(a=t.filter((function(t){return t.id!==i.id&&t.details.id===i.details.id})),s=0;s<e.ascendInfoData.upgradeNeedNum-1;s++)a.length>0&&a[s]&&e.selCharacter.push(a[s]);e.setTopPorpItem(e.selCharacter[0]),e.renderAscendSelList();case 11:case"end":return n.stop()}}),n)}))),e),n.getChildByPath("Mask").active=!1})),this.renderAscendSelList()},s.setTopPorpItem=function(t){t&&(this.setSpriteFrame2(this.propagationStopped.getChildByPath("PropItem_Tribute/hero"),"prop/"+t.details.icon,null,y.bundles.icon),this.setSpriteFrame2(this.propagationStopped.getChildByPath("PropItem_Tribute/icon"),"prop/"+t.details.rarity+"_z",null,y.bundles.icon),this.setPropBg(this.propagationStopped.getChildByPath("PropItem_Tribute"),t.details.rarity))},s.renderAscendSelList=function(){var t=this;this.ascendInfo.active=this.selCharacter.length>0;var e=this.propagationStopped.getChildByPath("btnList");e.removeAllChildren();for(var n=function(n){var i=d(t.ascendSel);i.active=!0,t.selCharacter[n]?(t.setSpriteFrame2(i.getChildByPath("character/hero"),"prop/"+t.selCharacter[n].details.icon,null,y.bundles.icon),t.setSpriteFrame2(i.getChildByPath("character/icon"),"prop/"+t.selCharacter[n].details.rarity+"_z",null,y.bundles.icon),t.setPropBg(i.getChildByPath("character"),t.selCharacter[n].details.rarity),i.getChildByPath("character").active=!0,i.getChildByPath("nocharacter").active=!1,i.on(c.EventType.TOUCH_END,(function(e){t.selCharacter.splice(n,1),t.setAscendNeedTip(),t.renderAscendSelList()}),t)):(i.getChildByPath("character").active=!1,i.getChildByPath("nocharacter").active=!0),e.addChild(i)},i=0;i<5;i++)n(i);this.scrollViewContent.children.forEach((function(e){e.getChildByPath("Mask").active=t.selCharacter.find((function(t){return t.id===e.item.id}))})),this.setAscendNeedTip()},s.renderAscendInfo=function(){var t=a(o().mark((function t(e){var n,i,r,a,s,l,c;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,g.GetInstance().levelUpCostSkin("equipment",e);case 3:(n=t.sent)?(this.succRate.string="Success Probability\nCurrent Success Rate: "+n.succRate+"%",this.ascendInfoData=n,i=this.ascendInfo.getChildByPath("ascend"),r=this.ascendInfo.getChildByPath("hp"),a=this.ascendInfo.getChildByPath("atk"),s=this.ascendInfo.getChildByPath("defense"),l=n.currentItem,c=n.nextItem,i.getChildByPath("from").getComponent(h).string=l.level,i.getChildByPath("to").getComponent(h).string=c.level,r.getChildByPath("from").getComponent(h).string=l.hpAdd,r.getChildByPath("to").getComponent(h).string=c.hpAdd,a.getChildByPath("from").getComponent(h).string=l.atkAdd,a.getChildByPath("to").getComponent(h).string=c.atkAdd,s.getChildByPath("from").getComponent(h).string=l.defenseAdd,s.getChildByPath("to").getComponent(h).string=c.defenseAdd):C.createNotice("Get data failed"),t.next=11;break;case 7:t.prev=7,t.t0=t.catch(0),console.log("🚀 ~ TributeLayer ~ renderAscendInfo ~ error:",t.t0),C.createNotice("Get data failed");case 11:case"end":return t.stop()}}),t,this,[[0,7]])})));return function(e){return t.apply(this,arguments)}}(),s.setAscendNeedTip=function(){var t,e,n,i;this.ascendNeed.getComponent(h).string=this.selCharacter.length+"/"+((null==(t=this.ascendInfoData)?void 0:t.upgradeNeedNum)||0),this.ascendNeedTip.active=this.selCharacter.length<(null==(e=this.ascendInfoData)?void 0:e.upgradeNeedNum),this.ascendBtn.getChildByPath("bg/canAscend").active=this.selCharacter.length>=(null==(n=this.ascendInfoData)?void 0:n.upgradeNeedNum),this.ascendBtn.getChildByPath("costNum").getComponent(h).string=null==(i=this.ascendInfoData)?void 0:i.mpCoinCost},s.onClickBtnSkin=function(){var t;this.selCharacter.length>=(null==(t=this.ascendInfoData)?void 0:t.upgradeNeedNum)&&(this.confirmBox.active=!0)},s.onBtnCloseConfirm=function(){this.confirmBox.active=!1},s.onBtnConfirm=function(){var t=a(o().mark((function t(){var e,n;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.selCharacter.map((function(t){return t.id})),t.prev=1,t.next=4,g.GetInstance().levelUpEquip(m.getInstance().getUserServerData().userId,e);case 4:(n=t.sent)?(this.confirmBox.active=!1,this.confirmMask.active=!0,this.selCharacter.length=0,this.renderConfirmMask(n),this.initList()):C.createNotice("Ascend failed"),t.next=12;break;case 8:t.prev=8,t.t0=t.catch(1),console.log("🚀 ~ TributeLayer ~ onBtnConfirm ~ error:",t.t0),C.createNotice("Ascend failed");case 12:case"end":return t.stop()}}),t,this,[[1,8]])})));return function(){return t.apply(this,arguments)}}(),s.renderConfirmMask=function(t){var e=this.confirmMask.getChildByPath("HPBox"),n=e.getChildByPath("hp"),i=e.getChildByPath("atk"),r=e.getChildByPath("defense"),a=e.getChildByPath("soul");n.getChildByPath("from").getComponent(h).string=""+this.ascendInfoData.currentItem.hpAdd,n.getChildByPath("to").getComponent(h).string="+ "+t.hpAdd,i.getChildByPath("from").getComponent(h).string=""+this.ascendInfoData.currentItem.atkAdd,i.getChildByPath("to").getComponent(h).string="+ "+t.atkAdd,r.getChildByPath("from").getComponent(h).string=""+this.ascendInfoData.currentItem.defenseAdd,r.getChildByPath("to").getComponent(h).string="+ "+t.defenseAdd,a.getChildByPath("from").getComponent(h).string=this.ascendInfoData.currentItem.soulDropRateAdd+"%",a.getChildByPath("to").getComponent(h).string="+ "+t.soulDropRateAdd+"%",this.setSpriteFrame2(this.confirmMask.getChildByPath("PropItem_Tribute/hero"),"prop/"+t.icon,null,y.bundles.icon),this.setSpriteFrame2(this.confirmMask.getChildByPath("PropItem_Tribute/icon"),"prop/"+t.rarity+"_z",null,y.bundles.icon),this.setPropBg(this.confirmMask.getChildByPath("PropItem_Tribute"),t.rarity)},e}(p)).prototype,"GrayMask",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),R=e(_.prototype,"propagationStopped",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),F=e(_.prototype,"btnBack",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),V=e(_.prototype,"Mask",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),G=e(_.prototype,"scrollView",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),H=e(_.prototype,"scrollViewContent",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),O=e(_.prototype,"confirmBox",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),q=e(_.prototype,"confirmMask",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),j=e(_.prototype,"ascendSel",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),J=e(_.prototype,"ascendInfo",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),X=e(_.prototype,"ascendNeed",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),K=e(_.prototype,"ascendNeedTip",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Q=e(_.prototype,"ascendBtn",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),W=e(_.prototype,"succRate",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Y=e(_.prototype,"buttons",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),z=_))||z));s._RF.pop()}}}));

System.register("chunks:///_virtual/Tutorial.ts",["./rollupPluginModLoBabelHelpers.js","cc","./BaseUILayer.ts","./eventManager.ts","./msgac.ts"],(function(t){var e,n,i,o,r,s,a,c,u,l;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,i=t.initializerDefineProperty,o=t.assertThisInitialized},function(t){r=t.cclegacy,s=t._decorator,a=t.Node},function(t){c=t.BaseUILayer},function(t){u=t.eventManager},function(t){l=t.msgac}],execute:function(){var p,f,y,h,d,v,g;r._RF.push({},"14058nn8H5GDas/2+JRMjXJ","Tutorial",void 0);var k=s.ccclass,m=s.property;t("Tutorial",(p=k("Tutorial"),f=m({type:[a]}),y=m({type:a}),p((v=e((d=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return e=t.call.apply(t,[this].concat(r))||this,i(e,"steps",v,o(e)),i(e,"skipBtn",g,o(e)),e.rootNode=void 0,e}n(e,t);var r=e.prototype;return r.onDestroy=function(){t.prototype.onDestroy.call(this)},r.onLoad=function(){this.rootNode=this.node},r.start=function(){this.setShowTutorialIndex(null,0)},r.setShowTutorialIndex=function(t,e){if(e<0)this.onClickBtnSkip();else for(var n=0;n<this.steps.length-1;n++)this.steps[n].active=n==e},r.update=function(t){},r.onClickBtnSkip=function(){u.send(l.mapGameResume),this.closeLayer()},r.onClickBtnVerify=function(){},e}(c)).prototype,"steps",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),g=e(d.prototype,"skipBtn",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),h=d))||h));r._RF.pop()}}}));

System.register("chunks:///_virtual/tyqAdManager.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(n){var t,e;return{setters:[function(n){t=n.createClass},function(n){e=n.cclegacy}],execute:function(){e._RF.push({},"5016fHIeplPW6XZXXcWsDos","tyqAdManager",void 0);var i=n("Channel",function(n){return n[n.DEFAULT=0]="DEFAULT",n[n.WECHAT=1]="WECHAT",n[n.ANDROID=2]="ANDROID",n[n.IOS=3]="IOS",n[n.ANDROID_233=4]="ANDROID_233",n[n.ANDROID_4399=5]="ANDROID_4399",n[n.H5_4399=6]="H5_4399",n[n.VIVO_MINI_GAME=7]="VIVO_MINI_GAME",n[n.OPPO_MINI_GAME=8]="OPPO_MINI_GAME",n}({})),c=function(){function n(){this.channel=i.DEFAULT,this.customAdSizeObj={rect:{width:360,height:506},horizontal:{width:288,height:90},vertical:{width:62,height:388},grid:{width:68,height:102}},this.videoCallBack=function(){},this.videoCallBackFail=function(){},this.channel=i.DEFAULT,this.channel=i.OPPO_MINI_GAME}return n.prototype.getChannel=function(){return this.channel},t(n,null,[{key:"instance",get:function(){return this._instance||(this._instance=new n),this._instance}}]),n}();c._instance=void 0;n("tyqAdManager",c.instance);e._RF.pop()}}}));

System.register("chunks:///_virtual/TyqBaseLayer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./tyqSDK.ts","./tyqLayerManager.ts"],(function(t){var n,e,o,a,i,r,s,c,u;return{setters:[function(t){n=t.inheritsLoose},function(t){e=t.cclegacy,o=t.find,a=t.Button,i=t.Label,r=t.RichText,s=t.Component},function(t){c=t.tyqSDK},function(t){u=t.tyqLayerManager}],execute:function(){e._RF.push({},"a66efz9BgNL7Z/VjLWB3zxY","TyqBaseLayer",void 0);t("TyqBaseLayer",function(t){function e(){for(var n,e=arguments.length,o=new Array(e),a=0;a<e;a++)o[a]=arguments[a];return(n=t.call.apply(t,[this].concat(o))||this).obj={},n.cb=void 0,n.layerName="DefaultLayer",n.pathNodeObj=new Map,n}n(e,t);var s=e.prototype;return s.onLoad=function(){this.addButtonListener(this.node),this.addPathNode(this.node,"")},s.addPathNode=function(t,n){t!=this.node&&this.pathNodeObj.set(n,t),n&&(n+="/");for(var e=t.children,o=0,a=e.length;o<a;o++){var i=e[o];this.addPathNode(i,n+i.name)}},s.getNodeByPath=function(t){var n=this.pathNodeObj.get(t);return n||((n=o(t,this.node))?(this.pathNodeObj.set(t,n),n):null)},s.addButtonListener=function(t){t.getComponent(a)&&t.on("click",this.preOnButtonClick,this);for(var n=t.children,e=0,o=n.length;e<o;e++){var i=n[e];this.addButtonListener(i)}},s.preOnButtonClick=function(t){var n=t.node,e=n.name;c.log(this.layerName+" onButtonClick "+e),this.onButtonClick(n,n.name)},s.onButtonClick=function(t,n){},s.openLayer=function(t,n,e){u.openLayer(t,n,e)},s.closeLayer=function(){u.closeLayer(this)},s.setString=function(t,n){n+="";var e=t.getComponent(i);if(e)e.string=n;else{var o=t.getComponent(r);o&&(o.string=n)}},e}(s));e._RF.pop()}}}));

System.register("chunks:///_virtual/tyqConstants.ts",["cc"],(function(t){var e;return{setters:[function(t){e=t.cclegacy}],execute:function(){e._RF.push({},"cd600cwJNFD5JPQRITwJnyg","tyqConstants",void 0);t("tyqConstants",{paths:{layer:"layer/"},bundles:{tyqSDKBundle:"tyqSDKBundle"},layers:{TyqMoreGameLayer:"TyqMoreGameLayer"}});e._RF.pop()}}}));

System.register("chunks:///_virtual/tyqLayerManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./tyqSDK.ts","./tyqConstants.ts","./tyqResManager.ts"],(function(n){var e,t,a,r,s,o,i,c,u;return{setters:[function(n){e=n.createClass},function(n){t=n.cclegacy,a=n.Prefab,r=n.instantiate,s=n.UITransform,o=n.find},function(n){i=n.tyqSDK},function(n){c=n.tyqConstants},function(n){u=n.tyqResManager}],execute:function(){t._RF.push({},"f9b90DrhuNGUIR8MI8kci08","tyqLayerManager",void 0);var y=function(){function n(){}var t=n.prototype;return t.openLayer=function(n,e,t){var y=c.paths.layer+n;u.loadAsset(c.bundles.tyqSDKBundle,y,a,null,(function(a,c){if(a)i.log("LayerManager.openLayer error:"+a.message,n,a);else{var u=r(c),y=u.addComponent(n);y.obj=e,y.cb=t,y.layerName=n,u.getComponent(s).priority=999,u.parent=o("Canvas"),i.log("openLayer "+n,e)}}))},t.closeLayer=function(n){n.layerName;n.node.destroy()},e(n,null,[{key:"instance",get:function(){return null==this._instance&&(this._instance=new n),this._instance}}]),n}();y._instance=void 0;n("tyqLayerManager",y.instance);t._RF.pop()}}}));

System.register("chunks:///_virtual/tyqResManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./tyqSDK.ts"],(function(n){var e,t,s,a;return{setters:[function(n){e=n.createClass},function(n){t=n.cclegacy,s=n.assetManager},function(n){a=n.tyqSDK}],execute:function(){t._RF.push({},"fa238FBPppPF5f/CBCqj0Uj","tyqResManager",void 0);var i=function(){function n(){}return n.prototype.loadAsset=function(n,e,t,i,u){var o=s.getBundle(n);if(o&&o.get(e,t))u&&u(null,o.get(e,t));else{var r=function(){o.load(e,t,(function(n,e){i&&i(n,e)}),(function(t,s){if(t)return a.log("ResManager.loadAsset error:"+t.message,n,e,t),void(u&&u(t));u&&u(null,s)}))};o?r():s.loadBundle(n,(function(n,e){n?u&&u(n):(o=e,r())}))}},e(n,null,[{key:"instance",get:function(){return null==this._instance&&(this._instance=new n),this._instance}}]),n}();i._instance=void 0;n("tyqResManager",i.instance);t._RF.pop()}}}));

System.register("chunks:///_virtual/tyqSDK.ts",["cc","./conf.ts","./tyqAdManager.ts","./tyqSDKConfig.ts","./weNetworkMgr.ts"],(function(t){var e,i,n,o,r,s,a;return{setters:[function(t){e=t.cclegacy,i=t.sys},function(t){n=t.GNetConf},function(t){o=t.tyqAdManager,r=t.Channel},function(t){s=t.tyqSDKConfig},function(t){a=t.NetworkMgr}],execute:function(){var h;e._RF.push({},"83a26NRnL5AdYsLDFN660As","tyqSDK",void 0);var l=t("ChannelFlag",function(t){return t[t.WECHAT_MRTGD=1]="WECHAT_MRTGD",t[t.WECHAT_JJWS=2]="WECHAT_JJWS",t}({})),c=function(){function t(){this.switch_info={},this.master_switch=0,this.openid="",this._playTime=0,this._gameLevel=0,this.item_openId="tyq_item_openid",this.item_watermark="tyq_item_watermark_",this._watermark="",this._onlineTime=0,this.weixin_ads_data=null,this.wxGameIconData=[],this.levelCount=0,this.timeDiff=0,this.channel=void 0,this.shareTime=void 0,this.shareCallback=void 0}var e=t.prototype;return e.getUrl=function(){return this.channel==l.WECHAT_MRTGD?{httpUrl:n.mrtgd_HttpUrl,wsUrl:n.mrtgd_WsUrl}:this.channel==l.WECHAT_JJWS?{httpUrl:n.mrtgd_jjws_HttpUrl,wsUrl:n.mrtgd_jjws_WsUrl}:void 0},e.share=function(t,e){o.getChannel()==r.WECHAT&&(this.shareTime=new Date,this.shareCallback=e,wx.shareAppMessage({query:t}))},e.getSwitchValue=function(t,e){return 0==this.master_switch?0:this.switch_info[t]?"0"==this.switch_info[t]?0:this.switch_info[t]:(this.log(t+"开关不存在"),e||0)},e.collectPlayeTime=function(){if(this.openid){var t=this.getTimeStamp()-this._onlineTime;this.log("上传停留",t);var e={duration_time:t};this.httpPost("api/v1/collect_open_game_play_time",e)}else this.error("没有openid")},e.httpPost=function(t,e,i,n){var o=this;e||(e={}),e.appid=s.appId,e.nonce_str=this.randomStr(),e.time_stamp=this.getTimeStamp(!0)+this.timeDiff,e.app_version=s.appVersion,e.openid=this.openid,e.watermark=this._watermark,this.log("请求",t,e),a.xhrPost(t,e,(function(e){o.log("请求返回",t,e),i&&i(e)}),(function(){n&&n()}))},e.randomStr=function(t){void 0===t&&(t=32);for(var e=t,i="ABCDEFGHJKMNPQRSTWXYZabcdefhijkmnprstwxyz2345678",n=i.length,o="",r=0;r<e;r++)o+=i.charAt(Math.floor(Math.random()*n));return o},e.getTimeStamp=function(t){void 0===t&&(t=!1);var e=Date.now();return t&&(e=Math.floor(e/1e3)),e},e.initOpenId=function(){var t=i.localStorage.getItem(this.item_openId);return t||(t=this.randOpenId(),i.localStorage.setItem(this.item_openId,t),this.log("注册："+t)),this.log("openid=",t),t},e.randOpenId=function(){for(var t=[],e="0123456789abcdef",i=0;i<40;i++)t[i]=e.substr(Math.floor(16*Math.random()),1);return t[14]="4",t[19]=e.substr(3&t[19]|8,1),t[8]=t[13]=t[18]=t[23]=t[28]="-",t.join("")},e.eventSendCustomEvent=function(t,e){if(this.openid){var i=e?t+"-"+e:t;this.log("%cevent:"+i,"color:#FF0000");var n={event_id:i};this.httpPost("api/v1/collect_click_event",n)}else this.error("没有openid")},e.collectLevelInfo=function(t){if(this.openid){var e=this.getTimeStamp(!1),i=0;1==t?this._playTime=e:(i=e-this._playTime,this._playTime=0);var n={game_level:this._gameLevel,status:t,play_time:i};this.httpPost("api/v1/collect_user_play_game_level",n)}else this.error("没有openid")},e.setLogOpen=function(t){s.isLogOpen=t},e.log=function(t){if(s.isLogOpen){for(var e=arguments.length,i=new Array(e>1?e-1:0),n=1;n<e;n++)i[n-1]=arguments[n];var o,r;if("string"==typeof t)(o=console).log.apply(o,["[TyqSDK]"+t].concat(i));else(r=console).log.apply(r,["[TyqSDK]",t].concat(i))}},e.error=function(t){var e;if(s.isLogOpen){for(var i=arguments.length,n=new Array(i>1?i-1:0),o=1;o<i;o++)n[o-1]=arguments[o];(e=console).error.apply(e,["[TyqSDK]"+t].concat(n))}},t}();h=c,c.instance=new h;t("tyqSDK",c.instance);e._RF.pop()}}}));

System.register("chunks:///_virtual/tyqSDKConfig.ts",["cc"],(function(t){var e;return{setters:[function(t){e=t.cclegacy}],execute:function(){e._RF.push({},"a09daxOR+NG0KJMyaVfvvK+","tyqSDKConfig",void 0);t("tyqSDKConfig",{gameName:"末日特工队",gameVersion:"1.0.0",appVersion:1,appId:"",apiKey:"",AppSecret:"1",server:"https://api.game.xmtyq.com/china_app_game_sdk/",isLogOpen:!1,isCloseAd:!0,isOpenBeHavior:!1,paramsKeys:{tyq_ad_banners:"tyq_ad_banners",tyq_ad_interstitial:"tyq_ad_interstitial",tyq_ad_custom_rect:"tyq_ad_custom_rect",tyq_ad_custom_v:"tyq_ad_custom_v",tyq_ad_custom_h:"tyq_ad_custom_h",tyq_ad_rewarded:"tyq_ad_rewarded",tyq_banner_turns:"tyq_banner_turns",tyq_custom_h_switch:"tyq_custom_h_switch",tyq_custom_v_switch:"tyq_custom_v_switch",tyq_show_main_layer:"tyq_show_main_layer",tyq_level_count:"tyq_level_count",tyq_reward_level:"tyq_reward_level",tyq_banner_touch:"tyq_banner_touch",tyq_more_game_level:"tyq_more_game_level",tyq_ad_custom_rect_switch:"tyq_ad_custom_rect_switch"},adShowTypes:{rewardedAd:"激励视频广告点击",interstitialAd:"插屏广告点击",bannerAndCustomAd:"banner与原生广告点击"},eventNames:{enterLoadingLayer:"进入加载页",enterHomeLayer:"进入主界面",rewardedAdStart:"观看激励视频-",rewardedAdSuccess:"观看完激励视频-"}});e._RF.pop()}}}));

System.register("chunks:///_virtual/UserData.ts",["./rollupPluginModLoBabelHelpers.js","cc","./myLog.ts","./CronCtr.ts","./ServerCtr.ts","./cocosUtil.ts","./constants.ts","./msgac.ts","./audioManager.ts","./designManager.ts","./eventManager.ts","./RedPointLogicMgr.ts","./playerModel.ts","./BaseLayer.ts"],(function(e){var t,r,a,n,i,o,s,u,h,p,c,d,l,f,m,g,v,w,$,y,D,I,P,k,R;return{setters:[function(e){t=e.inheritsLoose,r=e.createClass,a=e.asyncToGenerator,n=e.regeneratorRuntime},function(e){i=e.cclegacy,o=e.instantiate,s=e.tween,u=e.v3,h=e.game,p=e.Game,c=e.js,d=e.sys},function(e){l=e.myLog},function(e){f=e.default},function(e){m=e.default},function(e){g=e.cocosUtil},function(e){v=e.constants},function(e){w=e.msgac},function(e){$=e.audioManager},function(e){y=e.designManager},function(e){D=e.eventManager},function(e){I=e.RedPointLogicMgr,P=e.RPointMask},function(e){k=e.playerModel},function(e){R=e.BaseLayer}],execute:function(){i._RF.push({},"0f1be+8a5tBc613pNYA6Pnr","UserData",void 0);var _=e("UserData",function(e){function i(){for(var t,r=arguments.length,a=new Array(r),n=0;n<r;n++)a[n]=arguments[n];return(t=e.call.apply(e,[this].concat(a))||this).$localKey="UserData",t.$time=null,t.$roleLv=1,t.$roleExp=1,t._maxPower=30,t._powerRevoverTime=60,t.$powerTime=0,t.$power=30,t.$baoShi=0,t.$coin=0,t.$optStone=0,t.$dayAct=0,t.$mapHand=0,t._attack=0,t._life=0,t._defense=10,t._gameKey="00000000000000",t.$curMap=1,t.$openLevel=1,t.$levelData=[],t.$mapData=void 0,t.$propData=[{id:301,num:0,iswear:0},{id:2002,num:1,iswear:0},{id:2003,num:1,iswear:0},{id:2004,num:1,iswear:0},{id:2005,num:1,iswear:0},{id:2006,num:1,iswear:0},{id:2007,num:1,iswear:0},{id:2008,num:1,iswear:0}],t.$wearProp=[0,0,0,0,0,0],t.$playerData={},t.$patrolStartTime=0,t.$patrolRewardProp=[],t.$patrolRewardPropArr=[],t.$heroSkin=2001,t.$drawNormalNum=0,t.$drawGradeNum=0,t.$pyramidState=[0,0,0,0,0,0,0,0,0,0],t.$pyramidDrawTime=0,t.$friendPassCnt=0,t.$videoCalCnt=0,t.$freeDraw=0,t.userRuntimeData=null,t.userServerData=null,t.userWeb3Data=null,t.UserAddress=null,t._isShowOpenLevel=!1,t._drawAllWeight=[0,0,0],t._drawAllSureWeight=[0,0,0],t}t(i,e),i.getInstance=function(){return null!=this._instance||this._isInitializing||(this._isInitializing=!0,this._instance=new i),this._instance};var R=i.prototype;return R.getWeaponLv=function(){return 1},R.getUserSkinRes=function(e){var t="",r="",a="";switch(e){case"Fire":a="cBG01",r="js_tb01",t="Characters1";break;case"Water":a="cBG02",r="js_tb02",t="Characters2";break;case"Earth":a="cBG03",r="js_tb03",t="Characters3";break;case"Light":a="cBG04",r="js_tb04",t="Characters4";break;case"Wind":a="cBG05",r="js_tb05",t="Characters5";break;case"Dark":a="cBG06",r="js_tb06",t="Characters6";break;case"Lightning":a="cBG07",r="js_tb07",t="Characters7"}return{bgIconSmall:t,headIcon:r,bgIconBig:a}},R.setUserServerData=function(e){this.userServerData=e,this.userRuntimeData=e,this.heroSkin=null==e?void 0:e.skinWear,D.send(w.commonResRefresh)},R.getUserServerData=function(){return this.userServerData},R.setUserWeb3Data=function(e){this.userWeb3Data=e},R.getUserWeb3Data=function(){return this.userWeb3Data},R.setUserAddress=function(e){this.UserAddress=e},R.getUserAddress=function(){return this.UserAddress},R.setUserRuntimeData=function(e){this.userRuntimeData=e,D.send(w.commonResRefresh)},R.getUserRuntimeData=function(){return this.userRuntimeData},R.syncUser2Runtime=function(){this.setUserRuntimeData(this.userServerData)},R.updateUserData=function(){var e=a(n().mark((function e(){var t;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.GetInstance().fetchUserServerData();case 2:t=e.sent,console.log("🚀 ~ UserData ~ updateUserData ~ userServerData:",t),t&&this.setUserServerData(t);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),R.onInit=function(){var e=a(n().mark((function e(){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.loadServerData(m.GetInstance().serverData),this.initEvent(),this.setBaseConfig();case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),R.setBaseConfig=function(){this._maxPower=y.config.energyMax,this._powerRevoverTime=y.config.energyRecoverTime,this.updateRoleAtkHp()},R.getHeroSkin=function(){var e,t=null==(e=this.getUserServerData().skinDetails)?void 0:e.icon;return t?this.trimHeroSkin(t):"skin1"},R.trimHeroSkin=function(e){return e.replace(/^skin_hero(\d+)$/,"skin$1")},R.isHaveProp=function(e){if("number"==typeof e){for(var t=0;t<this.$propData.length;t++)if(this.$propData[t].id==e&&this.$propData[t].num>0)return!0}else{for(var r=0,a=0;a<e.length;a++)for(var n=0;n<this.$propData.length;n++)this.$propData[n].id==e[a]&&this.$propData[n].num>0&&r++;if(r>=e.length)return!0}return!1},R.checkPowerTime=function(){if(this.$power<this._maxPower)if(0==this.$powerTime)this.$powerTime=(new Date).getTime();else{var e=(new Date).getTime()-this.$powerTime,t=Math.floor(e/1e3/this._powerRevoverTime);t>0&&(this.$power+=t,this.$power=Math.min(this._maxPower,Math.max(0,this.$power)),this.$powerTime=this.$powerTime+t*this._powerRevoverTime*1e3)}else this.$powerTime=0},R.getCountTime=function(){return this.$power<this._maxPower?Math.max(0,Math.min(this._powerRevoverTime,this._powerRevoverTime-((new Date).getTime()-this.$powerTime)/1e3)):0},R.usePower=function(e){this.$power+=e,this.$power=Math.min(this._maxPower,Math.max(0,this.$power)),this.checkPowerTime()},R.useOptStone=function(e){this.$optStone+=e,this.$optStone=Math.max(0,this.$optStone),m.GetInstance().addDataVersion()},R.useDayAct=function(e){this.$dayAct+=e,this.$dayAct=Math.max(0,this.$dayAct),m.GetInstance().addDataVersion()},R.useEnergy=function(e){k.energyObj.num+=e,k.energyObj.num=Math.max(0,k.energyObj.num),m.GetInstance().addDataVersion()},R.useCoin=function(e,t){void 0===t&&(t=!1),this.$coin+=e,this.$coin=Math.max(0,this.$coin),t&&D.send(w.commonResRefresh),m.GetInstance().addDataVersion()},R.cheackAndUseCoin=function(e,t){return void 0===t&&(t=!1),this.$coin>=e&&(this.useCoin(0-e,t),!0)},R.addExp=function(e){this.$roleExp+=e;for(var t=y.getTable(v.tableName.heroLevel),r=this.roleLv+1;r<t.length;r++){var a=t[r-1];if(!(this.$roleExp>=a.exp))return;this.$roleLv=r,this.updateRoleAtkHp()}m.GetInstance().addDataVersion()},R.updateRoleAtkBeforeFight=function(){var e=a(n().mark((function e(){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return 80,80,this._attack+=80,this._life+=80,e.abrupt("return",{atk:this._attack,hp:this._life});case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),R.updateRoleAtkHp=function(){var e=y.getRowById(v.tableName.heroLevel,this.$roleLv);this._attack=e.atk,this._life=e.hp;for(var t=0;t<this.$wearProp.length;t++)if(this.$wearProp[t]>0){var r=y.getRowById(v.tableName.prop,this.$wearProp[t]);r&&r.atk&&(this._attack+=r.atk),r&&r.hp&&(this._life+=r.hp)}var a=this.getSuitPercentAdd();this._attack*=1+a.atk,this._life*=1+a.hp,this._attack=Math.floor(this._attack),this._life=Math.floor(this._life)},R.getSuitPercentAdd=function(){var e=this.getSuitId(),t=0,r=0;if(0!=e){var a=e[0],n=e[1],i=y.getRowById(v.tableName.suit,a);n>=5?(t=i.effectAtk_5,r=i.effectHP_5):n>=3&&(t=i.effectAtk_3,r=i.effectHP_3)}return{atk:t/100,hp:r/100}},R.weaponOptLvEffect=function(e,t){var r=y.getRowById(v.tableName.weaponOpt,t);return r&&(e*=1+r.atk/100,e=Math.ceil(e)),e},R.getNextLevelExp=function(){var e=y.getRowById(v.tableName.heroLevel,this.$roleLv+1);return e?e.exp:this.$roleExp},R.setCurMap=function(e){this.$curMap=e,m.GetInstance().addDataVersion()},R.getCurMap=function(){return this.$curMap},R.setWearProp=function(e){if(e){if(this.$wearProp[e.wearIndex-1]==e.id)return;0==this.$wearProp[e.wearIndex-1]?(this.$wearProp[e.wearIndex-1]=e.id,this.setPropWearById(e.id,1)):(this.setPropWearById(this.$wearProp[e.wearIndex-1],0),this.$wearProp[e.wearIndex-1]=e.id,this.setPropWearById(e.id,1)),I.ins().sendValueSettingMsg(P.RPM_PropWear,!1),this.updateRoleAtkHp()}},R.unWearProp=function(e){e&&this.$wearProp[e.wearIndex-1]==e.id&&(this.$wearProp[e.wearIndex-1]=0,this.setPropWearById(e.id,0),this.updateRoleAtkHp(),I.ins().sendValueSettingMsg(P.RPM_PropWear,!1),m.GetInstance().addDataVersion())},R.autoWearProp=function(e){e&&(this.$wearProp[e.wearIndex-1]==e.id?(this.$wearProp[e.wearIndex-1]=0,this.setPropWearById(e.id,0)):(this.$wearProp[e.wearIndex-1]=e.id,this.setPropWearById(e.id,1)),this.updateRoleAtkHp(),I.ins().sendValueSettingMsg(P.RPM_PropWear,!1),m.GetInstance().addDataVersion())},R.checkWearProp=function(e){return!!e&&this.$wearProp[e.wearIndex-1]==e.id},R.checkThisPropBestToWear=function(e){var t=y.getRowById(v.tableName.prop,e);if(t.wearIndex>0){if(0==this.$wearProp[t.wearIndex-1]){for(var r=0;r<this.$propData.length;r++){var a=y.getRowById(v.tableName.prop,this.$propData[r].id);if(a.wearIndex==t.wearIndex&&t.quality<a.quality)return!1}return!0}if(y.getRowById(v.tableName.prop,this.$wearProp[t.wearIndex-1]).quality<t.quality){for(var n=0;n<this.$propData.length;n++){var i=y.getRowById(v.tableName.prop,this.$propData[n].id);if(i.wearIndex==t.wearIndex&&t.quality<i.quality)return!1}return!0}}return!1},R.checkBestPropToWear=function(){for(var e=0;e<this.$propData.length;e++){var t=this.$propData[e],r=y.getRowById(v.tableName.prop,t.id);if(r.wearIndex>0){if(0==this.$wearProp[r.wearIndex-1])return!0;if(y.getRowById(v.tableName.prop,this.$wearProp[r.wearIndex-1]).quality<r.quality)return!0}}return!1},R.setPropById=function(e,t){for(var r=0;r<this.$propData.length;r++){var a=this.$propData[r];if(a.id==e)return void(a.num+=t)}this.$propData.push({id:e,num:t,iswear:0}),m.GetInstance().addDataVersion()},R.blessProp=function(e,t,r){this.setPropById(t,1),this.setPropById(e,r),I.ins().sendValueSettingMsg(P.RPM_BlessProp,!1);for(var a=0;a<this.$wearProp.length;a++)this.$wearProp[a]==e&&(this.$wearProp[a]=t,this.setPropWearById(t,1),this.setPropWearById(e,0),this.updateRoleAtkHp());D.send(w.updateDropData),m.GetInstance().addDataVersion()},R.checkChapterCanReward=function(){for(var e=i.getInstance().getLevelData(i.getInstance().getCurMap()),t=0;t<3;t++)if(e.Time>=60*(5*t+5)&&0==e.ReceiveState[t])return!0;return!1},R.setPropWearById=function(e,t){for(var r=0;r<this.$propData.length;r++){var a=this.$propData[r];if(a.id==e)return void(a.iswear=t)}m.GetInstance().addDataVersion()},R.setLevelData=function(e){if(y.getRowById(v.tableName.map,e.Level).type==v.mapTypes.main){var t=e.Level-1;if(t<0&&(t=0),null==this.$levelData[t]?this.$levelData[t]=e:e.Time>this.$levelData[t].Time&&(this.$levelData[t].Time=e.Time),this.$levelData[t].Time>=900&&this.$openLevel<=e.Level){var r=this.$openLevel+1;y.getRowById(v.tableName.map,r)&&(this.$openLevel++,this.$curMap=this.$openLevel,this._isShowOpenLevel=!0),m.GetInstance().addDataVersion()}}},R.getLevelData=function(e){var t=e-1;if(t<0&&(t=0),this.$levelData[t])return this.$levelData[t];var r={Level:e,Time:0,ReceiveState:[0,0,0]};return i.getInstance().setLevelData(r),r},R.getPropSort=function(){var e=[];for(var t in this.$propData){var r=this.$propData[t],a=y.getRowById(v.tableName.prop,r.id);8!=a.type&&11!=a.type||e.push(r)}return e.sort((function(e,t){var r=y.getRowById(v.tableName.prop,e.id),a=y.getRowById(v.tableName.prop,t.id);return r.wearIndex-a.wearIndex})),e},R.getPropById=function(e){for(var t=0;t<this.$propData.length;t++){var r=this.$propData[t];if(r.id==e)return r.num}return 0},R.getSuitId=function(){for(var e=[],t=0;t<this.$wearProp.length;t++){var r=this.$wearProp[t];if(r>0){var a=y.getRowById(v.tableName.prop,r);e[a.suit_id]||(e[a.suit_id]=0),e[a.suit_id]++}}for(var n=0;n<e.length;n++)if(e[n]>=3)return[n,e[n]];return 0},R.getSuitNum=function(e){for(var t=e.suit_id,r=0,a=0;a<this.$wearProp.length;a++){var n=this.$wearProp[a];if(n>0)y.getRowById(v.tableName.prop,n).suit_id==t&&r++}return r},R.tobePropItem=function(e){for(var t=[],r=0;r<e.length;r++){var a={Id:e[r][0],Num:e[r][1]};t.push(a)}return t},R.getPropNumById=function(e){var t=0;switch(y.getRowById(v.tableName.prop,e).type){case 1:t=this.$coin;break;case 9:t=this.$baoShi;break;case 10:t=this.$roleExp;break;case 12:t=this.$power;break;case 14:t=this.$optStone;break;case 15:t=this.$dayAct;break;default:for(var r in this.$propData){var a=this.$propData[r];if(a.id==e){t=a.num;break}}}return t},R.addPropNum=function(e,t){var r={Id:e,Num:t};return this.getRewardProp([r]),r},R.addPropByDesign=function(e){return this.addPropNum(e[0],e[1])},R.addPropArrByDesign=function(e){var t=[];for(var r in e){var a=e[r],n={Id:a[0],Num:a[1]};t.push(n)}return this.getRewardProp(t),t},R.getRewardProp=function(e,t){void 0===t&&(t=1);for(var r=0;r<e.length;r++){var a=e[r],n=y.getRowById(v.tableName.prop,a.Id);n?1==n.type?this.useCoin(a.Num*t):10==n.type?this.addExp(a.Num*t):8==n.type||11==n.type?(this.setPropById(a.Id,a.Num*t),I.ins().sendValueSettingMsg(P.RPM_PropWear,!1),I.ins().sendValueSettingMsg(P.RPM_BlessProp,!1)):9==n.type||(12==n.type?this.usePower(a.Num*t):14==n.type?this.useOptStone(a.Num*t):15==n.type?this.useDayAct(a.Num*t):16==n.type?this.useEnergy(a.Num*t):this.setPropById(a.Id,a.Num*t)):l.e("prop is not in design",n)}D.send(w.commonResRefresh),this.saveData()},R.checkUseProp=function(e){var t=y.getRowById(v.tableName.prop,e.Id);if(t)return 1==t.type?this.$coin>=e.Num&&(this.useCoin(0-e.Num),!0):9==t.type?this.$baoShi>=e.Num:14==t.type?this.$optStone>=e.Num&&(this.useOptStone(0-e.Num),!0):void 0;l.e("prop is not in design",t)},R.showGetAnimal=function(e,t,r,a){for(var n=g.getCircleDirectionArr(10,100),i=0;i<10;i++){var h=o(t);e.addChild(h),h.layer=e.layer,s(h).set({positon:u(r[0],r[1],0)}).to(.2,{positon:u(n[i].x,n[i].y,0)}).to(.5,{positon:u(a[0],a[1],0)}).start(),g.drawCurvePath(h,[n[i].x,n[i].y],[a[0],a[1]],.2+.2*Math.random(),30,.1+.05*i)}},R.stringToArr=function(e){var t=e.indexOf("["),r=e.indexOf("]");return e.substring(t+1,r).split(",")},R.initEvent=function(){var e=this;h.on(p.EVENT_HIDE,(function(){e.resetAccount||(e.$time=Date.now(),e.saveData(),f.getInstance().uploadAllRecord(e.getLocalData()))})),h.on(p.EVENT_SHOW,(function(){$.gameOnShow()}))},R.saveData=function(){D.send(w.saveDataBefore);var e=c.createMap(!0);for(var t in this)-1!=t.indexOf("$")&&(e[t]=this[t]);d.localStorage.setItem(this.$localKey,JSON.stringify(e)),m.GetInstance().addDataVersion(),D.send(w.saveDataAfter)},R.getLocalData=function(){var e=c.createMap(!0);for(var t in this)-1!=t.indexOf("$")&&(e[t]=this[t]);return{userData:JSON.stringify(e),version:m.GetInstance().dataVersion,friendPassCnt:this.$friendPassCnt,videoCalCnt:this.$videoCalCnt}},R.loadServerData=function(e){console.log("---------各种问题---",e),m.GetInstance().dataVersion=e.version;var t=e.userData;t&&c.mixin(this,JSON.parse(t)),d.localStorage.setItem(this.$localKey,JSON.stringify(t))},R.remove=function(){d.localStorage.removeItem(this.$localKey),this.onInit(),D.send(w.commonResRefresh)},R.clearAccountData=function(){m.GetInstance().addDataVersion(),f.getInstance().uploadAllRecord({version:m.GetInstance().dataVersion+1}),d.localStorage.removeItem("dataVersion"),this.resetAccount=!0},R.getDrawItem=function(e){var t=this,r=2;0==e?(this.$drawNormalNum++,r=2):(this.$drawGradeNum++,r=1);var a=!1;2==r?this.$drawNormalNum>=y.config.extra2&&(a=!0,this.$drawNormalNum=0):this.$drawGradeNum>=y.config.extra1&&(a=!0,this.$drawGradeNum=0);var n=y.getRowsByType(v.tableName.draw,r);(Number.isNaN(this._drawAllWeight[r])||this._drawAllWeight[r]<=0)&&(this._drawAllSureWeight[r]=0,n.forEach((function(e){r==e.type&&(t._drawAllWeight[r]+=e.weight,""!=e.extra&&(t._drawAllSureWeight[r]+=parseInt(e.extra)))})));var i=null;if(a)for(var o=Math.floor(Math.random()*this._drawAllSureWeight[r]),s=0;s<n.length;s++){var u=n[s];if(r==u.type&&u.extra&&(o-=u.extra)<=0){i=u;break}}else for(var h=Math.floor(Math.random()*this._drawAllWeight[r]),p=0;p<n.length;p++){var c=n[p];if(r==c.type&&(h-=c.weight)<=0){i=c;break}}return null==i&&console.log("item null 没抽中 "),i},R.getCurPatrolData=function(){if(this.$patrolStartTime<=0)this.$patrolStartTime=(new Date).getTime();else{var e=(new Date).getTime(),t=this.getPatrolReward();this.$patrolStartTime=e,this.$patrolRewardPropArr=[],this.$patrolRewardProp=[],this.getRewardProp(t)}},R.getPatrolTime=function(){var e=(new Date).getTime();return Math.min(60*y.config.towerTop,Math.floor((e-this.$patrolStartTime)/1e3))},R.getPatrolReward=function(){var e=this.getPatrolTime(),t=Math.floor(e*y.config.towerExp/60),r=Math.floor(e*y.config.towerCoin/60),a=[];a.push({Id:101,Num:r}),a.push({Id:901,Num:t});for(var n=y.config.towerItem,i=Math.floor(e/600),o=0;o<i;o++)if(1!=this.$patrolRewardProp[o]){for(var s=0;s<n.length;s++){if(Math.random()<n[s][1]/1e4){var u={Id:n[s][0],Num:1};l.i("抽中 ",n[s][0]),this.$patrolRewardPropArr.push(u)}}this.$patrolRewardProp[o]=1}return this.$patrolRewardPropArr.forEach((function(e){a.push(e)})),a},R.getPatrolState=function(){var e=this.getPatrolTime();return e<600?600-e:0},R.getPatrolRewardByTime=function(e){var t=Math.floor(e*y.config.towerExp/60),r=Math.floor(e*y.config.towerCoin/60),a=[];a.push({Id:101,Num:r}),a.push({Id:901,Num:t});for(var n=y.config.towerItem,i=Math.floor(e/600),o=0;o<i;o++)for(var s=0;s<n.length;s++){if(Math.random()<n[s][1]/1e4){var u={Id:n[s][0],Num:1};l.i("抽中 ",n[s][0]),a.push(u)}}return a},R.setPyramidState=function(e){this.$pyramidState[e]=1,m.GetInstance().addDataVersion()},r(i,[{key:"heroSkin",get:function(){return this.$heroSkin},set:function(e){for(var t=0;t<this.$propData.length;t++)if(this.$propData[t].id==e&&this.$propData[t].num>0)return void(this.$heroSkin=e)}},{key:"roleLv",get:function(){return this.$roleLv}},{key:"power",get:function(){return this.checkPowerTime(),this.$power}},{key:"optStone",get:function(){return this.$optStone}},{key:"dayAct",get:function(){return this.$dayAct},set:function(e){this.$dayAct=e,m.GetInstance().addDataVersion()}},{key:"energy",get:function(){return k.energyObj.num}},{key:"coin",get:function(){return this.$coin}},{key:"attack",get:function(){return this._attack},set:function(e){this._attack=e,m.GetInstance().addDataVersion()}},{key:"life",get:function(){return this._life},set:function(e){this._life=e,m.GetInstance().addDataVersion()}},{key:"defense",get:function(){return this._defense},set:function(e){this._defense=e,m.GetInstance().addDataVersion()}},{key:"roleExp",get:function(){return this.$roleExp}},{key:"openLevel",get:function(){return this.$openLevel},set:function(e){this.$openLevel=e,m.GetInstance().addDataVersion()}},{key:"mapData",get:function(){return this.$mapData},set:function(e){this.$mapData=e,m.GetInstance().addDataVersion()}},{key:"playerData",get:function(){return this.$playerData},set:function(e){this.$playerData=e,m.GetInstance().addDataVersion()}},{key:"mapHand",get:function(){return this.$mapHand},set:function(e){this.$mapHand=e,m.GetInstance().addDataVersion()}},{key:"gameKey",get:function(){return this._gameKey},set:function(e){this._gameKey=e,m.GetInstance().addDataVersion()}},{key:"wearProp",get:function(){return this.$wearProp}},{key:"propData",get:function(){return this.$propData}}]),i}(R));_._instance=null,_._isInitializing=!1,i._RF.pop()}}}));

System.register("chunks:///_virtual/utilTools.ts",["./rollupPluginModLoBabelHelpers.js","cc","./layerManager.ts","./http.ts","./ServerCtr.ts"],(function(t){var r,e,n,a,o,i;return{setters:[function(t){r=t.asyncToGenerator,e=t.regeneratorRuntime},function(t){n=t.cclegacy},function(t){a=t.layerManager},function(t){o=t.default},function(t){i=t.default}],execute:function(){n._RF.push({},"b89676Mxu5K2pyA+Ct5gTyj","utilTools",void 0),String.prototype.format=function(){var t=this;for(var r in arguments)t=t.replace(/\%\w/,arguments[r]);return t};var c=t("utilTools",{getRandomSign:function(){return Math.random()>.5?1:-1},radianToAngle:function(t){return t/Math.PI*180},angleToRadian:function(t){return t/180*Math.PI},forArr:function(t,r){var e=t.length;if(!(e<=0))for(var n=0;n<e;n++){var a=t[n];if(null!=a)if(r(a,n))break}},waterfall:function(t,r){if(r||(r=function(){}),!Array.isArray(t)||t.length<=0)r("taskArr is null");else{var e=0,n={};!function a(){var o=t[e];o?o(n,(function(t){t?r(t,null):(e++,a())})):r(null,n)}()}},valToPercent:function(t,r){return t=Math.floor(1e4*t),null==r&&(r=2),(100*(t/=1e4)).toFixed(r)+"%"},getTimeStr:function(t,r){var e="";t<0&&(t=0),t/=1e3;var n=Math.floor(t/3600),a=Math.floor((t-3600*n)/60),o=Math.floor(t-3600*n-60*a);return r?a+=60*n:e=n>=10?e+n+":":e+"0"+n+":",e=a>=10?e+a+":":e+"0"+a+":",o>=10?e+=o:e=e+"0"+o,e},getTimeStrChinese:function(t,r,e,n){void 0===r&&(r=!0);var a="";t<0&&(t=0),t/=1e3;var o=Math.floor(t/3600),i=Math.floor((t-3600*o)/60),c=Math.floor(t-3600*o-60*i);return o>0&&(a=a+o+"h"),a=i>=10?a+i+"m":a+"0"+i+"m",r&&(a=c>=10?a+c+"s":a+"0"+c+"s"),a},timeStrToDate:function(t){if("object"!=typeof t||null==t)return t;if(Array.isArray(t))for(var r in t){var e=t[r];e&&"object"==typeof e&&c.timeStrToDate(e)}else{var n=Object.keys(t);for(var a in n){var o=n[a]+"",i=t[o];if(i&&"object"==typeof i)c.timeStrToDate(i);else try{o.length>=4&&"time"==o.substring(o.length-4,o.length).toLocaleLowerCase()&&i&&"string"==typeof i&&(t[o]=new Date(i))}catch(r){console.log("utilTools.timeStrToDate error:"+r.message,r,t)}}}return t},sortArr:function(t,r){if(!t||t.length<=1)return t;for(var e=0;e<t.length-1;e++)for(var n=e+1;n<t.length;n++){var a=t[e],o=t[n];r(a,o)&&(t[e]=o,t[n]=a)}},isProb:function(t){return t||(t=0),Math.random()<t},randomArr:function(t,r){void 0===r&&(r=!1),r||(t=JSON.parse(JSON.stringify(t)));for(var e=[];t.length>0;){var n=Math.floor(Math.random()*t.length);e.push(t[n]),t.splice(n,1)}return e},getFloatValue:function(t,r,e){var n=r-t;return 0==n?t:n<0?0:e?t+Math.floor(Math.random()*(n+1)):t+Math.random()*n},overDay:function(t,r){if(!t)return!0;r||(r=new Date);var e=!1;return t.getDate()==r.getDate()?r.getTime()-t.getTime()>=864e5&&(e=!0):e=!0,e},getRowsByWeightAndNum:function(t,r,e){r||(r=1);var n=[];t=c.copyObj(t);for(var a=0;a<r&&!(t.length<=0);a++){var o=this.getRowByWeight(t);if(n.push(o),!e){var i=t.indexOf(o);t.splice(i,1)}}return n},getRowByWeight:function(t,r){if(!r)for(var e in r=0,t){(i=t[e].weight)||(i=0),r+=i}var n=Math.random()*r,a=0,o=null;for(var e in t){var i,c=t[e];if((i=c.weight)||(i=0),n>=a&&n<a+i){o=c;break}a+=i}return o},getRandomItemByArr:function(t,r){if(void 0===r&&(r=!1),!t||t.length<=0)return null;var e=Math.floor(Math.random()*t.length),n=t[e];return r&&t.splice(e,1),n},copyObj:function(t){return JSON.parse(JSON.stringify(t))},toast:function(t){a.createNotice(t)},copyTextToClipboard:function(t){var r=this;navigator.clipboard&&navigator.clipboard.writeText?navigator.clipboard.writeText(t).then((function(){r.toast("Text copied to clipboard successfully!")})).catch((function(t){r.toast("Failed to copy text to clipboard:",t)})):this.toast("Clipboard API not supported")},getUserId:function(){var t;return null==(t=window.userData)?void 0:t.userId},checkRequestState:function(t,n,a,c,u,l){var f=this;return r(e().mark((function r(){var s,h;return e().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(s=i.BASE_URL+"/"+t,(h=f.parseParamsString(a)).length>0&&(s=s.concat("?")),h.forEach((function(t){switch(t){case"userId":s=s.concat(t+"="+f.getUserId()+"&");break;case"taskId":s=s.concat(t+"="+c+"&");break;case"socialId":s=s.concat(t+"="+u+"&");break;case"address":s=s.concat(t+"="+window.address+"&");break;case"link":s=s.concat(t+"="+l+"&")}})),"GET"!==n){r.next=6;break}return r.abrupt("return",new Promise((function(t,r){o.getInstance().httpGet(s,{},(function(r){t(r.data.data)}))})));case 6:case"end":return r.stop()}}),r)})))()},parseParamsString:function(t){var r=t.replace(/([a-zA-Z0-9_]+)/g,'"$1"');return JSON.parse(r)}});n._RF.pop()}}}));

System.register("chunks:///_virtual/VipLayer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./sdkManager.ts","./constants.ts","./localText.ts","./msgac.ts","./designManager.ts","./eventManager.ts","./playerModel.ts","./UserData.ts","./BaseLayer.ts"],(function(t){var i,e,o,n,a,s,r,c,h,p,d,v,u;return{setters:[function(t){i=t.inheritsLoose},function(t){e=t.cclegacy,o=t._decorator,n=t.find},function(t){a=t.sdkManager},function(t){s=t.constants},function(t){r=t.localText},function(t){c=t.msgac},function(t){h=t.designManager},function(t){p=t.eventManager},function(t){d=t.playerModel},function(t){v=t.UserData},function(t){u=t.BaseLayer}],execute:function(){var l;e._RF.push({},"65d95RVlY1HpbS1t/Mm0AZ0","VipLayer",void 0);var y=o.ccclass;o.property,t("VipLayer",y("VipLayer")(l=function(t){function e(){for(var i,e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return(i=t.call.apply(t,[this].concat(o))||this).choseVip=void 0,i}i(e,t);var o=e.prototype;return o.onLoad=function(){t.prototype.onLoad.call(this),this.choseVip=d.vipObj.vip},o.onEnable=function(){t.prototype.onEnable.call(this)},o.onDisable=function(){t.prototype.onDisable.call(this)},o.onDestroy=function(){t.prototype.onDestroy.call(this)},o.initUI=function(){var t=d.vipObj.vip;this.setString(this.getNodeByPath("ui/top/rank/val"),t);var i=this.getNodeByPath("ui/top/bar/info"),e=h.getRowById(s.tableName.vip,t),o=h.getRowById(s.tableName.vip,t+1),a=this.getNodeByPath("ui/top/btnGet");o?(i.active=!0,a.active=!0,this.setString(n("val",i),e.adNum),this.setString(n("vip",i),"VIP"+o.id),this.setProgressBar(this.getNodeByPath("ui/top/bar"),d.vipObj.adNum/e.adNum),this.setString(this.getNodeByPath("ui/top/bar/val"),d.vipObj.adNum+"/"+e.adNum)):(a.active=!1,i.active=!1,this.setProgressBar(this.getNodeByPath("ui/top/bar"),1),this.setString(this.getNodeByPath("ui/top/bar/val"),r.full)),this.setString(this.getNodeByPath("ui/vip"),"VIP"+this.choseVip+"特权");var c=h.getRowById(s.tableName.vip,this.choseVip);this.setString(this.getNodeByPath("ui/text"),r.weaponEquipAdd.format(100*c.atkAdd));var p=this.getNodeByPath("ui/info/itemLayer/btnBox1/btnGetBox1"),v=this.getNodeByPath("ui/info/itemLayer/btnBox1/hasGet");p.active=!1,v.active=!1,d.vipObj.onceObj[this.choseVip]?v.active=!0:this.choseVip<=t&&(p.active=!0);var u=this.getNodeByPath("ui/info/itemLayer/btnBox2/btnGetBox2"),l=this.getNodeByPath("ui/info/itemLayer/btnBox2/hasGet");u.active=!1,l.active=!1,this.choseVip==t&&(d.vipObj.dayAward?l.active=!0:u.active=!0)},o.processEvent=function(t,i){},o.onButtonClick=function(t,i){},o.onClickBtnGetBox1=function(){if(!(this.choseVip>d.vipObj.vip||d.vipObj.onceObj[this.choseVip])){var t=h.getRowById(s.tableName.vip,this.choseVip),i=v.getInstance().addPropArrByDesign(t.award);this.openAwardGetLayer(i),d.vipObj.onceObj[this.choseVip]=1,this.initUI(),p.send(c.refreshRedPoint)}},o.onClickBtnGetBox2=function(){if(!(this.choseVip>d.vipObj.vip||d.vipObj.dayAward)){var t=h.getRowById(s.tableName.vip,this.choseVip),i=v.getInstance().addPropArrByDesign(t.dayAward);this.openAwardGetLayer(i),d.vipObj.dayAward=1,this.initUI(),p.send(c.refreshRedPoint)}},o.onClickBtnLeft=function(){this.choseVip<=1||(this.choseVip--,this.initUI())},o.onClickBtnRight=function(){h.getRowById(s.tableName.vip,this.choseVip+1)&&(this.choseVip++,this.initUI())},o.onClickBtnBox1=function(){if(d.vipObj.onceObj[this.choseVip]){var t=h.getRowById(s.tableName.vip,this.choseVip);this.openAwardInfoLayer(t.award)}else this.onClickBtnGetBox1()},o.onClickBtnBox2=function(){if(d.vipObj.dayAward){var t=h.getRowById(s.tableName.vip,this.choseVip);this.openAwardInfoLayer(t.dayAward)}else this.onClickBtnGetBox2()},o.onClickBtnGet=function(){var t=this;a.openAd("VIP特权",(function(i){1==i&&(d.addVipAdNum()&&(t.choseVip=d.vipObj.vip),t.initUI(),p.send(c.refreshRedPoint))}))},e}(u))||l);e._RF.pop()}}}));

System.register("chunks:///_virtual/WalletLayer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./BaseLayer.ts","./audioManager.ts","./UserData.ts"],(function(e){var t,n,i,r,o,l,a,u,c,s,p,f,y;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,i=e.initializerDefineProperty,r=e.assertThisInitialized,o=e.asyncToGenerator,l=e.regeneratorRuntime},function(e){a=e.cclegacy,u=e._decorator,c=e.Node,s=e.Label},function(e){p=e.BaseLayer},function(e){f=e.audioManager},function(e){y=e.UserData}],execute:function(){var d,b,h,C,w,W,g,v,m,L,k,D,z,A,E,T,B,N,U,_,H,V,O,P,M,I,x,R,F,j,G,S,q;a._RF.push({},"9725cxOtchM1I16pBg6HMD1","WalletLayer",void 0);var J=u.ccclass,K=u.property;e("WalletLayer",(d=J("WalletLayer"),b=K({type:c,tooltip:"PleaseConfirm"}),h=K({type:c,tooltip:"WithdrawBle"}),C=K({type:c,tooltip:"LinkWallet"}),w=K({type:c,tooltip:"ConnectWallet"}),W=K({type:c,tooltip:"Wallet"}),g=K({type:c,tooltip:"Withdraw"}),v=K({type:c,tooltip:"Deposit"}),m=K({type:c,tooltip:"Verify"}),L=K({type:c,tooltip:"LinkClose"}),k=K({type:c,tooltip:"WithdrawClose"}),D=K({type:c,tooltip:"WithdrawVerify"}),z=K({type:c,tooltip:"ConfirmClose"}),A=K({type:s,tooltip:"accountAddress"}),E=K({type:s,tooltip:"accountAddressAll"}),T=K([c]),d((U=t((N=function(e){function t(){for(var t,n=arguments.length,o=new Array(n),l=0;l<n;l++)o[l]=arguments[l];return t=e.call.apply(e,[this].concat(o))||this,i(t,"PleaseConfirm",U,r(t)),i(t,"WithdrawBle",_,r(t)),i(t,"LinkWallet",H,r(t)),i(t,"ConnectWallet",V,r(t)),i(t,"Wallet",O,r(t)),i(t,"Withdraw",P,r(t)),i(t,"Deposit",M,r(t)),i(t,"Verify",I,r(t)),i(t,"LinkClose",x,r(t)),i(t,"WithdrawClose",R,r(t)),i(t,"WithdrawVerify",F,r(t)),i(t,"ConfirmClose",j,r(t)),i(t,"accountAddress",G,r(t)),i(t,"accountAddressAll",S,r(t)),i(t,"buttons",q,r(t)),t.bgNodes=[],t}n(t,e);var a=t.prototype;return a.start=function(){var e=this;this.buttons.forEach((function(t,n){var i=t.getChildByName("checked");i&&e.bgNodes.push(i),t.on(c.EventType.TOUCH_END,(function(t){console.log(t,"eventeventevent"),e.onButtonClick(t,n)}),e),e.LinkClose.on(c.EventType.TOUCH_END,(function(t){e.LinkWallet.active=!1}),e),e.WithdrawClose.on(c.EventType.TOUCH_END,(function(t){e.WithdrawBle.active=!1}),e),e.WithdrawVerify.on(c.EventType.TOUCH_END,(function(t){e.WithdrawBle.active=!1}),e),e.Withdraw.on(c.EventType.TOUCH_END,(function(t){e.WithdrawBle.active=!0}),e),e.ConfirmClose.on(c.EventType.TOUCH_END,(function(t){e.PleaseConfirm.active=!1}),e),e.WithdrawVerify.on(c.EventType.TOUCH_END,(function(t){e.WithdrawBle.active=!1,e.PleaseConfirm.active=!0}),e)})),this.accountAddress.string=this.shortenAddress(y.getInstance().getUserAddress()),this.accountAddressAll.string=y.getInstance().getUserAddress()},a.onButtonClick=function(e,t){f.playEffect("btnClick");e.target;this.bgNodes.forEach((function(e,n){e.active=n===t}))},a.onDestroy=function(){e.prototype.onDestroy.call(this)},a.update=function(e){},a.shortenAddress=function(e){return e.length<=8?e:e.slice(0,4)+"...."+e.slice(-4)},a.onClickConnectWallet=function(){var e=o(l().mark((function e(t){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.onClickVerify=function(){this.ConnectWallet.active=!1,this.LinkWallet.active=!1,this.Wallet.active=!0},a.onClickBtnClose=function(){this.closeLayer()},t}(p)).prototype,"PleaseConfirm",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),_=t(N.prototype,"WithdrawBle",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),H=t(N.prototype,"LinkWallet",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),V=t(N.prototype,"ConnectWallet",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),O=t(N.prototype,"Wallet",[W],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),P=t(N.prototype,"Withdraw",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),M=t(N.prototype,"Deposit",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),I=t(N.prototype,"Verify",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),x=t(N.prototype,"LinkClose",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),R=t(N.prototype,"WithdrawClose",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),F=t(N.prototype,"WithdrawVerify",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),j=t(N.prototype,"ConfirmClose",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),G=t(N.prototype,"accountAddress",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),S=t(N.prototype,"accountAddressAll",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),q=t(N.prototype,"buttons",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),B=N))||B));a._RF.pop()}}}));

System.register("chunks:///_virtual/WalletLinkLayer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./BaseLayer.ts","./audioManager.ts"],(function(t){var e,n,r,o,i,a,c,s,u;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,r=t.initializerDefineProperty,o=t.assertThisInitialized},function(t){i=t.cclegacy,a=t._decorator,c=t.Node},function(t){s=t.BaseLayer},function(t){u=t.audioManager}],execute:function(){var l,f,p,y,h;i._RF.push({},"4253crg/eJOQr5DY3w1kAP0","WalletLinkLayer",void 0);var d=a.ccclass,g=a.property;t("WalletLinkLayer",(l=d("WalletLinkLayer"),f=g([c]),l((h=e((y=function(t){function e(){for(var e,n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=t.call.apply(t,[this].concat(i))||this,r(e,"buttons",h,o(e)),e.bgNodes=[],e}n(e,t);var i=e.prototype;return i.start=function(){var t=this;this.buttons.forEach((function(e,n){var r=e.getChildByName("checked");r&&t.bgNodes.push(r),e.on(c.EventType.TOUCH_END,(function(e){t.onButtonClick(e,n)}),t)}))},i.update=function(t){},i.onDestroy=function(){t.prototype.onDestroy.call(this)},i.onButtonClick=function(t,e){u.playEffect("btnClick");t.target;this.bgNodes.forEach((function(t,n){t.active=n===e}))},e}(s)).prototype,"buttons",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),p=y))||p));i._RF.pop()}}}));

System.register("chunks:///_virtual/Weapon.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./utilTools.ts","./constants.ts","./audioManager.ts","./designManager.ts","./mapModel.ts","./playerModel.ts","./UserData.ts","./physicsGroup.ts","./BaseLayer.ts","./Monster.ts"],(function(t){var i,e,o,n,a,s,l,d,c,r,h,u,p,g,f,v,y,w,k,m,P,b;return{setters:[function(t){i=t.inheritsLoose},function(t){e=t.cclegacy,o=t._decorator,n=t.BoxCollider2D,a=t.Contact2DType,s=t.find,l=t.Tween,d=t.v3,c=t.tween,r=t.Vec3,h=t.Vec2},function(t){u=t.cocosUtil},function(t){p=t.utilTools},function(t){g=t.constants},function(t){f=t.audioManager},function(t){v=t.designManager},function(t){y=t.mapModel},function(t){w=t.playerModel},function(t){k=t.UserData},function(t){m=t.physicsGroup},function(t){P=t.BaseLayer},function(t){b=t.Monster}],execute:function(){var U;e._RF.push({},"f10f3YlgP5L4LOzHlrtQCU3","Weapon",void 0);var N=o.ccclass;o.property,t("Weapon",N("Weapon")(U=function(t){function e(){for(var i,e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return(i=t.call.apply(t,[this].concat(o))||this).info=void 0,i.id=void 0,i.direction=void 0,i.row=void 0,i.atk=void 0,i.atkPercentAdd=void 0,i.bodyNode=void 0,i.collider=void 0,i.lightNode=void 0,i.forward=void 0,i.targetNode=void 0,i.outV3=d(0,0,0),i.canFace=!0,i.parentPos=void 0,i.timeCount=0,i.weaponUtil=void 0,i}i(e,t);var o=e.prototype;return o.onLoad=function(){this.collider=this.node.getComponent(n),this.collider&&(this.collider.enabled=!1,this.collider.on(a.BEGIN_CONTACT,this.contactBegin,this)),this.bodyNode=s("body",this.node),this.lightNode=s("light",this.node),this.parentPos=this.node.parent.getPosition()},o.onDestroy=function(){this.unscheduleAllCallbacks(),this.weaponUtil&&this.weaponUtil.unscheduleAllCallbacks()},o.init=function(t){this.bodyNode||this.onLoad(),this.info=t;var i=t.id;this.id=i,this.unscheduleAllCallbacks(),l.stopAllByTarget(this.bodyNode);var e=v.getRowById(g.tableName.weapon,i);this.row=e,this.atk=e.atk,console.log("---atk---atk---atk---atk---atk---atk---",e.atk);try{var o=u.addComponentOnce(this,"Weapon"+e.type);o.unscheduleAllCallbacks(),this.weaponUtil=o,o.init(this)}catch(t){}if(this.weaponUtil&&this.weaponUtil.isFixedPos){var n=this.node.getScale();0==t.uiIndex||3==t.uiIndex?this.node.setScale(d(Math.abs(n.x),n.y,n.z)):this.node.setScale(d(-Math.abs(n.x),n.y,n.z))}if(this.atkPercentAdd=0,this.weaponUtil&&this.weaponUtil.weaponId>0&&y.floor>0){var a=k.getInstance().getWeaponLv(),s=v.getRowById(g.tableName.weaponOpt,a);this.atkPercentAdd=s.atk/100}if(y.weaponSystem.weaponArr[0]==t){var c=v.getRowById(g.tableName.vip,w.vipObj.vip);c&&(this.atkPercentAdd+=c.atkAdd)}},o.atkByDart=function(){var t=this;f.playEffect(this.row.audio);var i=u.convertToWorldSpace(this.node),e={};e.atkPercentAdd=this.atkPercentAdd,y.bulletSystem.addBullet(this.row.bulletId,m.PLAYER_BULLET,i,this.direction,e),this.timeCount=0,this.bodyNode.active=!1,c(this.bodyNode).delay(this.row.atkTime-.2).call((function(){t.bodyNode.active=!0,t.bodyNode.setScale(d(.1,.1,1))})).to(.2,{scale:d(1,1,1)},{easing:"quadOut"}).start()},o.atkByShot=function(){var t=this;f.playEffect(this.row.audio),this.lightNode&&(this.lightNode.active=!0,this.scheduleOnce((function(){t.lightNode.active=!1}),.03)),this.canFace=!1;var i=this.direction.clone().normalize().negative().multiplyScalar(20),e=this.node.getPosition();c(this.node).to(.05,{position:i},{easing:"quadOut"}).to(.05,{position:e},{easing:"quadIn"}).call((function(){t.canFace=!0,t.timeCount=0})).start()},o.atkByFist=function(t,i){var e=this;if(this.getDisTargetNode()>t)return!0;f.playEffect(this.row.audio);var o=this.direction.clone().normalize().negative().multiplyScalar(20),n=this.direction.clone().normalize().multiplyScalar(t),a=this.node.getPosition();this.canFace=!1,this.forward=!1,c(this.node).to(i,{position:o},{easing:"quadOut"}).call((function(){e.forward=!0,e.collider.enabled=!0})).to(2*i,{position:n},{easing:"quadOut"}).call((function(){e.forward=!1,e.collider.enabled=!1,e.weaponUtil&&e.weaponUtil.moveMaxFar&&e.weaponUtil.moveMaxFar()})).to(2*i,{position:a},{easing:"quadIn"}).call((function(){e.canFace=!0,e.timeCount=0})).start()},o.atkByStick=function(t){var i=this;if(!(this.getDisTargetNode()>t)){f.playEffect(this.row.audio),this.canFace=!1;var e=this.node.angle,o=.03;c(this.node).to(o,{angle:e+90}).call((function(){var t={};t.atkPercentAdd=i.atkPercentAdd,y.bulletSystem.addBullet(i.row.bulletId,m.PLAYER_BULLET,u.convertToWorldSpace(i.node),i.direction,t)})).to(o,{angle:e}).to(o,{angle:e-90}).call((function(){i.canFace=!0,i.timeCount=0})).start()}},o.targetForceMoveBack=function(t){if(this.forward){var i=t.getComponent(b);if(i&&i.row.type!=g.monsterTypes.boss){var e=this.direction.clone().normalize().multiplyScalar(50);c(t).by(.02,{position:e}).start()}}},o.getInfoPosition=function(t,i){var e=this.node.getPosition(),o=s("info",this.node);if(t>0&&(o=s("info"+t,this.node)),o){o.active=!1;var n=o.getPosition();r.rotateZ(n,n,r.ZERO,p.angleToRadian(this.node.angle)),e.x+=n.x,e.y+=n.y}return this.weaponUtil&&this.weaponUtil.isFixedPos&&this.node.scale.x<0&&(e.x=-e.x),i&&(e=u.convertToWorldSpaceWithPos(this.node,e)),e},o.contactBegin=function(t,i){if(i.group==m.MONSTER){var e=i.getComponent(b);if(e){var o=this.atk;this.atkPercentAdd>0&&(o*=1+this.atkPercentAdd,o=Math.ceil(o)),e.hitWithDam(o)}}this.weaponUtil&&this.weaponUtil.contactBegin&&this.weaponUtil.contactBegin(i.node)},o.getCalPosition=function(){var t=y.player.node.getPosition();return t.x+=this.parentPos.x,t.y+=this.parentPos.y,t},o.getDisTargetNode=function(){return this.targetNode?h.distance(this.getCalPosition(),this.targetNode.position):999999},o.updateLogic=function(t){this.targetNode=null;var i=y.mapSystem.getMinDisTargetNode(this.getCalPosition());if(i&&this.canFace){this.targetNode=i;var e=u.convertToWorldSpace(this.node),o=u.convertToWorldSpace(i),n=this.node.getScale();this.weaponUtil&&this.weaponUtil.isFixedPos||(e.x<=o.x?this.node.setScale(d(n.x,Math.abs(n.y),n.z)):this.node.setScale(d(n.x,-Math.abs(n.y),n.z))),o.subtract(e),this.direction=o;var a=p.radianToAngle(Math.atan2(o.y,o.x));this.weaponUtil&&(this.weaponUtil.isFixedDirection&&(a=a>-90&&a<=90?0:180),this.weaponUtil.isFixedPos&&(a=0)),this.node.angle=a,this.weaponUtil&&this.weaponUtil.stopTimeCount||(this.timeCount+=t,this.timeCount>=this.row.atkTime&&this.weaponUtil&&u.isValid(this.targetNode)&&this.weaponUtil.atk())}},e}(P))||U);e._RF.pop()}}}));

System.register("chunks:///_virtual/Weapon1.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(n){var t,o,e,r;return{setters:[function(n){t=n.inheritsLoose},function(n){o=n.cclegacy,e=n._decorator,r=n.Component}],execute:function(){var a;o._RF.push({},"eb75cIxY7pCw4EqtaskfNq3","Weapon1",void 0);var c=e.ccclass;e.property,n("Weapon1",c("Weapon1")(a=function(n){function o(){for(var t,o=arguments.length,e=new Array(o),r=0;r<o;r++)e[r]=arguments[r];return(t=n.call.apply(n,[this].concat(e))||this).weapon=void 0,t.weaponId=10130,t}t(o,n);var e=o.prototype;return e.init=function(n){this.weapon=n},e.atk=function(){this.weapon.atkByDart()},o}(r))||a);o._RF.pop()}}}));

System.register("chunks:///_virtual/Weapon2.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./constants.ts","./mapModel.ts","./physicsGroup.ts","./Hint.ts"],(function(t){var n,o,e,c,i,a,s,r,p;return{setters:[function(t){n=t.inheritsLoose},function(t){o=t.cclegacy,e=t._decorator,c=t.Component},function(t){i=t.cocosUtil},function(t){a=t.constants},function(t){s=t.mapModel},function(t){r=t.physicsGroup},function(t){p=t.HintNames}],execute:function(){var u;o._RF.push({},"c5509xfbVZJL4esZufQHnOD","Weapon2",void 0);var l=e.ccclass;e.property,t("Weapon2",l("Weapon2")(u=function(t){function o(){for(var n,o=arguments.length,e=new Array(o),c=0;c<o;c++)e[c]=arguments[c];return(n=t.call.apply(t,[this].concat(e))||this).weapon=void 0,n.weaponId=10135,n.bulletId=7,n}n(o,t);var e=o.prototype;return e.init=function(t){this.weapon=t},e.atk=function(){this.weapon.atkByFist(300,.1)},e.contactBegin=function(t){s.hintSystem.addHint(p.hit1,i.convertToWorldSpace(t)),this.weapon.targetForceMoveBack(t)},e.moveMaxFar=function(){this.weapon.row.lv==a.design.maxLv&&s.bulletSystem.addBullet(this.bulletId,r.PLAYER_BULLET,i.convertToWorldSpace(this.weapon.node),null,this.weapon.node.angle)},o}(c))||u);o._RF.pop()}}}));

System.register("chunks:///_virtual/Weapon3.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./constants.ts","./mapModel.ts","./Hint.ts"],(function(t){var n,o,e,c,i,a,s,r;return{setters:[function(t){n=t.inheritsLoose},function(t){o=t.cclegacy,e=t._decorator,c=t.Component},function(t){i=t.cocosUtil},function(t){a=t.constants},function(t){s=t.mapModel},function(t){r=t.HintNames}],execute:function(){var p;o._RF.push({},"f5930HqAsFLYJwEoWUnW3U5","Weapon3",void 0);var u=e.ccclass;e.property,t("Weapon3",u("Weapon3")(p=function(t){function o(){for(var n,o=arguments.length,e=new Array(o),c=0;c<o;c++)e[c]=arguments[c];return(n=t.call.apply(t,[this].concat(e))||this).weapon=void 0,n.weaponId=10140,n}n(o,t);var e=o.prototype;return e.init=function(t){this.weapon=t},e.atk=function(){this.weapon.atkByFist(300,.1)},e.contactBegin=function(t){this.weapon.row.lv==a.design.maxLv?s.hintSystem.addHint(r.hit7,i.convertToWorldSpace(t)):s.hintSystem.addHint(r.hit3,i.convertToWorldSpace(t)),this.weapon.targetForceMoveBack(t)},o}(c))||p);o._RF.pop()}}}));

System.register("chunks:///_virtual/Weapon4.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(n){var o,t,e,r;return{setters:[function(n){o=n.inheritsLoose},function(n){t=n.cclegacy,e=n._decorator,r=n.Component}],execute:function(){var i;t._RF.push({},"87f193XmIVPsoGBgcT84RKn","Weapon4",void 0);var c=e.ccclass;e.property,n("Weapon4",c("Weapon4")(i=function(n){function t(){for(var o,t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return(o=n.call.apply(n,[this].concat(e))||this).weapon=void 0,o.weaponId=10145,o.isFixedDirection=!0,o}o(t,n);var e=t.prototype;return e.init=function(n){this.weapon=n},e.atk=function(){this.weapon.atkByStick(500)},t}(r))||i);t._RF.pop()}}}));

System.register("chunks:///_virtual/Weapon5.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./mapModel.ts","./Hint.ts","./constants.ts"],(function(n){var t,o,e,a,i,c,s,r;return{setters:[function(n){t=n.inheritsLoose},function(n){o=n.cclegacy,e=n._decorator,a=n.Component},function(n){i=n.cocosUtil},function(n){c=n.mapModel},function(n){s=n.HintNames},function(n){r=n.constants}],execute:function(){var p;o._RF.push({},"e405cst8JNFQLZ6QAhoKYRD","Weapon5",void 0);var l=e.ccclass;e.property,n("Weapon5",l("Weapon5")(p=function(n){function o(){for(var t,o=arguments.length,e=new Array(o),a=0;a<o;a++)e[a]=arguments[a];return(t=n.call.apply(n,[this].concat(e))||this).weapon=void 0,t.weaponId=10150,t}t(o,n);var e=o.prototype;return e.init=function(n){this.weapon=n},e.atk=function(){var n=this,t=300;this.weapon.row.lv==r.design.maxLv&&(t=400),this.weapon.atkByFist(t,.05)||this.scheduleOnce((function(){n.weapon.row.lv==r.design.maxLv?c.hintSystem.addHint(s.hit4,i.convertToWorldSpace(n.weapon.node),n.weapon.node.angle):c.hintSystem.addHint(s.hit6,i.convertToWorldSpace(n.weapon.node),n.weapon.node.angle)}),.1)},e.contactBegin=function(n){c.hintSystem.addHint(s.hit5,i.convertToWorldSpace(n)),this.weapon.targetForceMoveBack(n)},o}(a))||p);o._RF.pop()}}}));

System.register("chunks:///_virtual/Weapon6.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./constants.ts","./audioManager.ts","./mapModel.ts","./physicsGroup.ts","./AnimationCtrl.ts"],(function(n){var t,e,o,a,i,c,l,s,r,u;return{setters:[function(n){t=n.inheritsLoose},function(n){e=n.cclegacy,o=n._decorator,a=n.Component},function(n){i=n.cocosUtil},function(n){c=n.constants},function(n){l=n.audioManager},function(n){s=n.mapModel},function(n){r=n.physicsGroup},function(n){u=n.AnimationCtrl}],execute:function(){var p;e._RF.push({},"f797baKKVlBaapupRSrfXVD","Weapon6",void 0);var d=o.ccclass;o.property,n("Weapon6",d("Weapon6")(p=function(n){function e(){for(var t,e=arguments.length,o=new Array(e),a=0;a<e;a++)o[a]=arguments[a];return(t=n.call.apply(n,[this].concat(o))||this).weapon=void 0,t.weaponId=10155,t.isFixedPos=!0,t.aniCtrl=void 0,t}t(e,n);var o=e.prototype;return o.init=function(n){this.weapon=n,this.unscheduleAllCallbacks(),this.aniCtrl=i.addComponentOnce(this,u),this.aniCtrl.playAnimation("1",!0)},o.atk=function(){var n=this;this.weapon.getDisTargetNode()>200||(l.playEffect(this.weapon.row.audio),this.weapon.canFace=!1,this.aniCtrl.playAnimationOnce("2"),this.scheduleOnce((function(){var t=n.weapon.getInfoPosition(0,!0),e={};if(e.atkPercentAdd=n.weapon.atkPercentAdd,s.bulletSystem.addBullet(n.weapon.row.bulletId,r.PLAYER_BULLET,t,null,e),n.weapon.row.lv==c.design.maxLv)for(var o=n.weapon.direction.clone().normalize(),a=0,i=[100,80,60,40],l=function(e){n.scheduleOnce((function(){a+=i[e]+i[e+1];var c=t.clone().add(o.clone().multiplyScalar(a)),l={};l.scale=.8-.2*e,l.atkPercentAdd=n.weapon.atkPercentAdd,s.bulletSystem.addBullet(n.weapon.row.bulletId,r.PLAYER_BULLET,c,null,l)}),.2*e+.2)},u=0;u<3;u++)l(u)}),.1),this.scheduleOnce((function(){n.weapon.canFace=!0,n.weapon.timeCount=0}),.32))},e}(a))||p);e._RF.pop()}}}));

System.register("chunks:///_virtual/Weapon7.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./constants.ts","./audioManager.ts","./mapModel.ts","./physicsGroup.ts"],(function(t){var e,i,o,s,n,a,l,u,c,h;return{setters:[function(t){e=t.inheritsLoose},function(t){i=t.cclegacy,o=t._decorator,s=t.UITransform,n=t.Component},function(t){a=t.cocosUtil},function(t){l=t.constants},function(t){u=t.audioManager},function(t){c=t.mapModel},function(t){h=t.physicsGroup}],execute:function(){var r;i._RF.push({},"cb7391UjCxAgIU9XcT27b6W","Weapon7",void 0);var p=o.ccclass;o.property,t("Weapon7",p("Weapon7")(r=function(t){function i(){for(var e,i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return(e=t.call.apply(t,[this].concat(o))||this).weapon=void 0,e.weaponId=10160,e.stopTimeCount=void 0,e.atkDis=400,e.isHitPass=!1,e.bullet=void 0,e}e(i,t);var o=i.prototype;return o.init=function(t){this.weapon=t,this.stopTimeCount=!1,this.weapon.row.lv==l.design.maxLv?(this.isHitPass=!0,this.atkDis=1e3):(this.isHitPass=!1,this.atkDis=400)},o.atk=function(){var t=this;if(!(this.weapon.getDisTargetNode()>this.atkDis)){this.stopTimeCount=!0;var e=this.weapon.getInfoPosition(0,!0);this.bullet=null;var i={};i.atkPercentAdd=this.weapon.atkPercentAdd,i.invokeClass=function(e){a.isValid(t.node)?(u.playEffect(t.weapon.row.audio),t.bullet=e,t.update()):t.bullet.recycleSelf()},c.bulletSystem.addBullet(this.weapon.row.bulletId,h.PLAYER_BULLET,e,this.weapon.direction,i),this.scheduleOnce(this.atkEnd,this.weapon.row.lv)}},o.atkEnd=function(){this.unschedule(this.atkEnd),this.weapon.timeCount=0,this.stopTimeCount=!1,a.isValid(this.bullet)&&(this.bullet.recycleSelf(),this.bullet=null)},o.forceDestroy=function(){this.atkEnd()},o.update=function(){if(this.bullet){this.bullet.node.angle=this.node.angle;var t=this.weapon.getInfoPosition(0,!0);if(t=a.convertToNodeSpace(this.bullet.node,t),this.bullet.node.setPosition(t),this.weapon.targetNode){var e=this.weapon.getDisTargetNode();this.isHitPass&&(e=this.atkDis),this.bullet.bulletUtil.setBodyWidth(e-.2*this.weapon.targetNode.getComponent(s).height),e>this.atkDis&&this.atkEnd()}}},i}(n))||r);i._RF.pop()}}}));

System.register("chunks:///_virtual/Weapon8.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./constants.ts","./mapModel.ts","./physicsGroup.ts"],(function(t){var o,n,e,i,c,a,r,s;return{setters:[function(t){o=t.inheritsLoose},function(t){n=t.cclegacy,e=t._decorator,i=t.Component},function(t){c=t.cocosUtil},function(t){a=t.constants},function(t){r=t.mapModel},function(t){s=t.physicsGroup}],execute:function(){var p;n._RF.push({},"0c8d8yDhG9J8Yg5i2BgCTFf","Weapon8",void 0);var u=e.ccclass;e.property,t("Weapon8",u("Weapon8")(p=function(t){function n(){for(var o,n=arguments.length,e=new Array(n),i=0;i<n;i++)e[i]=arguments[i];return(o=t.call.apply(t,[this].concat(e))||this).weapon=void 0,o.weaponId=10165,o}o(n,t);var e=n.prototype;return e.init=function(t){this.weapon=t},e.atk=function(){var t=this,o=this.weapon.getInfoPosition(0,!0),n=1;this.weapon.row.lv==a.design.maxLv&&(n=3);var e=c.getSectorDirectionArr(this.weapon.direction,15,n),i={};i.atkPercentAdd=this.weapon.atkPercentAdd,e.forEach((function(n){r.bulletSystem.addBullet(t.weapon.row.bulletId,s.PLAYER_BULLET,o,n,i)})),this.weapon.atkByShot()},n}(i))||p);n._RF.pop()}}}));

System.register("chunks:///_virtual/WeaponSystem.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./utilTools.ts","./constants.ts","./designManager.ts","./resManager.ts","./BaseLayer.ts","./Weapon.ts"],(function(e){var n,t,r,a,o,i,s,c,u,p,d,f,l;return{setters:[function(e){n=e.inheritsLoose,t=e.asyncToGenerator,r=e.regeneratorRuntime},function(e){a=e.cclegacy,o=e._decorator,i=e.Prefab},function(e){s=e.cocosUtil},function(e){c=e.utilTools},function(e){u=e.constants},function(e){p=e.designManager},function(e){d=e.resManager},function(e){f=e.BaseLayer},function(e){l=e.Weapon}],execute:function(){var h;a._RF.push({},"b004fNa2AhH0YD5gpIzN4C+","WeaponSystem",void 0);var y=o.ccclass;o.property,e("WeaponSystem",y("WeaponSystem")(h=function(e){function a(){for(var n,t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return(n=e.call.apply(e,[this].concat(r))||this).weaponArr=void 0,n}n(a,e);var o=a.prototype;return o.onLoad=function(){e.prototype.onLoad.call(this),this.weaponArr=[]},o.onEnable=function(){e.prototype.onEnable.call(this)},o.initData=function(e){this.addWeapon(1,e.weaponId)},o.getSaveData=function(){var e={};return e.arr=this.weaponArr,e},o.loadSaveData=function(e){var n=this;c.forArr(e.arr,(function(e){n.addWeapon(0,e.id)}))},o.loadWeaponPrefab=function(e){return new Promise((function(n,t){d.loadAsset(u.bundles.weapon,e,i,null,(function(e,r){e?t():n(r)}))}))},o.getWeaponInfoByType=function(e){for(var n in this.weaponArr){var t=this.weaponArr[n];if(p.getRowById(u.tableName.weapon,t.id).type==e)return t}return null},o.addWeapon=function(){var e=t(r().mark((function e(n,t){var a,o,i,d,f,h,y,b,g,w,v;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:void 0===t&&(t=0),t>0&&(n=p.getRowById(u.tableName.weapon,t).type),a=null,o=0,e.t0=r().keys(this.weaponArr);case 5:if((e.t1=e.t0()).done){e.next=15;break}if(i=e.t1.value,d=this.weaponArr[i],p.getRowById(u.tableName.weapon,d.id).type!=n){e.next=13;break}return a=d,o=parseInt(i),e.abrupt("break",15);case 13:e.next=5;break;case 15:if(!a){e.next=22;break}if((f=p.getRowById(u.tableName.weapon,a.id+1))&&!(f.lv>u.design.maxLv)){e.next=19;break}return e.abrupt("return");case 19:a.id++,e.next=28;break;case 22:if(!(this.weaponArr.length>=u.design.weaponNum)){e.next=24;break}return e.abrupt("return");case 24:(a={}).id=p.getFirstIdByType(n),this.weaponArr.push(a),o=this.weaponArr.length-1;case 28:if(t>0&&(a.id=t),h=this.node.children[o]){e.next=32;break}return e.abrupt("return");case 32:return c.forArr(h.children,(function(e){var n=e.getComponent(l).weaponUtil;n&&n.forceDestroy&&n.forceDestroy(),e.destroy()})),a.uiIndex=o,y=a.id,b=p.getRowById(u.tableName.weapon,y),e.next=38,this.loadWeaponPrefab(b.prefab);case 38:if(g=e.sent,y==a.id&&s.isValid(this)){e.next=41;break}return e.abrupt("return");case 41:w=s.instantiate(g),v=w.addComponent(l),w.parent=h,v.init(a);case 45:case"end":return e.stop()}}),e,this)})));return function(n,t){return e.apply(this,arguments)}}(),o.updateLogic=function(e){c.forArr(this.node.children,(function(n,t){if(n.active){var r=n.children[0];r&&r.getComponent(l).updateLogic(e)}}))},a}(f))||h);a._RF.pop()}}}));

System.register("chunks:///_virtual/wechat.ts",["./rollupPluginModLoBabelHelpers.js","cc","./tyqSDK.ts"],(function(e){var t,i,n,o;return{setters:[function(e){t=e.createClass},function(e){i=e.cclegacy,n=e.view},function(e){o=e.tyqSDK}],execute:function(){var s;i._RF.push({},"d06fezwCoBE2Y+Q+xMyxDek","wechat",void 0);var r=null,a=null,h=function(){function e(){this.isWxAuthorize=!1,this.systemInfo=null,this.userInfoButton=null,this.bannerAd=null,this.rewardedVideoAd=null,this.interstitialAd=null,this.RiconAD=null,this.LiconAD=null,this.gridAd=null,this.gridAdCunt=null,this.GameRecorder=null,this.startListener=null,this.resumeListener=null,this.pauseListener=null,this.stopListener=null,this.errorListener=null,this.abortListener=null,this.timeUpdateListener=null,this.gameClub=null,this.feedbackButton=null,this.showListener=null,this.hideListener=null,this._bannerAdUnitId=[],this._bannerAdObjList=[],this._bannerShowIndex=0,this._bannerTimer=-1,this._bannerAdRefreshTimeOutId=0,this._rewardedVideoAdUnitId=[],this._curRewardVideoAdUnitId="",this._shareValue=0,this._rewardValue=1,this._interstitialAdUnitId=[],this._latticeAdUnitId="",this._RIconAdunit="",this._LIconAdunit="",this.mainBannerAD=null,this._userInfoButtonData={width:null,height:null,x:null,y:null,url:null},this._feedbackButtonData={width:null,height:null,x:null,y:null,url:null},this._bannerSize={width:600,height:172},this._gameClubSize={icon:"",x:0,y:0,width:0,height:0},this._closeRewardVideoListener=null,window.wx&&this.getSystemInfoSync()}var i=e.prototype;return i.getSetting=function(t,i){e.isSupportedAPI(wx.getSetting)?wx.getSetting({success:function(e){t(e.authSetting["scope.userInfo"])},fail:function(e){i&&i(e)}}):(console.error("----\x3e 微信版本不支持getSetting API"),i&&i("----\x3e 微信版本不支持getSetting API"))},i.createUserInfoButton=function(t,i,s,r){void 0===t&&(t=0),void 0===i&&(i=0),void 0===s&&(s=n.getVisibleSize().width),void 0===r&&(r=n.getVisibleSize().height),e.isSupportedAPI(wx.createUserInfoButton)?this.userInfoButton=wx.createUserInfoButton({type:"image",style:{left:t,top:i,width:n.getVisibleSize().width,height:n.getVisibleSize().height}}):o.log("=====> @framework,当前微信版本过低，无法使用授权按钮，请升级到最新微信版本后重试")},i.destroyAuthorizeBtn=function(){this.userInfoButton&&(this.userInfoButton.destroy(),this.userInfoButton=null)},i.login=function(e,t){wx.login({success:function(t){e(t.code)},fail:function(){t()}})},i.wxGetSetting=function(){var e=this;return new Promise((function(t,i){try{wx.getSetting({success:function(n){if(console.log("微信授权信息1",n),n.authSetting["scope.userInfo"])e.isWxAuthorize=!0,console.log("已经授权了2"),t(n);else{console.log("未授权----");var o=wx.getSystemInfoSync(),s=o.screenWidth,r=o.screenHeight,a=wx.createUserInfoButton({type:"text",text:"",style:{left:0,top:0,width:s,height:r,lineHeight:60,backgroundColor:"rgba(0, 0, 0, 0)",color:"rgba(0, 0, 0, 0)",textAlign:"center",fontSize:24,borderRadius:4}});a.onTap((function(n){console.log("授权结果",n),"getUserInfo:ok"==n.errMsg?(e.isWxAuthorize=!0,console.log("授权结果1 resolve",n),t(n)):(console.log("授权结果2 reject",n),i(n)),a.hide()})),console.log("显示授权按钮",a),a.show()}},fail:function(e){console.log("微信授权失败处理函数11"),i(e)}})}catch(e){console.log("微信授权异常处理函数11"),i(e)}}))},i.shareAppMessage=function(e,t,i){wx.shareAppMessage({title:e,imageUrl:t,query:i})},i.isShareBehavior=function(){return 1==this._shareValue},i.isRewardBehavior=function(){return 1==this._rewardValue},i.closeRewardVideo=function(){this._closeRewardVideoListener&&this._closeRewardVideoListener()},i.createInterstitialAd=function(){if(!this.interstitialAd){var e=this._interstitialAdUnitId[Math.floor(Math.random()*this._interstitialAdUnitId.length)];this.interstitialAd=wx.createInterstitialAd({adUnitId:e}),this.interstitialAd.onLoad(this.interstitialAdOnLoadListener)}},i.interstitialAdOnLoadListener=function(){o.log("=====> @framework,插屏创建成功")},i.createGameClubButton=function(){wx.createGameClubButton?this.gameClub||(this.gameClub=wx.createGameClubButton({icon:this._gameClubSize.icon,style:{left:this._gameClubSize.x/this.systemInfo.pixelRatio,top:this._gameClubSize.y/this.systemInfo.pixelRatio,width:this._gameClubSize.width,height:this._gameClubSize.height}}),this.gameClub.hide(),o.log("gameClub",this.gameClub)):o.log("=====> @framework,当前微信版本过低，无法使用游戏圈功能，请升级到最新微信版本后重试")},i.showGameClub=function(){o.log("显示游戏圈：",this.gameClub),this.createGameClubButton(),this.gameClub&&(this.gameClub.show(),o.log("显示游戏圈成功"))},i.hideGameClub=function(){this.gameClub&&this.gameClub.hide()},i.postMessage=function(e,t){var i={message:"",value:t};i.message=e,i.value=t,o.log("发送信息: ",i),wx.getOpenDataContext().postMessage(i)},i.createFeedbackButton=function(t,i){e.isSupportedAPI(wx.createFeedbackButton)?(this.feedbackButton=wx.createFeedbackButton({type:"image",image:this._feedbackButtonData.url,style:{left:this._feedbackButtonData.x,top:this._feedbackButtonData.y,width:this._feedbackButtonData.width,height:this._feedbackButtonData.height}}),t(this.feedbackButton)):(o.log("=====> @framework,当前微信版本过低，无法使用反馈按钮，请升级到最新微信版本后重试"),i())},i.onTapFeedbackButton=function(e,t){this.feedbackButton?this.feedbackButton.onTap((function(){e()})):t()},i.showFeedbackButton=function(){this.feedbackButton&&this.feedbackButton.show()},i.hideFeedbackButton=function(){this.feedbackButton&&this.feedbackButton.hide()},i.getGameRecorder=function(t,i){e.isSupportedAPI(wx.getGameRecorder)?(this.GameRecorder=wx.getGameRecorder(),t()):i()},i.registerRecordScreenEvent=function(){var t=this;e.isSupportedAPI(wx.getGameRecorder)?(this.GameRecorder=wx.getGameRecorder(),this.GameRecorder.on("start",(function(e){t.resumeListener&&t.resumeListener()})),this.GameRecorder.on("pause",(function(e){t.pauseListener&&t.pauseListener()})),this.GameRecorder.on("stop",(function(e){t.stopListener&&(o.log("视频的时长：",e.duration),t.stopListener(e.duration))})),this.GameRecorder.on("error",(function(e){o.log("=====> @framework,录屏错误：",e.error.message,",code: ",e.error.code),t.errorListener&&t.errorListener()})),this.GameRecorder.on("timeUpdate",(function(e){o.log("=====> @framework,录屏到第几秒：",e.currentTime),t.timeUpdateListener&&t.timeUpdateListener()})),this.GameRecorder.on("abort",(function(e){t.abortListener&&t.abortListener()}))):o.log("=====> @framework,当前客户端版过低，无法使用录制功能，请升级到最新客户端版本后重试")},i.startRecordScreen=function(e){},i.pauseRecordScreen=function(e){this.pauseListener=e,this.GameRecorder.pause()},i.resumeRecordScreen=function(e){this.resumeListener=e,this.GameRecorder.resume()},i.stopRecordScreen=function(e){this.stopListener=e,this.GameRecorder.stop()},i.abortRecordScreen=function(e){this.abortListener=e,this.GameRecorder.abort()},i.createGameRecorderShareButton=function(){},i.onShow=function(e){this.showListener=e,wx.onShow(this.onShowListener.bind(this))},i.offShow=function(){wx.offShow(this.onShowListener)},i.onHide=function(e){this.hideListener=e,wx.onHide(this.onHideListener.bind(this))},i.offHide=function(){this.hideListener=null,wx.offHide(this.onHideListener)},i.onShowListener=function(e){this.showListener&&this.showListener(e)},i.onHideListener=function(){this.hideListener&&this.hideListener()},i.navigateToMiniProgram=function(t,i,n,o){e.isSupportedAPI(wx.navigateToMiniProgram)?wx.navigateToMiniProgram({appId:t,path:i,envVersion:"release",success:function(){n()},fail:function(){o()},complete:function(){}}):o()},i.vibrateLong=function(e){e&&console.warn("----\x3e vibrateLong 微信可能没有cb"),wx.vibrateLong()},i.vibrateShort=function(e){console.warn("----\x3e vibrateShort 微信可能没有cb"),wx.vibrateShort()},i.getSystemInfoSync=function(){this.systemInfo=wx.getSystemInfoSync()},e.isSupportedAPI=function(e){return!!e||(wx.showModal({title:"提示",content:"当前微信版本过低，无法使用该功能，请升级到最新微信版本后重试。"}),!1)},i.exitMiniProgram=function(e){wx.exitMiniProgram(e)},i.showToast=function(e,t,i){void 0===t&&(t=3e3),wx.showToast({title:e,duration:t,success:function(){i&&i()}})},i.getSystemInfo=function(e){wx.getSystemInfo({success:function(t){e&&e(t)}})},i.aldSendEvent=function(e,t){o.log("send msg: ",e),wx.aldSendEvent?t?wx.aldSendEvent(e):wx.aldSendEvent(e,t):console.error("----\x3e 阿拉丁接入失败，请检查game.js")},i.createIconAd=function(){var e=this,t=[].concat(Array(a+1).map((function(e,t){return{appNameHidden:!1,color:"white",size:100,borderWidth:100,borderColor:"white",left:100*t,top:100}})));this.LiconAD=wx.createGameIcon({adUnitId:this._LIconAdunit,count:a,style:t}),this.LiconAD.onError((function(e){o.log("=====> @framework, 小游戏推荐左边icon加载失败：",e)})),this.LiconAD.onLoad((function(){o.log("=====> @framework, 小游戏推荐左边icon加载成功")})),this.LiconAD.onResize((function(t){var i;i=e.systemInfo.windowHeight/2-a/2*t[0].height;for(var n=0;n<t.length;n++)t[n].left=10,t[n].top=i+72*n}))},i.showIconAd=function(e){var t=this;"R"==e?this.RiconAD?this.RiconAD.load().then((function(){t.RiconAD.show()})).catch((function(e){console.error(e)})):setTimeout(this.createIconAd,1e3):this.LiconAD?this.LiconAD.load().then((function(){t.LiconAD.show()})).catch((function(e){console.error(e)})):setTimeout(this.createIconAd,1e3)},i.createGridAd=function(e){var t=this;this.gridAd=wx.createGridAd({adUnitId:r,adTheme:"white",gridCount:e,adIntervals:30,style:{left:0,top:this.systemInfo.windowHeight/2-350,width:500,opacity:.8}}),this.gridAd.onLoad((function(){o.log("=====> @framework, 格子广告加载成功"),t.gridAdCunt=e})),this.gridAd.onError((function(e){o.log("=====> @framework, 格子广告加载失败：",e)}))},i.showGridAd=function(e){e!=this.gridAdCunt&&(this.gridAd&&this.gridAd.destroy(),this.createGridAd(e)),this.gridAd.show()},i.hideGridAd=function(){this.gridAd.hide()},i.showShareMenu=function(e){void 0===e&&(e=!1),window.wx&&wx.showShareMenu({withShareTicket:e,menus:["shareAppMessage","shareTimeline"]})},t(e,[{key:"RIconAduni",set:function(e){this._RIconAdunit=e}},{key:"LIconAduni",set:function(e){this._LIconAdunit=e}},{key:"bannerAdUnitId",set:function(e){}},{key:"rewardedVideoAdUnitId",set:function(e){}},{key:"interstitialAdUnitId",set:function(e){}},{key:"bannerSize",set:function(e){this._bannerSize.width=e.width,this._bannerSize.height=e.height,console.log("this._bannerSize = ",this._bannerSize)}},{key:"latticeAdUnitId",set:function(e){this._latticeAdUnitId=e}},{key:"gameClubSize",set:function(e){this._gameClubSize.x=e.x,this._gameClubSize.y=e.y,this._gameClubSize.width=e.width,this._gameClubSize.height=e.height,this._gameClubSize.icon=e.icon}},{key:"userInfoButtonData",set:function(e){this._userInfoButtonData.width=e.width,this._userInfoButtonData.height=e.height,this._userInfoButtonData.x=e.x,this._userInfoButtonData.y=e.y,this._userInfoButtonData.url=e.url}},{key:"closeRewardVideoListener",set:function(e){this._closeRewardVideoListener=e}}]),e}();s=h,h._instance=new s;e("Wechat",h._instance);i._RF.pop()}}}));

System.register("chunks:///_virtual/weHttp.ts",["./rollupPluginModLoBabelHelpers.js","cc","./weNetworkMgr.ts"],(function(t){var r,n,e;return{setters:[function(t){r=t.createClass},function(t){n=t.cclegacy},function(t){e=t.NetworkMgr}],execute:function(){var o;n._RF.push({},"173afuMo01FM6fOhHVnnAqs","weHttp",void 0);var u=function(){function t(){this._timeOut=1e4,this._httpUrl="",this._apiKey=""}var n=t.prototype;return n.init=function(t,r){this._httpUrl=t,this._apiKey=r},n.post=function(t,r,n){var o="";r&&(o=this.createSign(r));var u=new XMLHttpRequest;u.timeout=this._timeOut,u.open("POST",this._httpUrl+t,!0),u.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),u.send(o),u.onreadystatechange=function(){if(4===u.readyState&&u.status>=200&&u.status<300){var r=u.responseText;if(!r)return void e.onHttpError(n,null,"http request respone is null");e.checkRespone(t,r,n)}}.bind(this),u.ontimeout=function(t){console.error("http request timeout: ",t),e.onHttpError(n,null,"http request timeout: ")}.bind(this),u.onerror=function(t){e.onHttpError(n,t,"http request error: ")}.bind(this)},n.post2=function(t,r,n){var o=this.MsgToString(r),u=new XMLHttpRequest;u.timeout=this._timeOut,u.open("GET",this._httpUrl+t+"?"+o,!0),u.setRequestHeader("Content-Type","text/plain;charset=UTF-8"),u.send(JSON.stringify(r)),u.onreadystatechange=function(){if(4===u.readyState&&u.status>=200&&u.status<300){var r=u.responseText;if(!r)return void e.onHttpError(n,null,"http request respone is null");e.checkRespone(t,r,n)}}.bind(this),u.ontimeout=function(t){console.error("http request timeout: ",t)}.bind(this),u.onerror=function(t){e.onHttpError(n,t,"http request error: ")}.bind(this)},n.MsgToString=function(t){for(var r="",n=0,e=Object.keys(t);n<e.length;n++){var o=e[n];r+=o+'="'+t[o]+'"&'}return r},n.strToDES3=function(t){},n.createSign=function(t){var r=new Array,n=0;for(var e in t)r[n]=e,n++;var o=r.sort(),u="";for(var e in o)(t[o[e]]||"number"==typeof t[o[e]])&&(u+=o[e]+"="+t[o[e]]+"&&");var i=u;return i+="api_key="+this._apiKey,u+="sign="+this.MD5(decodeURIComponent(i))},n.md5encode=function(t){var r,n=function(t,r){t[r>>5]|=128<<r%32,t[14+(r+64>>>9<<4)]=r;for(var n=1732584193,e=-271733879,c=-1732584194,f=271733878,h=0;h<t.length;h+=16){var p=n,l=e,v=c,d=f;n=o(n,e,c,f,t[h+0],7,-680876936),f=o(f,n,e,c,t[h+1],12,-389564586),c=o(c,f,n,e,t[h+2],17,606105819),e=o(e,c,f,n,t[h+3],22,-1044525330),n=o(n,e,c,f,t[h+4],7,-176418897),f=o(f,n,e,c,t[h+5],12,1200080426),c=o(c,f,n,e,t[h+6],17,-1473231341),e=o(e,c,f,n,t[h+7],22,-45705983),n=o(n,e,c,f,t[h+8],7,1770035416),f=o(f,n,e,c,t[h+9],12,-1958414417),c=o(c,f,n,e,t[h+10],17,-42063),e=o(e,c,f,n,t[h+11],22,-1990404162),n=o(n,e,c,f,t[h+12],7,1804603682),f=o(f,n,e,c,t[h+13],12,-40341101),c=o(c,f,n,e,t[h+14],17,-1502002290),e=o(e,c,f,n,t[h+15],22,1236535329),n=u(n,e,c,f,t[h+1],5,-165796510),f=u(f,n,e,c,t[h+6],9,-1069501632),c=u(c,f,n,e,t[h+11],14,643717713),e=u(e,c,f,n,t[h+0],20,-373897302),n=u(n,e,c,f,t[h+5],5,-701558691),f=u(f,n,e,c,t[h+10],9,38016083),c=u(c,f,n,e,t[h+15],14,-660478335),e=u(e,c,f,n,t[h+4],20,-405537848),n=u(n,e,c,f,t[h+9],5,568446438),f=u(f,n,e,c,t[h+14],9,-1019803690),c=u(c,f,n,e,t[h+3],14,-187363961),e=u(e,c,f,n,t[h+8],20,1163531501),n=u(n,e,c,f,t[h+13],5,-1444681467),f=u(f,n,e,c,t[h+2],9,-51403784),c=u(c,f,n,e,t[h+7],14,1735328473),e=u(e,c,f,n,t[h+12],20,-1926607734),n=i(n,e,c,f,t[h+5],4,-378558),f=i(f,n,e,c,t[h+8],11,-2022574463),c=i(c,f,n,e,t[h+11],16,1839030562),e=i(e,c,f,n,t[h+14],23,-35309556),n=i(n,e,c,f,t[h+1],4,-1530992060),f=i(f,n,e,c,t[h+4],11,1272893353),c=i(c,f,n,e,t[h+7],16,-155497632),e=i(e,c,f,n,t[h+10],23,-1094730640),n=i(n,e,c,f,t[h+13],4,681279174),f=i(f,n,e,c,t[h+0],11,-358537222),c=i(c,f,n,e,t[h+3],16,-722521979),e=i(e,c,f,n,t[h+6],23,76029189),n=i(n,e,c,f,t[h+9],4,-640364487),f=i(f,n,e,c,t[h+12],11,-421815835),c=i(c,f,n,e,t[h+15],16,530742520),e=i(e,c,f,n,t[h+2],23,-995338651),n=a(n,e,c,f,t[h+0],6,-198630844),f=a(f,n,e,c,t[h+7],10,1126891415),c=a(c,f,n,e,t[h+14],15,-1416354905),e=a(e,c,f,n,t[h+5],21,-57434055),n=a(n,e,c,f,t[h+12],6,1700485571),f=a(f,n,e,c,t[h+3],10,-1894986606),c=a(c,f,n,e,t[h+10],15,-1051523),e=a(e,c,f,n,t[h+1],21,-2054922799),n=a(n,e,c,f,t[h+8],6,1873313359),f=a(f,n,e,c,t[h+15],10,-30611744),c=a(c,f,n,e,t[h+6],15,-1560198380),e=a(e,c,f,n,t[h+13],21,1309151649),n=a(n,e,c,f,t[h+4],6,-145523070),f=a(f,n,e,c,t[h+11],10,-1120210379),c=a(c,f,n,e,t[h+2],15,718787259),e=a(e,c,f,n,t[h+9],21,-343485551),n=s(n,p),e=s(e,l),c=s(c,v),f=s(f,d)}return Array(n,e,c,f)},e=function(t,r,n,e,o,u){return s(c(s(s(r,t),s(e,u)),o),n)},o=function(t,r,n,o,u,i,a){return e(r&n|~r&o,t,r,u,i,a)},u=function(t,r,n,o,u,i,a){return e(r&o|n&~o,t,r,u,i,a)},i=function(t,r,n,o,u,i,a){return e(r^n^o,t,r,u,i,a)},a=function(t,r,n,o,u,i,a){return e(n^(r|~o),t,r,u,i,a)},s=function(t,r){var n=(65535&t)+(65535&r);return(t>>16)+(r>>16)+(n>>16)<<16|65535&n},c=function(t,r){return t<<r|t>>>32-r};return function(t){for(var r="0123456789abcdef",n="",e=0;e<4*t.length;e++)n+=r.charAt(t[e>>2]>>e%4*8+4&15)+r.charAt(t[e>>2]>>e%4*8&15);return n}(n(function(t){for(var r=Array(),n=0;n<8*t.length;n+=8)r[n>>5]|=(255&t.charCodeAt(n/8))<<n%32;return r}(r=t),8*r.length))},n.MD5=function(t){var r=0;function n(t,r,n,e,o,u){return a((i=a(a(r,t),a(e,u)))<<(s=o)|i>>>32-s,n);var i,s}function e(t,r,e,o,u,i,a){return n(r&e|~r&o,t,r,u,i,a)}function o(t,r,e,o,u,i,a){return n(r&o|e&~o,t,r,u,i,a)}function u(t,r,e,o,u,i,a){return n(r^e^o,t,r,u,i,a)}function i(t,r,e,o,u,i,a){return n(e^(r|~o),t,r,u,i,a)}function a(t,r){var n=(65535&t)+(65535&r);return(t>>16)+(r>>16)+(n>>16)<<16|65535&n}return function(t){for(var n,e=r?"0123456789ABCDEF":"0123456789abcdef",o="",u=0;u<t.length;u++)n=t.charCodeAt(u),o+=e.charAt(n>>>4&15)+e.charAt(15&n);return o}(function(t){return function(t){for(var r="",n=0;n<32*t.length;n+=8)r+=String.fromCharCode(t[n>>5]>>>n%32&255);return r}(function(t,r){t[r>>5]|=128<<r%32,t[14+(r+64>>>9<<4)]=r;for(var n=1732584193,s=-271733879,c=-1732584194,f=271733878,h=0;h<t.length;h+=16){var p=n,l=s,v=c,d=f;n=e(n,s,c,f,t[h+0],7,-680876936),f=e(f,n,s,c,t[h+1],12,-389564586),c=e(c,f,n,s,t[h+2],17,606105819),s=e(s,c,f,n,t[h+3],22,-1044525330),n=e(n,s,c,f,t[h+4],7,-176418897),f=e(f,n,s,c,t[h+5],12,1200080426),c=e(c,f,n,s,t[h+6],17,-1473231341),s=e(s,c,f,n,t[h+7],22,-45705983),n=e(n,s,c,f,t[h+8],7,1770035416),f=e(f,n,s,c,t[h+9],12,-1958414417),c=e(c,f,n,s,t[h+10],17,-42063),s=e(s,c,f,n,t[h+11],22,-1990404162),n=e(n,s,c,f,t[h+12],7,1804603682),f=e(f,n,s,c,t[h+13],12,-40341101),c=e(c,f,n,s,t[h+14],17,-1502002290),n=o(n,s=e(s,c,f,n,t[h+15],22,1236535329),c,f,t[h+1],5,-165796510),f=o(f,n,s,c,t[h+6],9,-1069501632),c=o(c,f,n,s,t[h+11],14,643717713),s=o(s,c,f,n,t[h+0],20,-373897302),n=o(n,s,c,f,t[h+5],5,-701558691),f=o(f,n,s,c,t[h+10],9,38016083),c=o(c,f,n,s,t[h+15],14,-660478335),s=o(s,c,f,n,t[h+4],20,-405537848),n=o(n,s,c,f,t[h+9],5,568446438),f=o(f,n,s,c,t[h+14],9,-1019803690),c=o(c,f,n,s,t[h+3],14,-187363961),s=o(s,c,f,n,t[h+8],20,1163531501),n=o(n,s,c,f,t[h+13],5,-1444681467),f=o(f,n,s,c,t[h+2],9,-51403784),c=o(c,f,n,s,t[h+7],14,1735328473),n=u(n,s=o(s,c,f,n,t[h+12],20,-1926607734),c,f,t[h+5],4,-378558),f=u(f,n,s,c,t[h+8],11,-2022574463),c=u(c,f,n,s,t[h+11],16,1839030562),s=u(s,c,f,n,t[h+14],23,-35309556),n=u(n,s,c,f,t[h+1],4,-1530992060),f=u(f,n,s,c,t[h+4],11,1272893353),c=u(c,f,n,s,t[h+7],16,-155497632),s=u(s,c,f,n,t[h+10],23,-1094730640),n=u(n,s,c,f,t[h+13],4,681279174),f=u(f,n,s,c,t[h+0],11,-358537222),c=u(c,f,n,s,t[h+3],16,-722521979),s=u(s,c,f,n,t[h+6],23,76029189),n=u(n,s,c,f,t[h+9],4,-640364487),f=u(f,n,s,c,t[h+12],11,-421815835),c=u(c,f,n,s,t[h+15],16,530742520),n=i(n,s=u(s,c,f,n,t[h+2],23,-995338651),c,f,t[h+0],6,-198630844),f=i(f,n,s,c,t[h+7],10,1126891415),c=i(c,f,n,s,t[h+14],15,-1416354905),s=i(s,c,f,n,t[h+5],21,-57434055),n=i(n,s,c,f,t[h+12],6,1700485571),f=i(f,n,s,c,t[h+3],10,-1894986606),c=i(c,f,n,s,t[h+10],15,-1051523),s=i(s,c,f,n,t[h+1],21,-2054922799),n=i(n,s,c,f,t[h+8],6,1873313359),f=i(f,n,s,c,t[h+15],10,-30611744),c=i(c,f,n,s,t[h+6],15,-1560198380),s=i(s,c,f,n,t[h+13],21,1309151649),n=i(n,s,c,f,t[h+4],6,-145523070),f=i(f,n,s,c,t[h+11],10,-1120210379),c=i(c,f,n,s,t[h+2],15,718787259),s=i(s,c,f,n,t[h+9],21,-343485551),n=a(n,p),s=a(s,l),c=a(c,v),f=a(f,d)}return Array(n,s,c,f)}(function(t){for(var r=Array(t.length>>2),n=0;n<r.length;n++)r[n]=0;for(n=0;n<8*t.length;n+=8)r[n>>5]|=(255&t.charCodeAt(n/8))<<n%32;return r}(t),8*t.length))}(function(t){for(var r,n,e="",o=-1;++o<t.length;)r=t.charCodeAt(o),n=o+1<t.length?t.charCodeAt(o+1):0,55296<=r&&r<=56319&&56320<=n&&n<=57343&&(r=65536+((1023&r)<<10)+(1023&n),o++),r<=127?e+=String.fromCharCode(r):r<=2047?e+=String.fromCharCode(192|r>>>6&31,128|63&r):r<=65535?e+=String.fromCharCode(224|r>>>12&15,128|r>>>6&63,128|63&r):r<=2097151&&(e+=String.fromCharCode(240|r>>>18&7,128|r>>>12&63,128|r>>>6&63,128|63&r));return e}(t)))},n.get=function(t,r,n,e){var o=new XMLHttpRequest;o.timeout=5e3;var u="?";for(var i in r)"?"!=u&&(u+="&"),u+=i+"="+r[i];null==e&&(e=GHttpClient.url);var a=e+t+u;return o.open("GET",a,!0),o.onreadystatechange=function(){if(4===o.readyState&&o.status>=200&&o.status<300)try{var t=JSON.parse(o.responseText);null!==n&&n(null,t)}catch(t){null!==n&&n(t)}},o.send(),o},r(t,[{key:"timeOut",set:function(t){this._timeOut=t}},{key:"httpUrl",set:function(t){this._httpUrl=t}}]),t}();o=u,u._instance=new o;t("Http",u._instance);n._RF.pop()}}}));

System.register("chunks:///_virtual/weNetworkMgr.ts",["./rollupPluginModLoBabelHelpers.js","cc","./weHttp.ts"],(function(e){var t,s,i;return{setters:[function(e){t=e.createClass},function(e){s=e.cclegacy},function(e){i=e.Http}],execute:function(){var r;s._RF.push({},"2991fUDIpdHqILuAYJgQGGA","weNetworkMgr",void 0);var a=function(){function e(){this.mid=0,this.messageList={},this.limitMessageNum=5,this.timer=null,this.token="",this.isLock=!1,this._dealHeadListener=null,this._encryptRule=["mid:","uid:","key:","data:"],this._encryptCode="zqkg",this._intervalTime=3e3,this._errorServerCode=500,this._successCode=0,this._errorRestartGameCode=[102],this._errorNetCode={},this._overTime=5e3,this._uid=0,this.lastMessage=null,this.mid=0,this.messageList={},this.timer=null}var s=e.prototype;return s.xhrPost=function(e,t,s,i,r){void 0===r&&(r=!1),this.mid+=1;var a={head:{route:e,mid:this.mid.toString(),uid:this._uid},body:t},o=new n;o.route=e,o.mid=this.mid,o.data=a,s&&(o.callback=s),o.isRepeat=r,i&&(o.failCallBack=i),this.messageList[this.mid]=o,this.startTimer(),this.isLock||this.sendMessage(this.mid)},s.checkRespone=function(e,t,s){var i=this.jsdecrypt(t),r=this.messageList[s];this.succeedResponeBody(r,i,s)},s.succeedResponeHead=function(e){this._dealHeadListener&&this._dealHeadListener(e)},s.succeedResponeBody=function(e,t,s){this.isLock=!1,this.clearTimer(),this.deleteMessageListItem(s,!1),this.checkNextMessage(),e&&e.callback&&e.callback(t)},s.checkErrorCode=function(e,t){e!==this._errorServerCode&&this.deleteMessageListItem(t,!0);for(var s=0;s<this._errorRestartGameCode.length;s++){e===this._errorRestartGameCode[s]&&this.restartGame()}var i=this.getErrorCodeMeaning(e);console.error("----\x3e 返回错误, code:",e,i)},s.checkNextMessage=function(){for(var e in this.messageList){var t=this.messageList[e];0===t.sendNum&&this.sendMessage(t.mid)}},s.deleteMessageListItem=function(e,t){this.messageList&&this.messageList[e]&&(this.messageList[e].failCallBack&&t&&this.messageList[e].failCallBack(),delete this.messageList[e])},s.jsdecrypt=function(e){var t=null;if("string"==typeof e)try{t=JSON.parse(e)}catch(e){}return t},s.sendMessage=function(e,t){if(void 0===t&&(t=!0),0!==Object.keys(this.messageList).length){var s=this.messageList[e];if(t&&s.sendNum>=this.limitMessageNum||!t&&s.errorNum>=this.limitMessageNum)return console.error(s.data.head.route,"message send too much times"),void this.deleteMessageListItem(e,!1);s.sendNum+=1;var r=s.data,a=r.head.route;r.head.token=this.token,this.lastMessage=s,i.post(a,r.body,e)}},s.getErrorCodeMeaning=function(e){var t=this._errorNetCode[e],s=t;return t||(s="服务器错误码： "+e),s},s.restartGame=function(){},s.startTimer=function(){this.timer||(this.timer=setInterval(this.checkPackage.bind(this),this._intervalTime))},s.checkPackage=function(){if(0!==Object.keys(this.messageList).length)for(var e in this.messageList){var t=this.messageList[e];if(Date.now()-t.time>this._overTime&&t.isRepeat){var s=t.mid;this.sendMessage(s);break}this.deleteMessageListItem(t.mid,!1)}else this.clearTimer()},s.clearTimer=function(){this.timer&&(clearInterval(this.timer),this.timer=0)},s.onHttpError=function(e,t,s){var i=this;s?console.error("----\x3e onHttpError",s,t):console.error("----\x3e onHttpError",t);var r=this.messageList[e];r&&(r.isRepeat?setTimeout((function(){r.errorNum++,i.sendMessage(e,!1)}),3e3):this.deleteMessageListItem(e,!0))},t(e,[{key:"errorNetCode",set:function(e){this._errorNetCode=e}},{key:"encryptCode",set:function(e){this._encryptCode=e}},{key:"errorRestartGameCode",set:function(e){this._errorRestartGameCode=e}},{key:"successCode",set:function(e){this._successCode=e}},{key:"errorServerCode",set:function(e){this._errorServerCode=e}},{key:"encryptRule",set:function(e){this._encryptRule=e}},{key:"intervalTime",set:function(e){this._intervalTime=e}},{key:"overTime",set:function(e){this._overTime=e}},{key:"dealHeadListener",set:function(e){this._dealHeadListener=e}},{key:"uid",set:function(e){this._uid=e}}]),e}();r=a,a._instance=new r;e("NetworkMgr",a._instance);var n=e("default",(function(e){for(var t in this.route="",this.lock=!1,this.mid=0,this.data=null,this.callback=null,this.failCallBack=null,this.time=0,this.sendNum=0,this.errorNum=0,this.isRepeat=!1,this.time=Date.now(),e){this[t]=e[t]}}));s._RF.pop()}}}));

System.register("chunks:///_virtual/wmsocket.ts",["cc","./env","./tyqSDK.ts","./conf.ts"],(function(t){var n,s,e,i,c,o;return{setters:[function(t){n=t.cclegacy,s=t._decorator,e=t.director},function(t){i=t.NATIVE},function(t){c=t.tyqSDK},function(t){o=t.GNetCmd}],execute:function(){var r,h;n._RF.push({},"9880dNyHD1CKppdHqsFlPoY","wmsocket",void 0);var a=s.ccclass;s.property,t("WmSocket",a("WmSocket")(((h=function(){function t(){this.eventHandlers=[],this.lastHeartbeatTime=0,this.isWsConnect=!1,this.ws=null,this.wxws=null,this.msgBuff={},this.isFirst=!0,this.addListener()}t.getInstance=function(){return this._instance||(this._instance=new t),this._instance};var n=t.prototype;return n.addListener=function(){e.on("ws_reconnect",this.onReconnect,this),e.on("ws_close",this.onClose,this),e.on(o.StickPack,this.respStickPack,this)},n.respStickPack=function(t){0==t.isEnd?this.sendStickPack(t.stick_id,t.idx+1):delete this.msgBuff[t.stick_id]},n.getGuid=function(){var t=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(n){var s=(t+16*Math.random())%16|0;return t=Math.floor(t/16),("x"==n?s:3&s|8).toString(16)}))},n.getTotalLen=function(t){for(var n=0,s=0;s<t.length;s++)n+=t[s].length;return n},n.sendStickPack=function(n,s){var e={cmd:o.StickPack,stick_id:n,stick_len:this.getTotalLen(this.msgBuff[n]),stick_val:this.msgBuff[n][s],isEnd:s==this.msgBuff[n].length-1,isStart:0==s,idx:s};t.getInstance().sendSP(JSON.stringify(e))},n.onReconnect=function(){this.isFirst?(this.isFirst=!1,this.connect(),console.log("发起第一次连-------")):this.isConnected()||(this.connect(),console.log("发起重连-------"))},n.onClose=function(){this.isConnected()&&(t.getInstance().isWsConnect?this.wxws.close():this.ws.close())},n.connect=function(){this.ws_connect()},n.ws_connect=function(){console.log("ws_connect...........................");try{i||(this.ws=new WebSocket(c.getUrl().wsUrl))}catch(t){console.error("网络连接异常 --- exception---------------- ",t)}},n.onMessage=function(t){var n=JSON.parse(t);e.emit(n.cmd+"",n)},n.isConnected=function(){return this.isWsConnect},n.sendSP=function(t){this.isConnected()&&this.ws.send(t)},n.send=function(t){if(this.isConnected()){var n=JSON.stringify(t.data),s=21917.2;if(n.length>s){var e=n,i=[],c=n.length/s+1,o=0;for(e.length;o<c;o++){var r=e.slice(s*o,s*(o+1));i.push(r)}var h=this.getGuid();return this.msgBuff[h]=i,void this.sendStickPack(h,0)}this.ws.send(n)}},t}())._instance=void 0,r=h))||r);n._RF.pop()}}}));

System.register("chunks:///_virtual/WXCustomAd.ts",["cc","./tyqSDK.ts"],(function(t){var i,n;return{setters:[function(t){i=t.cclegacy},function(t){n=t.tyqSDK}],execute:function(){i._RF.push({},"66f499zhQ5ApIF9FuOwpPWZ","WXCustomAd",void 0);t("EType",function(t){return t[t.rect=1]="rect",t[t.horizontal=2]="horizontal",t[t.vertical=3]="vertical",t[t.grid=4]="grid",t}({}));var s=t("WXCustomAd",function(){function t(){this.cb=void 0}return t.setadunit=function(t,i,n,s){this._customc_rect_adunit=t,this._customc_h_adunit=i,this._customc_v_adunit=n,this._customc_one_adunit=s},t.createCustomAd=function(t,i,s,o,e,c){var r=this;if(window.wx){this.sysInfo||(this.sysInfo=wx.getSystemInfoSync());var h=this.sysInfo.SDKVersion,u=null,d="",a=this;if(c&&(this.cb=c),1==i?d=this._customc_rect_adunit[this.rand(0,this._customc_rect_adunit.length-1)]:2==i?d=this._customc_h_adunit[this.rand(0,this._customc_h_adunit.length-1)]:3==i?d=this._customc_v_adunit[this.rand(0,this._customc_v_adunit.length-1)]:4==i&&(d=this._customc_one_adunit[this.rand(0,this._customc_one_adunit.length-1)]),e&&""!==e&&("string"==typeof e?d=e:e instanceof Array&&(d=e[this.rand(0,e.length-1)])),""!=d)if(n.log("显示原生模板广告",t,this._ads,this._waits),this._ads[t])u=this._ads[t],n.log("缓存有"),u.isShow()||u.show();else if(this.compareVersion(h,"2.11.1")>=0){n.log("创建原生模板广告"+t,"id:"+d,"pos:",s);var _=a.getPos(o,s);(u=wx.createCustomAd({adUnitId:d,adIntervals:30,style:{top:_.top,left:_.left,width:o.width,fixed:!1}})).onLoad((function(){a._ads[t]=u;var i=a._waits.indexOf(t);n.log("原生模板广告加载完成："+t,a._waits,i),-1==i?u.show():(a._waits=a._waits.filter((function(i){return i!=t})),u.hide().then((function(){})).catch((function(){n.log("第二次hide"),u.hide().catch((function(){n.log("第三次hide")}))})))})),u.onError((function(t){n.log("原生模板广告加载失败:",t.errCode," ",t.errMsg),1004===parseInt(t.errCode)&&r.cb&&(n.log("拉取失败"),r.cb())})),u.onClose((function(){n.log("原生模板广告关闭")}))}}},t.rand=function(t,i){return t+Math.floor(Math.random()*(i-t+1))},t.destroyCustomAd=function(t){this._ads[t]&&(this._ads[t].destroy(),this._ads[t]=null)},t.compareVersion=function(t,i){t=t.split("."),i=i.split(".");for(var n=Math.max(t.length,i.length);t.length<n;)t.push("0");for(;i.length<n;)i.push("0");for(var s=0;s<n;s++){var o=parseInt(t[s]),e=parseInt(i[s]);if(o>e)return 1;if(o<e)return-1}return 0},t.getPos=function(t,i){this.sysInfo||(this.sysInfo=wx.getSystemInfoSync());var n=this.sysInfo,s=t.width,o=t.height,e=n.windowWidth/cc.winSize.width,c=n.windowHeight/cc.winSize.height,r=(n.windowWidth-s)/2,h=(n.windowHeight-o)/2;return i&&null!=i.left&&(r=i.left*e),i&&null!=i.top&&(h=i.top*c),i&&null!=i.right&&(r=n.windowWidth-s-i.right*e),i&&null!=i.bottom&&(h=n.windowHeight-o-i.bottom*c),i&&null!=i.centerX&&(r=(n.windowWidth-s)/2+i.centerX*e),i&&null!=i.centerY&&(h=(n.windowHeight-o)/2+i.centerY*c),{left:r,top:h}},t}());s._customc_rect_adunit=[],s._customc_h_adunit=[],s._customc_v_adunit=[],s._customc_one_adunit=[],s._ads={},s._waits=[],s.sysInfo=null,s.cb=void 0,i._RF.pop()}}}));

(function(r) {
  r('virtual:///prerequisite-imports/main', 'chunks:///_virtual/main'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    return {
        setters: [function(_m) {
            var _exportObj = {};

            for (var _key in _m) {
              if (_key !== "default" && _key !== "__esModule") _exportObj[_key] = _m[_key];
            }
      
            _export(_exportObj);
        }],
        execute: function () { }
    };
    });
});